# Comparing `tmp/pyramids-gis-0.4.1.tar.gz` & `tmp/pyramids-gis-0.4.2.tar.gz`

## filetype from file(1)

```diff
@@ -1 +1 @@
-gzip compressed data, was "pyramids-gis-0.4.1.tar", last modified: Sun Apr 23 10:28:21 2023, max compression
+gzip compressed data, was "pyramids-gis-0.4.2.tar", last modified: Thu Apr 27 02:36:11 2023, max compression
```

## Comparing `pyramids-gis-0.4.1.tar` & `pyramids-gis-0.4.2.tar`

### file list

```diff
@@ -1,27 +1,27 @@
-drwxrwxrwx   0        0        0        0 2023-04-23 10:28:21.981789 pyramids-gis-0.4.1/
--rw-rw-rw-   0        0        0      173 2023-01-23 00:40:23.000000 pyramids-gis-0.4.1/AUTHORS.rst
--rw-rw-rw-   0        0        0    35591 2023-01-23 00:40:23.000000 pyramids-gis-0.4.1/LICENSE.md
--rw-rw-rw-   0        0        0    10664 2023-04-23 10:28:21.980820 pyramids-gis-0.4.1/PKG-INFO
--rw-rw-rw-   0        0        0     7028 2023-04-23 10:21:27.000000 pyramids-gis-0.4.1/README.md
-drwxrwxrwx   0        0        0        0 2023-04-23 10:28:21.966210 pyramids-gis-0.4.1/pyramids/
--rw-rw-rw-   0        0        0     1036 2023-01-23 00:40:23.000000 pyramids-gis-0.4.1/pyramids/__init__.py
--rw-rw-rw-   0        0        0     1222 2023-04-23 10:21:27.000000 pyramids-gis-0.4.1/pyramids/_errors.py
--rw-rw-rw-   0        0        0     8542 2023-04-23 10:21:27.000000 pyramids-gis-0.4.1/pyramids/_io.py
--rw-rw-rw-   0        0        0     7101 2023-04-23 10:21:27.000000 pyramids-gis-0.4.1/pyramids/_utils.py
--rw-rw-rw-   0        0        0   141798 2023-04-23 10:21:27.000000 pyramids-gis-0.4.1/pyramids/dataset.py
--rw-rw-rw-   0        0        0    22445 2023-04-23 10:21:27.000000 pyramids-gis-0.4.1/pyramids/dem.py
--rw-rw-rw-   0        0        0    38125 2023-04-23 10:21:27.000000 pyramids-gis-0.4.1/pyramids/featurecollection.py
--rw-rw-rw-   0        0        0     5701 2023-04-11 20:12:29.000000 pyramids-gis-0.4.1/pyramids/gdal_drivers.yaml
--rw-rw-rw-   0        0        0     6285 2023-04-11 20:12:29.000000 pyramids-gis-0.4.1/pyramids/ogr_drivers.yaml
-drwxrwxrwx   0        0        0        0 2023-04-23 10:28:21.973258 pyramids-gis-0.4.1/pyramids_gis.egg-info/
--rw-rw-rw-   0        0        0    10664 2023-04-23 10:28:21.000000 pyramids-gis-0.4.1/pyramids_gis.egg-info/PKG-INFO
--rw-rw-rw-   0        0        0      487 2023-04-23 10:28:21.000000 pyramids-gis-0.4.1/pyramids_gis.egg-info/SOURCES.txt
--rw-rw-rw-   0        0        0        1 2023-04-23 10:28:21.000000 pyramids-gis-0.4.1/pyramids_gis.egg-info/dependency_links.txt
--rw-rw-rw-   0        0        0        2 2023-04-23 10:28:21.000000 pyramids-gis-0.4.1/pyramids_gis.egg-info/not-zip-safe
--rw-rw-rw-   0        0        0      145 2023-04-23 10:28:21.000000 pyramids-gis-0.4.1/pyramids_gis.egg-info/requires.txt
--rw-rw-rw-   0        0        0        9 2023-04-23 10:28:21.000000 pyramids-gis-0.4.1/pyramids_gis.egg-info/top_level.txt
--rw-rw-rw-   0        0        0       42 2023-04-23 10:28:21.981789 pyramids-gis-0.4.1/setup.cfg
--rw-rw-rw-   0        0        0     1752 2023-04-23 10:21:27.000000 pyramids-gis-0.4.1/setup.py
-drwxrwxrwx   0        0        0        0 2023-04-23 10:28:21.977793 pyramids-gis-0.4.1/tests/
--rw-rw-rw-   0        0        0     4744 2023-04-23 10:21:27.000000 pyramids-gis-0.4.1/tests/test_io.py
--rw-rw-rw-   0        0        0     1453 2023-04-23 10:21:27.000000 pyramids-gis-0.4.1/tests/test_utils.py
+drwxrwxrwx   0        0        0        0 2023-04-27 02:36:11.197923 pyramids-gis-0.4.2/
+-rw-rw-rw-   0        0        0      173 2023-01-23 00:40:23.000000 pyramids-gis-0.4.2/AUTHORS.rst
+-rw-rw-rw-   0        0        0    35591 2023-01-23 00:40:23.000000 pyramids-gis-0.4.2/LICENSE.md
+-rw-rw-rw-   0        0        0    11089 2023-04-27 02:36:11.196925 pyramids-gis-0.4.2/PKG-INFO
+-rw-rw-rw-   0        0        0     7082 2023-04-27 02:28:30.000000 pyramids-gis-0.4.2/README.md
+drwxrwxrwx   0        0        0        0 2023-04-27 02:36:11.177858 pyramids-gis-0.4.2/pyramids/
+-rw-rw-rw-   0        0        0     1036 2023-01-23 00:40:23.000000 pyramids-gis-0.4.2/pyramids/__init__.py
+-rw-rw-rw-   0        0        0     1222 2023-04-26 16:17:57.000000 pyramids-gis-0.4.2/pyramids/_errors.py
+-rw-rw-rw-   0        0        0     8542 2023-04-26 16:17:57.000000 pyramids-gis-0.4.2/pyramids/_io.py
+-rw-rw-rw-   0        0        0     7101 2023-04-26 16:17:57.000000 pyramids-gis-0.4.2/pyramids/_utils.py
+-rw-rw-rw-   0        0        0   143488 2023-04-27 02:28:30.000000 pyramids-gis-0.4.2/pyramids/dataset.py
+-rw-rw-rw-   0        0        0    22445 2023-04-26 16:17:57.000000 pyramids-gis-0.4.2/pyramids/dem.py
+-rw-rw-rw-   0        0        0    38126 2023-04-27 02:28:30.000000 pyramids-gis-0.4.2/pyramids/featurecollection.py
+-rw-rw-rw-   0        0        0     5701 2023-04-26 16:17:57.000000 pyramids-gis-0.4.2/pyramids/gdal_drivers.yaml
+-rw-rw-rw-   0        0        0     6285 2023-04-26 16:17:57.000000 pyramids-gis-0.4.2/pyramids/ogr_drivers.yaml
+drwxrwxrwx   0        0        0        0 2023-04-27 02:36:11.188371 pyramids-gis-0.4.2/pyramids_gis.egg-info/
+-rw-rw-rw-   0        0        0    11089 2023-04-27 02:36:10.000000 pyramids-gis-0.4.2/pyramids_gis.egg-info/PKG-INFO
+-rw-rw-rw-   0        0        0      487 2023-04-27 02:36:11.000000 pyramids-gis-0.4.2/pyramids_gis.egg-info/SOURCES.txt
+-rw-rw-rw-   0        0        0        1 2023-04-27 02:36:10.000000 pyramids-gis-0.4.2/pyramids_gis.egg-info/dependency_links.txt
+-rw-rw-rw-   0        0        0        2 2023-04-27 02:36:10.000000 pyramids-gis-0.4.2/pyramids_gis.egg-info/not-zip-safe
+-rw-rw-rw-   0        0        0      145 2023-04-27 02:36:10.000000 pyramids-gis-0.4.2/pyramids_gis.egg-info/requires.txt
+-rw-rw-rw-   0        0        0        9 2023-04-27 02:36:10.000000 pyramids-gis-0.4.2/pyramids_gis.egg-info/top_level.txt
+-rw-rw-rw-   0        0        0       42 2023-04-27 02:36:11.197923 pyramids-gis-0.4.2/setup.cfg
+-rw-rw-rw-   0        0        0     1752 2023-04-27 02:28:30.000000 pyramids-gis-0.4.2/setup.py
+drwxrwxrwx   0        0        0        0 2023-04-27 02:36:11.193367 pyramids-gis-0.4.2/tests/
+-rw-rw-rw-   0        0        0     4744 2023-04-26 16:17:58.000000 pyramids-gis-0.4.2/tests/test_io.py
+-rw-rw-rw-   0        0        0     1453 2023-04-26 16:17:58.000000 pyramids-gis-0.4.2/tests/test_utils.py
```

### Comparing `pyramids-gis-0.4.1/LICENSE.md` & `pyramids-gis-0.4.2/LICENSE.md`

 * *Files identical despite different names*

### Comparing `pyramids-gis-0.4.1/PKG-INFO` & `pyramids-gis-0.4.2/PKG-INFO`

 * *Files 6% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: pyramids-gis
-Version: 0.4.1
+Version: 0.4.2
 Summary: GIS utility package
 Home-page: https://github.com/MAfarrag/pyramids
 Author: Mostafa Farrag
 Author-email: moah.farag@gmail.come
 License: GNU General Public License v3
 Keywords: GIS,gdal
 Classifier: Development Status :: 5 - Production/Stable
@@ -33,15 +33,16 @@
 ![GitHub last commit](https://img.shields.io/github/last-commit/MAfarrag/pyramids)
 ![GitHub forks](https://img.shields.io/github/forks/MAfarrag/pyramids?style=social)
 ![GitHub Repo stars](https://img.shields.io/github/stars/MAfarrag/pyramids?style=social)
 [![codecov](https://codecov.io/gh/Serapieum-of-alex/pyramids/branch/main/graph/badge.svg?token=g0DV4dCa8N)](https://codecov.io/gh/Serapieum-of-alex/pyramids)
 [![Codacy Badge](https://app.codacy.com/project/badge/Grade/5e3aa4d0acc843d1a91caf33545ecf03)](https://www.codacy.com/gh/Serapieum-of-alex/pyramids/dashboard?utm_source=github.com&amp;utm_medium=referral&amp;utm_content=Serapieum-of-alex/pyramids&amp;utm_campaign=Badge_Grade)
 
 
-![GitHub commits since latest release (by SemVer including pre-releases)](https://img.shields.io/github/commits-since/mafarrag/pyramids/0.4.1?include_prereleases&style=plastic)
+![GitHub commits since latest release (by SemVer including pre-releases)](https://img.shields.
+io/github/commits-since/mafarrag/pyramids/0.4.2?include_prereleases&style=plastic)
 ![GitHub last commit](https://img.shields.io/github/last-commit/mafarrag/pyramids)
 
 Current release info
 ====================
 
 | Name                                                                                                                 | Downloads                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | Version                                                                                                                                                                                                                                                                                                                                                 | Platforms |
 |----------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------| --- |
@@ -49,14 +50,16 @@
 
 pyramids - GIS utility package
 =====================================================================
 **pyramids** is a GIS utility package using gdal, ....
 
 pyramids
 
+![1](/docs/images/package-work-flow/overall.png)
+
 Main Features
 -------------
   - GIS modules to enable the modeler to fully prepare the meteorological inputs and do all the preprocessing
     needed to build the model (align rasters with the DEM), in addition to various methods to manipulate and
     convert different forms of distributed data (rasters, NetCDF, shapefiles)
 
 
@@ -68,15 +71,15 @@
 
 Installing pyramids
 ===============
 
 Installing `pyramids` from the `conda-forge` channel can be achieved by:
 
 ```
-conda install -c conda-forge pyramids=0.4.1
+conda install -c conda-forge pyramids=0.4.2
 ```
 
 It is possible to list all of the versions of `pyramids` available on your platform with:
 
 ```
 conda search pyramids --channel conda-forge
 ```
@@ -86,15 +89,15 @@
 ```
 pip install git+https://github.com/Serapieum-of-alex/pyramids
 ```
 
 ## pip
 to install the last release you can easly use pip
 ```
-pip install pyramids-gis==0.4.1
+pip install pyramids-gis==0.4.2
 ```
 
 Quick start
 ===========
 
 ```
   >>> import pyramids
@@ -176,7 +179,14 @@
 * adjust all spatial operation functions to work with multi-band rasters.
 * use gdal exceptions to capture runtime error of not finding the the file.
 * add cluster method to dataset class.
 * time_stamp attribute returns None if there is no time_stamp.
 * restructure the no_data_value related functions.
 * plot function can plot rgb imagr for multi-band rasters.
 * to_file detect the driver type from the extension in the path.
+
+0.4.2 (2023-04-27)
+------------------
+* fix bug in plotting dataset without specifying the band
+* fix bug in passing ot not passing band index in case of multi band rasters
+* change the bounds in to_dataset method to total_bounds tp get the bbox of the whole geometries in the gdf
+* add convert_longitude method to convert longitude to range between -180 and 180
```

### Comparing `pyramids-gis-0.4.1/README.md` & `pyramids-gis-0.4.2/README.md`

 * *Files 2% similar despite different names*

```diff
@@ -9,15 +9,16 @@
 ![GitHub last commit](https://img.shields.io/github/last-commit/MAfarrag/pyramids)
 ![GitHub forks](https://img.shields.io/github/forks/MAfarrag/pyramids?style=social)
 ![GitHub Repo stars](https://img.shields.io/github/stars/MAfarrag/pyramids?style=social)
 [![codecov](https://codecov.io/gh/Serapieum-of-alex/pyramids/branch/main/graph/badge.svg?token=g0DV4dCa8N)](https://codecov.io/gh/Serapieum-of-alex/pyramids)
 [![Codacy Badge](https://app.codacy.com/project/badge/Grade/5e3aa4d0acc843d1a91caf33545ecf03)](https://www.codacy.com/gh/Serapieum-of-alex/pyramids/dashboard?utm_source=github.com&amp;utm_medium=referral&amp;utm_content=Serapieum-of-alex/pyramids&amp;utm_campaign=Badge_Grade)
 
 
-![GitHub commits since latest release (by SemVer including pre-releases)](https://img.shields.io/github/commits-since/mafarrag/pyramids/0.4.1?include_prereleases&style=plastic)
+![GitHub commits since latest release (by SemVer including pre-releases)](https://img.shields.
+io/github/commits-since/mafarrag/pyramids/0.4.2?include_prereleases&style=plastic)
 ![GitHub last commit](https://img.shields.io/github/last-commit/mafarrag/pyramids)
 
 Current release info
 ====================
 
 | Name                                                                                                                 | Downloads                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | Version                                                                                                                                                                                                                                                                                                                                                 | Platforms |
 |----------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------| --- |
@@ -25,14 +26,16 @@
 
 pyramids - GIS utility package
 =====================================================================
 **pyramids** is a GIS utility package using gdal, ....
 
 pyramids
 
+![1](/docs/images/package-work-flow/overall.png)
+
 Main Features
 -------------
   - GIS modules to enable the modeler to fully prepare the meteorological inputs and do all the preprocessing
     needed to build the model (align rasters with the DEM), in addition to various methods to manipulate and
     convert different forms of distributed data (rasters, NetCDF, shapefiles)
 
 
@@ -44,15 +47,15 @@
 
 Installing pyramids
 ===============
 
 Installing `pyramids` from the `conda-forge` channel can be achieved by:
 
 ```
-conda install -c conda-forge pyramids=0.4.1
+conda install -c conda-forge pyramids=0.4.2
 ```
 
 It is possible to list all of the versions of `pyramids` available on your platform with:
 
 ```
 conda search pyramids --channel conda-forge
 ```
@@ -62,15 +65,15 @@
 ```
 pip install git+https://github.com/Serapieum-of-alex/pyramids
 ```
 
 ## pip
 to install the last release you can easly use pip
 ```
-pip install pyramids-gis==0.4.1
+pip install pyramids-gis==0.4.2
 ```
 
 Quick start
 ===========
 
 ```
   >>> import pyramids
```

### Comparing `pyramids-gis-0.4.1/pyramids/__init__.py` & `pyramids-gis-0.4.2/pyramids/__init__.py`

 * *Files identical despite different names*

### Comparing `pyramids-gis-0.4.1/pyramids/_errors.py` & `pyramids-gis-0.4.2/pyramids/_errors.py`

 * *Files identical despite different names*

### Comparing `pyramids-gis-0.4.1/pyramids/_io.py` & `pyramids-gis-0.4.2/pyramids/_io.py`

 * *Files identical despite different names*

### Comparing `pyramids-gis-0.4.1/pyramids/_utils.py` & `pyramids-gis-0.4.2/pyramids/_utils.py`

 * *Files identical despite different names*

### Comparing `pyramids-gis-0.4.1/pyramids/dataset.py` & `pyramids-gis-0.4.2/pyramids/dataset.py`

 * *Files 1% similar despite different names*

```diff
@@ -238,8626 +238,8731 @@
 00000ed0: 2020 2020 2020 2020 2020 4e75 6d62 6572            Number
 00000ee0: 206f 6620 4261 6e64 733a 207b 7365 6c66   of Bands: {self
 00000ef0: 2e62 616e 645f 636f 756e 747d 0d0a 2020  .band_count}..  
 00000f00: 2020 2020 2020 2020 2020 4261 6e64 206e            Band n
 00000f10: 616d 6573 3a20 7b73 656c 662e 6261 6e64  ames: {self.band
 00000f20: 5f6e 616d 6573 7d0d 0a20 2020 2020 2020  _names}..       
 00000f30: 2020 2020 2044 696d 656e 7369 6f6e 3a20       Dimension: 
-00000f40: 7b73 656c 662e 726f 7773 202a 2073 656c  {self.rows * sel
-00000f50: 662e 636f 6c75 6d6e 737d 0d0a 2020 2020  f.columns}..    
-00000f60: 2020 2020 2020 2020 4d61 736b 3a20 7b73          Mask: {s
-00000f70: 656c 662e 5f6e 6f5f 6461 7461 5f76 616c  elf._no_data_val
-00000f80: 7565 5b30 5d7d 0d0a 2020 2020 2020 2020  ue[0]}..        
-00000f90: 2020 2020 4461 7461 2074 7970 653a 207b      Data type: {
-00000fa0: 7365 6c66 2e64 7479 7065 5b30 5d7d 0d0a  self.dtype[0]}..
-00000fb0: 2020 2020 2020 2020 2222 220d 0a20 2020          """..   
-00000fc0: 2020 2020 2072 6574 7572 6e20 6d65 7373       return mess
-00000fd0: 6167 650d 0a0d 0a20 2020 2064 6566 205f  age....    def _
-00000fe0: 5f72 6570 725f 5f28 7365 6c66 293a 0d0a  _repr__(self):..
-00000ff0: 2020 2020 2020 2020 6d65 7373 6167 6520          message 
-00001000: 3d20 2222 220d 0a20 2020 2020 2020 2020  = """..         
-00001010: 2020 2046 696c 653a 207b 307d 0d0a 2020     File: {0}..  
-00001020: 2020 2020 2020 2020 2020 4365 6c6c 2073            Cell s
-00001030: 697a 653a 207b 317d 0d0a 2020 2020 2020  ize: {1}..      
-00001040: 2020 2020 2020 4550 5347 3a20 7b32 7d0d        EPSG: {2}.
-00001050: 0a20 2020 2020 2020 2020 2020 2056 6172  .            Var
-00001060: 6961 626c 6573 3a20 7b33 7d0d 0a20 2020  iables: {3}..   
-00001070: 2020 2020 2020 2020 204e 756d 6265 7220           Number 
-00001080: 6f66 2042 616e 6473 3a20 7b34 7d0d 0a20  of Bands: {4}.. 
-00001090: 2020 2020 2020 2020 2020 2042 616e 6420             Band 
-000010a0: 6e61 6d65 733a 207b 357d 0d0a 2020 2020  names: {5}..    
-000010b0: 2020 2020 2020 2020 4469 6d65 6e73 696f          Dimensio
-000010c0: 6e3a 207b 367d 202a 207b 377d 0d0a 2020  n: {6} * {7}..  
-000010d0: 2020 2020 2020 2020 2020 4d61 736b 3a20            Mask: 
-000010e0: 7b38 7d0d 0a20 2020 2020 2020 2020 2020  {8}..           
-000010f0: 2044 6174 6120 7479 7065 3a20 7b39 7d0d   Data type: {9}.
-00001100: 0a20 2020 2020 2020 2020 2020 2070 726f  .            pro
-00001110: 6a65 6374 696f 6e3a 207b 3130 7d0d 0a20  jection: {10}.. 
-00001120: 2020 2020 2020 2020 2020 204d 6574 6164             Metad
-00001130: 6174 613a 207b 3131 7d0d 0a20 2020 2020  ata: {11}..     
-00001140: 2020 2022 2222 2e66 6f72 6d61 7428 0d0a     """.format(..
-00001150: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00001160: 2e66 696c 655f 6e61 6d65 2c0d 0a20 2020  .file_name,..   
-00001170: 2020 2020 2020 2020 2073 656c 662e 6365           self.ce
-00001180: 6c6c 5f73 697a 652c 0d0a 2020 2020 2020  ll_size,..      
-00001190: 2020 2020 2020 7365 6c66 2e65 7073 672c        self.epsg,
-000011a0: 0d0a 2020 2020 2020 2020 2020 2020 7365  ..            se
-000011b0: 6c66 2e76 6172 6961 626c 6573 2c0d 0a20  lf.variables,.. 
-000011c0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-000011d0: 6261 6e64 5f63 6f75 6e74 2c0d 0a20 2020  band_count,..   
-000011e0: 2020 2020 2020 2020 2073 656c 662e 6261           self.ba
-000011f0: 6e64 5f6e 616d 6573 2c0d 0a20 2020 2020  nd_names,..     
-00001200: 2020 2020 2020 2073 656c 662e 726f 7773         self.rows
-00001210: 2c0d 0a20 2020 2020 2020 2020 2020 2073  ,..            s
-00001220: 656c 662e 636f 6c75 6d6e 732c 0d0a 2020  elf.columns,..  
-00001230: 2020 2020 2020 2020 2020 7365 6c66 2e5f            self._
-00001240: 6e6f 5f64 6174 615f 7661 6c75 655b 305d  no_data_value[0]
-00001250: 2c0d 0a20 2020 2020 2020 2020 2020 2073  ,..            s
-00001260: 656c 662e 6474 7970 655b 305d 2c0d 0a20  elf.dtype[0],.. 
-00001270: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-00001280: 6372 732c 0d0a 2020 2020 2020 2020 2020  crs,..          
-00001290: 2020 7365 6c66 2e6d 6574 615f 6461 7461    self.meta_data
-000012a0: 2c0d 0a20 2020 2020 2020 2029 0d0a 2020  ,..        )..  
-000012b0: 2020 2020 2020 7265 7475 726e 206d 6573        return mes
-000012c0: 7361 6765 0d0a 0d0a 2020 2020 4070 726f  sage....    @pro
-000012d0: 7065 7274 790d 0a20 2020 2064 6566 2072  perty..    def r
-000012e0: 6173 7465 7228 7365 6c66 2920 2d3e 2067  aster(self) -> g
-000012f0: 6461 6c2e 4461 7461 7365 743a 0d0a 2020  dal.Dataset:..  
-00001300: 2020 2020 2020 2222 2247 4441 4c20 4461        """GDAL Da
-00001310: 7461 7365 7422 2222 0d0a 2020 2020 2020  taset"""..      
-00001320: 2020 7265 7475 726e 2073 656c 662e 5f72    return self._r
-00001330: 6173 7465 720d 0a0d 0a20 2020 2040 7261  aster....    @ra
-00001340: 7374 6572 2e73 6574 7465 720d 0a20 2020  ster.setter..   
-00001350: 2064 6566 2072 6173 7465 7228 7365 6c66   def raster(self
-00001360: 2c20 7661 6c75 653a 2067 6461 6c2e 4461  , value: gdal.Da
-00001370: 7461 7365 7429 3a0d 0a20 2020 2020 2020  taset):..       
-00001380: 2073 656c 662e 5f72 6173 7465 7220 3d20   self._raster = 
-00001390: 7661 6c75 650d 0a0d 0a20 2020 2040 7072  value....    @pr
-000013a0: 6f70 6572 7479 0d0a 2020 2020 6465 6620  operty..    def 
-000013b0: 7661 6c75 6573 2873 656c 6629 202d 3e20  values(self) -> 
-000013c0: 6e70 2e6e 6461 7272 6179 3a0d 0a20 2020  np.ndarray:..   
-000013d0: 2020 2020 2022 2222 6172 7261 7920 7661       """array va
-000013e0: 6c75 6573 2e22 2222 0d0a 2020 2020 2020  lues."""..      
-000013f0: 2020 7265 7475 726e 2073 656c 662e 7265    return self.re
-00001400: 6164 5f61 7272 6179 2862 616e 643d 4e6f  ad_array(band=No
-00001410: 6e65 290d 0a0d 0a20 2020 2040 7072 6f70  ne)....    @prop
-00001420: 6572 7479 0d0a 2020 2020 6465 6620 726f  erty..    def ro
-00001430: 7773 2873 656c 6629 202d 3e20 696e 743a  ws(self) -> int:
-00001440: 0d0a 2020 2020 2020 2020 2222 224e 756d  ..        """Num
-00001450: 6265 7220 6f66 2072 6f77 7320 696e 2074  ber of rows in t
-00001460: 6865 2072 6173 7465 7220 6172 7261 792e  he raster array.
-00001470: 2222 220d 0a20 2020 2020 2020 2072 6574  """..        ret
-00001480: 7572 6e20 7365 6c66 2e5f 726f 7773 0d0a  urn self._rows..
-00001490: 0d0a 2020 2020 4070 726f 7065 7274 790d  ..    @property.
-000014a0: 0a20 2020 2064 6566 2063 6f6c 756d 6e73  .    def columns
-000014b0: 2873 656c 6629 202d 3e20 696e 743a 0d0a  (self) -> int:..
-000014c0: 2020 2020 2020 2020 2222 224e 756d 6265          """Numbe
-000014d0: 7220 6f66 2063 6f6c 756d 6e73 2069 6e20  r of columns in 
-000014e0: 7468 6520 7261 7374 6572 2061 7272 6179  the raster array
-000014f0: 2e22 2222 0d0a 2020 2020 2020 2020 7265  ."""..        re
-00001500: 7475 726e 2073 656c 662e 5f63 6f6c 756d  turn self._colum
-00001510: 6e73 0d0a 0d0a 2020 2020 4070 726f 7065  ns....    @prope
-00001520: 7274 790d 0a20 2020 2064 6566 2073 6861  rty..    def sha
-00001530: 7065 2873 656c 6629 3a0d 0a20 2020 2020  pe(self):..     
-00001540: 2020 2022 2222 4461 7461 7365 7420 7368     """Dataset sh
-00001550: 6170 6522 2222 0d0a 2020 2020 2020 2020  ape"""..        
-00001560: 7265 7475 726e 2073 656c 662e 6261 6e64  return self.band
-00001570: 5f63 6f75 6e74 2c20 7365 6c66 2e72 6f77  _count, self.row
-00001580: 732c 2073 656c 662e 636f 6c75 6d6e 730d  s, self.columns.
-00001590: 0a0d 0a20 2020 2040 7072 6f70 6572 7479  ...    @property
-000015a0: 0d0a 2020 2020 6465 6620 6765 6f74 7261  ..    def geotra
-000015b0: 6e73 666f 726d 2873 656c 6629 3a0d 0a20  nsform(self):.. 
-000015c0: 2020 2020 2020 2022 2222 574b 5420 7072         """WKT pr
-000015d0: 6f6a 6563 7469 6f6e 2e22 2222 0d0a 2020  ojection."""..  
-000015e0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-000015f0: 662e 5f67 656f 7472 616e 7366 6f72 6d0d  f._geotransform.
-00001600: 0a0d 0a20 2020 2040 7072 6f70 6572 7479  ...    @property
-00001610: 0d0a 2020 2020 6465 6620 7069 766f 745f  ..    def pivot_
-00001620: 706f 696e 7428 7365 6c66 293a 0d0a 2020  point(self):..  
-00001630: 2020 2020 2020 2222 2254 6f70 206c 6566        """Top lef
-00001640: 7420 636f 726e 6572 2063 6f6f 7264 696e  t corner coordin
-00001650: 6174 6573 2e22 2222 0d0a 2020 2020 2020  ates."""..      
-00001660: 2020 786d 696e 2c20 5f2c 205f 2c20 796d    xmin, _, _, ym
-00001670: 6178 2c20 5f2c 205f 203d 2073 656c 662e  ax, _, _ = self.
-00001680: 5f67 656f 7472 616e 7366 6f72 6d0d 0a20  _geotransform.. 
-00001690: 2020 2020 2020 2072 6574 7572 6e20 786d         return xm
-000016a0: 696e 2c20 796d 6178 0d0a 0d0a 2020 2020  in, ymax....    
-000016b0: 4070 726f 7065 7274 790d 0a20 2020 2064  @property..    d
-000016c0: 6566 2062 6f75 6e64 7328 7365 6c66 2920  ef bounds(self) 
-000016d0: 2d3e 2047 656f 4461 7461 4672 616d 653a  -> GeoDataFrame:
-000016e0: 0d0a 2020 2020 2020 2020 2222 2262 6f75  ..        """bou
-000016f0: 6e64 7322 2222 0d0a 2020 2020 2020 2020  nds"""..        
-00001700: 7265 7475 726e 2073 656c 662e 5f63 616c  return self._cal
-00001710: 6375 6c61 7465 5f62 6f75 6e64 7328 290d  culate_bounds().
-00001720: 0a0d 0a20 2020 2040 7072 6f70 6572 7479  ...    @property
-00001730: 0d0a 2020 2020 6465 6620 6262 6f78 2873  ..    def bbox(s
-00001740: 656c 6629 202d 3e20 4c69 7374 3a0d 0a20  elf) -> List:.. 
-00001750: 2020 2020 2020 2022 2222 5b78 6d69 6e2c         """[xmin,
-00001760: 2079 6d69 6e2c 2078 6d61 782c 2079 6d61   ymin, xmax, yma
-00001770: 785d 2222 220d 0a20 2020 2020 2020 2072  x]"""..        r
-00001780: 6574 7572 6e20 7365 6c66 2e5f 6361 6c63  eturn self._calc
-00001790: 756c 6174 655f 6262 6f78 2829 0d0a 0d0a  ulate_bbox()....
-000017a0: 2020 2020 4070 726f 7065 7274 790d 0a20      @property.. 
-000017b0: 2020 2064 6566 2065 7073 6728 7365 6c66     def epsg(self
-000017c0: 293a 0d0a 2020 2020 2020 2020 2222 2257  ):..        """W
-000017d0: 4b54 2070 726f 6a65 6374 696f 6e2e 2222  KT projection.""
-000017e0: 220d 0a20 2020 2020 2020 2072 6574 7572  "..        retur
-000017f0: 6e20 7365 6c66 2e5f 6570 7367 0d0a 0d0a  n self._epsg....
-00001800: 2020 2020 4070 726f 7065 7274 790d 0a20      @property.. 
-00001810: 2020 2064 6566 206c 6f6e 2873 656c 6629     def lon(self)
-00001820: 3a0d 0a20 2020 2020 2020 2022 2222 4c6f  :..        """Lo
-00001830: 6e67 6974 7564 6520 636f 6f72 6469 6e61  ngitude coordina
-00001840: 7465 7322 2222 0d0a 2020 2020 2020 2020  tes"""..        
-00001850: 6966 206e 6f74 2068 6173 6174 7472 2873  if not hasattr(s
-00001860: 656c 662c 2022 5f6c 6f6e 2229 3a0d 0a20  elf, "_lon"):.. 
-00001870: 2020 2020 2020 2020 2020 2070 6976 6f74             pivot
-00001880: 5f78 203d 2073 656c 662e 7069 766f 745f  _x = self.pivot_
-00001890: 706f 696e 745b 305d 0d0a 2020 2020 2020  point[0]..      
-000018a0: 2020 2020 2020 6365 6c6c 5f73 697a 6520        cell_size 
-000018b0: 3d20 7365 6c66 2e63 656c 6c5f 7369 7a65  = self.cell_size
-000018c0: 0d0a 2020 2020 2020 2020 2020 2020 785f  ..            x_
-000018d0: 636f 6f72 6473 203d 205b 0d0a 2020 2020  coords = [..    
-000018e0: 2020 2020 2020 2020 2020 2020 7069 766f              pivo
-000018f0: 745f 7820 2b20 6920 2a20 6365 6c6c 5f73  t_x + i * cell_s
-00001900: 697a 6520 2b20 6365 6c6c 5f73 697a 6520  ize + cell_size 
-00001910: 2f20 3220 666f 7220 6920 696e 2072 616e  / 2 for i in ran
-00001920: 6765 2873 656c 662e 636f 6c75 6d6e 7329  ge(self.columns)
-00001930: 0d0a 2020 2020 2020 2020 2020 2020 5d0d  ..            ].
-00001940: 0a20 2020 2020 2020 2065 6c73 653a 0d0a  .        else:..
-00001950: 2020 2020 2020 2020 2020 2020 2320 696e              # in
-00001960: 2063 6173 6520 7468 6520 6c61 7420 616e   case the lat an
-00001970: 6420 6c6f 6e20 6172 6520 7265 6164 2066  d lon are read f
-00001980: 726f 6d20 7468 6520 6e65 7463 6466 2066  rom the netcdf f
-00001990: 696c 6520 6a75 7374 2072 6561 6420 7468  ile just read th
-000019a0: 6520 7661 6c75 6573 2066 726f 6d20 7468  e values from th
-000019b0: 6520 6669 6c65 0d0a 2020 2020 2020 2020  e file..        
-000019c0: 2020 2020 785f 636f 6f72 6473 203d 2073      x_coords = s
-000019d0: 656c 662e 5f6c 6f6e 0d0a 2020 2020 2020  elf._lon..      
-000019e0: 2020 7265 7475 726e 206e 702e 6172 7261    return np.arra
-000019f0: 7928 785f 636f 6f72 6473 290d 0a0d 0a20  y(x_coords).... 
-00001a00: 2020 2040 7072 6f70 6572 7479 0d0a 2020     @property..  
-00001a10: 2020 6465 6620 6c61 7428 7365 6c66 293a    def lat(self):
-00001a20: 0d0a 2020 2020 2020 2020 2222 224c 6174  ..        """Lat
-00001a30: 6974 7564 652d 636f 6f72 6469 6e61 7465  itude-coordinate
-00001a40: 2222 220d 0a20 2020 2020 2020 2069 6620  """..        if 
-00001a50: 6e6f 7420 6861 7361 7474 7228 7365 6c66  not hasattr(self
-00001a60: 2c20 225f 6c61 7422 293a 0d0a 2020 2020  , "_lat"):..    
-00001a70: 2020 2020 2020 2020 7069 766f 745f 7920          pivot_y 
-00001a80: 3d20 7365 6c66 2e70 6976 6f74 5f70 6f69  = self.pivot_poi
-00001a90: 6e74 5b31 5d0d 0a20 2020 2020 2020 2020  nt[1]..         
-00001aa0: 2020 2063 656c 6c5f 7369 7a65 203d 2073     cell_size = s
-00001ab0: 656c 662e 6365 6c6c 5f73 697a 650d 0a20  elf.cell_size.. 
-00001ac0: 2020 2020 2020 2020 2020 2079 5f63 6f6f             y_coo
-00001ad0: 7264 7320 3d20 5b0d 0a20 2020 2020 2020  rds = [..       
-00001ae0: 2020 2020 2020 2020 2070 6976 6f74 5f79           pivot_y
-00001af0: 202d 2069 202a 2063 656c 6c5f 7369 7a65   - i * cell_size
-00001b00: 202d 2063 656c 6c5f 7369 7a65 202f 2032   - cell_size / 2
-00001b10: 2066 6f72 2069 2069 6e20 7261 6e67 6528   for i in range(
-00001b20: 7365 6c66 2e72 6f77 7329 0d0a 2020 2020  self.rows)..    
-00001b30: 2020 2020 2020 2020 5d0d 0a20 2020 2020          ]..     
-00001b40: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
-00001b50: 2020 2020 2020 2320 696e 2063 6173 6520        # in case 
-00001b60: 7468 6520 6c61 7420 616e 6420 6c6f 6e20  the lat and lon 
-00001b70: 6172 6520 7265 6164 2066 726f 6d20 7468  are read from th
-00001b80: 6520 6e65 7463 6466 2066 696c 6520 6a75  e netcdf file ju
-00001b90: 7374 2072 6561 6420 7468 6520 7661 6c75  st read the valu
-00001ba0: 6573 2066 726f 6d20 7468 6520 6669 6c65  es from the file
-00001bb0: 0d0a 2020 2020 2020 2020 2020 2020 795f  ..            y_
-00001bc0: 636f 6f72 6473 203d 2073 656c 662e 5f6c  coords = self._l
-00001bd0: 6174 0d0a 2020 2020 2020 2020 7265 7475  at..        retu
-00001be0: 726e 206e 702e 6172 7261 7928 795f 636f  rn np.array(y_co
-00001bf0: 6f72 6473 290d 0a0d 0a20 2020 2040 7072  ords)....    @pr
-00001c00: 6f70 6572 7479 0d0a 2020 2020 6465 6620  operty..    def 
-00001c10: 7828 7365 6c66 293a 0d0a 2020 2020 2020  x(self):..      
-00001c20: 2020 2222 2278 2d63 6f6f 7264 696e 6174    """x-coordinat
-00001c30: 6522 2222 0d0a 2020 2020 2020 2020 2320  e"""..        # 
-00001c40: 585f 636f 6f72 6469 6e61 7465 203d 2075  X_coordinate = u
-00001c50: 7070 6572 6c65 6674 2063 6f72 6e65 7220  pperleft corner 
-00001c60: 7820 2b20 696e 6465 7820 2a20 6365 6c6c  x + index * cell
-00001c70: 2073 697a 6520 2b20 6365 6c73 697a 652f   size + celsize/
-00001c80: 320d 0a20 2020 2020 2020 2069 6620 6e6f  2..        if no
-00001c90: 7420 6861 7361 7474 7228 7365 6c66 2c20  t hasattr(self, 
-00001ca0: 225f 6c6f 6e22 293a 0d0a 2020 2020 2020  "_lon"):..      
-00001cb0: 2020 2020 2020 7069 766f 745f 7820 3d20        pivot_x = 
-00001cc0: 7365 6c66 2e70 6976 6f74 5f70 6f69 6e74  self.pivot_point
-00001cd0: 5b30 5d0d 0a20 2020 2020 2020 2020 2020  [0]..           
-00001ce0: 2063 656c 6c5f 7369 7a65 203d 2073 656c   cell_size = sel
-00001cf0: 662e 6365 6c6c 5f73 697a 650d 0a20 2020  f.cell_size..   
-00001d00: 2020 2020 2020 2020 2078 5f63 6f6f 7264           x_coord
-00001d10: 7320 3d20 5b0d 0a20 2020 2020 2020 2020  s = [..         
-00001d20: 2020 2020 2020 2070 6976 6f74 5f78 202b         pivot_x +
-00001d30: 2069 202a 2063 656c 6c5f 7369 7a65 202b   i * cell_size +
-00001d40: 2063 656c 6c5f 7369 7a65 202f 2032 2066   cell_size / 2 f
-00001d50: 6f72 2069 2069 6e20 7261 6e67 6528 7365  or i in range(se
-00001d60: 6c66 2e63 6f6c 756d 6e73 290d 0a20 2020  lf.columns)..   
-00001d70: 2020 2020 2020 2020 205d 0d0a 2020 2020           ]..    
-00001d80: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
-00001d90: 2020 2020 2020 2023 2069 6e20 6361 7365         # in case
-00001da0: 2074 6865 206c 6174 2061 6e64 206c 6f6e   the lat and lon
-00001db0: 2061 7265 2072 6561 6420 6672 6f6d 2074   are read from t
-00001dc0: 6865 206e 6574 6364 6620 6669 6c65 206a  he netcdf file j
-00001dd0: 7573 7420 7265 6164 2074 6865 2076 616c  ust read the val
-00001de0: 7565 7320 6672 6f6d 2074 6865 2066 696c  ues from the fil
-00001df0: 650d 0a20 2020 2020 2020 2020 2020 2078  e..            x
-00001e00: 5f63 6f6f 7264 7320 3d20 7365 6c66 2e5f  _coords = self._
-00001e10: 6c6f 6e0d 0a20 2020 2020 2020 2072 6574  lon..        ret
-00001e20: 7572 6e20 6e70 2e61 7272 6179 2878 5f63  urn np.array(x_c
-00001e30: 6f6f 7264 7329 0d0a 0d0a 2020 2020 4070  oords)....    @p
-00001e40: 726f 7065 7274 790d 0a20 2020 2064 6566  roperty..    def
-00001e50: 2079 2873 656c 6629 3a0d 0a20 2020 2020   y(self):..     
-00001e60: 2020 2022 2222 792d 636f 6f72 6469 6e61     """y-coordina
-00001e70: 7465 2222 220d 0a20 2020 2020 2020 2023  te"""..        #
-00001e80: 2058 5f63 6f6f 7264 696e 6174 6520 3d20   X_coordinate = 
-00001e90: 7570 7065 726c 6566 7420 636f 726e 6572  upperleft corner
-00001ea0: 2078 202b 2069 6e64 6578 202a 2063 656c   x + index * cel
-00001eb0: 6c20 7369 7a65 202b 2063 656c 7369 7a65  l size + celsize
-00001ec0: 2f32 0d0a 2020 2020 2020 2020 6966 206e  /2..        if n
-00001ed0: 6f74 2068 6173 6174 7472 2873 656c 662c  ot hasattr(self,
-00001ee0: 2022 5f6c 6174 2229 3a0d 0a20 2020 2020   "_lat"):..     
-00001ef0: 2020 2020 2020 2070 6976 6f74 5f79 203d         pivot_y =
-00001f00: 2073 656c 662e 7069 766f 745f 706f 696e   self.pivot_poin
-00001f10: 745b 315d 0d0a 2020 2020 2020 2020 2020  t[1]..          
-00001f20: 2020 6365 6c6c 5f73 697a 6520 3d20 7365    cell_size = se
-00001f30: 6c66 2e63 656c 6c5f 7369 7a65 0d0a 2020  lf.cell_size..  
-00001f40: 2020 2020 2020 2020 2020 795f 636f 6f72            y_coor
-00001f50: 6473 203d 205b 0d0a 2020 2020 2020 2020  ds = [..        
-00001f60: 2020 2020 2020 2020 7069 766f 745f 7920          pivot_y 
-00001f70: 2d20 6920 2a20 6365 6c6c 5f73 697a 6520  - i * cell_size 
-00001f80: 2d20 6365 6c6c 5f73 697a 6520 2f20 3220  - cell_size / 2 
-00001f90: 666f 7220 6920 696e 2072 616e 6765 2873  for i in range(s
-00001fa0: 656c 662e 726f 7773 290d 0a20 2020 2020  elf.rows)..     
-00001fb0: 2020 2020 2020 205d 0d0a 2020 2020 2020         ]..      
-00001fc0: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
-00001fd0: 2020 2020 2023 2069 6e20 6361 7365 2074       # in case t
-00001fe0: 6865 206c 6174 2061 6e64 206c 6f6e 2061  he lat and lon a
-00001ff0: 7265 2072 6561 6420 6672 6f6d 2074 6865  re read from the
-00002000: 206e 6574 6364 6620 6669 6c65 206a 7573   netcdf file jus
-00002010: 7420 7265 6164 2074 6865 2076 616c 7565  t read the value
-00002020: 7320 6672 6f6d 2074 6865 2066 696c 650d  s from the file.
-00002030: 0a20 2020 2020 2020 2020 2020 2079 5f63  .            y_c
-00002040: 6f6f 7264 7320 3d20 7365 6c66 2e5f 6c61  oords = self._la
-00002050: 740d 0a20 2020 2020 2020 2072 6574 7572  t..        retur
-00002060: 6e20 6e70 2e61 7272 6179 2879 5f63 6f6f  n np.array(y_coo
-00002070: 7264 7329 0d0a 0d0a 2020 2020 4070 726f  rds)....    @pro
-00002080: 7065 7274 790d 0a20 2020 2064 6566 2063  perty..    def c
-00002090: 7273 2873 656c 6629 202d 3e20 7374 723a  rs(self) -> str:
-000020a0: 0d0a 2020 2020 2020 2020 2222 2243 6f6f  ..        """Coo
-000020b0: 7264 696e 6174 6520 7265 6665 7265 6e63  rdinate referenc
-000020c0: 6520 7379 7374 656d 2e22 2222 0d0a 2020  e system."""..  
-000020d0: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
-000020e0: 662e 5f67 6574 5f63 7273 2829 0d0a 0d0a  f._get_crs()....
-000020f0: 2020 2020 4063 7273 2e73 6574 7465 720d      @crs.setter.
-00002100: 0a20 2020 2064 6566 2063 7273 2873 656c  .    def crs(sel
-00002110: 662c 2076 616c 7565 3a20 7374 7229 3a0d  f, value: str):.
-00002120: 0a20 2020 2020 2020 2022 2222 436f 6f72  .        """Coor
-00002130: 6469 6e61 7465 2072 6566 6572 656e 6365  dinate reference
-00002140: 2073 7973 7465 6d2e 2222 220d 0a20 2020   system."""..   
-00002150: 2020 2020 2073 656c 662e 7365 745f 6372       self.set_cr
-00002160: 7328 7661 6c75 6529 0d0a 0d0a 2020 2020  s(value)....    
-00002170: 4070 726f 7065 7274 790d 0a20 2020 2064  @property..    d
-00002180: 6566 2063 656c 6c5f 7369 7a65 2873 656c  ef cell_size(sel
-00002190: 6629 202d 3e20 696e 743a 0d0a 2020 2020  f) -> int:..    
-000021a0: 2020 2020 2222 2243 656c 6c20 7369 7a65      """Cell size
-000021b0: 2e22 2222 0d0a 2020 2020 2020 2020 7265  ."""..        re
-000021c0: 7475 726e 2073 656c 662e 5f63 656c 6c5f  turn self._cell_
-000021d0: 7369 7a65 0d0a 0d0a 2020 2020 4070 726f  size....    @pro
-000021e0: 7065 7274 790d 0a20 2020 2064 6566 2062  perty..    def b
-000021f0: 616e 645f 636f 756e 7428 7365 6c66 293a  and_count(self):
-00002200: 0d0a 2020 2020 2020 2020 2222 224e 756d  ..        """Num
-00002210: 6265 7220 6f66 2062 616e 6473 2069 6e20  ber of bands in 
-00002220: 7468 6520 7261 7374 6572 2e22 2222 0d0a  the raster."""..
-00002230: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-00002240: 656c 662e 5f62 616e 645f 636f 756e 740d  elf._band_count.
-00002250: 0a0d 0a20 2020 2040 7072 6f70 6572 7479  ...    @property
-00002260: 0d0a 2020 2020 6465 6620 6261 6e64 5f6e  ..    def band_n
-00002270: 616d 6573 2873 656c 6629 3a0d 0a20 2020  ames(self):..   
-00002280: 2020 2020 2022 2222 4261 6e64 206e 616d       """Band nam
-00002290: 6573 2e22 2222 0d0a 2020 2020 2020 2020  es."""..        
-000022a0: 7265 7475 726e 2073 656c 662e 5f62 616e  return self._ban
-000022b0: 645f 6e61 6d65 730d 0a0d 0a20 2020 2040  d_names....    @
-000022c0: 7072 6f70 6572 7479 0d0a 2020 2020 6465  property..    de
-000022d0: 6620 7661 7269 6162 6c65 7328 7365 6c66  f variables(self
-000022e0: 293a 0d0a 2020 2020 2020 2020 2222 2256  ):..        """V
-000022f0: 6172 6961 626c 6573 2069 6e20 7468 6520  ariables in the 
-00002300: 7261 7374 6572 2028 7265 7361 6d62 6c65  raster (resamble
-00002310: 7320 7468 6520 7661 7269 6162 6c65 7320  s the variables 
-00002320: 696e 206e 6574 6364 6620 6669 6c65 732e  in netcdf files.
-00002330: 2922 2222 0d0a 2020 2020 2020 2020 7265  )"""..        re
-00002340: 7475 726e 2073 656c 662e 5f76 6172 6961  turn self._varia
-00002350: 626c 6573 0d0a 0d0a 2020 2020 4070 726f  bles....    @pro
-00002360: 7065 7274 790d 0a20 2020 2064 6566 206e  perty..    def n
-00002370: 6f5f 6461 7461 5f76 616c 7565 2873 656c  o_data_value(sel
-00002380: 6629 3a0d 0a20 2020 2020 2020 2022 2222  f):..        """
-00002390: 4e6f 2064 6174 6120 7661 6c75 6520 7468  No data value th
-000023a0: 6174 206d 6172 6b73 2074 6865 2063 656c  at marks the cel
-000023b0: 6c73 206f 7574 206f 6620 7468 6520 646f  ls out of the do
-000023c0: 6d61 696e 2222 220d 0a20 2020 2020 2020  main"""..       
-000023d0: 2072 6574 7572 6e20 7365 6c66 2e5f 6e6f   return self._no
-000023e0: 5f64 6174 615f 7661 6c75 650d 0a0d 0a20  _data_value.... 
-000023f0: 2020 2040 6e6f 5f64 6174 615f 7661 6c75     @no_data_valu
-00002400: 652e 7365 7474 6572 0d0a 2020 2020 6465  e.setter..    de
-00002410: 6620 6e6f 5f64 6174 615f 7661 6c75 6528  f no_data_value(
-00002420: 7365 6c66 2c20 7661 6c75 653a 206f 626a  self, value: obj
-00002430: 6563 7429 3a0d 0a20 2020 2020 2020 2022  ect):..        "
-00002440: 2222 4e6f 2064 6174 6120 7661 6c75 6520  ""No data value 
-00002450: 7468 6174 206d 6172 6b73 2074 6865 2063  that marks the c
-00002460: 656c 6c73 206f 7574 206f 6620 7468 6520  ells out of the 
-00002470: 646f 6d61 696e 2222 220d 0a20 2020 2020  domain"""..     
-00002480: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
-00002490: 2876 616c 7565 2c20 6c69 7374 293a 0d0a  (value, list):..
-000024a0: 2020 2020 2020 2020 2020 2020 666f 7220              for 
-000024b0: 692c 2076 616c 2069 6e20 656e 756d 6572  i, val in enumer
-000024c0: 6174 6528 7661 6c75 6529 3a0d 0a20 2020  ate(value):..   
-000024d0: 2020 2020 2020 2020 2020 2020 2073 656c               sel
-000024e0: 662e 5f63 6861 6e67 655f 6e6f 5f64 6174  f._change_no_dat
-000024f0: 615f 7661 6c75 655f 6174 7472 2869 2c20  a_value_attr(i, 
-00002500: 7661 6c29 0d0a 2020 2020 2020 2020 656c  val)..        el
-00002510: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
-00002520: 2073 656c 662e 5f63 6861 6e67 655f 6e6f   self._change_no
-00002530: 5f64 6174 615f 7661 6c75 655f 6174 7472  _data_value_attr
-00002540: 2830 2c20 7661 6c75 6529 0d0a 0d0a 2020  (0, value)....  
-00002550: 2020 4070 726f 7065 7274 790d 0a20 2020    @property..   
-00002560: 2064 6566 206d 6574 615f 6461 7461 2873   def meta_data(s
-00002570: 656c 6629 3a0d 0a20 2020 2020 2020 2022  elf):..        "
-00002580: 2222 4d65 7461 2064 6174 6122 2222 0d0a  ""Meta data"""..
-00002590: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-000025a0: 656c 662e 5f6d 6574 615f 6461 7461 0d0a  elf._meta_data..
-000025b0: 0d0a 2020 2020 4070 726f 7065 7274 790d  ..    @property.
-000025c0: 0a20 2020 2064 6566 2064 7479 7065 2873  .    def dtype(s
-000025d0: 656c 6629 3a0d 0a20 2020 2020 2020 2022  elf):..        "
-000025e0: 2222 4461 7461 2054 7970 6522 2222 0d0a  ""Data Type"""..
-000025f0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-00002600: 656c 662e 5f64 7479 7065 0d0a 0d0a 2020  elf._dtype....  
-00002610: 2020 4070 726f 7065 7274 790d 0a20 2020    @property..   
-00002620: 2064 6566 2066 696c 655f 6e61 6d65 2873   def file_name(s
-00002630: 656c 6629 3a0d 0a20 2020 2020 2020 2022  elf):..        "
-00002640: 2222 6669 6c65 206e 616d 6522 2222 0d0a  ""file name"""..
-00002650: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
-00002660: 5f66 696c 655f 6e61 6d65 2e73 7461 7274  _file_name.start
-00002670: 7377 6974 6828 224e 4554 4344 4622 293a  swith("NETCDF"):
-00002680: 0d0a 2020 2020 2020 2020 2020 2020 6e61  ..            na
-00002690: 6d65 203d 2073 656c 662e 5f66 696c 655f  me = self._file_
-000026a0: 6e61 6d65 2e73 706c 6974 2822 3a22 295b  name.split(":")[
-000026b0: 315d 5b31 3a2d 315d 0d0a 2020 2020 2020  1][1:-1]..      
-000026c0: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
-000026d0: 2020 2020 206e 616d 6520 3d20 7365 6c66       name = self
-000026e0: 2e5f 6669 6c65 5f6e 616d 650d 0a20 2020  ._file_name..   
-000026f0: 2020 2020 2072 6574 7572 6e20 6e61 6d65       return name
-00002700: 0d0a 0d0a 2020 2020 4070 726f 7065 7274  ....    @propert
-00002710: 790d 0a20 2020 2064 6566 2074 696d 655f  y..    def time_
-00002720: 7374 616d 7028 7365 6c66 293a 0d0a 2020  stamp(self):..  
-00002730: 2020 2020 2020 2222 2254 696d 6520 7374        """Time st
-00002740: 616d 7022 2222 0d0a 2020 2020 2020 2020  amp"""..        
-00002750: 6966 2068 6173 6174 7472 2873 656c 662c  if hasattr(self,
-00002760: 2022 5f74 696d 655f 7374 616d 7022 293a   "_time_stamp"):
-00002770: 0d0a 2020 2020 2020 2020 2020 2020 7661  ..            va
-00002780: 6c20 3d20 7365 6c66 2e5f 7469 6d65 5f73  l = self._time_s
-00002790: 7461 6d70 0d0a 2020 2020 2020 2020 656c  tamp..        el
-000027a0: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
-000027b0: 2076 616c 203d 204e 6f6e 650d 0a0d 0a20   val = None.... 
-000027c0: 2020 2020 2020 2072 6574 7572 6e20 7661         return va
-000027d0: 6c0d 0a0d 0a20 2020 2040 7072 6f70 6572  l....    @proper
-000027e0: 7479 0d0a 2020 2020 6465 6620 6472 6976  ty..    def driv
-000027f0: 6572 5f74 7970 6528 7365 6c66 293a 0d0a  er_type(self):..
-00002800: 2020 2020 2020 2020 2222 2244 7269 7665          """Drive
-00002810: 7220 5479 7065 2222 220d 0a20 2020 2020  r Type"""..     
-00002820: 2020 2064 7269 7665 725f 7479 7065 203d     driver_type =
-00002830: 2073 656c 662e 7261 7374 6572 2e47 6574   self.raster.Get
-00002840: 4472 6976 6572 2829 2e47 6574 4465 7363  Driver().GetDesc
-00002850: 7269 7074 696f 6e28 290d 0a20 2020 2020  ription()..     
-00002860: 2020 2072 6574 7572 6e20 4341 5441 4c4f     return CATALO
-00002870: 472e 6765 745f 6472 6976 6572 5f6e 616d  G.get_driver_nam
-00002880: 6528 6472 6976 6572 5f74 7970 6529 0d0a  e(driver_type)..
-00002890: 0d0a 2020 2020 4063 6c61 7373 6d65 7468  ..    @classmeth
-000028a0: 6f64 0d0a 2020 2020 6465 6620 7265 6164  od..    def read
-000028b0: 5f66 696c 6528 636c 732c 2070 6174 683a  _file(cls, path:
-000028c0: 2073 7472 2c20 7265 6164 5f6f 6e6c 793d   str, read_only=
-000028d0: 5472 7565 293a 0d0a 2020 2020 2020 2020  True):..        
-000028e0: 2222 2272 6561 6420 6669 6c65 2e0d 0a0d  """read file....
-000028f0: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
-00002900: 6572 730d 0a20 2020 2020 2020 202d 2d2d  ers..        ---
-00002910: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
-00002920: 2070 6174 6820 3a20 5b73 7472 5d0d 0a20   path : [str].. 
-00002930: 2020 2020 2020 2020 2020 2050 6174 6820             Path 
-00002940: 6f66 2066 696c 6520 746f 206f 7065 6e28  of file to open(
-00002950: 776f 726b 7320 666f 7220 6173 6369 692c  works for ascii,
-00002960: 2067 656f 7469 6666 292e 0d0a 2020 2020   geotiff)...    
-00002970: 2020 2020 7265 6164 5f6f 6e6c 7920 3a20      read_only : 
-00002980: 5b62 6f6f 6c5d 0d0a 2020 2020 2020 2020  [bool]..        
-00002990: 2020 2020 4669 6c65 206d 6f64 652c 2073      File mode, s
-000029a0: 6574 2074 6f20 4661 6c73 6520 746f 206f  et to False to o
-000029b0: 7065 6e20 696e 2022 7570 6461 7465 2220  pen in "update" 
-000029c0: 6d6f 6465 2e0d 0a0d 0a20 2020 2020 2020  mode.....       
-000029d0: 2052 6574 7572 6e73 0d0a 2020 2020 2020   Returns..      
-000029e0: 2020 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020    -------..     
-000029f0: 2020 2047 4441 4c20 6461 7461 7365 740d     GDAL dataset.
-00002a00: 0a20 2020 2020 2020 2022 2222 0d0a 2020  .        """..  
-00002a10: 2020 2020 2020 7372 6320 3d20 5f69 6f2e        src = _io.
-00002a20: 7265 6164 5f66 696c 6528 7061 7468 2c20  read_file(path, 
-00002a30: 7265 6164 5f6f 6e6c 7929 0d0a 2020 2020  read_only)..    
-00002a40: 2020 2020 7265 7475 726e 2063 6c73 2873      return cls(s
-00002a50: 7263 290d 0a0d 0a20 2020 2040 636c 6173  rc)....    @clas
-00002a60: 736d 6574 686f 640d 0a20 2020 2064 6566  smethod..    def
-00002a70: 205f 6372 6561 7465 5f65 6d70 7479 5f64   _create_empty_d
-00002a80: 7269 7665 7228 0d0a 2020 2020 2020 2020  river(..        
-00002a90: 636c 732c 2073 7263 3a20 6764 616c 2e44  cls, src: gdal.D
-00002aa0: 6174 6173 6574 2c20 7061 7468 3a20 7374  ataset, path: st
-00002ab0: 7220 3d20 4e6f 6e65 2c20 6261 6e64 733a  r = None, bands:
-00002ac0: 2069 6e74 203d 2031 2c20 6e6f 5f64 6174   int = 1, no_dat
-00002ad0: 615f 7661 6c75 653d 4e6f 6e65 0d0a 2020  a_value=None..  
-00002ae0: 2020 293a 0d0a 2020 2020 2020 2020 2222    ):..        ""
-00002af0: 2243 7265 6174 6520 6120 6e65 7720 656d  "Create a new em
-00002b00: 7074 7920 6472 6976 6572 2066 726f 6d20  pty driver from 
-00002b10: 616e 6f74 6865 7220 6461 7461 7365 742e  another dataset.
-00002b20: 0d0a 0d0a 2020 2020 2020 2020 5061 7261  ....        Para
-00002b30: 6d65 7465 7273 0d0a 2020 2020 2020 2020  meters..        
-00002b40: 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020  ----------..    
-00002b50: 2020 2020 7372 6320 3a20 5b67 6461 6c2e      src : [gdal.
-00002b60: 4461 7461 6375 6265 5d0d 0a20 2020 2020  Datacube]..     
-00002b70: 2020 2020 2020 2067 6461 6c20 6461 7461         gdal data
-00002b80: 7365 740d 0a20 2020 2020 2020 2070 6174  set..        pat
-00002b90: 6820 3a20 7374 720d 0a20 2020 2020 2020  h : str..       
-00002ba0: 2062 616e 6473 203a 2069 6e74 206f 7220   bands : int or 
-00002bb0: 4e6f 6e65 0d0a 2020 2020 2020 2020 2020  None..          
-00002bc0: 2020 4e75 6d62 6572 206f 6620 6261 6e64    Number of band
-00002bd0: 7320 746f 2063 7265 6174 6520 696e 2074  s to create in t
-00002be0: 6865 206f 7574 7075 7420 7261 7374 6572  he output raster
-00002bf0: 2e0d 0a20 2020 2020 2020 206e 6f5f 6461  ...        no_da
-00002c00: 7461 5f76 616c 7565 203a 2066 6c6f 6174  ta_value : float
-00002c10: 206f 7220 4e6f 6e65 0d0a 2020 2020 2020   or None..      
-00002c20: 2020 2020 2020 4e6f 2064 6174 6120 7661        No data va
-00002c30: 6c75 652c 2069 6620 4e6f 6e65 2075 7365  lue, if None use
-00002c40: 7320 7468 6520 7361 6d65 2061 7320 6060  s the same as ``
-00002c50: 7372 6360 602e 0d0a 0d0a 2020 2020 2020  src``.....      
-00002c60: 2020 5265 7475 726e 730d 0a20 2020 2020    Returns..     
-00002c70: 2020 202d 2d2d 2d2d 2d2d 0d0a 2020 2020     -------..    
-00002c80: 2020 2020 6764 616c 2e44 6174 6153 6574      gdal.DataSet
-00002c90: 0d0a 2020 2020 2020 2020 2222 220d 0a20  ..        """.. 
-00002ca0: 2020 2020 2020 2062 616e 6473 203d 2069         bands = i
-00002cb0: 6e74 2862 616e 6473 2920 6966 2062 616e  nt(bands) if ban
-00002cc0: 6473 2069 7320 6e6f 7420 4e6f 6e65 2065  ds is not None e
-00002cd0: 6c73 6520 7372 632e 5261 7374 6572 436f  lse src.RasterCo
-00002ce0: 756e 740d 0a20 2020 2020 2020 2023 2063  unt..        # c
-00002cf0: 7265 6174 6520 7468 6520 6f62 6865 6374  reate the obhect
-00002d00: 0d0a 2020 2020 2020 2020 7372 635f 6f62  ..        src_ob
-00002d10: 6a20 3d20 636c 7328 7372 6329 0d0a 2020  j = cls(src)..  
-00002d20: 2020 2020 2020 2320 4372 6561 7465 2074        # Create t
-00002d30: 6865 2064 7269 7665 722e 0d0a 2020 2020  he driver...    
-00002d40: 2020 2020 6473 7420 3d20 7372 635f 6f62      dst = src_ob
-00002d50: 6a2e 5f63 7265 6174 655f 6764 616c 5f64  j._create_gdal_d
-00002d60: 6174 6173 6574 280d 0a20 2020 2020 2020  ataset(..       
-00002d70: 2020 2020 2073 7263 5f6f 626a 2e63 6f6c       src_obj.col
-00002d80: 756d 6e73 2c20 7372 635f 6f62 6a2e 726f  umns, src_obj.ro
-00002d90: 7773 2c20 6261 6e64 732c 2073 7263 5f6f  ws, bands, src_o
-00002da0: 626a 2e64 7479 7065 5b30 5d2c 2070 6174  bj.dtype[0], pat
-00002db0: 683d 7061 7468 0d0a 2020 2020 2020 2020  h=path..        
-00002dc0: 290d 0a0d 0a20 2020 2020 2020 2023 2053  )....        # S
-00002dd0: 6574 2074 6865 2070 726f 6a65 6374 696f  et the projectio
-00002de0: 6e2e 0d0a 2020 2020 2020 2020 6473 742e  n...        dst.
-00002df0: 5365 7447 656f 5472 616e 7366 6f72 6d28  SetGeoTransform(
-00002e00: 7372 635f 6f62 6a2e 6765 6f74 7261 6e73  src_obj.geotrans
-00002e10: 666f 726d 290d 0a20 2020 2020 2020 2064  form)..        d
-00002e20: 7374 2e53 6574 5072 6f6a 6563 7469 6f6e  st.SetProjection
-00002e30: 2873 7263 5f6f 626a 2e72 6173 7465 722e  (src_obj.raster.
-00002e40: 4765 7450 726f 6a65 6374 696f 6e52 6566  GetProjectionRef
-00002e50: 2829 290d 0a20 2020 2020 2020 2064 7374  ())..        dst
-00002e60: 203d 2063 6c73 2864 7374 290d 0a20 2020   = cls(dst)..   
-00002e70: 2020 2020 2069 6620 6e6f 5f64 6174 615f       if no_data_
-00002e80: 7661 6c75 6520 6973 206e 6f74 204e 6f6e  value is not Non
-00002e90: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-00002ea0: 6473 742e 5f73 6574 5f6e 6f5f 6461 7461  dst._set_no_data
-00002eb0: 5f76 616c 7565 286e 6f5f 6461 7461 5f76  _value(no_data_v
-00002ec0: 616c 7565 3d66 6c6f 6174 286e 6f5f 6461  alue=float(no_da
-00002ed0: 7461 5f76 616c 7565 2929 0d0a 0d0a 2020  ta_value))....  
-00002ee0: 2020 2020 2020 7265 7475 726e 2064 7374        return dst
-00002ef0: 0d0a 0d0a 2020 2020 4063 6c61 7373 6d65  ....    @classme
-00002f00: 7468 6f64 0d0a 2020 2020 6465 6620 5f63  thod..    def _c
-00002f10: 7265 6174 655f 6472 6976 6572 5f66 726f  reate_driver_fro
-00002f20: 6d5f 7363 7261 7463 6828 0d0a 2020 2020  m_scratch(..    
-00002f30: 2020 2020 636c 732c 0d0a 2020 2020 2020      cls,..      
-00002f40: 2020 6365 6c6c 5f73 697a 653a 2069 6e74    cell_size: int
-00002f50: 2c0d 0a20 2020 2020 2020 2072 6f77 733a  ,..        rows:
-00002f60: 2069 6e74 2c0d 0a20 2020 2020 2020 2063   int,..        c
-00002f70: 6f6c 756d 6e73 3a20 696e 742c 0d0a 2020  olumns: int,..  
-00002f80: 2020 2020 2020 6474 7970 653a 2069 6e74        dtype: int
-00002f90: 2c0d 0a20 2020 2020 2020 2062 616e 6473  ,..        bands
-00002fa0: 3a20 696e 742c 0d0a 2020 2020 2020 2020  : int,..        
-00002fb0: 746f 705f 6c65 6674 5f63 6f6f 7264 733a  top_left_coords:
-00002fc0: 2054 7570 6c65 2c0d 0a20 2020 2020 2020   Tuple,..       
-00002fd0: 2065 7073 673a 2069 6e74 2c0d 0a20 2020   epsg: int,..   
-00002fe0: 2020 2020 206e 6f5f 6461 7461 5f76 616c       no_data_val
-00002ff0: 7565 3a20 416e 7920 3d20 4e6f 6e65 2c0d  ue: Any = None,.
-00003000: 0a20 2020 2020 2020 2070 6174 683a 2073  .        path: s
-00003010: 7472 203d 204e 6f6e 652c 0d0a 2020 2020  tr = None,..    
-00003020: 293a 0d0a 2020 2020 2020 2020 2222 2243  ):..        """C
-00003030: 7265 6174 6520 6120 6e65 7720 656d 7074  reate a new empt
-00003040: 7920 6472 6976 6572 2066 726f 6d20 616e  y driver from an
-00003050: 6f74 6865 7220 6461 7461 7365 742e 0d0a  other dataset...
-00003060: 0d0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
-00003070: 7465 7273 0d0a 2020 2020 2020 2020 2d2d  ters..        --
-00003080: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020  --------..      
-00003090: 2020 6365 6c6c 5f73 697a 653a 205b 416e    cell_size: [An
-000030a0: 795d 0d0a 2020 2020 2020 2020 2020 2020  y]..            
-000030b0: 6365 6c6c 2073 697a 652e 0d0a 2020 2020  cell size...    
-000030c0: 2020 2020 726f 7773 3a20 5b69 6e74 5d0d      rows: [int].
-000030d0: 0a20 2020 2020 2020 2020 2020 206e 756d  .            num
-000030e0: 6265 7220 6f66 2072 6f77 732e 0d0a 2020  ber of rows...  
-000030f0: 2020 2020 2020 636f 6c75 6d6e 733a 205b        columns: [
-00003100: 696e 745d 0d0a 2020 2020 2020 2020 2020  int]..          
-00003110: 2020 6e75 6d62 6572 206f 6620 636f 6c75    number of colu
-00003120: 6d6e 732e 0d0a 2020 2020 2020 2020 6474  mns...        dt
-00003130: 7970 653a 205b 696e 745d 0d0a 2020 2020  ype: [int]..    
-00003140: 2020 2020 2020 2020 6461 7461 2074 7970          data typ
-00003150: 652e 0d0a 2020 2020 2020 2020 6261 6e64  e...        band
-00003160: 7320 3a20 696e 7420 6f72 204e 6f6e 650d  s : int or None.
-00003170: 0a20 2020 2020 2020 2020 2020 204e 756d  .            Num
-00003180: 6265 7220 6f66 2062 616e 6473 2074 6f20  ber of bands to 
-00003190: 6372 6561 7465 2069 6e20 7468 6520 6f75  create in the ou
-000031a0: 7470 7574 2072 6173 7465 722e 0d0a 2020  tput raster...  
-000031b0: 2020 2020 2020 746f 705f 6c65 6674 5f63        top_left_c
-000031c0: 6f6f 7264 733a 205b 5475 706c 655d 0d0a  oords: [Tuple]..
-000031d0: 2020 2020 2020 2020 2020 2020 636f 6f72              coor
-000031e0: 6469 6e61 7465 7320 6f66 2074 6865 2074  dinates of the t
-000031f0: 6f70 206c 6566 7420 636f 726e 6572 2070  op left corner p
-00003200: 6f69 6e74 2e0d 0a20 2020 2020 2020 2065  oint...        e
-00003210: 7073 673a 205b 696e 745d 0d0a 2020 2020  psg: [int]..    
-00003220: 2020 2020 2020 2020 6570 7367 206e 756d          epsg num
-00003230: 6265 7220 746f 2069 6465 6e74 6966 7920  ber to identify 
-00003240: 7468 6520 7072 6f6a 6563 7469 6f6e 206f  the projection o
-00003250: 6620 7468 6520 636f 6f72 6469 6e61 7465  f the coordinate
-00003260: 7320 696e 2074 6865 2063 7265 6174 6564  s in the created
-00003270: 2072 6173 7465 722e 0d0a 2020 2020 2020   raster...      
-00003280: 2020 6e6f 5f64 6174 615f 7661 6c75 6520    no_data_value 
-00003290: 3a20 666c 6f61 7420 6f72 204e 6f6e 650d  : float or None.
-000032a0: 0a20 2020 2020 2020 2020 2020 204e 6f20  .            No 
-000032b0: 6461 7461 2076 616c 7565 2c20 6966 204e  data value, if N
-000032c0: 6f6e 6520 7573 6573 2074 6865 2073 616d  one uses the sam
-000032d0: 6520 6173 2060 6073 7263 6060 2e0d 0a20  e as ``src``... 
-000032e0: 2020 2020 2020 2070 6174 6820 3a20 5b73         path : [s
-000032f0: 7472 5d0d 0a20 2020 2020 2020 2020 2020  tr]..           
-00003300: 2070 6174 6820 6f6e 2064 6973 6b2e 0d0a   path on disk...
-00003310: 0d0a 2020 2020 2020 2020 5265 7475 726e  ..        Return
-00003320: 730d 0a20 2020 2020 2020 202d 2d2d 2d2d  s..        -----
-00003330: 2d2d 0d0a 2020 2020 2020 2020 6764 616c  --..        gdal
-00003340: 2e44 6174 6153 6574 0d0a 2020 2020 2020  .DataSet..      
-00003350: 2020 2222 220d 0a20 2020 2020 2020 2023    """..        #
-00003360: 2043 7265 6174 6520 7468 6520 6472 6976   Create the driv
-00003370: 6572 2e0d 0a20 2020 2020 2020 2064 7374  er...        dst
-00003380: 203d 2044 6174 6173 6574 2e5f 6372 6561   = Dataset._crea
-00003390: 7465 5f67 6461 6c5f 6461 7461 7365 7428  te_gdal_dataset(
-000033a0: 636f 6c75 6d6e 732c 2072 6f77 732c 2062  columns, rows, b
-000033b0: 616e 6473 2c20 6474 7970 652c 2070 6174  ands, dtype, pat
-000033c0: 683d 7061 7468 290d 0a20 2020 2020 2020  h=path)..       
-000033d0: 2067 656f 7472 616e 7366 6f72 6d20 3d20   geotransform = 
-000033e0: 280d 0a20 2020 2020 2020 2020 2020 2074  (..            t
-000033f0: 6f70 5f6c 6566 745f 636f 6f72 6473 5b30  op_left_coords[0
-00003400: 5d2c 0d0a 2020 2020 2020 2020 2020 2020  ],..            
-00003410: 6365 6c6c 5f73 697a 652c 0d0a 2020 2020  cell_size,..    
-00003420: 2020 2020 2020 2020 302c 0d0a 2020 2020          0,..    
-00003430: 2020 2020 2020 2020 746f 705f 6c65 6674          top_left
-00003440: 5f63 6f6f 7264 735b 315d 2c0d 0a20 2020  _coords[1],..   
-00003450: 2020 2020 2020 2020 2030 2c0d 0a20 2020           0,..   
-00003460: 2020 2020 2020 2020 202d 3120 2a20 6365           -1 * ce
-00003470: 6c6c 5f73 697a 652c 0d0a 2020 2020 2020  ll_size,..      
-00003480: 2020 290d 0a20 2020 2020 2020 2073 7220    )..        sr 
-00003490: 3d20 4461 7461 7365 742e 5f63 7265 6174  = Dataset._creat
-000034a0: 655f 7372 5f66 726f 6d5f 6570 7367 2865  e_sr_from_epsg(e
-000034b0: 7073 6729 0d0a 0d0a 2020 2020 2020 2020  psg)....        
-000034c0: 2320 5365 7420 7468 6520 7072 6f6a 6563  # Set the projec
-000034d0: 7469 6f6e 2e0d 0a20 2020 2020 2020 2064  tion...        d
-000034e0: 7374 2e53 6574 4765 6f54 7261 6e73 666f  st.SetGeoTransfo
-000034f0: 726d 2867 656f 7472 616e 7366 6f72 6d29  rm(geotransform)
-00003500: 0d0a 2020 2020 2020 2020 6473 742e 5365  ..        dst.Se
-00003510: 7450 726f 6a65 6374 696f 6e28 7372 2e45  tProjection(sr.E
-00003520: 7870 6f72 7454 6f57 6b74 2829 290d 0a20  xportToWkt()).. 
-00003530: 2020 2020 2020 2064 7374 203d 2063 6c73         dst = cls
-00003540: 2864 7374 290d 0a20 2020 2020 2020 2069  (dst)..        i
-00003550: 6620 6e6f 5f64 6174 615f 7661 6c75 6520  f no_data_value 
-00003560: 6973 206e 6f74 204e 6f6e 653a 0d0a 2020  is not None:..  
-00003570: 2020 2020 2020 2020 2020 6473 742e 5f73            dst._s
-00003580: 6574 5f6e 6f5f 6461 7461 5f76 616c 7565  et_no_data_value
-00003590: 286e 6f5f 6461 7461 5f76 616c 7565 3d6e  (no_data_value=n
-000035a0: 6f5f 6461 7461 5f76 616c 7565 290d 0a0d  o_data_value)...
-000035b0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-000035c0: 6473 740d 0a0d 0a20 2020 2064 6566 2072  dst....    def r
-000035d0: 6561 645f 6172 7261 7928 7365 6c66 2c20  ead_array(self, 
-000035e0: 6261 6e64 3a20 696e 7420 3d20 4e6f 6e65  band: int = None
-000035f0: 2920 2d3e 206e 702e 6e64 6172 7261 793a  ) -> np.ndarray:
-00003600: 0d0a 2020 2020 2020 2020 2222 2252 6561  ..        """Rea
-00003610: 6420 4172 7261 790d 0a0d 0a20 2020 2020  d Array....     
-00003620: 2020 2020 2020 202d 2072 6561 6420 7468         - read th
-00003630: 6520 7661 6c75 6573 2073 746f 7265 6420  e values stored 
-00003640: 696e 2061 2067 6976 656e 2062 616e 642e  in a given band.
-00003650: 0d0a 0d0a 2020 2020 2020 2020 5061 7261  ....        Para
-00003660: 6d65 7465 7273 0d0a 2020 2020 2020 2020  meters..        
-00003670: 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020  ----------..    
-00003680: 2020 2020 6261 6e64 203a 205b 696e 7465      band : [inte
-00003690: 6765 725d 0d0a 2020 2020 2020 2020 2020  ger]..          
-000036a0: 2020 7468 6520 6261 6e64 2079 6f75 2077    the band you w
-000036b0: 616e 7420 746f 2067 6574 2069 7473 2064  ant to get its d
-000036c0: 6174 612e 2044 6566 6175 6c74 2069 7320  ata. Default is 
-000036d0: 300d 0a0d 0a20 2020 2020 2020 2052 6574  0....        Ret
-000036e0: 7572 6e73 0d0a 2020 2020 2020 2020 2d2d  urns..        --
-000036f0: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 2061  -----..        a
-00003700: 7272 6179 203a 205b 6172 7261 795d 0d0a  rray : [array]..
-00003710: 2020 2020 2020 2020 2020 2020 6172 7261              arra
-00003720: 7920 7769 7468 2061 6c6c 2074 6865 2076  y with all the v
-00003730: 616c 7565 7320 696e 2074 6865 2072 6173  alues in the ras
-00003740: 7465 722e 0d0a 2020 2020 2020 2020 2222  ter...        ""
-00003750: 220d 0a20 2020 2020 2020 2023 2074 7279  "..        # try
-00003760: 2074 6f20 7265 7475 726e 2061 7272 6179   to return array
-00003770: 2061 7320 7468 6520 7361 6d65 2074 7970   as the same typ
-00003780: 6520 6173 2074 6865 2072 6173 7465 7220  e as the raster 
-00003790: 6261 6e64 2062 7574 206d 6164 6520 7072  band but made pr
-000037a0: 6f62 6c65 6d73 2077 6865 6e20 7472 7969  oblems when tryi
-000037b0: 6e67 2074 6f20 7265 706c 6163 6520 7468  ng to replace th
-000037c0: 650d 0a20 2020 2020 2020 2023 206e 6f5f  e..        # no_
-000037d0: 6461 7461 5f76 616c 7565 206f 6620 616e  data_value of an
-000037e0: 2069 6e74 6567 6572 2062 616e 6420 7769   integer band wi
-000037f0: 7468 206e 702e 6e61 6e20 7661 6c75 650d  th np.nan value.
-00003800: 0a20 2020 2020 2020 2023 2064 7479 7065  .        # dtype
-00003810: 203d 2067 6461 6c5f 746f 5f6e 756d 7079   = gdal_to_numpy
-00003820: 5f64 7479 7065 2873 656c 662e 6474 7970  _dtype(self.dtyp
-00003830: 655b 305d 290d 0a20 2020 2020 2020 2069  e[0])..        i
-00003840: 6620 6261 6e64 2069 7320 4e6f 6e65 2061  f band is None a
-00003850: 6e64 2073 656c 662e 6261 6e64 5f63 6f75  nd self.band_cou
-00003860: 6e74 203e 2031 3a0d 0a20 2020 2020 2020  nt > 1:..       
-00003870: 2020 2020 2061 7272 203d 206e 702e 6f6e       arr = np.on
-00003880: 6573 280d 0a20 2020 2020 2020 2020 2020  es(..           
-00003890: 2020 2020 2028 0d0a 2020 2020 2020 2020       (..        
-000038a0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-000038b0: 2e62 616e 645f 636f 756e 742c 0d0a 2020  .band_count,..  
-000038c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000038d0: 2020 7365 6c66 2e72 6f77 732c 0d0a 2020    self.rows,..  
-000038e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000038f0: 2020 7365 6c66 2e63 6f6c 756d 6e73 2c0d    self.columns,.
-00003900: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00003910: 2029 2c0d 0a20 2020 2020 2020 2020 2020   ),..           
-00003920: 2020 2020 2023 2064 7479 7065 3d64 7479       # dtype=dty
-00003930: 7065 0d0a 2020 2020 2020 2020 2020 2020  pe..            
-00003940: 290d 0a20 2020 2020 2020 2020 2020 2066  )..            f
-00003950: 6f72 2069 2069 6e20 7261 6e67 6528 7365  or i in range(se
-00003960: 6c66 2e62 616e 645f 636f 756e 7429 3a0d  lf.band_count):.
-00003970: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00003980: 2061 7272 5b69 2c20 3a2c 203a 5d20 3d20   arr[i, :, :] = 
-00003990: 7365 6c66 2e5f 7261 7374 6572 2e47 6574  self._raster.Get
-000039a0: 5261 7374 6572 4261 6e64 2869 202b 2031  RasterBand(i + 1
-000039b0: 292e 5265 6164 4173 4172 7261 7928 290d  ).ReadAsArray().
-000039c0: 0a20 2020 2020 2020 2065 6c73 653a 0d0a  .        else:..
-000039d0: 2020 2020 2020 2020 2020 2020 6966 2062              if b
-000039e0: 616e 6420 6973 204e 6f6e 653a 0d0a 2020  and is None:..  
-000039f0: 2020 2020 2020 2020 2020 2020 2020 6261                ba
-00003a00: 6e64 203d 2030 0d0a 2020 2020 2020 2020  nd = 0..        
-00003a10: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
-00003a20: 2020 2020 2020 2020 2020 2069 6620 6261             if ba
-00003a30: 6e64 203e 2073 656c 662e 6261 6e64 5f63  nd > self.band_c
-00003a40: 6f75 6e74 202d 2031 3a0d 0a20 2020 2020  ount - 1:..     
-00003a50: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-00003a60: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
-00003a70: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00003a80: 2020 2020 2020 2020 2020 6622 6261 6e64            f"band
-00003a90: 2069 6e64 6578 2073 686f 756c 6420 6265   index should be
-00003aa0: 2062 6574 7765 656e 2030 2061 6e64 207b   between 0 and {
-00003ab0: 7365 6c66 2e62 616e 645f 636f 756e 7420  self.band_count 
-00003ac0: 2d20 317d 220d 0a20 2020 2020 2020 2020  - 1}"..         
-00003ad0: 2020 2020 2020 2020 2020 2029 0d0a 2020             )..  
-00003ae0: 2020 2020 2020 2020 2020 6172 7220 3d20            arr = 
-00003af0: 7365 6c66 2e72 6173 7465 722e 4765 7452  self.raster.GetR
-00003b00: 6173 7465 7242 616e 6428 6261 6e64 202b  asterBand(band +
-00003b10: 2031 292e 5265 6164 4173 4172 7261 7928   1).ReadAsArray(
-00003b20: 290d 0a0d 0a20 2020 2020 2020 2072 6574  )....        ret
-00003b30: 7572 6e20 6172 720d 0a0d 0a20 2020 2064  urn arr....    d
-00003b40: 6566 2070 6c6f 7428 0d0a 2020 2020 2020  ef plot(..      
-00003b50: 2020 7365 6c66 2c0d 0a20 2020 2020 2020    self,..       
-00003b60: 2062 616e 643a 2069 6e74 203d 204e 6f6e   band: int = Non
-00003b70: 652c 0d0a 2020 2020 2020 2020 6578 636c  e,..        excl
-00003b80: 7564 655f 7661 6c75 653a 2041 6e79 203d  ude_value: Any =
-00003b90: 204e 6f6e 652c 0d0a 2020 2020 2020 2020   None,..        
-00003ba0: 7267 623a 204c 6973 745b 696e 745d 203d  rgb: List[int] =
-00003bb0: 204e 6f6e 652c 0d0a 2020 2020 2020 2020   None,..        
-00003bc0: 7375 7266 6163 655f 7265 666c 6563 7461  surface_reflecta
-00003bd0: 6e63 653a 2069 6e74 203d 2031 3030 3030  nce: int = 10000
-00003be0: 2c0d 0a20 2020 2020 2020 2063 7574 6f66  ,..        cutof
-00003bf0: 663a 204c 6973 7420 3d20 4e6f 6e65 2c0d  f: List = None,.
-00003c00: 0a20 2020 2020 2020 202a 2a6b 7761 7267  .        **kwarg
-00003c10: 732c 0d0a 2020 2020 293a 0d0a 2020 2020  s,..    ):..    
-00003c20: 2020 2020 2222 2252 6561 6420 4172 7261      """Read Arra
-00003c30: 790d 0a0d 0a20 2020 2020 2020 2020 2020  y....           
-00003c40: 202d 2072 6561 6420 7468 6520 7661 6c75   - read the valu
-00003c50: 6573 2073 746f 7265 6420 696e 2061 2067  es stored in a g
-00003c60: 6976 656e 2062 616e 642e 0d0a 0d0a 2020  iven band.....  
-00003c70: 2020 2020 2020 5061 7261 6d65 7465 7273        Parameters
-00003c80: 0d0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ..        ------
-00003c90: 2d2d 2d2d 0d0a 2020 2020 2020 2020 6261  ----..        ba
-00003ca0: 6e64 203a 205b 696e 7465 6765 725d 0d0a  nd : [integer]..
-00003cb0: 2020 2020 2020 2020 2020 2020 7468 6520              the 
-00003cc0: 6261 6e64 2079 6f75 2077 616e 7420 746f  band you want to
-00003cd0: 2067 6574 2069 7473 2064 6174 612e 2044   get its data. D
-00003ce0: 6566 6175 6c74 2069 7320 300d 0a20 2020  efault is 0..   
-00003cf0: 2020 2020 2065 7863 6c75 6465 5f76 616c       exclude_val
-00003d00: 7565 3a20 5b41 6e79 5d0d 0a20 2020 2020  ue: [Any]..     
-00003d10: 2020 2020 2020 2076 616c 7565 2074 6f20         value to 
-00003d20: 6578 6563 6c75 6465 2066 726f 6d20 7468  execlude from th
-00003d30: 6520 706c 6f74 2e20 4465 6661 756c 7420  e plot. Default 
-00003d40: 6973 204e 6f6e 652e 0d0a 2020 2020 2020  is None...      
-00003d50: 2020 7267 623a 205b 4c69 7374 5d0d 0a20    rgb: [List].. 
-00003d60: 2020 2020 2020 2020 2020 2044 6566 6175             Defau
-00003d70: 6c74 2069 7320 5b33 2c32 2c31 5d0d 0a20  lt is [3,2,1].. 
-00003d80: 2020 2020 2020 2073 7572 6661 6365 5f72         surface_r
-00003d90: 6566 6c65 6374 616e 6365 3a20 5b69 6e74  eflectance: [int
-00003da0: 5d0d 0a20 2020 2020 2020 2020 2020 2044  ]..            D
-00003db0: 6566 6175 6c74 2069 7320 2031 3030 3030  efault is  10000
-00003dc0: 0d0a 2020 2020 2020 2020 6375 746f 6666  ..        cutoff
-00003dd0: 3a20 5b4c 6973 745d 0d0a 2020 2020 2020  : [List]..      
-00003de0: 2020 2020 2020 636c 6970 2074 6865 2072        clip the r
-00003df0: 616e 6765 206f 6620 7069 7865 6c20 7661  ange of pixel va
-00003e00: 6c75 6573 2066 6f72 2065 6163 6820 6261  lues for each ba
-00003e10: 6e64 2e20 2874 616b 6520 6f6e 6c79 2074  nd. (take only t
-00003e20: 6865 2070 6978 656c 2076 616c 7565 7320  he pixel values 
-00003e30: 6672 6f6d 2030 2074 6f20 7661 6c75 6520  from 0 to value 
-00003e40: 6f66 2074 6865 2063 7574 6f66 6620 616e  of the cutoff an
-00003e50: 640d 0a20 2020 2020 2020 2020 2020 2073  d..            s
-00003e60: 6361 6c65 2074 6865 6d20 6261 636b 2074  cale them back t
-00003e70: 6f20 6265 7477 6565 6e20 3020 616e 6420  o between 0 and 
-00003e80: 312e 2044 6566 6175 6c74 2069 7320 4e6f  1. Default is No
-00003e90: 6e65 2e0d 0a20 2020 2020 2020 202a 2a6b  ne...        **k
-00003ea0: 7761 7267 730d 0a20 2020 2020 2020 2020  wargs..         
-00003eb0: 2020 2070 6f69 6e74 7320 3a20 5b61 7272     points : [arr
-00003ec0: 6179 5d0d 0a20 2020 2020 2020 2020 2020  ay]..           
-00003ed0: 2020 2020 2033 2063 6f6c 756d 6e20 6172       3 column ar
-00003ee0: 7261 7920 7769 7468 2074 6865 2066 6972  ray with the fir
-00003ef0: 7374 2063 6f6c 756d 6e20 6173 2074 6865  st column as the
-00003f00: 2076 616c 7565 2079 6f75 2077 616e 7420   value you want 
-00003f10: 746f 2064 6973 706c 6179 2066 6f72 2074  to display for t
-00003f20: 6865 2070 6f69 6e74 2c20 7468 6520 7365  he point, the se
-00003f30: 636f 6e64 2069 7320 7468 6520 726f 7773  cond is the rows
-00003f40: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00003f50: 2020 696e 6465 7820 6f66 2074 6865 2070    index of the p
-00003f60: 6f69 6e74 2069 6e20 7468 6520 6172 7261  oint in the arra
-00003f70: 792c 2061 6e64 2074 6865 2074 6869 7264  y, and the third
-00003f80: 2063 6f6c 756d 6e20 6173 2074 6865 2063   column as the c
-00003f90: 6f6c 756d 6e20 696e 6465 7820 696e 2074  olumn index in t
-00003fa0: 6865 2061 7272 6179 2e0d 0a20 2020 2020  he array...     
-00003fb0: 2020 2020 2020 2020 2020 202d 2074 6865             - the
-00003fc0: 2073 6563 6f6e 6420 616e 6420 7468 6972   second and thir
-00003fd0: 6420 636f 6c75 6d6e 2074 656c 6c73 2074  d column tells t
-00003fe0: 6865 206c 6f63 6174 696f 6e20 6f66 2074  he location of t
-00003ff0: 6865 2070 6f69 6e74 2069 6e20 7468 6520  he point in the 
-00004000: 6172 7261 792e 0d0a 2020 2020 2020 2020  array...        
-00004010: 2020 2020 706f 696e 745f 636f 6c6f 723a      point_color:
-00004020: 205b 7374 725d 0d0a 2020 2020 2020 2020   [str]..        
-00004030: 2020 2020 2020 2020 636f 6c6f 722e 0d0a          color...
-00004040: 2020 2020 2020 2020 2020 2020 706f 696e              poin
-00004050: 745f 7369 7a65 3a20 5b41 6e79 5d0d 0a20  t_size: [Any].. 
-00004060: 2020 2020 2020 2020 2020 2020 2020 2073                 s
-00004070: 697a 6520 6f66 2074 6865 2070 6f69 6e74  ize of the point
-00004080: 2e0d 0a20 2020 2020 2020 2020 2020 2070  ...            p
-00004090: 6964 5f63 6f6c 6f72 3a20 5b73 7472 5d0d  id_color: [str].
-000040a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000040b0: 2074 6865 2063 6f6c 6f72 206f 6620 7468   the color of th
-000040c0: 6520 616e 6f74 6174 696f 6e20 6f66 2074  e anotation of t
-000040d0: 6865 2070 6f69 6e74 2e20 4465 6661 756c  he point. Defaul
-000040e0: 7420 6973 2062 6c75 652e 0d0a 2020 2020  t is blue...    
-000040f0: 2020 2020 2020 2020 7069 645f 7369 7a65          pid_size
-00004100: 3a20 5b41 6e79 5d0d 0a20 2020 2020 2020  : [Any]..       
-00004110: 2020 2020 2020 2020 2073 697a 6520 6f66           size of
-00004120: 2074 6865 2070 6f69 6e74 2061 6e6e 6f74   the point annot
-00004130: 6174 696f 6e2e 0d0a 2020 2020 2020 2020  ation...        
-00004140: 2020 2020 6669 6773 697a 6520 3a20 5b74      figsize : [t
-00004150: 7570 6c65 5d2c 206f 7074 696f 6e61 6c0d  uple], optional.
-00004160: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00004170: 2066 6967 7572 6520 7369 7a65 2e20 5468   figure size. Th
-00004180: 6520 6465 6661 756c 7420 6973 2028 382c  e default is (8,
-00004190: 3829 2e0d 0a20 2020 2020 2020 2020 2020  8)...           
-000041a0: 2074 6974 6c65 203a 205b 7374 725d 2c20   title : [str], 
-000041b0: 6f70 7469 6f6e 616c 0d0a 2020 2020 2020  optional..      
-000041c0: 2020 2020 2020 2020 2020 7469 746c 6520            title 
-000041d0: 6f66 2074 6865 2070 6c6f 742e 2054 6865  of the plot. The
-000041e0: 2064 6566 6175 6c74 2069 7320 2754 6f74   default is 'Tot
-000041f0: 616c 2044 6973 6368 6172 6765 272e 0d0a  al Discharge'...
-00004200: 2020 2020 2020 2020 2020 2020 7469 746c              titl
-00004210: 655f 7369 7a65 203a 205b 696e 7465 6765  e_size : [intege
-00004220: 725d 2c20 6f70 7469 6f6e 616c 0d0a 2020  r], optional..  
-00004230: 2020 2020 2020 2020 2020 2020 2020 7469                ti
-00004240: 746c 6520 7369 7a65 2e20 5468 6520 6465  tle size. The de
-00004250: 6661 756c 7420 6973 2031 352e 0d0a 2020  fault is 15...  
-00004260: 2020 2020 2020 2020 2020 6f72 6965 6e74            orient
-00004270: 6174 696f 6e20 3a20 5b73 7472 696e 675d  ation : [string]
-00004280: 2c20 6f70 7469 6f6e 616c 0d0a 2020 2020  , optional..    
-00004290: 2020 2020 2020 2020 2020 2020 6f72 696e              orin
-000042a0: 7461 7469 6f6e 206f 6620 7468 6520 636f  tation of the co
-000042b0: 6c6f 7262 6172 2068 6f72 697a 6f6e 7461  lorbar horizonta
-000042c0: 6c2f 7665 7274 6963 616c 2e20 5468 6520  l/vertical. The 
-000042d0: 6465 6661 756c 7420 6973 2027 7665 7274  default is 'vert
-000042e0: 6963 616c 272e 0d0a 2020 2020 2020 2020  ical'...        
-000042f0: 2020 2020 726f 7461 7469 6f6e 203a 205b      rotation : [
-00004300: 6e75 6d62 6572 5d2c 206f 7074 696f 6e61  number], optiona
-00004310: 6c0d 0a20 2020 2020 2020 2020 2020 2020  l..             
-00004320: 2020 2072 6f74 6174 696f 6e20 6f66 2074     rotation of t
-00004330: 6865 2063 6f6c 6f72 6261 7220 6c61 6265  he colorbar labe
-00004340: 6c2e 2054 6865 2064 6566 6175 6c74 2069  l. The default i
-00004350: 7320 2d39 302e 0d0a 2020 2020 2020 2020  s -90...        
-00004360: 2020 2020 6f72 6965 6e74 6174 696f 6e20      orientation 
-00004370: 3a20 5b73 7472 696e 675d 2c20 6f70 7469  : [string], opti
-00004380: 6f6e 616c 0d0a 2020 2020 2020 2020 2020  onal..          
-00004390: 2020 2020 2020 6f72 696e 7461 7469 6f6e        orintation
-000043a0: 206f 6620 7468 6520 636f 6c6f 7262 6172   of the colorbar
-000043b0: 2068 6f72 697a 6f6e 7461 6c2f 7665 7274   horizontal/vert
-000043c0: 6963 616c 2e20 5468 6520 6465 6661 756c  ical. The defaul
-000043d0: 7420 6973 2027 7665 7274 6963 616c 272e  t is 'vertical'.
-000043e0: 0d0a 2020 2020 2020 2020 2020 2020 6362  ..            cb
-000043f0: 6172 5f6c 656e 6774 6820 3a20 5b66 6c6f  ar_length : [flo
-00004400: 6174 5d2c 206f 7074 696f 6e61 6c0d 0a20  at], optional.. 
-00004410: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-00004420: 6174 696f 2074 6f20 636f 6e74 726f 6c20  atio to control 
-00004430: 7468 6520 6865 6967 6874 206f 6620 7468  the height of th
-00004440: 6520 636f 6c6f 7262 6172 2e20 5468 6520  e colorbar. The 
-00004450: 6465 6661 756c 7420 6973 2030 2e37 352e  default is 0.75.
-00004460: 0d0a 2020 2020 2020 2020 2020 2020 7469  ..            ti
-00004470: 636b 735f 7370 6163 696e 6720 3a20 5b69  cks_spacing : [i
-00004480: 6e74 6567 6572 5d2c 206f 7074 696f 6e61  nteger], optiona
-00004490: 6c0d 0a20 2020 2020 2020 2020 2020 2020  l..             
-000044a0: 2020 2053 7061 6369 6e67 2069 6e20 7468     Spacing in th
-000044b0: 6520 636f 6c6f 7262 6172 2074 6963 6b73  e colorbar ticks
-000044c0: 2e20 5468 6520 6465 6661 756c 7420 6973  . The default is
-000044d0: 2032 2e0d 0a20 2020 2020 2020 2020 2020   2...           
-000044e0: 2063 6261 725f 6c61 6265 6c5f 7369 7a65   cbar_label_size
-000044f0: 203a 2069 6e74 6567 6572 2c20 6f70 7469   : integer, opti
-00004500: 6f6e 616c 0d0a 2020 2020 2020 2020 2020  onal..          
-00004510: 2020 2020 2020 7369 7a65 206f 6620 7468        size of th
-00004520: 6520 636f 6c6f 7220 6261 7220 6c61 6265  e color bar labe
-00004530: 6c2e 2054 6865 2064 6566 6175 6c74 2069  l. The default i
-00004540: 7320 3132 2e0d 0a20 2020 2020 2020 2020  s 12...         
-00004550: 2020 2063 6261 725f 6c61 6265 6c20 3a20     cbar_label : 
-00004560: 7374 722c 206f 7074 696f 6e61 6c0d 0a20  str, optional.. 
-00004570: 2020 2020 2020 2020 2020 2020 2020 206c                 l
-00004580: 6162 656c 206f 6620 7468 6520 636f 6c6f  abel of the colo
-00004590: 7220 6261 722e 2054 6865 2064 6566 6175  r bar. The defau
-000045a0: 6c74 2069 7320 2744 6973 6368 6172 6765  lt is 'Discharge
-000045b0: 206d 332f 7327 2e0d 0a20 2020 2020 2020   m3/s'...       
-000045c0: 2020 2020 2063 6f6c 6f72 5f73 6361 6c65       color_scale
-000045d0: 203a 2069 6e74 6567 6572 2c20 6f70 7469   : integer, opti
-000045e0: 6f6e 616c 0d0a 2020 2020 2020 2020 2020  onal..          
-000045f0: 2020 2020 2020 7468 6572 6520 6172 6520        there are 
-00004600: 3520 6f70 7469 6f6e 7320 746f 2063 6861  5 options to cha
-00004610: 6e67 6520 7468 6520 7363 616c 6520 6f66  nge the scale of
-00004620: 2074 6865 2063 6f6c 6f72 732e 2054 6865   the colors. The
-00004630: 2064 6566 6175 6c74 2069 7320 312e 0d0a   default is 1...
-00004640: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004650: 312d 2063 6f6c 6f72 5f73 6361 6c65 2031  1- color_scale 1
-00004660: 2069 7320 7468 6520 6e6f 726d 616c 2073   is the normal s
-00004670: 6361 6c65 0d0a 2020 2020 2020 2020 2020  cale..          
-00004680: 2020 2020 2020 322d 2063 6f6c 6f72 5f73        2- color_s
-00004690: 6361 6c65 2032 2069 7320 7468 6520 706f  cale 2 is the po
-000046a0: 7765 7220 7363 616c 650d 0a20 2020 2020  wer scale..     
-000046b0: 2020 2020 2020 2020 2020 2033 2d20 636f             3- co
-000046c0: 6c6f 725f 7363 616c 6520 3320 6973 2074  lor_scale 3 is t
-000046d0: 6865 2053 796d 4c6f 674e 6f72 6d20 7363  he SymLogNorm sc
-000046e0: 616c 650d 0a20 2020 2020 2020 2020 2020  ale..           
-000046f0: 2020 2020 2034 2d20 636f 6c6f 725f 7363       4- color_sc
-00004700: 616c 6520 3420 6973 2074 6865 2050 6f77  ale 4 is the Pow
-00004710: 6572 4e6f 726d 2073 6361 6c65 0d0a 2020  erNorm scale..  
-00004720: 2020 2020 2020 2020 2020 2020 2020 352d                5-
-00004730: 2063 6f6c 6f72 5f73 6361 6c65 2035 2069   color_scale 5 i
-00004740: 7320 7468 6520 426f 756e 6461 7279 4e6f  s the BoundaryNo
-00004750: 726d 2073 6361 6c65 0d0a 2020 2020 2020  rm scale..      
-00004760: 2020 2020 2020 2020 2020 2d2d 2d2d 2d2d            ------
-00004770: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00004780: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00004790: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-000047a0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020  ------------..  
-000047b0: 2020 2020 2020 2020 2020 2020 2020 6761                ga
-000047c0: 6d6d 6120 3a20 5b66 6c6f 6174 5d2c 206f  mma : [float], o
-000047d0: 7074 696f 6e61 6c0d 0a20 2020 2020 2020  ptional..       
-000047e0: 2020 2020 2020 2020 2020 2020 2076 616c               val
-000047f0: 7565 206e 6565 6465 6420 666f 7220 6f70  ue needed for op
-00004800: 7469 6f6e 2032 202e 2054 6865 2064 6566  tion 2 . The def
-00004810: 6175 6c74 2069 7320 312e 2f32 2e2e 0d0a  ault is 1./2....
-00004820: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00004830: 6c69 6e65 5f74 6872 6573 686f 6c64 203a  line_threshold :
-00004840: 205b 666c 6f61 745d 2c20 6f70 7469 6f6e   [float], option
-00004850: 616c 0d0a 2020 2020 2020 2020 2020 2020  al..            
-00004860: 2020 2020 2020 2020 7661 6c75 6520 6e65          value ne
-00004870: 6564 6564 2066 6f72 206f 7074 696f 6e20  eded for option 
-00004880: 332e 2054 6865 2064 6566 6175 6c74 2069  3. The default i
-00004890: 7320 302e 3030 3031 2e0d 0a20 2020 2020  s 0.0001...     
-000048a0: 2020 2020 2020 2020 2020 206c 696e 655f             line_
-000048b0: 7363 616c 6520 3a20 5b66 6c6f 6174 5d2c  scale : [float],
-000048c0: 206f 7074 696f 6e61 6c0d 0a20 2020 2020   optional..     
-000048d0: 2020 2020 2020 2020 2020 2020 2020 2076                 v
-000048e0: 616c 7565 206e 6565 6465 6420 666f 7220  alue needed for 
-000048f0: 6f70 7469 6f6e 2033 2e20 5468 6520 6465  option 3. The de
-00004900: 6661 756c 7420 6973 2030 2e30 3031 2e0d  fault is 0.001..
-00004910: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00004920: 2062 6f75 6e64 733a 205b 4c69 7374 5d0d   bounds: [List].
-00004930: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00004940: 2020 2020 2061 206c 6973 7420 6f66 206e       a list of n
-00004950: 756d 6265 7220 746f 2062 6520 7573 6564  umber to be used
-00004960: 2061 7320 6120 6469 7363 7265 7465 2062   as a discrete b
-00004970: 6f75 6e64 7320 666f 7220 7468 6520 636f  ounds for the co
-00004980: 6c6f 7220 7363 616c 6520 342e 4465 6661  lor scale 4.Defa
-00004990: 756c 7420 6973 204e 6f6e 652c 0d0a 2020  ult is None,..  
-000049a0: 2020 2020 2020 2020 2020 2020 2020 6d69                mi
-000049b0: 6470 6f69 6e74 203a 205b 666c 6f61 745d  dpoint : [float]
-000049c0: 2c20 6f70 7469 6f6e 616c 0d0a 2020 2020  , optional..    
-000049d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000049e0: 7661 6c75 6520 6e65 6564 6564 2066 6f72  value needed for
-000049f0: 206f 7074 696f 6e20 352e 2054 6865 2064   option 5. The d
-00004a00: 6566 6175 6c74 2069 7320 302e 0d0a 2020  efault is 0...  
-00004a10: 2020 2020 2020 2020 2020 2020 2020 2d2d                --
-00004a20: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00004a30: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00004a40: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00004a50: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-00004a60: 0d0a 2020 2020 2020 2020 2020 2020 636d  ..            cm
-00004a70: 6170 203a 205b 7374 725d 2c20 6f70 7469  ap : [str], opti
-00004a80: 6f6e 616c 0d0a 2020 2020 2020 2020 2020  onal..          
-00004a90: 2020 2020 2020 636f 6c6f 7220 7374 796c        color styl
-00004aa0: 652e 2054 6865 2064 6566 6175 6c74 2069  e. The default i
-00004ab0: 7320 2763 6f6f 6c77 6172 6d5f 7227 2e0d  s 'coolwarm_r'..
-00004ac0: 0a20 2020 2020 2020 2020 2020 2064 6973  .            dis
-00004ad0: 706c 6179 5f63 656c 6c5f 7661 6c75 6520  play_cell_value 
-00004ae0: 3a20 5b62 6f6f 6c5d 0d0a 2020 2020 2020  : [bool]..      
-00004af0: 2020 2020 2020 2020 2020 5472 7565 2069            True i
-00004b00: 6620 796f 7520 7761 6e74 2074 6f20 6469  f you want to di
-00004b10: 7370 6c61 7920 7468 6520 7661 6c75 6573  splay the values
-00004b20: 206f 6620 7468 6520 6365 6c6c 7320 6173   of the cells as
-00004b30: 2061 2074 6578 740d 0a20 2020 2020 2020   a text..       
-00004b40: 2020 2020 206e 756d 5f73 697a 6520 3a20       num_size : 
-00004b50: 696e 7465 6765 722c 206f 7074 696f 6e61  integer, optiona
-00004b60: 6c0d 0a20 2020 2020 2020 2020 2020 2020  l..             
-00004b70: 2020 2073 697a 6520 6f66 2074 6865 206e     size of the n
-00004b80: 756d 6265 7273 2070 6c6f 7474 6564 2069  umbers plotted i
-00004b90: 6e74 6f70 206f 6620 6561 6368 2063 656c  ntop of each cel
-00004ba0: 6c73 2e20 5468 6520 6465 6661 756c 7420  ls. The default 
-00004bb0: 6973 2038 2e0d 0a20 2020 2020 2020 2020  is 8...         
-00004bc0: 2020 2062 6163 6b67 726f 756e 645f 636f     background_co
-00004bd0: 6c6f 725f 7468 7265 7368 6f6c 6420 3a20  lor_threshold : 
-00004be0: 5b66 6c6f 6174 2f69 6e74 6567 6572 5d2c  [float/integer],
-00004bf0: 206f 7074 696f 6e61 6c0d 0a20 2020 2020   optional..     
-00004c00: 2020 2020 2020 2020 2020 2074 6872 6573             thres
-00004c10: 686f 6c64 2076 616c 7565 2069 6620 7468  hold value if th
-00004c20: 6520 7661 6c75 6520 6f66 2074 6865 2063  e value of the c
-00004c30: 656c 6c20 6973 2067 7265 6174 6572 2c20  ell is greater, 
-00004c40: 7468 6520 706c 6f74 7465 640d 0a20 2020  the plotted..   
-00004c50: 2020 2020 2020 2020 2020 2020 206e 756d               num
-00004c60: 6265 7273 2077 696c 6c20 6265 2062 6c61  bers will be bla
-00004c70: 636b 2061 6e64 2069 6620 736d 616c 6c65  ck and if smalle
-00004c80: 7220 7468 6520 706c 6f74 7465 6420 6e75  r the plotted nu
-00004c90: 6d62 6572 2077 696c 6c20 6265 2077 6869  mber will be whi
-00004ca0: 7465 0d0a 2020 2020 2020 2020 2020 2020  te..            
-00004cb0: 2020 2020 6966 204e 6f6e 6520 6769 7665      if None give
-00004cc0: 6e20 7468 6520 6d61 7876 616c 7565 2f32  n the maxvalue/2
-00004cd0: 2077 696c 6c20 6265 2063 6f6e 7369 6465   will be conside
-00004ce0: 7265 642e 2054 6865 2064 6566 6175 6c74  red. The default
-00004cf0: 2069 7320 4e6f 6e65 2e0d 0a0d 0a20 2020   is None.....   
-00004d00: 2020 2020 2052 6574 7572 6e73 0d0a 2020       Returns..  
-00004d10: 2020 2020 2020 2d2d 2d2d 2d2d 2d0d 0a20        -------.. 
-00004d20: 2020 2020 2020 2061 7865 733a 205b 6669         axes: [fi
-00004d30: 6775 7265 2061 7865 735d 2e0d 0a20 2020  gure axes]...   
-00004d40: 2020 2020 2020 2020 2074 6865 2061 7865           the axe
-00004d50: 7320 6f66 2074 6865 206d 6174 706c 6f74  s of the matplot
-00004d60: 6c69 6220 6669 6775 7265 0d0a 2020 2020  lib figure..    
-00004d70: 2020 2020 6669 673a 205b 6d61 7470 6c6f      fig: [matplo
-00004d80: 746c 6962 2066 6967 7572 6520 6f62 6a65  tlib figure obje
-00004d90: 6374 5d0d 0a20 2020 2020 2020 2020 2020  ct]..           
-00004da0: 2074 6865 2066 6967 7572 6520 6f62 6a65   the figure obje
-00004db0: 6374 0d0a 2020 2020 2020 2020 2222 220d  ct..        """.
-00004dc0: 0a20 2020 2020 2020 2069 6d70 6f72 745f  .        import_
-00004dd0: 636c 656f 7061 7472 6128 0d0a 2020 2020  cleopatra(..    
-00004de0: 2020 2020 2020 2020 2254 6865 2063 7572          "The cur
-00004df0: 7265 6e74 2066 756e 6372 696f 6e20 7573  rent funcrion us
-00004e00: 6573 2063 6c65 6f70 6174 7261 2070 6163  es cleopatra pac
-00004e10: 6b61 6765 2074 6f20 666f 7220 706c 6f74  kage to for plot
-00004e20: 7469 6e67 2c20 706c 6561 7365 2069 6e73  ting, please ins
-00004e30: 7461 6c6c 2069 7420 6d61 6e75 616c 6c79  tall it manually
-00004e40: 2c20 666f 7220 6d6f 7265 2069 6e66 6f20  , for more info 
-00004e50: 220d 0a20 2020 2020 2020 2020 2020 2022  "..            "
-00004e60: 6368 6563 6b20 6874 7470 733a 2f2f 6769  check https://gi
-00004e70: 7468 7562 2e63 6f6d 2f53 6572 6170 6965  thub.com/Serapie
-00004e80: 756d 2d6f 662d 616c 6578 2f63 6c65 6f70  um-of-alex/cleop
-00004e90: 6174 7261 220d 0a20 2020 2020 2020 2029  atra"..        )
-00004ea0: 0d0a 2020 2020 2020 2020 6672 6f6d 2063  ..        from c
-00004eb0: 6c65 6f70 6174 7261 2e61 7272 6179 2069  leopatra.array i
-00004ec0: 6d70 6f72 7420 4172 7261 790d 0a0d 0a20  mport Array.... 
-00004ed0: 2020 2020 2020 206e 6f5f 6461 7461 5f76         no_data_v
-00004ee0: 616c 7565 203d 205b 6e70 2e6e 616e 2069  alue = [np.nan i
-00004ef0: 6620 6920 6973 204e 6f6e 6520 656c 7365  f i is None else
-00004f00: 2069 2066 6f72 2069 2069 6e20 7365 6c66   i for i in self
-00004f10: 2e6e 6f5f 6461 7461 5f76 616c 7565 5d0d  .no_data_value].
-00004f20: 0a0d 0a20 2020 2020 2020 2069 6620 6261  ...        if ba
-00004f30: 6e64 2069 7320 4e6f 6e65 3a0d 0a20 2020  nd is None:..   
-00004f40: 2020 2020 2020 2020 2069 6620 7267 6220           if rgb 
-00004f50: 6973 204e 6f6e 653a 0d0a 2020 2020 2020  is None:..      
-00004f60: 2020 2020 2020 2020 2020 7267 6220 3d20            rgb = 
-00004f70: 5b33 2c20 322c 2031 5d0d 0a20 2020 2020  [3, 2, 1]..     
-00004f80: 2020 2020 2020 2023 2066 6972 7374 206d         # first m
-00004f90: 616b 6520 7468 6520 6261 6e64 2069 6e64  ake the band ind
-00004fa0: 6578 2074 6865 2066 6972 7374 2062 616e  ex the first ban
-00004fb0: 6420 696e 2074 6865 2072 6762 206c 6973  d in the rgb lis
-00004fc0: 7420 2872 6564 2062 616e 6429 0d0a 2020  t (red band)..  
-00004fd0: 2020 2020 2020 2020 2020 6261 6e64 203d            band =
-00004fe0: 2072 6762 5b30 5d0d 0a20 2020 2020 2020   rgb[0]..       
-00004ff0: 2020 2020 2065 7863 6c75 6465 5f76 616c       exclude_val
-00005000: 7565 203d 2028 0d0a 2020 2020 2020 2020  ue = (..        
-00005010: 2020 2020 2020 2020 5b6e 6f5f 6461 7461          [no_data
-00005020: 5f76 616c 7565 5b62 616e 645d 2c20 6578  _value[band], ex
-00005030: 636c 7564 655f 7661 6c75 655d 0d0a 2020  clude_value]..  
-00005040: 2020 2020 2020 2020 2020 2020 2020 6966                if
-00005050: 2065 7863 6c75 6465 5f76 616c 7565 2069   exclude_value i
-00005060: 7320 6e6f 7420 4e6f 6e65 0d0a 2020 2020  s not None..    
-00005070: 2020 2020 2020 2020 2020 2020 656c 7365              else
-00005080: 205b 6e6f 5f64 6174 615f 7661 6c75 655b   [no_data_value[
-00005090: 6261 6e64 5d5d 0d0a 2020 2020 2020 2020  band]]..        
-000050a0: 2020 2020 290d 0a0d 0a20 2020 2020 2020      )....       
-000050b0: 2020 2020 2062 616e 6420 3d20 4e6f 6e65       band = None
-000050c0: 0d0a 2020 2020 2020 2020 656c 7365 3a0d  ..        else:.
-000050d0: 0a20 2020 2020 2020 2020 2020 2065 7863  .            exc
-000050e0: 6c75 6465 5f76 616c 7565 203d 2028 0d0a  lude_value = (..
-000050f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005100: 5b73 656c 662e 6e6f 5f64 6174 615f 7661  [self.no_data_va
-00005110: 6c75 655b 6261 6e64 5d2c 2065 7863 6c75  lue[band], exclu
-00005120: 6465 5f76 616c 7565 5d0d 0a20 2020 2020  de_value]..     
-00005130: 2020 2020 2020 2020 2020 2069 6620 6578             if ex
-00005140: 636c 7564 655f 7661 6c75 6520 6973 206e  clude_value is n
-00005150: 6f74 204e 6f6e 650d 0a20 2020 2020 2020  ot None..       
-00005160: 2020 2020 2020 2020 2065 6c73 6520 5b73           else [s
-00005170: 656c 662e 6e6f 5f64 6174 615f 7661 6c75  elf.no_data_valu
-00005180: 655b 6261 6e64 5d5d 0d0a 2020 2020 2020  e[band]]..      
-00005190: 2020 2020 2020 290d 0a0d 0a20 2020 2020        )....     
-000051a0: 2020 2061 7272 203d 2073 656c 662e 7265     arr = self.re
-000051b0: 6164 5f61 7272 6179 2862 616e 643d 6261  ad_array(band=ba
-000051c0: 6e64 290d 0a20 2020 2020 2020 2063 6c65  nd)..        cle
-000051d0: 6f20 3d20 4172 7261 7928 0d0a 2020 2020  o = Array(..    
-000051e0: 2020 2020 2020 2020 6172 722c 0d0a 2020          arr,..  
-000051f0: 2020 2020 2020 2020 2020 6578 636c 7564            exclud
-00005200: 655f 7661 6c75 653d 6578 636c 7564 655f  e_value=exclude_
-00005210: 7661 6c75 652c 0d0a 2020 2020 2020 2020  value,..        
-00005220: 2020 2020 7267 623d 7267 622c 0d0a 2020      rgb=rgb,..  
-00005230: 2020 2020 2020 2020 2020 7375 7266 6163            surfac
-00005240: 655f 7265 666c 6563 7461 6e63 653d 7375  e_reflectance=su
-00005250: 7266 6163 655f 7265 666c 6563 7461 6e63  rface_reflectanc
-00005260: 652c 0d0a 2020 2020 2020 2020 2020 2020  e,..            
-00005270: 6375 746f 6666 3d63 7574 6f66 662c 0d0a  cutoff=cutoff,..
-00005280: 2020 2020 2020 2020 290d 0a20 2020 2020          )..     
-00005290: 2020 2066 6967 2c20 6178 203d 2063 6c65     fig, ax = cle
-000052a0: 6f2e 706c 6f74 282a 2a6b 7761 7267 7329  o.plot(**kwargs)
-000052b0: 0d0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-000052c0: 2066 6967 2c20 6178 0d0a 0d0a 2020 2020   fig, ax....    
-000052d0: 6465 6620 5f67 6574 5f74 696d 655f 7661  def _get_time_va
-000052e0: 7269 6162 6c65 2873 656c 6629 3a0d 0a20  riable(self):.. 
-000052f0: 2020 2020 2020 2022 2222 0d0a 0d0a 2020         """....  
-00005300: 2020 2020 2020 5265 7475 726e 730d 0a20        Returns.. 
-00005310: 2020 2020 2020 202d 2d2d 2d2d 2d2d 0d0a         -------..
-00005320: 0d0a 2020 2020 2020 2020 2222 220d 0a20  ..        """.. 
-00005330: 2020 2020 2020 2023 2074 696d 655f 7661         # time_va
-00005340: 7273 203d 205b 2869 2c20 7365 6c66 2e6d  rs = [(i, self.m
-00005350: 6574 615f 6461 7461 2e67 6574 2869 2929  eta_data.get(i))
-00005360: 2066 6f72 2069 2069 6e20 7365 6c66 2e6d   for i in self.m
-00005370: 6574 615f 6461 7461 2e6b 6579 7328 2920  eta_data.keys() 
-00005380: 6966 2069 2e73 7461 7274 7377 6974 6828  if i.startswith(
-00005390: 2274 696d 6522 295d 0d0a 2020 2020 2020  "time")]..      
-000053a0: 2020 2320 7469 6d65 5f76 6172 5f6e 616d    # time_var_nam
-000053b0: 6520 3d20 7469 6d65 5f76 6172 735b 305d  e = time_vars[0]
-000053c0: 5b30 5d2e 7370 6c69 7428 2223 2229 5b30  [0].split("#")[0
-000053d0: 5d0d 0a20 2020 2020 2020 2065 7874 7261  ]..        extra
-000053e0: 5f64 696d 203d 2073 656c 662e 6d65 7461  _dim = self.meta
-000053f0: 5f64 6174 612e 6765 7428 224e 4554 4344  _data.get("NETCD
-00005400: 465f 4449 4d5f 4558 5452 4122 290d 0a20  F_DIM_EXTRA").. 
-00005410: 2020 2020 2020 2069 6620 6578 7472 615f         if extra_
-00005420: 6469 6d20 6973 206e 6f74 204e 6f6e 653a  dim is not None:
-00005430: 0d0a 2020 2020 2020 2020 2020 2020 7469  ..            ti
-00005440: 6d65 5f76 6172 5f6e 616d 6520 3d20 6578  me_var_name = ex
-00005450: 7472 615f 6469 6d2e 7265 706c 6163 6528  tra_dim.replace(
-00005460: 227b 222c 2022 2229 2e72 6570 6c61 6365  "{", "").replace
-00005470: 2822 7d22 2c20 2222 290d 0a20 2020 2020  ("}", "")..     
-00005480: 2020 2020 2020 2075 6e69 7473 203d 2073         units = s
-00005490: 656c 662e 6d65 7461 5f64 6174 612e 6765  elf.meta_data.ge
-000054a0: 7428 6622 7b74 696d 655f 7661 725f 6e61  t(f"{time_var_na
-000054b0: 6d65 7d23 756e 6974 7322 290d 0a20 2020  me}#units")..   
-000054c0: 2020 2020 2020 2020 2066 756e 6320 3d20           func = 
-000054d0: 6372 6561 7465 5f74 696d 655f 636f 6e76  create_time_conv
-000054e0: 6572 7369 6f6e 5f66 756e 6328 756e 6974  ersion_func(unit
-000054f0: 7329 0d0a 2020 2020 2020 2020 2020 2020  s)..            
-00005500: 7469 6d65 5f76 616c 7320 3d20 7365 6c66  time_vals = self
-00005510: 2e5f 7265 6164 5f76 6172 6961 626c 6528  ._read_variable(
-00005520: 7469 6d65 5f76 6172 5f6e 616d 6529 0d0a  time_var_name)..
-00005530: 2020 2020 2020 2020 2020 2020 7469 6d65              time
-00005540: 5f73 7461 6d70 203d 206c 6973 7428 6d61  _stamp = list(ma
-00005550: 7028 6675 6e63 2c20 7469 6d65 5f76 616c  p(func, time_val
-00005560: 735b 305d 2929 0d0a 2020 2020 2020 2020  s[0]))..        
-00005570: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
-00005580: 2020 2074 696d 655f 7374 616d 7020 3d20     time_stamp = 
-00005590: 4e6f 6e65 0d0a 2020 2020 2020 2020 7265  None..        re
-000055a0: 7475 726e 2074 696d 655f 7374 616d 700d  turn time_stamp.
-000055b0: 0a0d 0a20 2020 2064 6566 205f 6765 745f  ...    def _get_
-000055c0: 6c61 745f 6c6f 6e28 7365 6c66 293a 0d0a  lat_lon(self):..
-000055d0: 2020 2020 2020 2020 6c6f 6e20 3d20 7365          lon = se
-000055e0: 6c66 2e5f 7265 6164 5f76 6172 6961 626c  lf._read_variabl
-000055f0: 6528 226c 6f6e 2229 0d0a 2020 2020 2020  e("lon")..      
-00005600: 2020 6c61 7420 3d20 7365 6c66 2e5f 7265    lat = self._re
-00005610: 6164 5f76 6172 6961 626c 6528 226c 6174  ad_variable("lat
-00005620: 2229 0d0a 2020 2020 2020 2020 7265 7475  ")..        retu
-00005630: 726e 206c 6174 2c20 6c6f 6e0d 0a0d 0a20  rn lat, lon.... 
-00005640: 2020 2064 6566 205f 7265 6164 5f76 6172     def _read_var
-00005650: 6961 626c 6528 7365 6c66 2c20 7661 723a  iable(self, var:
-00005660: 2073 7472 293a 0d0a 2020 2020 2020 2020   str):..        
-00005670: 7265 7475 726e 2067 6461 6c2e 4f70 656e  return gdal.Open
-00005680: 2866 224e 4554 4344 463a 7b73 656c 662e  (f"NETCDF:{self.
-00005690: 6669 6c65 5f6e 616d 657d 3a7b 7661 727d  file_name}:{var}
-000056a0: 2229 2e52 6561 6441 7341 7272 6179 2829  ").ReadAsArray()
-000056b0: 0d0a 0d0a 2020 2020 4073 7461 7469 636d  ....    @staticm
-000056c0: 6574 686f 640d 0a20 2020 2064 6566 205f  ethod..    def _
-000056d0: 6372 6561 7465 5f67 6461 6c5f 6461 7461  create_gdal_data
-000056e0: 7365 7428 0d0a 2020 2020 2020 2020 636f  set(..        co
-000056f0: 6c73 3a20 696e 742c 0d0a 2020 2020 2020  ls: int,..      
-00005700: 2020 726f 7773 3a20 696e 742c 0d0a 2020    rows: int,..  
-00005710: 2020 2020 2020 6261 6e64 733a 2069 6e74        bands: int
-00005720: 2c0d 0a20 2020 2020 2020 2064 7479 7065  ,..        dtype
-00005730: 3a20 696e 742c 0d0a 2020 2020 2020 2020  : int,..        
-00005740: 6472 6976 6572 3a20 7374 7220 3d20 224d  driver: str = "M
-00005750: 454d 222c 0d0a 2020 2020 2020 2020 7061  EM",..        pa
-00005760: 7468 3a20 7374 7220 3d20 4e6f 6e65 2c0d  th: str = None,.
-00005770: 0a20 2020 2029 202d 3e20 6764 616c 2e44  .    ) -> gdal.D
-00005780: 6174 6173 6574 3a0d 0a20 2020 2020 2020  ataset:..       
-00005790: 2022 2222 4372 6561 7465 2047 4441 4c20   """Create GDAL 
-000057a0: 6472 6976 6572 2e0d 0a0d 0a20 2020 2020  driver.....     
-000057b0: 2020 2020 2020 2063 7265 6174 6573 2061         creates a
-000057c0: 2064 7269 7665 7220 616e 6420 7361 7665   driver and save
-000057d0: 2069 7420 746f 2064 6973 6b20 616e 6420   it to disk and 
-000057e0: 696e 206d 656d 6f72 7920 6966 2070 6174  in memory if pat
-000057f0: 6820 6973 206e 6f74 2067 6976 656e 2e0d  h is not given..
-00005800: 0a0d 0a20 2020 2020 2020 2050 6172 616d  ...        Param
-00005810: 6574 6572 730d 0a20 2020 2020 2020 202d  eters..        -
-00005820: 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020  ---------..     
-00005830: 2020 2063 6f6c 733a 205b 696e 745d 0d0a     cols: [int]..
-00005840: 2020 2020 2020 2020 2020 2020 6e75 6d62              numb
-00005850: 6572 206f 6620 636f 6c75 6d6e 732e 0d0a  er of columns...
-00005860: 2020 2020 2020 2020 726f 7773 3a20 5b69          rows: [i
-00005870: 6e74 5d0d 0a20 2020 2020 2020 2020 2020  nt]..           
-00005880: 206e 756d 6265 7220 6f66 2072 6f77 732e   number of rows.
-00005890: 0d0a 2020 2020 2020 2020 6261 6e64 733a  ..        bands:
-000058a0: 205b 696e 745d 0d0a 2020 2020 2020 2020   [int]..        
-000058b0: 2020 2020 6e75 6d62 6572 206f 6620 6261      number of ba
-000058c0: 6e64 732e 0d0a 2020 2020 2020 2020 6472  nds...        dr
-000058d0: 6976 6572 3a20 5b73 7472 5d0d 0a20 2020  iver: [str]..   
-000058e0: 2020 2020 2020 2020 2064 7269 7665 7220           driver 
-000058f0: 7479 7065 205b 2247 5469 6666 222c 2022  type ["GTiff", "
-00005900: 4d45 4d22 5d2e 0d0a 2020 2020 2020 2020  MEM"]...        
-00005910: 7061 7468 3a20 5b73 7472 5d0d 0a20 2020  path: [str]..   
-00005920: 2020 2020 2020 2020 2070 6174 6820 746f           path to
-00005930: 2073 6176 6520 7468 6520 4754 6966 6620   save the GTiff 
-00005940: 6472 6976 6572 2e0d 0a20 2020 2020 2020  driver...       
-00005950: 2064 7479 7065 3a0d 0a20 2020 2020 2020   dtype:..       
-00005960: 2020 2020 2067 6461 6c20 6461 7461 2074       gdal data t
-00005970: 7970 652c 2075 7365 2074 6865 2066 756e  ype, use the fun
-00005980: 6374 696f 6e73 2069 6e20 7468 6520 7574  ctions in the ut
-00005990: 696c 7320 6d6f 6475 6c65 2074 6f20 6d61  ils module to ma
-000059a0: 7020 6461 7461 2074 7970 6573 2066 726f  p data types fro
-000059b0: 6d20 6e75 6d70 7920 6f72 206f 6772 2074  m numpy or ogr t
-000059c0: 6f20 6764 616c 2e0d 0a0d 0a20 2020 2020  o gdal.....     
-000059d0: 2020 2052 6574 7572 6e73 0d0a 2020 2020     Returns..    
-000059e0: 2020 2020 2d2d 2d2d 2d2d 2d0d 0a20 2020      -------..   
-000059f0: 2020 2020 2067 6461 6c20 6472 6976 6572       gdal driver
-00005a00: 0d0a 2020 2020 2020 2020 2222 220d 0a20  ..        """.. 
-00005a10: 2020 2020 2020 2069 6620 7061 7468 3a0d         if path:.
-00005a20: 0a20 2020 2020 2020 2020 2020 2064 7269  .            dri
-00005a30: 7665 7220 3d20 2247 5469 6666 2220 6966  ver = "GTiff" if
-00005a40: 2064 7269 7665 7220 3d3d 2022 4d45 4d22   driver == "MEM"
-00005a50: 2065 6c73 6520 6472 6976 6572 0d0a 2020   else driver..  
-00005a60: 2020 2020 2020 2020 2020 6966 206e 6f74            if not
-00005a70: 2069 7369 6e73 7461 6e63 6528 7061 7468   isinstance(path
-00005a80: 2c20 7374 7229 3a0d 0a20 2020 2020 2020  , str):..       
-00005a90: 2020 2020 2020 2020 2072 6169 7365 2054           raise T
-00005aa0: 7970 6545 7272 6f72 2822 5468 6520 7061  ypeError("The pa
-00005ab0: 7468 2069 6e70 7574 2073 686f 756c 6420  th input should 
-00005ac0: 6265 2073 7472 696e 6722 290d 0a20 2020  be string")..   
-00005ad0: 2020 2020 2020 2020 2069 6620 6472 6976           if driv
-00005ae0: 6572 203d 3d20 2247 5469 6666 223a 0d0a  er == "GTiff":..
-00005af0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005b00: 6966 206e 6f74 2070 6174 682e 656e 6473  if not path.ends
-00005b10: 7769 7468 2822 2e74 6966 2229 3a0d 0a20  with(".tif"):.. 
-00005b20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00005b30: 2020 2072 6169 7365 2054 7970 6545 7272     raise TypeErr
-00005b40: 6f72 280d 0a20 2020 2020 2020 2020 2020  or(..           
-00005b50: 2020 2020 2020 2020 2020 2020 2022 5468               "Th
-00005b60: 6520 7061 7468 2074 6f20 7361 7665 2074  e path to save t
-00005b70: 6865 2063 7265 6174 6564 2072 6173 7465  he created raste
-00005b80: 7220 7368 6f75 6c64 2065 6e64 2077 6974  r should end wit
-00005b90: 6820 2e74 6966 220d 0a20 2020 2020 2020  h .tif"..       
-00005ba0: 2020 2020 2020 2020 2020 2020 2029 0d0a               )..
-00005bb0: 2020 2020 2020 2020 2020 2020 2320 4c5a              # LZ
-00005bc0: 5720 6973 2061 206c 6f73 736c 6573 7320  W is a lossless 
-00005bd0: 636f 6d70 7265 7373 696f 6e20 6d65 7468  compression meth
-00005be0: 6f64 2061 6368 6965 7665 2074 6865 2068  od achieve the h
-00005bf0: 6967 6873 7420 636f 6d70 7265 7373 696f  ighst compressio
-00005c00: 6e20 6275 7420 7769 7468 206c 6f74 206f  n but with lot o
-00005c10: 6620 636f 6d70 7574 6174 696f 6e0d 0a20  f computation.. 
-00005c20: 2020 2020 2020 2020 2020 2073 7263 203d             src =
-00005c30: 2067 6461 6c2e 4765 7444 7269 7665 7242   gdal.GetDriverB
-00005c40: 794e 616d 6528 6472 6976 6572 292e 4372  yName(driver).Cr
-00005c50: 6561 7465 280d 0a20 2020 2020 2020 2020  eate(..         
-00005c60: 2020 2020 2020 2070 6174 682c 2063 6f6c         path, col
-00005c70: 732c 2072 6f77 732c 2062 616e 6473 2c20  s, rows, bands, 
-00005c80: 6474 7970 652c 205b 2243 4f4d 5052 4553  dtype, ["COMPRES
-00005c90: 533d 4c5a 5722 5d0d 0a20 2020 2020 2020  S=LZW"]..       
-00005ca0: 2020 2020 2029 0d0a 2020 2020 2020 2020       )..        
-00005cb0: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
-00005cc0: 2020 2023 2066 6f72 206d 656d 6f72 7920     # for memory 
-00005cd0: 6472 6976 6572 730d 0a20 2020 2020 2020  drivers..       
-00005ce0: 2020 2020 2064 7269 7665 7220 3d20 224d       driver = "M
-00005cf0: 454d 220d 0a20 2020 2020 2020 2020 2020  EM"..           
-00005d00: 2073 7263 203d 2067 6461 6c2e 4765 7444   src = gdal.GetD
-00005d10: 7269 7665 7242 794e 616d 6528 6472 6976  riverByName(driv
-00005d20: 6572 292e 4372 6561 7465 2822 222c 2063  er).Create("", c
-00005d30: 6f6c 732c 2072 6f77 732c 2062 616e 6473  ols, rows, bands
-00005d40: 2c20 6474 7970 6529 0d0a 2020 2020 2020  , dtype)..      
-00005d50: 2020 7265 7475 726e 2073 7263 0d0a 0d0a    return src....
-00005d60: 2020 2020 4063 6c61 7373 6d65 7468 6f64      @classmethod
-00005d70: 0d0a 2020 2020 6465 6620 6372 6561 7465  ..    def create
-00005d80: 5f66 726f 6d5f 6172 7261 7928 0d0a 2020  _from_array(..  
-00005d90: 2020 2020 2020 636c 732c 0d0a 2020 2020        cls,..    
-00005da0: 2020 2020 6172 723a 2055 6e69 6f6e 5b73      arr: Union[s
-00005db0: 7472 2c20 6764 616c 2e44 6174 6173 6574  tr, gdal.Dataset
-00005dc0: 2c20 6e70 2e6e 6461 7272 6179 5d2c 0d0a  , np.ndarray],..
-00005dd0: 2020 2020 2020 2020 6765 6f3a 2055 6e69          geo: Uni
-00005de0: 6f6e 5b73 7472 2c20 7475 706c 655d 2c0d  on[str, tuple],.
-00005df0: 0a20 2020 2020 2020 2065 7073 673a 2055  .        epsg: U
-00005e00: 6e69 6f6e 5b73 7472 2c20 696e 745d 2c0d  nion[str, int],.
-00005e10: 0a20 2020 2020 2020 206e 6f5f 6461 7461  .        no_data
-00005e20: 5f76 616c 7565 3a20 556e 696f 6e5b 416e  _value: Union[An
-00005e30: 792c 206c 6973 745d 203d 2044 4546 4155  y, list] = DEFAU
-00005e40: 4c54 5f4e 4f5f 4441 5441 5f56 414c 5545  LT_NO_DATA_VALUE
-00005e50: 2c0d 0a20 2020 2029 3a0d 0a20 2020 2020  ,..    ):..     
-00005e60: 2020 2022 2222 6372 6561 7465 5f72 6173     """create_ras
-00005e70: 7465 722e 0d0a 0d0a 2020 2020 2020 2020  ter.....        
-00005e80: 2020 2020 2d20 6372 6561 7465 5f72 6173      - create_ras
-00005e90: 7465 7220 6d65 7468 6f64 2063 7265 6174  ter method creat
-00005ea0: 6573 2061 2072 6173 7465 7220 6672 6f6d  es a raster from
-00005eb0: 2061 2067 6976 656e 2061 7272 6179 2061   a given array a
-00005ec0: 6e64 2067 656f 7472 616e 7366 6f72 6d20  nd geotransform 
-00005ed0: 6461 7461 0d0a 2020 2020 2020 2020 2020  data..          
-00005ee0: 2020 616e 6420 7361 7665 2074 6865 2074    and save the t
-00005ef0: 6966 2066 696c 6520 6966 2061 2050 6174  if file if a Pat
-00005f00: 6820 6973 2067 6976 656e 206f 7220 6974  h is given or it
-00005f10: 2077 696c 6c20 7265 7475 726e 2074 6865   will return the
-00005f20: 2067 6461 6c2e 4461 7461 6375 6265 0d0a   gdal.Datacube..
-00005f30: 0d0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
-00005f40: 7465 7273 0d0a 2020 2020 2020 2020 2d2d  ters..        --
-00005f50: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020  --------..      
-00005f60: 2020 6172 7220 3a20 5b61 7272 6179 5d2c    arr : [array],
-00005f70: 206f 7074 696f 6e61 6c0d 0a20 2020 2020   optional..     
-00005f80: 2020 2020 2020 206e 756d 7079 2061 7272         numpy arr
-00005f90: 6179 2e20 5468 6520 6465 6661 756c 7420  ay. The default 
-00005fa0: 6973 2027 272e 0d0a 2020 2020 2020 2020  is ''...        
-00005fb0: 6765 6f20 3a20 5b6c 6973 745d 2c20 6f70  geo : [list], op
-00005fc0: 7469 6f6e 616c 0d0a 2020 2020 2020 2020  tional..        
-00005fd0: 2020 2020 6765 6f74 7261 6e73 666f 726d      geotransform
-00005fe0: 206c 6973 7420 5b6d 696e 696d 756d 206c   list [minimum l
-00005ff0: 6f6e 2c20 7069 7865 6c73 697a 652c 2072  on, pixelsize, r
-00006000: 6f74 6174 696f 6e2c 206d 6178 696d 756d  otation, maximum
-00006010: 206c 6174 2c20 726f 7461 7469 6f6e 2c0d   lat, rotation,.
-00006020: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00006030: 2070 6978 656c 7369 7a65 5d2e 2054 6865   pixelsize]. The
-00006040: 2064 6566 6175 6c74 2069 7320 2727 2e0d   default is ''..
-00006050: 0a20 2020 2020 2020 206e 6f5f 6461 7461  .        no_data
-00006060: 5f76 616c 7565 203a 2054 5950 452c 206f  _value : TYPE, o
-00006070: 7074 696f 6e61 6c0d 0a20 2020 2020 2020  ptional..       
-00006080: 2020 2020 2044 4553 4352 4950 5449 4f4e       DESCRIPTION
-00006090: 2e20 5468 6520 6465 6661 756c 7420 6973  . The default is
-000060a0: 202d 3939 3939 2e0d 0a20 2020 2020 2020   -9999...       
-000060b0: 2065 7073 673a 205b 696e 7465 6765 725d   epsg: [integer]
-000060c0: 0d0a 2020 2020 2020 2020 2020 2020 696e  ..            in
-000060d0: 7465 6765 7220 7265 6665 7265 6e63 6520  teger reference 
-000060e0: 6e75 6d62 6572 2074 6f20 7468 6520 6e65  number to the ne
-000060f0: 7720 7072 6f6a 6563 7469 6f6e 2028 6874  w projection (ht
-00006100: 7470 733a 2f2f 6570 7367 2e69 6f2f 290d  tps://epsg.io/).
-00006110: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00006120: 2028 6465 6661 756c 7420 3338 3537 2074   (default 3857 t
-00006130: 6865 2072 6566 6572 656e 6365 206e 6f20  he reference no 
-00006140: 6f66 2057 4753 3834 2077 6562 206d 6572  of WGS84 web mer
-00006150: 6361 746f 7220 290d 0a0d 0a20 2020 2020  cator )....     
-00006160: 2020 2052 6574 7572 6e73 0d0a 2020 2020     Returns..    
-00006170: 2020 2020 2d2d 2d2d 2d2d 2d0d 0a20 2020      -------..   
-00006180: 2020 2020 2064 7374 203a 205b 4461 7461       dst : [Data
-00006190: 5365 745d 2e0d 0a20 2020 2020 2020 2020  Set]...         
-000061a0: 2020 2044 6174 6173 6574 206f 626a 6563     Dataset objec
-000061b0: 7420 7769 6c6c 2062 6520 7265 7475 726e  t will be return
-000061c0: 6564 2e0d 0a20 2020 2020 2020 2022 2222  ed...        """
-000061d0: 0d0a 2020 2020 2020 2020 6966 206c 656e  ..        if len
-000061e0: 2861 7272 2e73 6861 7065 2920 3d3d 2032  (arr.shape) == 2
-000061f0: 3a0d 0a20 2020 2020 2020 2020 2020 2062  :..            b
-00006200: 616e 6473 203d 2031 0d0a 2020 2020 2020  ands = 1..      
-00006210: 2020 2020 2020 726f 7773 203d 2069 6e74        rows = int
-00006220: 2861 7272 2e73 6861 7065 5b30 5d29 0d0a  (arr.shape[0])..
-00006230: 2020 2020 2020 2020 2020 2020 636f 6c73              cols
-00006240: 203d 2069 6e74 2861 7272 2e73 6861 7065   = int(arr.shape
-00006250: 5b31 5d29 0d0a 2020 2020 2020 2020 656c  [1])..        el
-00006260: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
-00006270: 2062 616e 6473 203d 2061 7272 2e73 6861   bands = arr.sha
-00006280: 7065 5b30 5d0d 0a20 2020 2020 2020 2020  pe[0]..         
+00000f40: 7b73 656c 662e 726f 7773 7d20 2a20 7b73  {self.rows} * {s
+00000f50: 656c 662e 636f 6c75 6d6e 737d 0d0a 2020  elf.columns}..  
+00000f60: 2020 2020 2020 2020 2020 4d61 736b 3a20            Mask: 
+00000f70: 7b73 656c 662e 5f6e 6f5f 6461 7461 5f76  {self._no_data_v
+00000f80: 616c 7565 5b30 5d7d 0d0a 2020 2020 2020  alue[0]}..      
+00000f90: 2020 2020 2020 4461 7461 2074 7970 653a        Data type:
+00000fa0: 207b 7365 6c66 2e64 7479 7065 5b30 5d7d   {self.dtype[0]}
+00000fb0: 0d0a 2020 2020 2020 2020 2222 220d 0a20  ..        """.. 
+00000fc0: 2020 2020 2020 2072 6574 7572 6e20 6d65         return me
+00000fd0: 7373 6167 650d 0a0d 0a20 2020 2064 6566  ssage....    def
+00000fe0: 205f 5f72 6570 725f 5f28 7365 6c66 293a   __repr__(self):
+00000ff0: 0d0a 2020 2020 2020 2020 6d65 7373 6167  ..        messag
+00001000: 6520 3d20 2222 220d 0a20 2020 2020 2020  e = """..       
+00001010: 2020 2020 2046 696c 653a 207b 307d 0d0a       File: {0}..
+00001020: 2020 2020 2020 2020 2020 2020 4365 6c6c              Cell
+00001030: 2073 697a 653a 207b 317d 0d0a 2020 2020   size: {1}..    
+00001040: 2020 2020 2020 2020 4550 5347 3a20 7b32          EPSG: {2
+00001050: 7d0d 0a20 2020 2020 2020 2020 2020 2056  }..            V
+00001060: 6172 6961 626c 6573 3a20 7b33 7d0d 0a20  ariables: {3}.. 
+00001070: 2020 2020 2020 2020 2020 204e 756d 6265             Numbe
+00001080: 7220 6f66 2042 616e 6473 3a20 7b34 7d0d  r of Bands: {4}.
+00001090: 0a20 2020 2020 2020 2020 2020 2042 616e  .            Ban
+000010a0: 6420 6e61 6d65 733a 207b 357d 0d0a 2020  d names: {5}..  
+000010b0: 2020 2020 2020 2020 2020 4469 6d65 6e73            Dimens
+000010c0: 696f 6e3a 207b 367d 202a 207b 377d 0d0a  ion: {6} * {7}..
+000010d0: 2020 2020 2020 2020 2020 2020 4d61 736b              Mask
+000010e0: 3a20 7b38 7d0d 0a20 2020 2020 2020 2020  : {8}..         
+000010f0: 2020 2044 6174 6120 7479 7065 3a20 7b39     Data type: {9
+00001100: 7d0d 0a20 2020 2020 2020 2020 2020 2070  }..            p
+00001110: 726f 6a65 6374 696f 6e3a 207b 3130 7d0d  rojection: {10}.
+00001120: 0a20 2020 2020 2020 2020 2020 204d 6574  .            Met
+00001130: 6164 6174 613a 207b 3131 7d0d 0a20 2020  adata: {11}..   
+00001140: 2020 2020 2022 2222 2e66 6f72 6d61 7428       """.format(
+00001150: 0d0a 2020 2020 2020 2020 2020 2020 7365  ..            se
+00001160: 6c66 2e66 696c 655f 6e61 6d65 2c0d 0a20  lf.file_name,.. 
+00001170: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00001180: 6365 6c6c 5f73 697a 652c 0d0a 2020 2020  cell_size,..    
+00001190: 2020 2020 2020 2020 7365 6c66 2e65 7073          self.eps
+000011a0: 672c 0d0a 2020 2020 2020 2020 2020 2020  g,..            
+000011b0: 7365 6c66 2e76 6172 6961 626c 6573 2c0d  self.variables,.
+000011c0: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+000011d0: 662e 6261 6e64 5f63 6f75 6e74 2c0d 0a20  f.band_count,.. 
+000011e0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+000011f0: 6261 6e64 5f6e 616d 6573 2c0d 0a20 2020  band_names,..   
+00001200: 2020 2020 2020 2020 2073 656c 662e 726f           self.ro
+00001210: 7773 2c0d 0a20 2020 2020 2020 2020 2020  ws,..           
+00001220: 2073 656c 662e 636f 6c75 6d6e 732c 0d0a   self.columns,..
+00001230: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+00001240: 2e5f 6e6f 5f64 6174 615f 7661 6c75 655b  ._no_data_value[
+00001250: 305d 2c0d 0a20 2020 2020 2020 2020 2020  0],..           
+00001260: 2073 656c 662e 6474 7970 655b 305d 2c0d   self.dtype[0],.
+00001270: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
+00001280: 662e 6372 732c 0d0a 2020 2020 2020 2020  f.crs,..        
+00001290: 2020 2020 7365 6c66 2e6d 6574 615f 6461      self.meta_da
+000012a0: 7461 2c0d 0a20 2020 2020 2020 2029 0d0a  ta,..        )..
+000012b0: 2020 2020 2020 2020 7265 7475 726e 206d          return m
+000012c0: 6573 7361 6765 0d0a 0d0a 2020 2020 4070  essage....    @p
+000012d0: 726f 7065 7274 790d 0a20 2020 2064 6566  roperty..    def
+000012e0: 2072 6173 7465 7228 7365 6c66 2920 2d3e   raster(self) ->
+000012f0: 2067 6461 6c2e 4461 7461 7365 743a 0d0a   gdal.Dataset:..
+00001300: 2020 2020 2020 2020 2222 2247 4441 4c20          """GDAL 
+00001310: 4461 7461 7365 7422 2222 0d0a 2020 2020  Dataset"""..    
+00001320: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+00001330: 5f72 6173 7465 720d 0a0d 0a20 2020 2040  _raster....    @
+00001340: 7261 7374 6572 2e73 6574 7465 720d 0a20  raster.setter.. 
+00001350: 2020 2064 6566 2072 6173 7465 7228 7365     def raster(se
+00001360: 6c66 2c20 7661 6c75 653a 2067 6461 6c2e  lf, value: gdal.
+00001370: 4461 7461 7365 7429 3a0d 0a20 2020 2020  Dataset):..     
+00001380: 2020 2073 656c 662e 5f72 6173 7465 7220     self._raster 
+00001390: 3d20 7661 6c75 650d 0a0d 0a20 2020 2040  = value....    @
+000013a0: 7072 6f70 6572 7479 0d0a 2020 2020 6465  property..    de
+000013b0: 6620 7661 6c75 6573 2873 656c 6629 202d  f values(self) -
+000013c0: 3e20 6e70 2e6e 6461 7272 6179 3a0d 0a20  > np.ndarray:.. 
+000013d0: 2020 2020 2020 2022 2222 6172 7261 7920         """array 
+000013e0: 7661 6c75 6573 2e22 2222 0d0a 2020 2020  values."""..    
+000013f0: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
+00001400: 7265 6164 5f61 7272 6179 2862 616e 643d  read_array(band=
+00001410: 4e6f 6e65 290d 0a0d 0a20 2020 2023 2040  None)....    # @
+00001420: 7661 6c75 6573 2e73 6574 7465 720d 0a20  values.setter.. 
+00001430: 2020 2023 2064 6566 2076 616c 7565 7328     # def values(
+00001440: 7365 6c66 2c20 6261 6e64 2c20 7661 6c75  self, band, valu
+00001450: 6529 3a0d 0a20 2020 2023 2020 2020 2073  e):..    #     s
+00001460: 656c 662e 5f0d 0a20 2020 2040 7072 6f70  elf._..    @prop
+00001470: 6572 7479 0d0a 2020 2020 6465 6620 726f  erty..    def ro
+00001480: 7773 2873 656c 6629 202d 3e20 696e 743a  ws(self) -> int:
+00001490: 0d0a 2020 2020 2020 2020 2222 224e 756d  ..        """Num
+000014a0: 6265 7220 6f66 2072 6f77 7320 696e 2074  ber of rows in t
+000014b0: 6865 2072 6173 7465 7220 6172 7261 792e  he raster array.
+000014c0: 2222 220d 0a20 2020 2020 2020 2072 6574  """..        ret
+000014d0: 7572 6e20 7365 6c66 2e5f 726f 7773 0d0a  urn self._rows..
+000014e0: 0d0a 2020 2020 4070 726f 7065 7274 790d  ..    @property.
+000014f0: 0a20 2020 2064 6566 2063 6f6c 756d 6e73  .    def columns
+00001500: 2873 656c 6629 202d 3e20 696e 743a 0d0a  (self) -> int:..
+00001510: 2020 2020 2020 2020 2222 224e 756d 6265          """Numbe
+00001520: 7220 6f66 2063 6f6c 756d 6e73 2069 6e20  r of columns in 
+00001530: 7468 6520 7261 7374 6572 2061 7272 6179  the raster array
+00001540: 2e22 2222 0d0a 2020 2020 2020 2020 7265  ."""..        re
+00001550: 7475 726e 2073 656c 662e 5f63 6f6c 756d  turn self._colum
+00001560: 6e73 0d0a 0d0a 2020 2020 4070 726f 7065  ns....    @prope
+00001570: 7274 790d 0a20 2020 2064 6566 2073 6861  rty..    def sha
+00001580: 7065 2873 656c 6629 3a0d 0a20 2020 2020  pe(self):..     
+00001590: 2020 2022 2222 4461 7461 7365 7420 7368     """Dataset sh
+000015a0: 6170 6522 2222 0d0a 2020 2020 2020 2020  ape"""..        
+000015b0: 7265 7475 726e 2073 656c 662e 6261 6e64  return self.band
+000015c0: 5f63 6f75 6e74 2c20 7365 6c66 2e72 6f77  _count, self.row
+000015d0: 732c 2073 656c 662e 636f 6c75 6d6e 730d  s, self.columns.
+000015e0: 0a0d 0a20 2020 2040 7072 6f70 6572 7479  ...    @property
+000015f0: 0d0a 2020 2020 6465 6620 6765 6f74 7261  ..    def geotra
+00001600: 6e73 666f 726d 2873 656c 6629 3a0d 0a20  nsform(self):.. 
+00001610: 2020 2020 2020 2022 2222 574b 5420 7072         """WKT pr
+00001620: 6f6a 6563 7469 6f6e 2e22 2222 0d0a 2020  ojection."""..  
+00001630: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+00001640: 662e 5f67 656f 7472 616e 7366 6f72 6d0d  f._geotransform.
+00001650: 0a0d 0a20 2020 2040 7072 6f70 6572 7479  ...    @property
+00001660: 0d0a 2020 2020 6465 6620 7069 766f 745f  ..    def pivot_
+00001670: 706f 696e 7428 7365 6c66 293a 0d0a 2020  point(self):..  
+00001680: 2020 2020 2020 2222 2254 6f70 206c 6566        """Top lef
+00001690: 7420 636f 726e 6572 2063 6f6f 7264 696e  t corner coordin
+000016a0: 6174 6573 2e22 2222 0d0a 2020 2020 2020  ates."""..      
+000016b0: 2020 786d 696e 2c20 5f2c 205f 2c20 796d    xmin, _, _, ym
+000016c0: 6178 2c20 5f2c 205f 203d 2073 656c 662e  ax, _, _ = self.
+000016d0: 5f67 656f 7472 616e 7366 6f72 6d0d 0a20  _geotransform.. 
+000016e0: 2020 2020 2020 2072 6574 7572 6e20 786d         return xm
+000016f0: 696e 2c20 796d 6178 0d0a 0d0a 2020 2020  in, ymax....    
+00001700: 4070 726f 7065 7274 790d 0a20 2020 2064  @property..    d
+00001710: 6566 2062 6f75 6e64 7328 7365 6c66 2920  ef bounds(self) 
+00001720: 2d3e 2047 656f 4461 7461 4672 616d 653a  -> GeoDataFrame:
+00001730: 0d0a 2020 2020 2020 2020 2222 2262 6f75  ..        """bou
+00001740: 6e64 7322 2222 0d0a 2020 2020 2020 2020  nds"""..        
+00001750: 7265 7475 726e 2073 656c 662e 5f63 616c  return self._cal
+00001760: 6375 6c61 7465 5f62 6f75 6e64 7328 290d  culate_bounds().
+00001770: 0a0d 0a20 2020 2040 7072 6f70 6572 7479  ...    @property
+00001780: 0d0a 2020 2020 6465 6620 6262 6f78 2873  ..    def bbox(s
+00001790: 656c 6629 202d 3e20 4c69 7374 3a0d 0a20  elf) -> List:.. 
+000017a0: 2020 2020 2020 2022 2222 5b78 6d69 6e2c         """[xmin,
+000017b0: 2079 6d69 6e2c 2078 6d61 782c 2079 6d61   ymin, xmax, yma
+000017c0: 785d 2222 220d 0a20 2020 2020 2020 2072  x]"""..        r
+000017d0: 6574 7572 6e20 7365 6c66 2e5f 6361 6c63  eturn self._calc
+000017e0: 756c 6174 655f 6262 6f78 2829 0d0a 0d0a  ulate_bbox()....
+000017f0: 2020 2020 4070 726f 7065 7274 790d 0a20      @property.. 
+00001800: 2020 2064 6566 2065 7073 6728 7365 6c66     def epsg(self
+00001810: 293a 0d0a 2020 2020 2020 2020 2222 2257  ):..        """W
+00001820: 4b54 2070 726f 6a65 6374 696f 6e2e 2222  KT projection.""
+00001830: 220d 0a20 2020 2020 2020 2072 6574 7572  "..        retur
+00001840: 6e20 7365 6c66 2e5f 6570 7367 0d0a 0d0a  n self._epsg....
+00001850: 2020 2020 4070 726f 7065 7274 790d 0a20      @property.. 
+00001860: 2020 2064 6566 206c 6f6e 2873 656c 6629     def lon(self)
+00001870: 3a0d 0a20 2020 2020 2020 2022 2222 4c6f  :..        """Lo
+00001880: 6e67 6974 7564 6520 636f 6f72 6469 6e61  ngitude coordina
+00001890: 7465 7322 2222 0d0a 2020 2020 2020 2020  tes"""..        
+000018a0: 6966 206e 6f74 2068 6173 6174 7472 2873  if not hasattr(s
+000018b0: 656c 662c 2022 5f6c 6f6e 2229 3a0d 0a20  elf, "_lon"):.. 
+000018c0: 2020 2020 2020 2020 2020 2070 6976 6f74             pivot
+000018d0: 5f78 203d 2073 656c 662e 7069 766f 745f  _x = self.pivot_
+000018e0: 706f 696e 745b 305d 0d0a 2020 2020 2020  point[0]..      
+000018f0: 2020 2020 2020 6365 6c6c 5f73 697a 6520        cell_size 
+00001900: 3d20 7365 6c66 2e63 656c 6c5f 7369 7a65  = self.cell_size
+00001910: 0d0a 2020 2020 2020 2020 2020 2020 785f  ..            x_
+00001920: 636f 6f72 6473 203d 205b 0d0a 2020 2020  coords = [..    
+00001930: 2020 2020 2020 2020 2020 2020 7069 766f              pivo
+00001940: 745f 7820 2b20 6920 2a20 6365 6c6c 5f73  t_x + i * cell_s
+00001950: 697a 6520 2b20 6365 6c6c 5f73 697a 6520  ize + cell_size 
+00001960: 2f20 3220 666f 7220 6920 696e 2072 616e  / 2 for i in ran
+00001970: 6765 2873 656c 662e 636f 6c75 6d6e 7329  ge(self.columns)
+00001980: 0d0a 2020 2020 2020 2020 2020 2020 5d0d  ..            ].
+00001990: 0a20 2020 2020 2020 2065 6c73 653a 0d0a  .        else:..
+000019a0: 2020 2020 2020 2020 2020 2020 2320 696e              # in
+000019b0: 2063 6173 6520 7468 6520 6c61 7420 616e   case the lat an
+000019c0: 6420 6c6f 6e20 6172 6520 7265 6164 2066  d lon are read f
+000019d0: 726f 6d20 7468 6520 6e65 7463 6466 2066  rom the netcdf f
+000019e0: 696c 6520 6a75 7374 2072 6561 6420 7468  ile just read th
+000019f0: 6520 7661 6c75 6573 2066 726f 6d20 7468  e values from th
+00001a00: 6520 6669 6c65 0d0a 2020 2020 2020 2020  e file..        
+00001a10: 2020 2020 785f 636f 6f72 6473 203d 2073      x_coords = s
+00001a20: 656c 662e 5f6c 6f6e 0d0a 2020 2020 2020  elf._lon..      
+00001a30: 2020 7265 7475 726e 206e 702e 6172 7261    return np.arra
+00001a40: 7928 785f 636f 6f72 6473 290d 0a0d 0a20  y(x_coords).... 
+00001a50: 2020 2040 7072 6f70 6572 7479 0d0a 2020     @property..  
+00001a60: 2020 6465 6620 6c61 7428 7365 6c66 293a    def lat(self):
+00001a70: 0d0a 2020 2020 2020 2020 2222 224c 6174  ..        """Lat
+00001a80: 6974 7564 652d 636f 6f72 6469 6e61 7465  itude-coordinate
+00001a90: 2222 220d 0a20 2020 2020 2020 2069 6620  """..        if 
+00001aa0: 6e6f 7420 6861 7361 7474 7228 7365 6c66  not hasattr(self
+00001ab0: 2c20 225f 6c61 7422 293a 0d0a 2020 2020  , "_lat"):..    
+00001ac0: 2020 2020 2020 2020 7069 766f 745f 7920          pivot_y 
+00001ad0: 3d20 7365 6c66 2e70 6976 6f74 5f70 6f69  = self.pivot_poi
+00001ae0: 6e74 5b31 5d0d 0a20 2020 2020 2020 2020  nt[1]..         
+00001af0: 2020 2063 656c 6c5f 7369 7a65 203d 2073     cell_size = s
+00001b00: 656c 662e 6365 6c6c 5f73 697a 650d 0a20  elf.cell_size.. 
+00001b10: 2020 2020 2020 2020 2020 2079 5f63 6f6f             y_coo
+00001b20: 7264 7320 3d20 5b0d 0a20 2020 2020 2020  rds = [..       
+00001b30: 2020 2020 2020 2020 2070 6976 6f74 5f79           pivot_y
+00001b40: 202d 2069 202a 2063 656c 6c5f 7369 7a65   - i * cell_size
+00001b50: 202d 2063 656c 6c5f 7369 7a65 202f 2032   - cell_size / 2
+00001b60: 2066 6f72 2069 2069 6e20 7261 6e67 6528   for i in range(
+00001b70: 7365 6c66 2e72 6f77 7329 0d0a 2020 2020  self.rows)..    
+00001b80: 2020 2020 2020 2020 5d0d 0a20 2020 2020          ]..     
+00001b90: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
+00001ba0: 2020 2020 2020 2320 696e 2063 6173 6520        # in case 
+00001bb0: 7468 6520 6c61 7420 616e 6420 6c6f 6e20  the lat and lon 
+00001bc0: 6172 6520 7265 6164 2066 726f 6d20 7468  are read from th
+00001bd0: 6520 6e65 7463 6466 2066 696c 6520 6a75  e netcdf file ju
+00001be0: 7374 2072 6561 6420 7468 6520 7661 6c75  st read the valu
+00001bf0: 6573 2066 726f 6d20 7468 6520 6669 6c65  es from the file
+00001c00: 0d0a 2020 2020 2020 2020 2020 2020 795f  ..            y_
+00001c10: 636f 6f72 6473 203d 2073 656c 662e 5f6c  coords = self._l
+00001c20: 6174 0d0a 2020 2020 2020 2020 7265 7475  at..        retu
+00001c30: 726e 206e 702e 6172 7261 7928 795f 636f  rn np.array(y_co
+00001c40: 6f72 6473 290d 0a0d 0a20 2020 2040 7072  ords)....    @pr
+00001c50: 6f70 6572 7479 0d0a 2020 2020 6465 6620  operty..    def 
+00001c60: 7828 7365 6c66 293a 0d0a 2020 2020 2020  x(self):..      
+00001c70: 2020 2222 2278 2d63 6f6f 7264 696e 6174    """x-coordinat
+00001c80: 6522 2222 0d0a 2020 2020 2020 2020 2320  e"""..        # 
+00001c90: 585f 636f 6f72 6469 6e61 7465 203d 2075  X_coordinate = u
+00001ca0: 7070 6572 6c65 6674 2063 6f72 6e65 7220  pperleft corner 
+00001cb0: 7820 2b20 696e 6465 7820 2a20 6365 6c6c  x + index * cell
+00001cc0: 2073 697a 6520 2b20 6365 6c73 697a 652f   size + celsize/
+00001cd0: 320d 0a20 2020 2020 2020 2069 6620 6e6f  2..        if no
+00001ce0: 7420 6861 7361 7474 7228 7365 6c66 2c20  t hasattr(self, 
+00001cf0: 225f 6c6f 6e22 293a 0d0a 2020 2020 2020  "_lon"):..      
+00001d00: 2020 2020 2020 7069 766f 745f 7820 3d20        pivot_x = 
+00001d10: 7365 6c66 2e70 6976 6f74 5f70 6f69 6e74  self.pivot_point
+00001d20: 5b30 5d0d 0a20 2020 2020 2020 2020 2020  [0]..           
+00001d30: 2063 656c 6c5f 7369 7a65 203d 2073 656c   cell_size = sel
+00001d40: 662e 6365 6c6c 5f73 697a 650d 0a20 2020  f.cell_size..   
+00001d50: 2020 2020 2020 2020 2078 5f63 6f6f 7264           x_coord
+00001d60: 7320 3d20 5b0d 0a20 2020 2020 2020 2020  s = [..         
+00001d70: 2020 2020 2020 2070 6976 6f74 5f78 202b         pivot_x +
+00001d80: 2069 202a 2063 656c 6c5f 7369 7a65 202b   i * cell_size +
+00001d90: 2063 656c 6c5f 7369 7a65 202f 2032 2066   cell_size / 2 f
+00001da0: 6f72 2069 2069 6e20 7261 6e67 6528 7365  or i in range(se
+00001db0: 6c66 2e63 6f6c 756d 6e73 290d 0a20 2020  lf.columns)..   
+00001dc0: 2020 2020 2020 2020 205d 0d0a 2020 2020           ]..    
+00001dd0: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
+00001de0: 2020 2020 2020 2023 2069 6e20 6361 7365         # in case
+00001df0: 2074 6865 206c 6174 2061 6e64 206c 6f6e   the lat and lon
+00001e00: 2061 7265 2072 6561 6420 6672 6f6d 2074   are read from t
+00001e10: 6865 206e 6574 6364 6620 6669 6c65 206a  he netcdf file j
+00001e20: 7573 7420 7265 6164 2074 6865 2076 616c  ust read the val
+00001e30: 7565 7320 6672 6f6d 2074 6865 2066 696c  ues from the fil
+00001e40: 650d 0a20 2020 2020 2020 2020 2020 2078  e..            x
+00001e50: 5f63 6f6f 7264 7320 3d20 7365 6c66 2e5f  _coords = self._
+00001e60: 6c6f 6e0d 0a20 2020 2020 2020 2072 6574  lon..        ret
+00001e70: 7572 6e20 6e70 2e61 7272 6179 2878 5f63  urn np.array(x_c
+00001e80: 6f6f 7264 7329 0d0a 0d0a 2020 2020 4070  oords)....    @p
+00001e90: 726f 7065 7274 790d 0a20 2020 2064 6566  roperty..    def
+00001ea0: 2079 2873 656c 6629 3a0d 0a20 2020 2020   y(self):..     
+00001eb0: 2020 2022 2222 792d 636f 6f72 6469 6e61     """y-coordina
+00001ec0: 7465 2222 220d 0a20 2020 2020 2020 2023  te"""..        #
+00001ed0: 2058 5f63 6f6f 7264 696e 6174 6520 3d20   X_coordinate = 
+00001ee0: 7570 7065 726c 6566 7420 636f 726e 6572  upperleft corner
+00001ef0: 2078 202b 2069 6e64 6578 202a 2063 656c   x + index * cel
+00001f00: 6c20 7369 7a65 202b 2063 656c 7369 7a65  l size + celsize
+00001f10: 2f32 0d0a 2020 2020 2020 2020 6966 206e  /2..        if n
+00001f20: 6f74 2068 6173 6174 7472 2873 656c 662c  ot hasattr(self,
+00001f30: 2022 5f6c 6174 2229 3a0d 0a20 2020 2020   "_lat"):..     
+00001f40: 2020 2020 2020 2070 6976 6f74 5f79 203d         pivot_y =
+00001f50: 2073 656c 662e 7069 766f 745f 706f 696e   self.pivot_poin
+00001f60: 745b 315d 0d0a 2020 2020 2020 2020 2020  t[1]..          
+00001f70: 2020 6365 6c6c 5f73 697a 6520 3d20 7365    cell_size = se
+00001f80: 6c66 2e63 656c 6c5f 7369 7a65 0d0a 2020  lf.cell_size..  
+00001f90: 2020 2020 2020 2020 2020 795f 636f 6f72            y_coor
+00001fa0: 6473 203d 205b 0d0a 2020 2020 2020 2020  ds = [..        
+00001fb0: 2020 2020 2020 2020 7069 766f 745f 7920          pivot_y 
+00001fc0: 2d20 6920 2a20 6365 6c6c 5f73 697a 6520  - i * cell_size 
+00001fd0: 2d20 6365 6c6c 5f73 697a 6520 2f20 3220  - cell_size / 2 
+00001fe0: 666f 7220 6920 696e 2072 616e 6765 2873  for i in range(s
+00001ff0: 656c 662e 726f 7773 290d 0a20 2020 2020  elf.rows)..     
+00002000: 2020 2020 2020 205d 0d0a 2020 2020 2020         ]..      
+00002010: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
+00002020: 2020 2020 2023 2069 6e20 6361 7365 2074       # in case t
+00002030: 6865 206c 6174 2061 6e64 206c 6f6e 2061  he lat and lon a
+00002040: 7265 2072 6561 6420 6672 6f6d 2074 6865  re read from the
+00002050: 206e 6574 6364 6620 6669 6c65 206a 7573   netcdf file jus
+00002060: 7420 7265 6164 2074 6865 2076 616c 7565  t read the value
+00002070: 7320 6672 6f6d 2074 6865 2066 696c 650d  s from the file.
+00002080: 0a20 2020 2020 2020 2020 2020 2079 5f63  .            y_c
+00002090: 6f6f 7264 7320 3d20 7365 6c66 2e5f 6c61  oords = self._la
+000020a0: 740d 0a20 2020 2020 2020 2072 6574 7572  t..        retur
+000020b0: 6e20 6e70 2e61 7272 6179 2879 5f63 6f6f  n np.array(y_coo
+000020c0: 7264 7329 0d0a 0d0a 2020 2020 4070 726f  rds)....    @pro
+000020d0: 7065 7274 790d 0a20 2020 2064 6566 2063  perty..    def c
+000020e0: 7273 2873 656c 6629 202d 3e20 7374 723a  rs(self) -> str:
+000020f0: 0d0a 2020 2020 2020 2020 2222 2243 6f6f  ..        """Coo
+00002100: 7264 696e 6174 6520 7265 6665 7265 6e63  rdinate referenc
+00002110: 6520 7379 7374 656d 2e22 2222 0d0a 2020  e system."""..  
+00002120: 2020 2020 2020 7265 7475 726e 2073 656c        return sel
+00002130: 662e 5f67 6574 5f63 7273 2829 0d0a 0d0a  f._get_crs()....
+00002140: 2020 2020 4063 7273 2e73 6574 7465 720d      @crs.setter.
+00002150: 0a20 2020 2064 6566 2063 7273 2873 656c  .    def crs(sel
+00002160: 662c 2076 616c 7565 3a20 7374 7229 3a0d  f, value: str):.
+00002170: 0a20 2020 2020 2020 2022 2222 436f 6f72  .        """Coor
+00002180: 6469 6e61 7465 2072 6566 6572 656e 6365  dinate reference
+00002190: 2073 7973 7465 6d2e 2222 220d 0a20 2020   system."""..   
+000021a0: 2020 2020 2073 656c 662e 7365 745f 6372       self.set_cr
+000021b0: 7328 7661 6c75 6529 0d0a 0d0a 2020 2020  s(value)....    
+000021c0: 4070 726f 7065 7274 790d 0a20 2020 2064  @property..    d
+000021d0: 6566 2063 656c 6c5f 7369 7a65 2873 656c  ef cell_size(sel
+000021e0: 6629 202d 3e20 696e 743a 0d0a 2020 2020  f) -> int:..    
+000021f0: 2020 2020 2222 2243 656c 6c20 7369 7a65      """Cell size
+00002200: 2e22 2222 0d0a 2020 2020 2020 2020 7265  ."""..        re
+00002210: 7475 726e 2073 656c 662e 5f63 656c 6c5f  turn self._cell_
+00002220: 7369 7a65 0d0a 0d0a 2020 2020 4070 726f  size....    @pro
+00002230: 7065 7274 790d 0a20 2020 2064 6566 2062  perty..    def b
+00002240: 616e 645f 636f 756e 7428 7365 6c66 293a  and_count(self):
+00002250: 0d0a 2020 2020 2020 2020 2222 224e 756d  ..        """Num
+00002260: 6265 7220 6f66 2062 616e 6473 2069 6e20  ber of bands in 
+00002270: 7468 6520 7261 7374 6572 2e22 2222 0d0a  the raster."""..
+00002280: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+00002290: 656c 662e 5f62 616e 645f 636f 756e 740d  elf._band_count.
+000022a0: 0a0d 0a20 2020 2040 7072 6f70 6572 7479  ...    @property
+000022b0: 0d0a 2020 2020 6465 6620 6261 6e64 5f6e  ..    def band_n
+000022c0: 616d 6573 2873 656c 6629 3a0d 0a20 2020  ames(self):..   
+000022d0: 2020 2020 2022 2222 4261 6e64 206e 616d       """Band nam
+000022e0: 6573 2e22 2222 0d0a 2020 2020 2020 2020  es."""..        
+000022f0: 7265 7475 726e 2073 656c 662e 5f62 616e  return self._ban
+00002300: 645f 6e61 6d65 730d 0a0d 0a20 2020 2040  d_names....    @
+00002310: 7072 6f70 6572 7479 0d0a 2020 2020 6465  property..    de
+00002320: 6620 7661 7269 6162 6c65 7328 7365 6c66  f variables(self
+00002330: 293a 0d0a 2020 2020 2020 2020 2222 2256  ):..        """V
+00002340: 6172 6961 626c 6573 2069 6e20 7468 6520  ariables in the 
+00002350: 7261 7374 6572 2028 7265 7361 6d62 6c65  raster (resamble
+00002360: 7320 7468 6520 7661 7269 6162 6c65 7320  s the variables 
+00002370: 696e 206e 6574 6364 6620 6669 6c65 732e  in netcdf files.
+00002380: 2922 2222 0d0a 2020 2020 2020 2020 7265  )"""..        re
+00002390: 7475 726e 2073 656c 662e 5f76 6172 6961  turn self._varia
+000023a0: 626c 6573 0d0a 0d0a 2020 2020 4070 726f  bles....    @pro
+000023b0: 7065 7274 790d 0a20 2020 2064 6566 206e  perty..    def n
+000023c0: 6f5f 6461 7461 5f76 616c 7565 2873 656c  o_data_value(sel
+000023d0: 6629 3a0d 0a20 2020 2020 2020 2022 2222  f):..        """
+000023e0: 4e6f 2064 6174 6120 7661 6c75 6520 7468  No data value th
+000023f0: 6174 206d 6172 6b73 2074 6865 2063 656c  at marks the cel
+00002400: 6c73 206f 7574 206f 6620 7468 6520 646f  ls out of the do
+00002410: 6d61 696e 2222 220d 0a20 2020 2020 2020  main"""..       
+00002420: 2072 6574 7572 6e20 7365 6c66 2e5f 6e6f   return self._no
+00002430: 5f64 6174 615f 7661 6c75 650d 0a0d 0a20  _data_value.... 
+00002440: 2020 2040 6e6f 5f64 6174 615f 7661 6c75     @no_data_valu
+00002450: 652e 7365 7474 6572 0d0a 2020 2020 6465  e.setter..    de
+00002460: 6620 6e6f 5f64 6174 615f 7661 6c75 6528  f no_data_value(
+00002470: 7365 6c66 2c20 7661 6c75 653a 206f 626a  self, value: obj
+00002480: 6563 7429 3a0d 0a20 2020 2020 2020 2022  ect):..        "
+00002490: 2222 4e6f 2064 6174 6120 7661 6c75 6520  ""No data value 
+000024a0: 7468 6174 206d 6172 6b73 2074 6865 2063  that marks the c
+000024b0: 656c 6c73 206f 7574 206f 6620 7468 6520  ells out of the 
+000024c0: 646f 6d61 696e 2222 220d 0a20 2020 2020  domain"""..     
+000024d0: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
+000024e0: 2876 616c 7565 2c20 6c69 7374 293a 0d0a  (value, list):..
+000024f0: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+00002500: 692c 2076 616c 2069 6e20 656e 756d 6572  i, val in enumer
+00002510: 6174 6528 7661 6c75 6529 3a0d 0a20 2020  ate(value):..   
+00002520: 2020 2020 2020 2020 2020 2020 2073 656c               sel
+00002530: 662e 5f63 6861 6e67 655f 6e6f 5f64 6174  f._change_no_dat
+00002540: 615f 7661 6c75 655f 6174 7472 2869 2c20  a_value_attr(i, 
+00002550: 7661 6c29 0d0a 2020 2020 2020 2020 656c  val)..        el
+00002560: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
+00002570: 2073 656c 662e 5f63 6861 6e67 655f 6e6f   self._change_no
+00002580: 5f64 6174 615f 7661 6c75 655f 6174 7472  _data_value_attr
+00002590: 2830 2c20 7661 6c75 6529 0d0a 0d0a 2020  (0, value)....  
+000025a0: 2020 4070 726f 7065 7274 790d 0a20 2020    @property..   
+000025b0: 2064 6566 206d 6574 615f 6461 7461 2873   def meta_data(s
+000025c0: 656c 6629 3a0d 0a20 2020 2020 2020 2022  elf):..        "
+000025d0: 2222 4d65 7461 2064 6174 6122 2222 0d0a  ""Meta data"""..
+000025e0: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+000025f0: 656c 662e 5f6d 6574 615f 6461 7461 0d0a  elf._meta_data..
+00002600: 0d0a 2020 2020 4070 726f 7065 7274 790d  ..    @property.
+00002610: 0a20 2020 2064 6566 2064 7479 7065 2873  .    def dtype(s
+00002620: 656c 6629 3a0d 0a20 2020 2020 2020 2022  elf):..        "
+00002630: 2222 4461 7461 2054 7970 6522 2222 0d0a  ""Data Type"""..
+00002640: 2020 2020 2020 2020 7265 7475 726e 2073          return s
+00002650: 656c 662e 5f64 7479 7065 0d0a 0d0a 2020  elf._dtype....  
+00002660: 2020 4070 726f 7065 7274 790d 0a20 2020    @property..   
+00002670: 2064 6566 2066 696c 655f 6e61 6d65 2873   def file_name(s
+00002680: 656c 6629 3a0d 0a20 2020 2020 2020 2022  elf):..        "
+00002690: 2222 6669 6c65 206e 616d 6522 2222 0d0a  ""file name"""..
+000026a0: 2020 2020 2020 2020 6966 2073 656c 662e          if self.
+000026b0: 5f66 696c 655f 6e61 6d65 2e73 7461 7274  _file_name.start
+000026c0: 7377 6974 6828 224e 4554 4344 4622 293a  swith("NETCDF"):
+000026d0: 0d0a 2020 2020 2020 2020 2020 2020 6e61  ..            na
+000026e0: 6d65 203d 2073 656c 662e 5f66 696c 655f  me = self._file_
+000026f0: 6e61 6d65 2e73 706c 6974 2822 3a22 295b  name.split(":")[
+00002700: 315d 5b31 3a2d 315d 0d0a 2020 2020 2020  1][1:-1]..      
+00002710: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
+00002720: 2020 2020 206e 616d 6520 3d20 7365 6c66       name = self
+00002730: 2e5f 6669 6c65 5f6e 616d 650d 0a20 2020  ._file_name..   
+00002740: 2020 2020 2072 6574 7572 6e20 6e61 6d65       return name
+00002750: 0d0a 0d0a 2020 2020 4070 726f 7065 7274  ....    @propert
+00002760: 790d 0a20 2020 2064 6566 2074 696d 655f  y..    def time_
+00002770: 7374 616d 7028 7365 6c66 293a 0d0a 2020  stamp(self):..  
+00002780: 2020 2020 2020 2222 2254 696d 6520 7374        """Time st
+00002790: 616d 7022 2222 0d0a 2020 2020 2020 2020  amp"""..        
+000027a0: 6966 2068 6173 6174 7472 2873 656c 662c  if hasattr(self,
+000027b0: 2022 5f74 696d 655f 7374 616d 7022 293a   "_time_stamp"):
+000027c0: 0d0a 2020 2020 2020 2020 2020 2020 7661  ..            va
+000027d0: 6c20 3d20 7365 6c66 2e5f 7469 6d65 5f73  l = self._time_s
+000027e0: 7461 6d70 0d0a 2020 2020 2020 2020 656c  tamp..        el
+000027f0: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
+00002800: 2076 616c 203d 204e 6f6e 650d 0a0d 0a20   val = None.... 
+00002810: 2020 2020 2020 2072 6574 7572 6e20 7661         return va
+00002820: 6c0d 0a0d 0a20 2020 2040 7072 6f70 6572  l....    @proper
+00002830: 7479 0d0a 2020 2020 6465 6620 6472 6976  ty..    def driv
+00002840: 6572 5f74 7970 6528 7365 6c66 293a 0d0a  er_type(self):..
+00002850: 2020 2020 2020 2020 2222 2244 7269 7665          """Drive
+00002860: 7220 5479 7065 2222 220d 0a20 2020 2020  r Type"""..     
+00002870: 2020 2064 7269 7665 725f 7479 7065 203d     driver_type =
+00002880: 2073 656c 662e 7261 7374 6572 2e47 6574   self.raster.Get
+00002890: 4472 6976 6572 2829 2e47 6574 4465 7363  Driver().GetDesc
+000028a0: 7269 7074 696f 6e28 290d 0a20 2020 2020  ription()..     
+000028b0: 2020 2072 6574 7572 6e20 4341 5441 4c4f     return CATALO
+000028c0: 472e 6765 745f 6472 6976 6572 5f6e 616d  G.get_driver_nam
+000028d0: 6528 6472 6976 6572 5f74 7970 6529 0d0a  e(driver_type)..
+000028e0: 0d0a 2020 2020 4063 6c61 7373 6d65 7468  ..    @classmeth
+000028f0: 6f64 0d0a 2020 2020 6465 6620 7265 6164  od..    def read
+00002900: 5f66 696c 6528 636c 732c 2070 6174 683a  _file(cls, path:
+00002910: 2073 7472 2c20 7265 6164 5f6f 6e6c 793d   str, read_only=
+00002920: 5472 7565 293a 0d0a 2020 2020 2020 2020  True):..        
+00002930: 2222 2272 6561 6420 6669 6c65 2e0d 0a0d  """read file....
+00002940: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
+00002950: 6572 730d 0a20 2020 2020 2020 202d 2d2d  ers..        ---
+00002960: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
+00002970: 2070 6174 6820 3a20 5b73 7472 5d0d 0a20   path : [str].. 
+00002980: 2020 2020 2020 2020 2020 2050 6174 6820             Path 
+00002990: 6f66 2066 696c 6520 746f 206f 7065 6e28  of file to open(
+000029a0: 776f 726b 7320 666f 7220 6173 6369 692c  works for ascii,
+000029b0: 2067 656f 7469 6666 292e 0d0a 2020 2020   geotiff)...    
+000029c0: 2020 2020 7265 6164 5f6f 6e6c 7920 3a20      read_only : 
+000029d0: 5b62 6f6f 6c5d 0d0a 2020 2020 2020 2020  [bool]..        
+000029e0: 2020 2020 4669 6c65 206d 6f64 652c 2073      File mode, s
+000029f0: 6574 2074 6f20 4661 6c73 6520 746f 206f  et to False to o
+00002a00: 7065 6e20 696e 2022 7570 6461 7465 2220  pen in "update" 
+00002a10: 6d6f 6465 2e0d 0a0d 0a20 2020 2020 2020  mode.....       
+00002a20: 2052 6574 7572 6e73 0d0a 2020 2020 2020   Returns..      
+00002a30: 2020 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020    -------..     
+00002a40: 2020 2047 4441 4c20 6461 7461 7365 740d     GDAL dataset.
+00002a50: 0a20 2020 2020 2020 2022 2222 0d0a 2020  .        """..  
+00002a60: 2020 2020 2020 7372 6320 3d20 5f69 6f2e        src = _io.
+00002a70: 7265 6164 5f66 696c 6528 7061 7468 2c20  read_file(path, 
+00002a80: 7265 6164 5f6f 6e6c 7929 0d0a 2020 2020  read_only)..    
+00002a90: 2020 2020 7265 7475 726e 2063 6c73 2873      return cls(s
+00002aa0: 7263 290d 0a0d 0a20 2020 2040 636c 6173  rc)....    @clas
+00002ab0: 736d 6574 686f 640d 0a20 2020 2064 6566  smethod..    def
+00002ac0: 205f 6372 6561 7465 5f65 6d70 7479 5f64   _create_empty_d
+00002ad0: 7269 7665 7228 0d0a 2020 2020 2020 2020  river(..        
+00002ae0: 636c 732c 2073 7263 3a20 6764 616c 2e44  cls, src: gdal.D
+00002af0: 6174 6173 6574 2c20 7061 7468 3a20 7374  ataset, path: st
+00002b00: 7220 3d20 4e6f 6e65 2c20 6261 6e64 733a  r = None, bands:
+00002b10: 2069 6e74 203d 2031 2c20 6e6f 5f64 6174   int = 1, no_dat
+00002b20: 615f 7661 6c75 653d 4e6f 6e65 0d0a 2020  a_value=None..  
+00002b30: 2020 293a 0d0a 2020 2020 2020 2020 2222    ):..        ""
+00002b40: 2243 7265 6174 6520 6120 6e65 7720 656d  "Create a new em
+00002b50: 7074 7920 6472 6976 6572 2066 726f 6d20  pty driver from 
+00002b60: 616e 6f74 6865 7220 6461 7461 7365 742e  another dataset.
+00002b70: 0d0a 0d0a 2020 2020 2020 2020 5061 7261  ....        Para
+00002b80: 6d65 7465 7273 0d0a 2020 2020 2020 2020  meters..        
+00002b90: 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020  ----------..    
+00002ba0: 2020 2020 7372 6320 3a20 5b67 6461 6c2e      src : [gdal.
+00002bb0: 4461 7461 6375 6265 5d0d 0a20 2020 2020  Datacube]..     
+00002bc0: 2020 2020 2020 2067 6461 6c20 6461 7461         gdal data
+00002bd0: 7365 740d 0a20 2020 2020 2020 2070 6174  set..        pat
+00002be0: 6820 3a20 7374 720d 0a20 2020 2020 2020  h : str..       
+00002bf0: 2062 616e 6473 203a 2069 6e74 206f 7220   bands : int or 
+00002c00: 4e6f 6e65 0d0a 2020 2020 2020 2020 2020  None..          
+00002c10: 2020 4e75 6d62 6572 206f 6620 6261 6e64    Number of band
+00002c20: 7320 746f 2063 7265 6174 6520 696e 2074  s to create in t
+00002c30: 6865 206f 7574 7075 7420 7261 7374 6572  he output raster
+00002c40: 2e0d 0a20 2020 2020 2020 206e 6f5f 6461  ...        no_da
+00002c50: 7461 5f76 616c 7565 203a 2066 6c6f 6174  ta_value : float
+00002c60: 206f 7220 4e6f 6e65 0d0a 2020 2020 2020   or None..      
+00002c70: 2020 2020 2020 4e6f 2064 6174 6120 7661        No data va
+00002c80: 6c75 652c 2069 6620 4e6f 6e65 2075 7365  lue, if None use
+00002c90: 7320 7468 6520 7361 6d65 2061 7320 6060  s the same as ``
+00002ca0: 7372 6360 602e 0d0a 0d0a 2020 2020 2020  src``.....      
+00002cb0: 2020 5265 7475 726e 730d 0a20 2020 2020    Returns..     
+00002cc0: 2020 202d 2d2d 2d2d 2d2d 0d0a 2020 2020     -------..    
+00002cd0: 2020 2020 6764 616c 2e44 6174 6153 6574      gdal.DataSet
+00002ce0: 0d0a 2020 2020 2020 2020 2222 220d 0a20  ..        """.. 
+00002cf0: 2020 2020 2020 2062 616e 6473 203d 2069         bands = i
+00002d00: 6e74 2862 616e 6473 2920 6966 2062 616e  nt(bands) if ban
+00002d10: 6473 2069 7320 6e6f 7420 4e6f 6e65 2065  ds is not None e
+00002d20: 6c73 6520 7372 632e 5261 7374 6572 436f  lse src.RasterCo
+00002d30: 756e 740d 0a20 2020 2020 2020 2023 2063  unt..        # c
+00002d40: 7265 6174 6520 7468 6520 6f62 6865 6374  reate the obhect
+00002d50: 0d0a 2020 2020 2020 2020 7372 635f 6f62  ..        src_ob
+00002d60: 6a20 3d20 636c 7328 7372 6329 0d0a 2020  j = cls(src)..  
+00002d70: 2020 2020 2020 2320 4372 6561 7465 2074        # Create t
+00002d80: 6865 2064 7269 7665 722e 0d0a 2020 2020  he driver...    
+00002d90: 2020 2020 6473 7420 3d20 7372 635f 6f62      dst = src_ob
+00002da0: 6a2e 5f63 7265 6174 655f 6764 616c 5f64  j._create_gdal_d
+00002db0: 6174 6173 6574 280d 0a20 2020 2020 2020  ataset(..       
+00002dc0: 2020 2020 2073 7263 5f6f 626a 2e63 6f6c       src_obj.col
+00002dd0: 756d 6e73 2c20 7372 635f 6f62 6a2e 726f  umns, src_obj.ro
+00002de0: 7773 2c20 6261 6e64 732c 2073 7263 5f6f  ws, bands, src_o
+00002df0: 626a 2e64 7479 7065 5b30 5d2c 2070 6174  bj.dtype[0], pat
+00002e00: 683d 7061 7468 0d0a 2020 2020 2020 2020  h=path..        
+00002e10: 290d 0a0d 0a20 2020 2020 2020 2023 2053  )....        # S
+00002e20: 6574 2074 6865 2070 726f 6a65 6374 696f  et the projectio
+00002e30: 6e2e 0d0a 2020 2020 2020 2020 6473 742e  n...        dst.
+00002e40: 5365 7447 656f 5472 616e 7366 6f72 6d28  SetGeoTransform(
+00002e50: 7372 635f 6f62 6a2e 6765 6f74 7261 6e73  src_obj.geotrans
+00002e60: 666f 726d 290d 0a20 2020 2020 2020 2064  form)..        d
+00002e70: 7374 2e53 6574 5072 6f6a 6563 7469 6f6e  st.SetProjection
+00002e80: 2873 7263 5f6f 626a 2e72 6173 7465 722e  (src_obj.raster.
+00002e90: 4765 7450 726f 6a65 6374 696f 6e52 6566  GetProjectionRef
+00002ea0: 2829 290d 0a20 2020 2020 2020 2064 7374  ())..        dst
+00002eb0: 203d 2063 6c73 2864 7374 290d 0a20 2020   = cls(dst)..   
+00002ec0: 2020 2020 2069 6620 6e6f 5f64 6174 615f       if no_data_
+00002ed0: 7661 6c75 6520 6973 206e 6f74 204e 6f6e  value is not Non
+00002ee0: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
+00002ef0: 6473 742e 5f73 6574 5f6e 6f5f 6461 7461  dst._set_no_data
+00002f00: 5f76 616c 7565 286e 6f5f 6461 7461 5f76  _value(no_data_v
+00002f10: 616c 7565 3d66 6c6f 6174 286e 6f5f 6461  alue=float(no_da
+00002f20: 7461 5f76 616c 7565 2929 0d0a 0d0a 2020  ta_value))....  
+00002f30: 2020 2020 2020 7265 7475 726e 2064 7374        return dst
+00002f40: 0d0a 0d0a 2020 2020 4063 6c61 7373 6d65  ....    @classme
+00002f50: 7468 6f64 0d0a 2020 2020 6465 6620 5f63  thod..    def _c
+00002f60: 7265 6174 655f 6472 6976 6572 5f66 726f  reate_driver_fro
+00002f70: 6d5f 7363 7261 7463 6828 0d0a 2020 2020  m_scratch(..    
+00002f80: 2020 2020 636c 732c 0d0a 2020 2020 2020      cls,..      
+00002f90: 2020 6365 6c6c 5f73 697a 653a 2069 6e74    cell_size: int
+00002fa0: 2c0d 0a20 2020 2020 2020 2072 6f77 733a  ,..        rows:
+00002fb0: 2069 6e74 2c0d 0a20 2020 2020 2020 2063   int,..        c
+00002fc0: 6f6c 756d 6e73 3a20 696e 742c 0d0a 2020  olumns: int,..  
+00002fd0: 2020 2020 2020 6474 7970 653a 2069 6e74        dtype: int
+00002fe0: 2c0d 0a20 2020 2020 2020 2062 616e 6473  ,..        bands
+00002ff0: 3a20 696e 742c 0d0a 2020 2020 2020 2020  : int,..        
+00003000: 746f 705f 6c65 6674 5f63 6f6f 7264 733a  top_left_coords:
+00003010: 2054 7570 6c65 2c0d 0a20 2020 2020 2020   Tuple,..       
+00003020: 2065 7073 673a 2069 6e74 2c0d 0a20 2020   epsg: int,..   
+00003030: 2020 2020 206e 6f5f 6461 7461 5f76 616c       no_data_val
+00003040: 7565 3a20 416e 7920 3d20 4e6f 6e65 2c0d  ue: Any = None,.
+00003050: 0a20 2020 2020 2020 2070 6174 683a 2073  .        path: s
+00003060: 7472 203d 204e 6f6e 652c 0d0a 2020 2020  tr = None,..    
+00003070: 293a 0d0a 2020 2020 2020 2020 2222 2243  ):..        """C
+00003080: 7265 6174 6520 6120 6e65 7720 656d 7074  reate a new empt
+00003090: 7920 6472 6976 6572 2066 726f 6d20 616e  y driver from an
+000030a0: 6f74 6865 7220 6461 7461 7365 742e 0d0a  other dataset...
+000030b0: 0d0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
+000030c0: 7465 7273 0d0a 2020 2020 2020 2020 2d2d  ters..        --
+000030d0: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020  --------..      
+000030e0: 2020 6365 6c6c 5f73 697a 653a 205b 416e    cell_size: [An
+000030f0: 795d 0d0a 2020 2020 2020 2020 2020 2020  y]..            
+00003100: 6365 6c6c 2073 697a 652e 0d0a 2020 2020  cell size...    
+00003110: 2020 2020 726f 7773 3a20 5b69 6e74 5d0d      rows: [int].
+00003120: 0a20 2020 2020 2020 2020 2020 206e 756d  .            num
+00003130: 6265 7220 6f66 2072 6f77 732e 0d0a 2020  ber of rows...  
+00003140: 2020 2020 2020 636f 6c75 6d6e 733a 205b        columns: [
+00003150: 696e 745d 0d0a 2020 2020 2020 2020 2020  int]..          
+00003160: 2020 6e75 6d62 6572 206f 6620 636f 6c75    number of colu
+00003170: 6d6e 732e 0d0a 2020 2020 2020 2020 6474  mns...        dt
+00003180: 7970 653a 205b 696e 745d 0d0a 2020 2020  ype: [int]..    
+00003190: 2020 2020 2020 2020 6461 7461 2074 7970          data typ
+000031a0: 652e 0d0a 2020 2020 2020 2020 6261 6e64  e...        band
+000031b0: 7320 3a20 696e 7420 6f72 204e 6f6e 650d  s : int or None.
+000031c0: 0a20 2020 2020 2020 2020 2020 204e 756d  .            Num
+000031d0: 6265 7220 6f66 2062 616e 6473 2074 6f20  ber of bands to 
+000031e0: 6372 6561 7465 2069 6e20 7468 6520 6f75  create in the ou
+000031f0: 7470 7574 2072 6173 7465 722e 0d0a 2020  tput raster...  
+00003200: 2020 2020 2020 746f 705f 6c65 6674 5f63        top_left_c
+00003210: 6f6f 7264 733a 205b 5475 706c 655d 0d0a  oords: [Tuple]..
+00003220: 2020 2020 2020 2020 2020 2020 636f 6f72              coor
+00003230: 6469 6e61 7465 7320 6f66 2074 6865 2074  dinates of the t
+00003240: 6f70 206c 6566 7420 636f 726e 6572 2070  op left corner p
+00003250: 6f69 6e74 2e0d 0a20 2020 2020 2020 2065  oint...        e
+00003260: 7073 673a 205b 696e 745d 0d0a 2020 2020  psg: [int]..    
+00003270: 2020 2020 2020 2020 6570 7367 206e 756d          epsg num
+00003280: 6265 7220 746f 2069 6465 6e74 6966 7920  ber to identify 
+00003290: 7468 6520 7072 6f6a 6563 7469 6f6e 206f  the projection o
+000032a0: 6620 7468 6520 636f 6f72 6469 6e61 7465  f the coordinate
+000032b0: 7320 696e 2074 6865 2063 7265 6174 6564  s in the created
+000032c0: 2072 6173 7465 722e 0d0a 2020 2020 2020   raster...      
+000032d0: 2020 6e6f 5f64 6174 615f 7661 6c75 6520    no_data_value 
+000032e0: 3a20 666c 6f61 7420 6f72 204e 6f6e 650d  : float or None.
+000032f0: 0a20 2020 2020 2020 2020 2020 204e 6f20  .            No 
+00003300: 6461 7461 2076 616c 7565 2c20 6966 204e  data value, if N
+00003310: 6f6e 6520 7573 6573 2074 6865 2073 616d  one uses the sam
+00003320: 6520 6173 2060 6073 7263 6060 2e0d 0a20  e as ``src``... 
+00003330: 2020 2020 2020 2070 6174 6820 3a20 5b73         path : [s
+00003340: 7472 5d0d 0a20 2020 2020 2020 2020 2020  tr]..           
+00003350: 2070 6174 6820 6f6e 2064 6973 6b2e 0d0a   path on disk...
+00003360: 0d0a 2020 2020 2020 2020 5265 7475 726e  ..        Return
+00003370: 730d 0a20 2020 2020 2020 202d 2d2d 2d2d  s..        -----
+00003380: 2d2d 0d0a 2020 2020 2020 2020 6764 616c  --..        gdal
+00003390: 2e44 6174 6153 6574 0d0a 2020 2020 2020  .DataSet..      
+000033a0: 2020 2222 220d 0a20 2020 2020 2020 2023    """..        #
+000033b0: 2043 7265 6174 6520 7468 6520 6472 6976   Create the driv
+000033c0: 6572 2e0d 0a20 2020 2020 2020 2064 7374  er...        dst
+000033d0: 203d 2044 6174 6173 6574 2e5f 6372 6561   = Dataset._crea
+000033e0: 7465 5f67 6461 6c5f 6461 7461 7365 7428  te_gdal_dataset(
+000033f0: 636f 6c75 6d6e 732c 2072 6f77 732c 2062  columns, rows, b
+00003400: 616e 6473 2c20 6474 7970 652c 2070 6174  ands, dtype, pat
+00003410: 683d 7061 7468 290d 0a20 2020 2020 2020  h=path)..       
+00003420: 2067 656f 7472 616e 7366 6f72 6d20 3d20   geotransform = 
+00003430: 280d 0a20 2020 2020 2020 2020 2020 2074  (..            t
+00003440: 6f70 5f6c 6566 745f 636f 6f72 6473 5b30  op_left_coords[0
+00003450: 5d2c 0d0a 2020 2020 2020 2020 2020 2020  ],..            
+00003460: 6365 6c6c 5f73 697a 652c 0d0a 2020 2020  cell_size,..    
+00003470: 2020 2020 2020 2020 302c 0d0a 2020 2020          0,..    
+00003480: 2020 2020 2020 2020 746f 705f 6c65 6674          top_left
+00003490: 5f63 6f6f 7264 735b 315d 2c0d 0a20 2020  _coords[1],..   
+000034a0: 2020 2020 2020 2020 2030 2c0d 0a20 2020           0,..   
+000034b0: 2020 2020 2020 2020 202d 3120 2a20 6365           -1 * ce
+000034c0: 6c6c 5f73 697a 652c 0d0a 2020 2020 2020  ll_size,..      
+000034d0: 2020 290d 0a20 2020 2020 2020 2073 7220    )..        sr 
+000034e0: 3d20 4461 7461 7365 742e 5f63 7265 6174  = Dataset._creat
+000034f0: 655f 7372 5f66 726f 6d5f 6570 7367 2865  e_sr_from_epsg(e
+00003500: 7073 6729 0d0a 0d0a 2020 2020 2020 2020  psg)....        
+00003510: 2320 5365 7420 7468 6520 7072 6f6a 6563  # Set the projec
+00003520: 7469 6f6e 2e0d 0a20 2020 2020 2020 2064  tion...        d
+00003530: 7374 2e53 6574 4765 6f54 7261 6e73 666f  st.SetGeoTransfo
+00003540: 726d 2867 656f 7472 616e 7366 6f72 6d29  rm(geotransform)
+00003550: 0d0a 2020 2020 2020 2020 6473 742e 5365  ..        dst.Se
+00003560: 7450 726f 6a65 6374 696f 6e28 7372 2e45  tProjection(sr.E
+00003570: 7870 6f72 7454 6f57 6b74 2829 290d 0a20  xportToWkt()).. 
+00003580: 2020 2020 2020 2064 7374 203d 2063 6c73         dst = cls
+00003590: 2864 7374 290d 0a20 2020 2020 2020 2069  (dst)..        i
+000035a0: 6620 6e6f 5f64 6174 615f 7661 6c75 6520  f no_data_value 
+000035b0: 6973 206e 6f74 204e 6f6e 653a 0d0a 2020  is not None:..  
+000035c0: 2020 2020 2020 2020 2020 6473 742e 5f73            dst._s
+000035d0: 6574 5f6e 6f5f 6461 7461 5f76 616c 7565  et_no_data_value
+000035e0: 286e 6f5f 6461 7461 5f76 616c 7565 3d6e  (no_data_value=n
+000035f0: 6f5f 6461 7461 5f76 616c 7565 290d 0a0d  o_data_value)...
+00003600: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00003610: 6473 740d 0a0d 0a20 2020 2064 6566 2072  dst....    def r
+00003620: 6561 645f 6172 7261 7928 7365 6c66 2c20  ead_array(self, 
+00003630: 6261 6e64 3a20 696e 7420 3d20 4e6f 6e65  band: int = None
+00003640: 2920 2d3e 206e 702e 6e64 6172 7261 793a  ) -> np.ndarray:
+00003650: 0d0a 2020 2020 2020 2020 2222 2252 6561  ..        """Rea
+00003660: 6420 4172 7261 790d 0a0d 0a20 2020 2020  d Array....     
+00003670: 2020 2020 2020 202d 2072 6561 6420 7468         - read th
+00003680: 6520 7661 6c75 6573 2073 746f 7265 6420  e values stored 
+00003690: 696e 2061 2067 6976 656e 2062 616e 642e  in a given band.
+000036a0: 0d0a 0d0a 2020 2020 2020 2020 5061 7261  ....        Para
+000036b0: 6d65 7465 7273 0d0a 2020 2020 2020 2020  meters..        
+000036c0: 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020  ----------..    
+000036d0: 2020 2020 6261 6e64 203a 205b 696e 7465      band : [inte
+000036e0: 6765 725d 0d0a 2020 2020 2020 2020 2020  ger]..          
+000036f0: 2020 7468 6520 6261 6e64 2079 6f75 2077    the band you w
+00003700: 616e 7420 746f 2067 6574 2069 7473 2064  ant to get its d
+00003710: 6174 612c 2049 6620 4e6f 6e65 2074 6865  ata, If None the
+00003720: 2064 6174 6120 6f66 2061 6c6c 2062 616e   data of all ban
+00003730: 6473 2077 696c 6c20 6265 2072 6561 642e  ds will be read.
+00003740: 2044 6566 6175 6c74 2069 7320 4e6f 6e65   Default is None
+00003750: 0d0a 0d0a 2020 2020 2020 2020 5265 7475  ....        Retu
+00003760: 726e 730d 0a20 2020 2020 2020 202d 2d2d  rns..        ---
+00003770: 2d2d 2d2d 0d0a 2020 2020 2020 2020 6172  ----..        ar
+00003780: 7261 7920 3a20 5b61 7272 6179 5d0d 0a20  ray : [array].. 
+00003790: 2020 2020 2020 2020 2020 2061 7272 6179             array
+000037a0: 2077 6974 6820 616c 6c20 7468 6520 7661   with all the va
+000037b0: 6c75 6573 2069 6e20 7468 6520 7261 7374  lues in the rast
+000037c0: 6572 2e0d 0a20 2020 2020 2020 2022 2222  er...        """
+000037d0: 0d0a 2020 2020 2020 2020 2320 7472 7920  ..        # try 
+000037e0: 746f 2072 6574 7572 6e20 6172 7261 7920  to return array 
+000037f0: 6173 2074 6865 2073 616d 6520 7479 7065  as the same type
+00003800: 2061 7320 7468 6520 7261 7374 6572 2062   as the raster b
+00003810: 616e 6420 6275 7420 6d61 6465 2070 726f  and but made pro
+00003820: 626c 656d 7320 7768 656e 2074 7279 696e  blems when tryin
+00003830: 6720 746f 2072 6570 6c61 6365 2074 6865  g to replace the
+00003840: 0d0a 2020 2020 2020 2020 2320 6e6f 5f64  ..        # no_d
+00003850: 6174 615f 7661 6c75 6520 6f66 2061 6e20  ata_value of an 
+00003860: 696e 7465 6765 7220 6261 6e64 2077 6974  integer band wit
+00003870: 6820 6e70 2e6e 616e 2076 616c 7565 0d0a  h np.nan value..
+00003880: 2020 2020 2020 2020 2320 6474 7970 6520          # dtype 
+00003890: 3d20 6764 616c 5f74 6f5f 6e75 6d70 795f  = gdal_to_numpy_
+000038a0: 6474 7970 6528 7365 6c66 2e64 7479 7065  dtype(self.dtype
+000038b0: 5b30 5d29 0d0a 2020 2020 2020 2020 6966  [0])..        if
+000038c0: 2062 616e 6420 6973 204e 6f6e 6520 616e   band is None an
+000038d0: 6420 7365 6c66 2e62 616e 645f 636f 756e  d self.band_coun
+000038e0: 7420 3e20 313a 0d0a 2020 2020 2020 2020  t > 1:..        
+000038f0: 2020 2020 6172 7220 3d20 6e70 2e6f 6e65      arr = np.one
+00003900: 7328 0d0a 2020 2020 2020 2020 2020 2020  s(..            
+00003910: 2020 2020 280d 0a20 2020 2020 2020 2020      (..         
+00003920: 2020 2020 2020 2020 2020 2073 656c 662e             self.
+00003930: 6261 6e64 5f63 6f75 6e74 2c0d 0a20 2020  band_count,..   
+00003940: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003950: 2073 656c 662e 726f 7773 2c0d 0a20 2020   self.rows,..   
+00003960: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003970: 2073 656c 662e 636f 6c75 6d6e 732c 0d0a   self.columns,..
+00003980: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003990: 292c 0d0a 2020 2020 2020 2020 2020 2020  ),..            
+000039a0: 2020 2020 2320 6474 7970 653d 6474 7970      # dtype=dtyp
+000039b0: 650d 0a20 2020 2020 2020 2020 2020 2029  e..            )
+000039c0: 0d0a 2020 2020 2020 2020 2020 2020 666f  ..            fo
+000039d0: 7220 6920 696e 2072 616e 6765 2873 656c  r i in range(sel
+000039e0: 662e 6261 6e64 5f63 6f75 6e74 293a 0d0a  f.band_count):..
+000039f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00003a00: 6172 725b 692c 203a 2c20 3a5d 203d 2073  arr[i, :, :] = s
+00003a10: 656c 662e 5f72 6173 7465 722e 4765 7452  elf._raster.GetR
+00003a20: 6173 7465 7242 616e 6428 6920 2b20 3129  asterBand(i + 1)
+00003a30: 2e52 6561 6441 7341 7272 6179 2829 0d0a  .ReadAsArray()..
+00003a40: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
+00003a50: 2020 2020 2020 2020 2020 2069 6620 6261             if ba
+00003a60: 6e64 2069 7320 4e6f 6e65 3a0d 0a20 2020  nd is None:..   
+00003a70: 2020 2020 2020 2020 2020 2020 2062 616e               ban
+00003a80: 6420 3d20 300d 0a20 2020 2020 2020 2020  d = 0..         
+00003a90: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
+00003aa0: 2020 2020 2020 2020 2020 6966 2062 616e            if ban
+00003ab0: 6420 3e20 7365 6c66 2e62 616e 645f 636f  d > self.band_co
+00003ac0: 756e 7420 2d20 313a 0d0a 2020 2020 2020  unt - 1:..      
+00003ad0: 2020 2020 2020 2020 2020 2020 2020 7261                ra
+00003ae0: 6973 6520 5661 6c75 6545 7272 6f72 280d  ise ValueError(.
+00003af0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00003b00: 2020 2020 2020 2020 2066 2262 616e 6420           f"band 
+00003b10: 696e 6465 7820 7368 6f75 6c64 2062 6520  index should be 
+00003b20: 6265 7477 6565 6e20 3020 616e 6420 7b73  between 0 and {s
+00003b30: 656c 662e 6261 6e64 5f63 6f75 6e74 202d  elf.band_count -
+00003b40: 2031 7d22 0d0a 2020 2020 2020 2020 2020   1}"..          
+00003b50: 2020 2020 2020 2020 2020 290d 0a20 2020            )..   
+00003b60: 2020 2020 2020 2020 2061 7272 203d 2073           arr = s
+00003b70: 656c 662e 7261 7374 6572 2e47 6574 5261  elf.raster.GetRa
+00003b80: 7374 6572 4261 6e64 2862 616e 6420 2b20  sterBand(band + 
+00003b90: 3129 2e52 6561 6441 7341 7272 6179 2829  1).ReadAsArray()
+00003ba0: 0d0a 0d0a 2020 2020 2020 2020 7265 7475  ....        retu
+00003bb0: 726e 2061 7272 0d0a 0d0a 2020 2020 6465  rn arr....    de
+00003bc0: 6620 706c 6f74 280d 0a20 2020 2020 2020  f plot(..       
+00003bd0: 2073 656c 662c 0d0a 2020 2020 2020 2020   self,..        
+00003be0: 6261 6e64 3a20 696e 7420 3d20 4e6f 6e65  band: int = None
+00003bf0: 2c0d 0a20 2020 2020 2020 2065 7863 6c75  ,..        exclu
+00003c00: 6465 5f76 616c 7565 3a20 416e 7920 3d20  de_value: Any = 
+00003c10: 4e6f 6e65 2c0d 0a20 2020 2020 2020 2072  None,..        r
+00003c20: 6762 3a20 4c69 7374 5b69 6e74 5d20 3d20  gb: List[int] = 
+00003c30: 4e6f 6e65 2c0d 0a20 2020 2020 2020 2073  None,..        s
+00003c40: 7572 6661 6365 5f72 6566 6c65 6374 616e  urface_reflectan
+00003c50: 6365 3a20 696e 7420 3d20 3130 3030 302c  ce: int = 10000,
+00003c60: 0d0a 2020 2020 2020 2020 6375 746f 6666  ..        cutoff
+00003c70: 3a20 4c69 7374 203d 204e 6f6e 652c 0d0a  : List = None,..
+00003c80: 2020 2020 2020 2020 2a2a 6b77 6172 6773          **kwargs
+00003c90: 2c0d 0a20 2020 2029 3a0d 0a20 2020 2020  ,..    ):..     
+00003ca0: 2020 2022 2222 5265 6164 2041 7272 6179     """Read Array
+00003cb0: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
+00003cc0: 2d20 7265 6164 2074 6865 2076 616c 7565  - read the value
+00003cd0: 7320 7374 6f72 6564 2069 6e20 6120 6769  s stored in a gi
+00003ce0: 7665 6e20 6261 6e64 2e0d 0a0d 0a20 2020  ven band.....   
+00003cf0: 2020 2020 2050 6172 616d 6574 6572 730d       Parameters.
+00003d00: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+00003d10: 2d2d 2d0d 0a20 2020 2020 2020 2062 616e  ---..        ban
+00003d20: 6420 3a20 5b69 6e74 6567 6572 5d0d 0a20  d : [integer].. 
+00003d30: 2020 2020 2020 2020 2020 2074 6865 2062             the b
+00003d40: 616e 6420 796f 7520 7761 6e74 2074 6f20  and you want to 
+00003d50: 6765 7420 6974 7320 6461 7461 2e20 4465  get its data. De
+00003d60: 6661 756c 7420 6973 2030 0d0a 2020 2020  fault is 0..    
+00003d70: 2020 2020 6578 636c 7564 655f 7661 6c75      exclude_valu
+00003d80: 653a 205b 416e 795d 0d0a 2020 2020 2020  e: [Any]..      
+00003d90: 2020 2020 2020 7661 6c75 6520 746f 2065        value to e
+00003da0: 7865 636c 7564 6520 6672 6f6d 2074 6865  xeclude from the
+00003db0: 2070 6c6f 742e 2044 6566 6175 6c74 2069   plot. Default i
+00003dc0: 7320 4e6f 6e65 2e0d 0a20 2020 2020 2020  s None...       
+00003dd0: 2072 6762 3a20 5b4c 6973 745d 0d0a 2020   rgb: [List]..  
+00003de0: 2020 2020 2020 2020 2020 4465 6661 756c            Defaul
+00003df0: 7420 6973 205b 332c 322c 315d 0d0a 2020  t is [3,2,1]..  
+00003e00: 2020 2020 2020 7375 7266 6163 655f 7265        surface_re
+00003e10: 666c 6563 7461 6e63 653a 205b 696e 745d  flectance: [int]
+00003e20: 0d0a 2020 2020 2020 2020 2020 2020 4465  ..            De
+00003e30: 6661 756c 7420 6973 2020 3130 3030 300d  fault is  10000.
+00003e40: 0a20 2020 2020 2020 2063 7574 6f66 663a  .        cutoff:
+00003e50: 205b 4c69 7374 5d0d 0a20 2020 2020 2020   [List]..       
+00003e60: 2020 2020 2063 6c69 7020 7468 6520 7261       clip the ra
+00003e70: 6e67 6520 6f66 2070 6978 656c 2076 616c  nge of pixel val
+00003e80: 7565 7320 666f 7220 6561 6368 2062 616e  ues for each ban
+00003e90: 642e 2028 7461 6b65 206f 6e6c 7920 7468  d. (take only th
+00003ea0: 6520 7069 7865 6c20 7661 6c75 6573 2066  e pixel values f
+00003eb0: 726f 6d20 3020 746f 2076 616c 7565 206f  rom 0 to value o
+00003ec0: 6620 7468 6520 6375 746f 6666 2061 6e64  f the cutoff and
+00003ed0: 0d0a 2020 2020 2020 2020 2020 2020 7363  ..            sc
+00003ee0: 616c 6520 7468 656d 2062 6163 6b20 746f  ale them back to
+00003ef0: 2062 6574 7765 656e 2030 2061 6e64 2031   between 0 and 1
+00003f00: 2e20 4465 6661 756c 7420 6973 204e 6f6e  . Default is Non
+00003f10: 652e 0d0a 2020 2020 2020 2020 2a2a 6b77  e...        **kw
+00003f20: 6172 6773 0d0a 2020 2020 2020 2020 2020  args..          
+00003f30: 2020 706f 696e 7473 203a 205b 6172 7261    points : [arra
+00003f40: 795d 0d0a 2020 2020 2020 2020 2020 2020  y]..            
+00003f50: 2020 2020 3320 636f 6c75 6d6e 2061 7272      3 column arr
+00003f60: 6179 2077 6974 6820 7468 6520 6669 7273  ay with the firs
+00003f70: 7420 636f 6c75 6d6e 2061 7320 7468 6520  t column as the 
+00003f80: 7661 6c75 6520 796f 7520 7761 6e74 2074  value you want t
+00003f90: 6f20 6469 7370 6c61 7920 666f 7220 7468  o display for th
+00003fa0: 6520 706f 696e 742c 2074 6865 2073 6563  e point, the sec
+00003fb0: 6f6e 6420 6973 2074 6865 2072 6f77 730d  ond is the rows.
+00003fc0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00003fd0: 2069 6e64 6578 206f 6620 7468 6520 706f   index of the po
+00003fe0: 696e 7420 696e 2074 6865 2061 7272 6179  int in the array
+00003ff0: 2c20 616e 6420 7468 6520 7468 6972 6420  , and the third 
+00004000: 636f 6c75 6d6e 2061 7320 7468 6520 636f  column as the co
+00004010: 6c75 6d6e 2069 6e64 6578 2069 6e20 7468  lumn index in th
+00004020: 6520 6172 7261 792e 0d0a 2020 2020 2020  e array...      
+00004030: 2020 2020 2020 2020 2020 2d20 7468 6520            - the 
+00004040: 7365 636f 6e64 2061 6e64 2074 6869 7264  second and third
+00004050: 2063 6f6c 756d 6e20 7465 6c6c 7320 7468   column tells th
+00004060: 6520 6c6f 6361 7469 6f6e 206f 6620 7468  e location of th
+00004070: 6520 706f 696e 7420 696e 2074 6865 2061  e point in the a
+00004080: 7272 6179 2e0d 0a20 2020 2020 2020 2020  rray...         
+00004090: 2020 2070 6f69 6e74 5f63 6f6c 6f72 3a20     point_color: 
+000040a0: 5b73 7472 5d0d 0a20 2020 2020 2020 2020  [str]..         
+000040b0: 2020 2020 2020 2063 6f6c 6f72 2e0d 0a20         color... 
+000040c0: 2020 2020 2020 2020 2020 2070 6f69 6e74             point
+000040d0: 5f73 697a 653a 205b 416e 795d 0d0a 2020  _size: [Any]..  
+000040e0: 2020 2020 2020 2020 2020 2020 2020 7369                si
+000040f0: 7a65 206f 6620 7468 6520 706f 696e 742e  ze of the point.
+00004100: 0d0a 2020 2020 2020 2020 2020 2020 7069  ..            pi
+00004110: 645f 636f 6c6f 723a 205b 7374 725d 0d0a  d_color: [str]..
+00004120: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00004130: 7468 6520 636f 6c6f 7220 6f66 2074 6865  the color of the
+00004140: 2061 6e6f 7461 7469 6f6e 206f 6620 7468   anotation of th
+00004150: 6520 706f 696e 742e 2044 6566 6175 6c74  e point. Default
+00004160: 2069 7320 626c 7565 2e0d 0a20 2020 2020   is blue...     
+00004170: 2020 2020 2020 2070 6964 5f73 697a 653a         pid_size:
+00004180: 205b 416e 795d 0d0a 2020 2020 2020 2020   [Any]..        
+00004190: 2020 2020 2020 2020 7369 7a65 206f 6620          size of 
+000041a0: 7468 6520 706f 696e 7420 616e 6e6f 7461  the point annota
+000041b0: 7469 6f6e 2e0d 0a20 2020 2020 2020 2020  tion...         
+000041c0: 2020 2066 6967 7369 7a65 203a 205b 7475     figsize : [tu
+000041d0: 706c 655d 2c20 6f70 7469 6f6e 616c 0d0a  ple], optional..
+000041e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000041f0: 6669 6775 7265 2073 697a 652e 2054 6865  figure size. The
+00004200: 2064 6566 6175 6c74 2069 7320 2838 2c38   default is (8,8
+00004210: 292e 0d0a 2020 2020 2020 2020 2020 2020  )...            
+00004220: 7469 746c 6520 3a20 5b73 7472 5d2c 206f  title : [str], o
+00004230: 7074 696f 6e61 6c0d 0a20 2020 2020 2020  ptional..       
+00004240: 2020 2020 2020 2020 2074 6974 6c65 206f           title o
+00004250: 6620 7468 6520 706c 6f74 2e20 5468 6520  f the plot. The 
+00004260: 6465 6661 756c 7420 6973 2027 546f 7461  default is 'Tota
+00004270: 6c20 4469 7363 6861 7267 6527 2e0d 0a20  l Discharge'... 
+00004280: 2020 2020 2020 2020 2020 2074 6974 6c65             title
+00004290: 5f73 697a 6520 3a20 5b69 6e74 6567 6572  _size : [integer
+000042a0: 5d2c 206f 7074 696f 6e61 6c0d 0a20 2020  ], optional..   
+000042b0: 2020 2020 2020 2020 2020 2020 2074 6974               tit
+000042c0: 6c65 2073 697a 652e 2054 6865 2064 6566  le size. The def
+000042d0: 6175 6c74 2069 7320 3135 2e0d 0a20 2020  ault is 15...   
+000042e0: 2020 2020 2020 2020 206f 7269 656e 7461           orienta
+000042f0: 7469 6f6e 203a 205b 7374 7269 6e67 5d2c  tion : [string],
+00004300: 206f 7074 696f 6e61 6c0d 0a20 2020 2020   optional..     
+00004310: 2020 2020 2020 2020 2020 206f 7269 6e74             orint
+00004320: 6174 696f 6e20 6f66 2074 6865 2063 6f6c  ation of the col
+00004330: 6f72 6261 7220 686f 7269 7a6f 6e74 616c  orbar horizontal
+00004340: 2f76 6572 7469 6361 6c2e 2054 6865 2064  /vertical. The d
+00004350: 6566 6175 6c74 2069 7320 2776 6572 7469  efault is 'verti
+00004360: 6361 6c27 2e0d 0a20 2020 2020 2020 2020  cal'...         
+00004370: 2020 2072 6f74 6174 696f 6e20 3a20 5b6e     rotation : [n
+00004380: 756d 6265 725d 2c20 6f70 7469 6f6e 616c  umber], optional
+00004390: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000043a0: 2020 726f 7461 7469 6f6e 206f 6620 7468    rotation of th
+000043b0: 6520 636f 6c6f 7262 6172 206c 6162 656c  e colorbar label
+000043c0: 2e20 5468 6520 6465 6661 756c 7420 6973  . The default is
+000043d0: 202d 3930 2e0d 0a20 2020 2020 2020 2020   -90...         
+000043e0: 2020 206f 7269 656e 7461 7469 6f6e 203a     orientation :
+000043f0: 205b 7374 7269 6e67 5d2c 206f 7074 696f   [string], optio
+00004400: 6e61 6c0d 0a20 2020 2020 2020 2020 2020  nal..           
+00004410: 2020 2020 206f 7269 6e74 6174 696f 6e20       orintation 
+00004420: 6f66 2074 6865 2063 6f6c 6f72 6261 7220  of the colorbar 
+00004430: 686f 7269 7a6f 6e74 616c 2f76 6572 7469  horizontal/verti
+00004440: 6361 6c2e 2054 6865 2064 6566 6175 6c74  cal. The default
+00004450: 2069 7320 2776 6572 7469 6361 6c27 2e0d   is 'vertical'..
+00004460: 0a20 2020 2020 2020 2020 2020 2063 6261  .            cba
+00004470: 725f 6c65 6e67 7468 203a 205b 666c 6f61  r_length : [floa
+00004480: 745d 2c20 6f70 7469 6f6e 616c 0d0a 2020  t], optional..  
+00004490: 2020 2020 2020 2020 2020 2020 2020 7261                ra
+000044a0: 7469 6f20 746f 2063 6f6e 7472 6f6c 2074  tio to control t
+000044b0: 6865 2068 6569 6768 7420 6f66 2074 6865  he height of the
+000044c0: 2063 6f6c 6f72 6261 722e 2054 6865 2064   colorbar. The d
+000044d0: 6566 6175 6c74 2069 7320 302e 3735 2e0d  efault is 0.75..
+000044e0: 0a20 2020 2020 2020 2020 2020 2074 6963  .            tic
+000044f0: 6b73 5f73 7061 6369 6e67 203a 205b 696e  ks_spacing : [in
+00004500: 7465 6765 725d 2c20 6f70 7469 6f6e 616c  teger], optional
+00004510: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00004520: 2020 5370 6163 696e 6720 696e 2074 6865    Spacing in the
+00004530: 2063 6f6c 6f72 6261 7220 7469 636b 732e   colorbar ticks.
+00004540: 2054 6865 2064 6566 6175 6c74 2069 7320   The default is 
+00004550: 322e 0d0a 2020 2020 2020 2020 2020 2020  2...            
+00004560: 6362 6172 5f6c 6162 656c 5f73 697a 6520  cbar_label_size 
+00004570: 3a20 696e 7465 6765 722c 206f 7074 696f  : integer, optio
+00004580: 6e61 6c0d 0a20 2020 2020 2020 2020 2020  nal..           
+00004590: 2020 2020 2073 697a 6520 6f66 2074 6865       size of the
+000045a0: 2063 6f6c 6f72 2062 6172 206c 6162 656c   color bar label
+000045b0: 2e20 5468 6520 6465 6661 756c 7420 6973  . The default is
+000045c0: 2031 322e 0d0a 2020 2020 2020 2020 2020   12...          
+000045d0: 2020 6362 6172 5f6c 6162 656c 203a 2073    cbar_label : s
+000045e0: 7472 2c20 6f70 7469 6f6e 616c 0d0a 2020  tr, optional..  
+000045f0: 2020 2020 2020 2020 2020 2020 2020 6c61                la
+00004600: 6265 6c20 6f66 2074 6865 2063 6f6c 6f72  bel of the color
+00004610: 2062 6172 2e20 5468 6520 6465 6661 756c   bar. The defaul
+00004620: 7420 6973 2027 4469 7363 6861 7267 6520  t is 'Discharge 
+00004630: 6d33 2f73 272e 0d0a 2020 2020 2020 2020  m3/s'...        
+00004640: 2020 2020 636f 6c6f 725f 7363 616c 6520      color_scale 
+00004650: 3a20 696e 7465 6765 722c 206f 7074 696f  : integer, optio
+00004660: 6e61 6c0d 0a20 2020 2020 2020 2020 2020  nal..           
+00004670: 2020 2020 2074 6865 7265 2061 7265 2035       there are 5
+00004680: 206f 7074 696f 6e73 2074 6f20 6368 616e   options to chan
+00004690: 6765 2074 6865 2073 6361 6c65 206f 6620  ge the scale of 
+000046a0: 7468 6520 636f 6c6f 7273 2e20 5468 6520  the colors. The 
+000046b0: 6465 6661 756c 7420 6973 2031 2e0d 0a20  default is 1... 
+000046c0: 2020 2020 2020 2020 2020 2020 2020 2031                 1
+000046d0: 2d20 636f 6c6f 725f 7363 616c 6520 3120  - color_scale 1 
+000046e0: 6973 2074 6865 206e 6f72 6d61 6c20 7363  is the normal sc
+000046f0: 616c 650d 0a20 2020 2020 2020 2020 2020  ale..           
+00004700: 2020 2020 2032 2d20 636f 6c6f 725f 7363       2- color_sc
+00004710: 616c 6520 3220 6973 2074 6865 2070 6f77  ale 2 is the pow
+00004720: 6572 2073 6361 6c65 0d0a 2020 2020 2020  er scale..      
+00004730: 2020 2020 2020 2020 2020 332d 2063 6f6c            3- col
+00004740: 6f72 5f73 6361 6c65 2033 2069 7320 7468  or_scale 3 is th
+00004750: 6520 5379 6d4c 6f67 4e6f 726d 2073 6361  e SymLogNorm sca
+00004760: 6c65 0d0a 2020 2020 2020 2020 2020 2020  le..            
+00004770: 2020 2020 342d 2063 6f6c 6f72 5f73 6361      4- color_sca
+00004780: 6c65 2034 2069 7320 7468 6520 506f 7765  le 4 is the Powe
+00004790: 724e 6f72 6d20 7363 616c 650d 0a20 2020  rNorm scale..   
+000047a0: 2020 2020 2020 2020 2020 2020 2035 2d20               5- 
+000047b0: 636f 6c6f 725f 7363 616c 6520 3520 6973  color_scale 5 is
+000047c0: 2074 6865 2042 6f75 6e64 6172 794e 6f72   the BoundaryNor
+000047d0: 6d20 7363 616c 650d 0a20 2020 2020 2020  m scale..       
+000047e0: 2020 2020 2020 2020 202d 2d2d 2d2d 2d2d           -------
+000047f0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00004800: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00004810: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00004820: 2d2d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020  -----------..   
+00004830: 2020 2020 2020 2020 2020 2020 2067 616d               gam
+00004840: 6d61 203a 205b 666c 6f61 745d 2c20 6f70  ma : [float], op
+00004850: 7469 6f6e 616c 0d0a 2020 2020 2020 2020  tional..        
+00004860: 2020 2020 2020 2020 2020 2020 7661 6c75              valu
+00004870: 6520 6e65 6564 6564 2066 6f72 206f 7074  e needed for opt
+00004880: 696f 6e20 3220 2e20 5468 6520 6465 6661  ion 2 . The defa
+00004890: 756c 7420 6973 2031 2e2f 322e 2e0d 0a20  ult is 1./2.... 
+000048a0: 2020 2020 2020 2020 2020 2020 2020 206c                 l
+000048b0: 696e 655f 7468 7265 7368 6f6c 6420 3a20  ine_threshold : 
+000048c0: 5b66 6c6f 6174 5d2c 206f 7074 696f 6e61  [float], optiona
+000048d0: 6c0d 0a20 2020 2020 2020 2020 2020 2020  l..             
+000048e0: 2020 2020 2020 2076 616c 7565 206e 6565         value nee
+000048f0: 6465 6420 666f 7220 6f70 7469 6f6e 2033  ded for option 3
+00004900: 2e20 5468 6520 6465 6661 756c 7420 6973  . The default is
+00004910: 2030 2e30 3030 312e 0d0a 2020 2020 2020   0.0001...      
+00004920: 2020 2020 2020 2020 2020 6c69 6e65 5f73            line_s
+00004930: 6361 6c65 203a 205b 666c 6f61 745d 2c20  cale : [float], 
+00004940: 6f70 7469 6f6e 616c 0d0a 2020 2020 2020  optional..      
+00004950: 2020 2020 2020 2020 2020 2020 2020 7661                va
+00004960: 6c75 6520 6e65 6564 6564 2066 6f72 206f  lue needed for o
+00004970: 7074 696f 6e20 332e 2054 6865 2064 6566  ption 3. The def
+00004980: 6175 6c74 2069 7320 302e 3030 312e 0d0a  ault is 0.001...
+00004990: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000049a0: 626f 756e 6473 3a20 5b4c 6973 745d 0d0a  bounds: [List]..
+000049b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000049c0: 2020 2020 6120 6c69 7374 206f 6620 6e75      a list of nu
+000049d0: 6d62 6572 2074 6f20 6265 2075 7365 6420  mber to be used 
+000049e0: 6173 2061 2064 6973 6372 6574 6520 626f  as a discrete bo
+000049f0: 756e 6473 2066 6f72 2074 6865 2063 6f6c  unds for the col
+00004a00: 6f72 2073 6361 6c65 2034 2e44 6566 6175  or scale 4.Defau
+00004a10: 6c74 2069 7320 4e6f 6e65 2c0d 0a20 2020  lt is None,..   
+00004a20: 2020 2020 2020 2020 2020 2020 206d 6964               mid
+00004a30: 706f 696e 7420 3a20 5b66 6c6f 6174 5d2c  point : [float],
+00004a40: 206f 7074 696f 6e61 6c0d 0a20 2020 2020   optional..     
+00004a50: 2020 2020 2020 2020 2020 2020 2020 2076                 v
+00004a60: 616c 7565 206e 6565 6465 6420 666f 7220  alue needed for 
+00004a70: 6f70 7469 6f6e 2035 2e20 5468 6520 6465  option 5. The de
+00004a80: 6661 756c 7420 6973 2030 2e0d 0a20 2020  fault is 0...   
+00004a90: 2020 2020 2020 2020 2020 2020 202d 2d2d               ---
+00004aa0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00004ab0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00004ac0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+00004ad0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d0d  ---------------.
+00004ae0: 0a20 2020 2020 2020 2020 2020 2063 6d61  .            cma
+00004af0: 7020 3a20 5b73 7472 5d2c 206f 7074 696f  p : [str], optio
+00004b00: 6e61 6c0d 0a20 2020 2020 2020 2020 2020  nal..           
+00004b10: 2020 2020 2063 6f6c 6f72 2073 7479 6c65       color style
+00004b20: 2e20 5468 6520 6465 6661 756c 7420 6973  . The default is
+00004b30: 2027 636f 6f6c 7761 726d 5f72 272e 0d0a   'coolwarm_r'...
+00004b40: 2020 2020 2020 2020 2020 2020 6469 7370              disp
+00004b50: 6c61 795f 6365 6c6c 5f76 616c 7565 203a  lay_cell_value :
+00004b60: 205b 626f 6f6c 5d0d 0a20 2020 2020 2020   [bool]..       
+00004b70: 2020 2020 2020 2020 2054 7275 6520 6966           True if
+00004b80: 2079 6f75 2077 616e 7420 746f 2064 6973   you want to dis
+00004b90: 706c 6179 2074 6865 2076 616c 7565 7320  play the values 
+00004ba0: 6f66 2074 6865 2063 656c 6c73 2061 7320  of the cells as 
+00004bb0: 6120 7465 7874 0d0a 2020 2020 2020 2020  a text..        
+00004bc0: 2020 2020 6e75 6d5f 7369 7a65 203a 2069      num_size : i
+00004bd0: 6e74 6567 6572 2c20 6f70 7469 6f6e 616c  nteger, optional
+00004be0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00004bf0: 2020 7369 7a65 206f 6620 7468 6520 6e75    size of the nu
+00004c00: 6d62 6572 7320 706c 6f74 7465 6420 696e  mbers plotted in
+00004c10: 746f 7020 6f66 2065 6163 6820 6365 6c6c  top of each cell
+00004c20: 732e 2054 6865 2064 6566 6175 6c74 2069  s. The default i
+00004c30: 7320 382e 0d0a 2020 2020 2020 2020 2020  s 8...          
+00004c40: 2020 6261 636b 6772 6f75 6e64 5f63 6f6c    background_col
+00004c50: 6f72 5f74 6872 6573 686f 6c64 203a 205b  or_threshold : [
+00004c60: 666c 6f61 742f 696e 7465 6765 725d 2c20  float/integer], 
+00004c70: 6f70 7469 6f6e 616c 0d0a 2020 2020 2020  optional..      
+00004c80: 2020 2020 2020 2020 2020 7468 7265 7368            thresh
+00004c90: 6f6c 6420 7661 6c75 6520 6966 2074 6865  old value if the
+00004ca0: 2076 616c 7565 206f 6620 7468 6520 6365   value of the ce
+00004cb0: 6c6c 2069 7320 6772 6561 7465 722c 2074  ll is greater, t
+00004cc0: 6865 2070 6c6f 7474 6564 0d0a 2020 2020  he plotted..    
+00004cd0: 2020 2020 2020 2020 2020 2020 6e75 6d62              numb
+00004ce0: 6572 7320 7769 6c6c 2062 6520 626c 6163  ers will be blac
+00004cf0: 6b20 616e 6420 6966 2073 6d61 6c6c 6572  k and if smaller
+00004d00: 2074 6865 2070 6c6f 7474 6564 206e 756d   the plotted num
+00004d10: 6265 7220 7769 6c6c 2062 6520 7768 6974  ber will be whit
+00004d20: 650d 0a20 2020 2020 2020 2020 2020 2020  e..             
+00004d30: 2020 2069 6620 4e6f 6e65 2067 6976 656e     if None given
+00004d40: 2074 6865 206d 6178 7661 6c75 652f 3220   the maxvalue/2 
+00004d50: 7769 6c6c 2062 6520 636f 6e73 6964 6572  will be consider
+00004d60: 6564 2e20 5468 6520 6465 6661 756c 7420  ed. The default 
+00004d70: 6973 204e 6f6e 652e 0d0a 0d0a 2020 2020  is None.....    
+00004d80: 2020 2020 5265 7475 726e 730d 0a20 2020      Returns..   
+00004d90: 2020 2020 202d 2d2d 2d2d 2d2d 0d0a 2020       -------..  
+00004da0: 2020 2020 2020 6178 6573 3a20 5b66 6967        axes: [fig
+00004db0: 7572 6520 6178 6573 5d2e 0d0a 2020 2020  ure axes]...    
+00004dc0: 2020 2020 2020 2020 7468 6520 6178 6573          the axes
+00004dd0: 206f 6620 7468 6520 6d61 7470 6c6f 746c   of the matplotl
+00004de0: 6962 2066 6967 7572 650d 0a20 2020 2020  ib figure..     
+00004df0: 2020 2066 6967 3a20 5b6d 6174 706c 6f74     fig: [matplot
+00004e00: 6c69 6220 6669 6775 7265 206f 626a 6563  lib figure objec
+00004e10: 745d 0d0a 2020 2020 2020 2020 2020 2020  t]..            
+00004e20: 7468 6520 6669 6775 7265 206f 626a 6563  the figure objec
+00004e30: 740d 0a20 2020 2020 2020 2022 2222 0d0a  t..        """..
+00004e40: 2020 2020 2020 2020 696d 706f 7274 5f63          import_c
+00004e50: 6c65 6f70 6174 7261 280d 0a20 2020 2020  leopatra(..     
+00004e60: 2020 2020 2020 2022 5468 6520 6375 7272         "The curr
+00004e70: 656e 7420 6675 6e63 7269 6f6e 2075 7365  ent funcrion use
+00004e80: 7320 636c 656f 7061 7472 6120 7061 636b  s cleopatra pack
+00004e90: 6167 6520 746f 2066 6f72 2070 6c6f 7474  age to for plott
+00004ea0: 696e 672c 2070 6c65 6173 6520 696e 7374  ing, please inst
+00004eb0: 616c 6c20 6974 206d 616e 7561 6c6c 792c  all it manually,
+00004ec0: 2066 6f72 206d 6f72 6520 696e 666f 2022   for more info "
+00004ed0: 0d0a 2020 2020 2020 2020 2020 2020 2263  ..            "c
+00004ee0: 6865 636b 2068 7474 7073 3a2f 2f67 6974  heck https://git
+00004ef0: 6875 622e 636f 6d2f 5365 7261 7069 6575  hub.com/Serapieu
+00004f00: 6d2d 6f66 2d61 6c65 782f 636c 656f 7061  m-of-alex/cleopa
+00004f10: 7472 6122 0d0a 2020 2020 2020 2020 290d  tra"..        ).
+00004f20: 0a20 2020 2020 2020 2066 726f 6d20 636c  .        from cl
+00004f30: 656f 7061 7472 612e 6172 7261 7920 696d  eopatra.array im
+00004f40: 706f 7274 2041 7272 6179 0d0a 0d0a 2020  port Array....  
+00004f50: 2020 2020 2020 6e6f 5f64 6174 615f 7661        no_data_va
+00004f60: 6c75 6520 3d20 5b6e 702e 6e61 6e20 6966  lue = [np.nan if
+00004f70: 2069 2069 7320 4e6f 6e65 2065 6c73 6520   i is None else 
+00004f80: 6920 666f 7220 6920 696e 2073 656c 662e  i for i in self.
+00004f90: 6e6f 5f64 6174 615f 7661 6c75 655d 0d0a  no_data_value]..
+00004fa0: 2020 2020 2020 2020 6172 7220 3d20 7365          arr = se
+00004fb0: 6c66 2e72 6561 645f 6172 7261 7928 6261  lf.read_array(ba
+00004fc0: 6e64 3d62 616e 6429 0d0a 2020 2020 2020  nd=band)..      
+00004fd0: 2020 2320 6966 2074 6865 2072 6173 7465    # if the raste
+00004fe0: 7220 6861 7320 7468 7265 6520 6261 6e64  r has three band
+00004ff0: 7320 6f72 206d 6f72 652e 0d0a 2020 2020  s or more...    
+00005000: 2020 2020 6966 2073 656c 662e 6261 6e64      if self.band
+00005010: 5f63 6f75 6e74 203e 3d20 333a 0d0a 2020  _count >= 3:..  
+00005020: 2020 2020 2020 2020 2020 6966 2062 616e            if ban
+00005030: 6420 6973 204e 6f6e 653a 0d0a 2020 2020  d is None:..    
+00005040: 2020 2020 2020 2020 2020 2020 6966 2072              if r
+00005050: 6762 2069 7320 4e6f 6e65 3a0d 0a20 2020  gb is None:..   
+00005060: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005070: 2072 6762 203d 205b 332c 2032 2c20 315d   rgb = [3, 2, 1]
+00005080: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00005090: 2020 2320 6669 7273 7420 6d61 6b65 2074    # first make t
+000050a0: 6865 2062 616e 6420 696e 6465 7820 7468  he band index th
+000050b0: 6520 6669 7273 7420 6261 6e64 2069 6e20  e first band in 
+000050c0: 7468 6520 7267 6220 6c69 7374 2028 7265  the rgb list (re
+000050d0: 6420 6261 6e64 290d 0a20 2020 2020 2020  d band)..       
+000050e0: 2020 2020 2020 2020 2062 616e 6420 3d20           band = 
+000050f0: 7267 625b 305d 0d0a 2020 2020 2020 2020  rgb[0]..        
+00005100: 2320 656c 6966 2073 656c 662e 6261 6e64  # elif self.band
+00005110: 5f63 6f75 6e74 203d 3d20 313a 0d0a 2020  _count == 1:..  
+00005120: 2020 2020 2020 2320 2020 2020 6261 6e64        #     band
+00005130: 203d 2030 0d0a 2020 2020 2020 2020 656c   = 0..        el
+00005140: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
+00005150: 2069 6620 6261 6e64 2069 7320 4e6f 6e65   if band is None
+00005160: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00005170: 2020 2062 616e 6420 3d20 300d 0a0d 0a20     band = 0.... 
+00005180: 2020 2020 2020 2065 7863 6c75 6465 5f76         exclude_v
+00005190: 616c 7565 203d 2028 0d0a 2020 2020 2020  alue = (..      
+000051a0: 2020 2020 2020 5b6e 6f5f 6461 7461 5f76        [no_data_v
+000051b0: 616c 7565 5b62 616e 645d 2c20 6578 636c  alue[band], excl
+000051c0: 7564 655f 7661 6c75 655d 0d0a 2020 2020  ude_value]..    
+000051d0: 2020 2020 2020 2020 6966 2065 7863 6c75          if exclu
+000051e0: 6465 5f76 616c 7565 2069 7320 6e6f 7420  de_value is not 
+000051f0: 4e6f 6e65 0d0a 2020 2020 2020 2020 2020  None..          
+00005200: 2020 656c 7365 205b 6e6f 5f64 6174 615f    else [no_data_
+00005210: 7661 6c75 655b 6261 6e64 5d5d 0d0a 2020  value[band]]..  
+00005220: 2020 2020 2020 290d 0a0d 0a20 2020 2020        )....     
+00005230: 2020 2063 6c65 6f20 3d20 4172 7261 7928     cleo = Array(
+00005240: 0d0a 2020 2020 2020 2020 2020 2020 6172  ..            ar
+00005250: 722c 0d0a 2020 2020 2020 2020 2020 2020  r,..            
+00005260: 6578 636c 7564 655f 7661 6c75 653d 6578  exclude_value=ex
+00005270: 636c 7564 655f 7661 6c75 652c 0d0a 2020  clude_value,..  
+00005280: 2020 2020 2020 2020 2020 7267 623d 7267            rgb=rg
+00005290: 622c 0d0a 2020 2020 2020 2020 2020 2020  b,..            
+000052a0: 7375 7266 6163 655f 7265 666c 6563 7461  surface_reflecta
+000052b0: 6e63 653d 7375 7266 6163 655f 7265 666c  nce=surface_refl
+000052c0: 6563 7461 6e63 652c 0d0a 2020 2020 2020  ectance,..      
+000052d0: 2020 2020 2020 6375 746f 6666 3d63 7574        cutoff=cut
+000052e0: 6f66 662c 0d0a 2020 2020 2020 2020 2020  off,..          
+000052f0: 2020 2a2a 6b77 6172 6773 2c0d 0a20 2020    **kwargs,..   
+00005300: 2020 2020 2029 0d0a 2020 2020 2020 2020       )..        
+00005310: 6669 672c 2061 7820 3d20 636c 656f 2e70  fig, ax = cleo.p
+00005320: 6c6f 7428 2a2a 6b77 6172 6773 290d 0a20  lot(**kwargs).. 
+00005330: 2020 2020 2020 2072 6574 7572 6e20 6669         return fi
+00005340: 672c 2061 780d 0a0d 0a20 2020 2064 6566  g, ax....    def
+00005350: 205f 6765 745f 7469 6d65 5f76 6172 6961   _get_time_varia
+00005360: 626c 6528 7365 6c66 293a 0d0a 2020 2020  ble(self):..    
+00005370: 2020 2020 2222 220d 0a0d 0a20 2020 2020      """....     
+00005380: 2020 2052 6574 7572 6e73 0d0a 2020 2020     Returns..    
+00005390: 2020 2020 2d2d 2d2d 2d2d 2d0d 0a0d 0a20      -------.... 
+000053a0: 2020 2020 2020 2022 2222 0d0a 2020 2020         """..    
+000053b0: 2020 2020 2320 7469 6d65 5f76 6172 7320      # time_vars 
+000053c0: 3d20 5b28 692c 2073 656c 662e 6d65 7461  = [(i, self.meta
+000053d0: 5f64 6174 612e 6765 7428 6929 2920 666f  _data.get(i)) fo
+000053e0: 7220 6920 696e 2073 656c 662e 6d65 7461  r i in self.meta
+000053f0: 5f64 6174 612e 6b65 7973 2829 2069 6620  _data.keys() if 
+00005400: 692e 7374 6172 7473 7769 7468 2822 7469  i.startswith("ti
+00005410: 6d65 2229 5d0d 0a20 2020 2020 2020 2023  me")]..        #
+00005420: 2074 696d 655f 7661 725f 6e61 6d65 203d   time_var_name =
+00005430: 2074 696d 655f 7661 7273 5b30 5d5b 305d   time_vars[0][0]
+00005440: 2e73 706c 6974 2822 2322 295b 305d 0d0a  .split("#")[0]..
+00005450: 2020 2020 2020 2020 6578 7472 615f 6469          extra_di
+00005460: 6d20 3d20 7365 6c66 2e6d 6574 615f 6461  m = self.meta_da
+00005470: 7461 2e67 6574 2822 4e45 5443 4446 5f44  ta.get("NETCDF_D
+00005480: 494d 5f45 5854 5241 2229 0d0a 2020 2020  IM_EXTRA")..    
+00005490: 2020 2020 6966 2065 7874 7261 5f64 696d      if extra_dim
+000054a0: 2069 7320 6e6f 7420 4e6f 6e65 3a0d 0a20   is not None:.. 
+000054b0: 2020 2020 2020 2020 2020 2074 696d 655f             time_
+000054c0: 7661 725f 6e61 6d65 203d 2065 7874 7261  var_name = extra
+000054d0: 5f64 696d 2e72 6570 6c61 6365 2822 7b22  _dim.replace("{"
+000054e0: 2c20 2222 292e 7265 706c 6163 6528 227d  , "").replace("}
+000054f0: 222c 2022 2229 0d0a 2020 2020 2020 2020  ", "")..        
+00005500: 2020 2020 756e 6974 7320 3d20 7365 6c66      units = self
+00005510: 2e6d 6574 615f 6461 7461 2e67 6574 2866  .meta_data.get(f
+00005520: 227b 7469 6d65 5f76 6172 5f6e 616d 657d  "{time_var_name}
+00005530: 2375 6e69 7473 2229 0d0a 2020 2020 2020  #units")..      
+00005540: 2020 2020 2020 6675 6e63 203d 2063 7265        func = cre
+00005550: 6174 655f 7469 6d65 5f63 6f6e 7665 7273  ate_time_convers
+00005560: 696f 6e5f 6675 6e63 2875 6e69 7473 290d  ion_func(units).
+00005570: 0a20 2020 2020 2020 2020 2020 2074 696d  .            tim
+00005580: 655f 7661 6c73 203d 2073 656c 662e 5f72  e_vals = self._r
+00005590: 6561 645f 7661 7269 6162 6c65 2874 696d  ead_variable(tim
+000055a0: 655f 7661 725f 6e61 6d65 290d 0a20 2020  e_var_name)..   
+000055b0: 2020 2020 2020 2020 2074 696d 655f 7374           time_st
+000055c0: 616d 7020 3d20 6c69 7374 286d 6170 2866  amp = list(map(f
+000055d0: 756e 632c 2074 696d 655f 7661 6c73 5b30  unc, time_vals[0
+000055e0: 5d29 290d 0a20 2020 2020 2020 2065 6c73  ]))..        els
+000055f0: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
+00005600: 7469 6d65 5f73 7461 6d70 203d 204e 6f6e  time_stamp = Non
+00005610: 650d 0a20 2020 2020 2020 2072 6574 7572  e..        retur
+00005620: 6e20 7469 6d65 5f73 7461 6d70 0d0a 0d0a  n time_stamp....
+00005630: 2020 2020 6465 6620 5f67 6574 5f6c 6174      def _get_lat
+00005640: 5f6c 6f6e 2873 656c 6629 3a0d 0a20 2020  _lon(self):..   
+00005650: 2020 2020 206c 6f6e 203d 2073 656c 662e       lon = self.
+00005660: 5f72 6561 645f 7661 7269 6162 6c65 2822  _read_variable("
+00005670: 6c6f 6e22 290d 0a20 2020 2020 2020 206c  lon")..        l
+00005680: 6174 203d 2073 656c 662e 5f72 6561 645f  at = self._read_
+00005690: 7661 7269 6162 6c65 2822 6c61 7422 290d  variable("lat").
+000056a0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+000056b0: 6c61 742c 206c 6f6e 0d0a 0d0a 2020 2020  lat, lon....    
+000056c0: 6465 6620 5f72 6561 645f 7661 7269 6162  def _read_variab
+000056d0: 6c65 2873 656c 662c 2076 6172 3a20 7374  le(self, var: st
+000056e0: 7229 3a0d 0a20 2020 2020 2020 2072 6574  r):..        ret
+000056f0: 7572 6e20 6764 616c 2e4f 7065 6e28 6622  urn gdal.Open(f"
+00005700: 4e45 5443 4446 3a7b 7365 6c66 2e66 696c  NETCDF:{self.fil
+00005710: 655f 6e61 6d65 7d3a 7b76 6172 7d22 292e  e_name}:{var}").
+00005720: 5265 6164 4173 4172 7261 7928 290d 0a0d  ReadAsArray()...
+00005730: 0a20 2020 2040 7374 6174 6963 6d65 7468  .    @staticmeth
+00005740: 6f64 0d0a 2020 2020 6465 6620 5f63 7265  od..    def _cre
+00005750: 6174 655f 6764 616c 5f64 6174 6173 6574  ate_gdal_dataset
+00005760: 280d 0a20 2020 2020 2020 2063 6f6c 733a  (..        cols:
+00005770: 2069 6e74 2c0d 0a20 2020 2020 2020 2072   int,..        r
+00005780: 6f77 733a 2069 6e74 2c0d 0a20 2020 2020  ows: int,..     
+00005790: 2020 2062 616e 6473 3a20 696e 742c 0d0a     bands: int,..
+000057a0: 2020 2020 2020 2020 6474 7970 653a 2069          dtype: i
+000057b0: 6e74 2c0d 0a20 2020 2020 2020 2064 7269  nt,..        dri
+000057c0: 7665 723a 2073 7472 203d 2022 4d45 4d22  ver: str = "MEM"
+000057d0: 2c0d 0a20 2020 2020 2020 2070 6174 683a  ,..        path:
+000057e0: 2073 7472 203d 204e 6f6e 652c 0d0a 2020   str = None,..  
+000057f0: 2020 2920 2d3e 2067 6461 6c2e 4461 7461    ) -> gdal.Data
+00005800: 7365 743a 0d0a 2020 2020 2020 2020 2222  set:..        ""
+00005810: 2243 7265 6174 6520 4744 414c 2064 7269  "Create GDAL dri
+00005820: 7665 722e 0d0a 0d0a 2020 2020 2020 2020  ver.....        
+00005830: 2020 2020 6372 6561 7465 7320 6120 6472      creates a dr
+00005840: 6976 6572 2061 6e64 2073 6176 6520 6974  iver and save it
+00005850: 2074 6f20 6469 736b 2061 6e64 2069 6e20   to disk and in 
+00005860: 6d65 6d6f 7279 2069 6620 7061 7468 2069  memory if path i
+00005870: 7320 6e6f 7420 6769 7665 6e2e 0d0a 0d0a  s not given.....
+00005880: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
+00005890: 7273 0d0a 2020 2020 2020 2020 2d2d 2d2d  rs..        ----
+000058a0: 2d2d 2d2d 2d2d 0d0a 2020 2020 2020 2020  ------..        
+000058b0: 636f 6c73 3a20 5b69 6e74 5d0d 0a20 2020  cols: [int]..   
+000058c0: 2020 2020 2020 2020 206e 756d 6265 7220           number 
+000058d0: 6f66 2063 6f6c 756d 6e73 2e0d 0a20 2020  of columns...   
+000058e0: 2020 2020 2072 6f77 733a 205b 696e 745d       rows: [int]
+000058f0: 0d0a 2020 2020 2020 2020 2020 2020 6e75  ..            nu
+00005900: 6d62 6572 206f 6620 726f 7773 2e0d 0a20  mber of rows... 
+00005910: 2020 2020 2020 2062 616e 6473 3a20 5b69         bands: [i
+00005920: 6e74 5d0d 0a20 2020 2020 2020 2020 2020  nt]..           
+00005930: 206e 756d 6265 7220 6f66 2062 616e 6473   number of bands
+00005940: 2e0d 0a20 2020 2020 2020 2064 7269 7665  ...        drive
+00005950: 723a 205b 7374 725d 0d0a 2020 2020 2020  r: [str]..      
+00005960: 2020 2020 2020 6472 6976 6572 2074 7970        driver typ
+00005970: 6520 5b22 4754 6966 6622 2c20 224d 454d  e ["GTiff", "MEM
+00005980: 225d 2e0d 0a20 2020 2020 2020 2070 6174  "]...        pat
+00005990: 683a 205b 7374 725d 0d0a 2020 2020 2020  h: [str]..      
+000059a0: 2020 2020 2020 7061 7468 2074 6f20 7361        path to sa
+000059b0: 7665 2074 6865 2047 5469 6666 2064 7269  ve the GTiff dri
+000059c0: 7665 722e 0d0a 2020 2020 2020 2020 6474  ver...        dt
+000059d0: 7970 653a 0d0a 2020 2020 2020 2020 2020  ype:..          
+000059e0: 2020 6764 616c 2064 6174 6120 7479 7065    gdal data type
+000059f0: 2c20 7573 6520 7468 6520 6675 6e63 7469  , use the functi
+00005a00: 6f6e 7320 696e 2074 6865 2075 7469 6c73  ons in the utils
+00005a10: 206d 6f64 756c 6520 746f 206d 6170 2064   module to map d
+00005a20: 6174 6120 7479 7065 7320 6672 6f6d 206e  ata types from n
+00005a30: 756d 7079 206f 7220 6f67 7220 746f 2067  umpy or ogr to g
+00005a40: 6461 6c2e 0d0a 0d0a 2020 2020 2020 2020  dal.....        
+00005a50: 5265 7475 726e 730d 0a20 2020 2020 2020  Returns..       
+00005a60: 202d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020   -------..      
+00005a70: 2020 6764 616c 2064 7269 7665 720d 0a20    gdal driver.. 
+00005a80: 2020 2020 2020 2022 2222 0d0a 2020 2020         """..    
+00005a90: 2020 2020 6966 2070 6174 683a 0d0a 2020      if path:..  
+00005aa0: 2020 2020 2020 2020 2020 6472 6976 6572            driver
+00005ab0: 203d 2022 4754 6966 6622 2069 6620 6472   = "GTiff" if dr
+00005ac0: 6976 6572 203d 3d20 224d 454d 2220 656c  iver == "MEM" el
+00005ad0: 7365 2064 7269 7665 720d 0a20 2020 2020  se driver..     
+00005ae0: 2020 2020 2020 2069 6620 6e6f 7420 6973         if not is
+00005af0: 696e 7374 616e 6365 2870 6174 682c 2073  instance(path, s
+00005b00: 7472 293a 0d0a 2020 2020 2020 2020 2020  tr):..          
+00005b10: 2020 2020 2020 7261 6973 6520 5479 7065        raise Type
+00005b20: 4572 726f 7228 2254 6865 2070 6174 6820  Error("The path 
+00005b30: 696e 7075 7420 7368 6f75 6c64 2062 6520  input should be 
+00005b40: 7374 7269 6e67 2229 0d0a 2020 2020 2020  string")..      
+00005b50: 2020 2020 2020 6966 2064 7269 7665 7220        if driver 
+00005b60: 3d3d 2022 4754 6966 6622 3a0d 0a20 2020  == "GTiff":..   
+00005b70: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00005b80: 6e6f 7420 7061 7468 2e65 6e64 7377 6974  not path.endswit
+00005b90: 6828 222e 7469 6622 293a 0d0a 2020 2020  h(".tif"):..    
+00005ba0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00005bb0: 7261 6973 6520 5479 7065 4572 726f 7228  raise TypeError(
+00005bc0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00005bd0: 2020 2020 2020 2020 2020 2254 6865 2070            "The p
+00005be0: 6174 6820 746f 2073 6176 6520 7468 6520  ath to save the 
+00005bf0: 6372 6561 7465 6420 7261 7374 6572 2073  created raster s
+00005c00: 686f 756c 6420 656e 6420 7769 7468 202e  hould end with .
+00005c10: 7469 6622 0d0a 2020 2020 2020 2020 2020  tif"..          
+00005c20: 2020 2020 2020 2020 2020 290d 0a20 2020            )..   
+00005c30: 2020 2020 2020 2020 2023 204c 5a57 2069           # LZW i
+00005c40: 7320 6120 6c6f 7373 6c65 7373 2063 6f6d  s a lossless com
+00005c50: 7072 6573 7369 6f6e 206d 6574 686f 6420  pression method 
+00005c60: 6163 6869 6576 6520 7468 6520 6869 6768  achieve the high
+00005c70: 7374 2063 6f6d 7072 6573 7369 6f6e 2062  st compression b
+00005c80: 7574 2077 6974 6820 6c6f 7420 6f66 2063  ut with lot of c
+00005c90: 6f6d 7075 7461 7469 6f6e 0d0a 2020 2020  omputation..    
+00005ca0: 2020 2020 2020 2020 7372 6320 3d20 6764          src = gd
+00005cb0: 616c 2e47 6574 4472 6976 6572 4279 4e61  al.GetDriverByNa
+00005cc0: 6d65 2864 7269 7665 7229 2e43 7265 6174  me(driver).Creat
+00005cd0: 6528 0d0a 2020 2020 2020 2020 2020 2020  e(..            
+00005ce0: 2020 2020 7061 7468 2c20 636f 6c73 2c20      path, cols, 
+00005cf0: 726f 7773 2c20 6261 6e64 732c 2064 7479  rows, bands, dty
+00005d00: 7065 2c20 5b22 434f 4d50 5245 5353 3d4c  pe, ["COMPRESS=L
+00005d10: 5a57 225d 0d0a 2020 2020 2020 2020 2020  ZW"]..          
+00005d20: 2020 290d 0a20 2020 2020 2020 2065 6c73    )..        els
+00005d30: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
+00005d40: 2320 666f 7220 6d65 6d6f 7279 2064 7269  # for memory dri
+00005d50: 7665 7273 0d0a 2020 2020 2020 2020 2020  vers..          
+00005d60: 2020 6472 6976 6572 203d 2022 4d45 4d22    driver = "MEM"
+00005d70: 0d0a 2020 2020 2020 2020 2020 2020 7372  ..            sr
+00005d80: 6320 3d20 6764 616c 2e47 6574 4472 6976  c = gdal.GetDriv
+00005d90: 6572 4279 4e61 6d65 2864 7269 7665 7229  erByName(driver)
+00005da0: 2e43 7265 6174 6528 2222 2c20 636f 6c73  .Create("", cols
+00005db0: 2c20 726f 7773 2c20 6261 6e64 732c 2064  , rows, bands, d
+00005dc0: 7479 7065 290d 0a20 2020 2020 2020 2072  type)..        r
+00005dd0: 6574 7572 6e20 7372 630d 0a0d 0a20 2020  eturn src....   
+00005de0: 2040 636c 6173 736d 6574 686f 640d 0a20   @classmethod.. 
+00005df0: 2020 2064 6566 2063 7265 6174 655f 6672     def create_fr
+00005e00: 6f6d 5f61 7272 6179 280d 0a20 2020 2020  om_array(..     
+00005e10: 2020 2063 6c73 2c0d 0a20 2020 2020 2020     cls,..       
+00005e20: 2061 7272 3a20 556e 696f 6e5b 7374 722c   arr: Union[str,
+00005e30: 2067 6461 6c2e 4461 7461 7365 742c 206e   gdal.Dataset, n
+00005e40: 702e 6e64 6172 7261 795d 2c0d 0a20 2020  p.ndarray],..   
+00005e50: 2020 2020 2067 656f 3a20 556e 696f 6e5b       geo: Union[
+00005e60: 7374 722c 2074 7570 6c65 5d2c 0d0a 2020  str, tuple],..  
+00005e70: 2020 2020 2020 6570 7367 3a20 556e 696f        epsg: Unio
+00005e80: 6e5b 7374 722c 2069 6e74 5d2c 0d0a 2020  n[str, int],..  
+00005e90: 2020 2020 2020 6e6f 5f64 6174 615f 7661        no_data_va
+00005ea0: 6c75 653a 2055 6e69 6f6e 5b41 6e79 2c20  lue: Union[Any, 
+00005eb0: 6c69 7374 5d20 3d20 4445 4641 554c 545f  list] = DEFAULT_
+00005ec0: 4e4f 5f44 4154 415f 5641 4c55 452c 0d0a  NO_DATA_VALUE,..
+00005ed0: 2020 2020 293a 0d0a 2020 2020 2020 2020      ):..        
+00005ee0: 2222 2263 7265 6174 655f 7261 7374 6572  """create_raster
+00005ef0: 2e0d 0a0d 0a20 2020 2020 2020 2020 2020  .....           
+00005f00: 202d 2063 7265 6174 655f 7261 7374 6572   - create_raster
+00005f10: 206d 6574 686f 6420 6372 6561 7465 7320   method creates 
+00005f20: 6120 7261 7374 6572 2066 726f 6d20 6120  a raster from a 
+00005f30: 6769 7665 6e20 6172 7261 7920 616e 6420  given array and 
+00005f40: 6765 6f74 7261 6e73 666f 726d 2064 6174  geotransform dat
+00005f50: 610d 0a20 2020 2020 2020 2020 2020 2061  a..            a
+00005f60: 6e64 2073 6176 6520 7468 6520 7469 6620  nd save the tif 
+00005f70: 6669 6c65 2069 6620 6120 5061 7468 2069  file if a Path i
+00005f80: 7320 6769 7665 6e20 6f72 2069 7420 7769  s given or it wi
+00005f90: 6c6c 2072 6574 7572 6e20 7468 6520 6764  ll return the gd
+00005fa0: 616c 2e44 6174 6163 7562 650d 0a0d 0a20  al.Datacube.... 
+00005fb0: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
+00005fc0: 730d 0a20 2020 2020 2020 202d 2d2d 2d2d  s..        -----
+00005fd0: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 2061  -----..        a
+00005fe0: 7272 203a 205b 6172 7261 795d 2c20 6f70  rr : [array], op
+00005ff0: 7469 6f6e 616c 0d0a 2020 2020 2020 2020  tional..        
+00006000: 2020 2020 6e75 6d70 7920 6172 7261 792e      numpy array.
+00006010: 2054 6865 2064 6566 6175 6c74 2069 7320   The default is 
+00006020: 2727 2e0d 0a20 2020 2020 2020 2067 656f  ''...        geo
+00006030: 203a 205b 6c69 7374 5d2c 206f 7074 696f   : [list], optio
+00006040: 6e61 6c0d 0a20 2020 2020 2020 2020 2020  nal..           
+00006050: 2067 656f 7472 616e 7366 6f72 6d20 6c69   geotransform li
+00006060: 7374 205b 6d69 6e69 6d75 6d20 6c6f 6e2c  st [minimum lon,
+00006070: 2070 6978 656c 7369 7a65 2c20 726f 7461   pixelsize, rota
+00006080: 7469 6f6e 2c20 6d61 7869 6d75 6d20 6c61  tion, maximum la
+00006090: 742c 2072 6f74 6174 696f 6e2c 0d0a 2020  t, rotation,..  
+000060a0: 2020 2020 2020 2020 2020 2020 2020 7069                pi
+000060b0: 7865 6c73 697a 655d 2e20 5468 6520 6465  xelsize]. The de
+000060c0: 6661 756c 7420 6973 2027 272e 0d0a 2020  fault is ''...  
+000060d0: 2020 2020 2020 6e6f 5f64 6174 615f 7661        no_data_va
+000060e0: 6c75 6520 3a20 5459 5045 2c20 6f70 7469  lue : TYPE, opti
+000060f0: 6f6e 616c 0d0a 2020 2020 2020 2020 2020  onal..          
+00006100: 2020 4445 5343 5249 5054 494f 4e2e 2054    DESCRIPTION. T
+00006110: 6865 2064 6566 6175 6c74 2069 7320 2d39  he default is -9
+00006120: 3939 392e 0d0a 2020 2020 2020 2020 6570  999...        ep
+00006130: 7367 3a20 5b69 6e74 6567 6572 5d0d 0a20  sg: [integer].. 
+00006140: 2020 2020 2020 2020 2020 2069 6e74 6567             integ
+00006150: 6572 2072 6566 6572 656e 6365 206e 756d  er reference num
+00006160: 6265 7220 746f 2074 6865 206e 6577 2070  ber to the new p
+00006170: 726f 6a65 6374 696f 6e20 2868 7474 7073  rojection (https
+00006180: 3a2f 2f65 7073 672e 696f 2f29 0d0a 2020  ://epsg.io/)..  
+00006190: 2020 2020 2020 2020 2020 2020 2020 2864                (d
+000061a0: 6566 6175 6c74 2033 3835 3720 7468 6520  efault 3857 the 
+000061b0: 7265 6665 7265 6e63 6520 6e6f 206f 6620  reference no of 
+000061c0: 5747 5338 3420 7765 6220 6d65 7263 6174  WGS84 web mercat
+000061d0: 6f72 2029 0d0a 0d0a 2020 2020 2020 2020  or )....        
+000061e0: 5265 7475 726e 730d 0a20 2020 2020 2020  Returns..       
+000061f0: 202d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020   -------..      
+00006200: 2020 6473 7420 3a20 5b44 6174 6153 6574    dst : [DataSet
+00006210: 5d2e 0d0a 2020 2020 2020 2020 2020 2020  ]...            
+00006220: 4461 7461 7365 7420 6f62 6a65 6374 2077  Dataset object w
+00006230: 696c 6c20 6265 2072 6574 7572 6e65 642e  ill be returned.
+00006240: 0d0a 2020 2020 2020 2020 2222 220d 0a20  ..        """.. 
+00006250: 2020 2020 2020 2069 6620 6c65 6e28 6172         if len(ar
+00006260: 722e 7368 6170 6529 203d 3d20 323a 0d0a  r.shape) == 2:..
+00006270: 2020 2020 2020 2020 2020 2020 6261 6e64              band
+00006280: 7320 3d20 310d 0a20 2020 2020 2020 2020  s = 1..         
 00006290: 2020 2072 6f77 7320 3d20 696e 7428 6172     rows = int(ar
-000062a0: 722e 7368 6170 655b 315d 290d 0a20 2020  r.shape[1])..   
+000062a0: 722e 7368 6170 655b 305d 290d 0a20 2020  r.shape[0])..   
 000062b0: 2020 2020 2020 2020 2063 6f6c 7320 3d20           cols = 
-000062c0: 696e 7428 6172 722e 7368 6170 655b 325d  int(arr.shape[2]
-000062d0: 290d 0a0d 0a20 2020 2020 2020 2064 7479  )....        dty
-000062e0: 7065 203d 206e 756d 7079 5f74 6f5f 6764  pe = numpy_to_gd
-000062f0: 616c 5f64 7479 7065 2861 7272 290d 0a20  al_dtype(arr).. 
-00006300: 2020 2020 2020 2064 7374 5f64 7320 3d20         dst_ds = 
-00006310: 4461 7461 7365 742e 5f63 7265 6174 655f  Dataset._create_
-00006320: 6764 616c 5f64 6174 6173 6574 280d 0a20  gdal_dataset(.. 
-00006330: 2020 2020 2020 2020 2020 2063 6f6c 732c             cols,
-00006340: 2072 6f77 732c 2062 616e 6473 2c20 6474   rows, bands, dt
-00006350: 7970 652c 2064 7269 7665 723d 224d 454d  ype, driver="MEM
-00006360: 222c 2070 6174 683d 4e6f 6e65 0d0a 2020  ", path=None..  
-00006370: 2020 2020 2020 290d 0a0d 0a20 2020 2020        )....     
-00006380: 2020 2073 7273 6520 3d20 4461 7461 7365     srse = Datase
-00006390: 742e 5f63 7265 6174 655f 7372 5f66 726f  t._create_sr_fro
-000063a0: 6d5f 6570 7367 2865 7073 673d 6570 7367  m_epsg(epsg=epsg
-000063b0: 290d 0a20 2020 2020 2020 2064 7374 5f64  )..        dst_d
-000063c0: 732e 5365 7450 726f 6a65 6374 696f 6e28  s.SetProjection(
-000063d0: 7372 7365 2e45 7870 6f72 7454 6f57 6b74  srse.ExportToWkt
-000063e0: 2829 290d 0a20 2020 2020 2020 2064 7374  ())..        dst
-000063f0: 5f6f 626a 203d 2063 6c73 2864 7374 5f64  _obj = cls(dst_d
-00006400: 7329 0d0a 2020 2020 2020 2020 6473 745f  s)..        dst_
-00006410: 6f62 6a2e 5f73 6574 5f6e 6f5f 6461 7461  obj._set_no_data
-00006420: 5f76 616c 7565 286e 6f5f 6461 7461 5f76  _value(no_data_v
-00006430: 616c 7565 3d6e 6f5f 6461 7461 5f76 616c  alue=no_data_val
-00006440: 7565 290d 0a0d 0a20 2020 2020 2020 2064  ue)....        d
-00006450: 7374 5f6f 626a 2e72 6173 7465 722e 5365  st_obj.raster.Se
-00006460: 7447 656f 5472 616e 7366 6f72 6d28 6765  tGeoTransform(ge
-00006470: 6f29 0d0a 2020 2020 2020 2020 6966 2062  o)..        if b
-00006480: 616e 6473 203d 3d20 313a 0d0a 2020 2020  ands == 1:..    
-00006490: 2020 2020 2020 2020 6473 745f 6f62 6a2e          dst_obj.
-000064a0: 7261 7374 6572 2e47 6574 5261 7374 6572  raster.GetRaster
-000064b0: 4261 6e64 2831 292e 5772 6974 6541 7272  Band(1).WriteArr
-000064c0: 6179 2861 7272 290d 0a20 2020 2020 2020  ay(arr)..       
-000064d0: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
-000064e0: 2020 2020 666f 7220 6920 696e 2072 616e      for i in ran
-000064f0: 6765 2862 616e 6473 293a 0d0a 2020 2020  ge(bands):..    
-00006500: 2020 2020 2020 2020 2020 2020 6473 745f              dst_
-00006510: 6f62 6a2e 7261 7374 6572 2e47 6574 5261  obj.raster.GetRa
-00006520: 7374 6572 4261 6e64 2869 202b 2031 292e  sterBand(i + 1).
-00006530: 5772 6974 6541 7272 6179 2861 7272 5b69  WriteArray(arr[i
-00006540: 2c20 3a2c 203a 5d29 0d0a 0d0a 2020 2020  , :, :])....    
-00006550: 2020 2020 7265 7475 726e 2064 7374 5f6f      return dst_o
-00006560: 626a 0d0a 0d0a 2020 2020 4063 6c61 7373  bj....    @class
-00006570: 6d65 7468 6f64 0d0a 2020 2020 6465 6620  method..    def 
-00006580: 6461 7461 7365 745f 6c69 6b65 280d 0a20  dataset_like(.. 
-00006590: 2020 2020 2020 2063 6c73 2c0d 0a20 2020         cls,..   
-000065a0: 2020 2020 2073 7263 2c0d 0a20 2020 2020       src,..     
-000065b0: 2020 2061 7272 6179 3a20 6e70 2e6e 6461     array: np.nda
-000065c0: 7272 6179 2c0d 0a20 2020 2020 2020 2064  rray,..        d
-000065d0: 7269 7665 723a 2073 7472 203d 2022 4d45  river: str = "ME
-000065e0: 4d22 2c0d 0a20 2020 2020 2020 2070 6174  M",..        pat
-000065f0: 683a 2073 7472 203d 204e 6f6e 652c 0d0a  h: str = None,..
-00006600: 2020 2020 2920 2d3e 2055 6e69 6f6e 5b67      ) -> Union[g
-00006610: 6461 6c2e 4461 7461 7365 742c 204e 6f6e  dal.Dataset, Non
-00006620: 655d 3a0d 0a20 2020 2020 2020 2022 2222  e]:..        """
-00006630: 7261 7374 6572 4c69 6b65 2e0d 0a0d 0a20  rasterLike..... 
-00006640: 2020 2020 2020 2072 6173 7465 724c 696b         rasterLik
-00006650: 6520 6d65 7468 6f64 2063 7265 6174 6573  e method creates
-00006660: 2061 2047 656f 7469 6666 2072 6173 7465   a Geotiff raste
-00006670: 7220 6c69 6b65 2061 6e6f 7468 6572 2069  r like another i
-00006680: 6e70 7574 2072 6173 7465 722c 206e 6577  nput raster, new
-00006690: 2072 6173 7465 720d 0a20 2020 2020 2020   raster..       
-000066a0: 2077 696c 6c20 6861 7665 2074 6865 2073   will have the s
-000066b0: 616d 6520 7072 6f6a 6563 7469 6f6e 2c20  ame projection, 
-000066c0: 636f 6f72 6469 6e61 7465 7320 6f72 2074  coordinates or t
-000066d0: 6865 2074 6f70 206c 6566 7420 636f 726e  he top left corn
-000066e0: 6572 206f 6620 7468 6520 6f72 6967 696e  er of the origin
-000066f0: 616c 0d0a 2020 2020 2020 2020 7261 7374  al..        rast
-00006700: 6572 2c20 6365 6c6c 2073 697a 652c 206e  er, cell size, n
-00006710: 6f64 6174 6120 7665 6c75 652c 2061 6e64  odata velue, and
-00006720: 206e 756d 6265 7220 6f66 2072 6f77 7320   number of rows 
-00006730: 616e 6420 636f 6c75 6d6e 730d 0a20 2020  and columns..   
-00006740: 2020 2020 2074 6865 2072 6173 7465 7220       the raster 
-00006750: 616e 6420 7468 6520 6465 6d20 7368 6f75  and the dem shou
-00006760: 6c64 2068 6176 6520 7468 6520 7361 6d65  ld have the same
-00006770: 206e 756d 6265 7220 6f66 2063 6f6c 756d   number of colum
-00006780: 6e73 2061 6e64 2072 6f77 730d 0a0d 0a20  ns and rows.... 
-00006790: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
-000067a0: 730d 0a20 2020 2020 2020 202d 2d2d 2d2d  s..        -----
-000067b0: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 2073  -----..        s
-000067c0: 7263 203a 205b 6764 616c 2e64 6174 6173  rc : [gdal.datas
-000067d0: 6574 5d0d 0a20 2020 2020 2020 2020 2020  et]..           
-000067e0: 2073 6f75 7263 6520 7261 7374 6572 2074   source raster t
-000067f0: 6f20 6765 7420 7468 6520 7370 6174 6961  o get the spatia
-00006800: 6c20 696e 666f 726d 6174 696f 6e0d 0a20  l information.. 
-00006810: 2020 2020 2020 2061 7272 6179 203a 205b         array : [
-00006820: 6e75 6d70 7920 6172 7261 795d 0d0a 2020  numpy array]..  
-00006830: 2020 2020 2020 2020 2020 746f 2073 746f            to sto
-00006840: 7265 2069 6e20 7468 6520 6e65 7720 7261  re in the new ra
-00006850: 7374 6572 0d0a 2020 2020 2020 2020 6472  ster..        dr
-00006860: 6976 6572 3a5b 7374 725d 0d0a 2020 2020  iver:[str]..    
-00006870: 2020 2020 2020 2020 6764 616c 2064 7269          gdal dri
-00006880: 7665 7220 7479 7065 2e20 4465 6661 756c  ver type. Defaul
-00006890: 7420 6973 2022 4754 6966 6622 0d0a 2020  t is "GTiff"..  
-000068a0: 2020 2020 2020 7061 7468 203a 205b 5374        path : [St
-000068b0: 7269 6e67 5d0d 0a20 2020 2020 2020 2020  ring]..         
-000068c0: 2020 2070 6174 6820 746f 2073 6176 6520     path to save 
-000068d0: 7468 6520 6e65 7720 7261 7374 6572 2069  the new raster i
-000068e0: 6e63 6c75 6469 6e67 206e 6577 2072 6173  ncluding new ras
-000068f0: 7465 7220 6e61 6d65 2061 6e64 2065 7874  ter name and ext
-00006900: 656e 7369 6f6e 2028 2e74 6966 290d 0a0d  ension (.tif)...
-00006910: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
-00006920: 0d0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ..        ------
-00006930: 2d0d 0a20 2020 2020 2020 204e 6f6e 653a  -..        None:
-00006940: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
-00006950: 2074 6865 2064 7269 7665 7220 6973 2022   the driver is "
-00006960: 4754 6966 6622 2074 6865 2066 756e 6374  GTiff" the funct
-00006970: 696f 6e20 7769 6c6c 2073 6176 6520 7468  ion will save th
-00006980: 6520 6e65 7720 7261 7374 6572 2074 6f20  e new raster to 
-00006990: 7468 6520 6769 7665 6e20 7061 7468 2e0d  the given path..
-000069a0: 0a20 2020 2020 2020 2044 6174 6163 7562  .        Datacub
-000069b0: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-000069c0: 6966 2074 6865 2064 7269 7665 7220 6973  if the driver is
-000069d0: 2022 4d45 4d22 2074 6865 2066 756e 6374   "MEM" the funct
-000069e0: 696f 6e20 7769 6c6c 2072 6574 7572 6e20  ion will return 
-000069f0: 7468 6520 6372 6561 7465 6420 7261 7374  the created rast
-00006a00: 6572 2069 6e20 6d65 6d6f 7279 2e0d 0a0d  er in memory....
-00006a10: 0a20 2020 2020 2020 2045 7861 6d70 6c65  .        Example
-00006a20: 0d0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ..        ------
-00006a30: 2d0d 0a20 2020 2020 2020 203e 3e3e 2061  -..        >>> a
-00006a40: 7272 6179 203d 206e 702e 6c6f 6164 2822  rray = np.load("
-00006a50: 5241 494e 5f35 6b2e 6e70 7922 290d 0a20  RAIN_5k.npy").. 
-00006a60: 2020 2020 2020 203e 3e3e 2073 7263 203d         >>> src =
-00006a70: 2067 6461 6c2e 4f70 656e 2822 4445 4d2e   gdal.Open("DEM.
-00006a80: 7469 6622 290d 0a20 2020 2020 2020 203e  tif")..        >
-00006a90: 3e3e 206e 616d 6520 3d20 2272 6169 6e2e  >> name = "rain.
-00006aa0: 7469 6622 0d0a 2020 2020 2020 2020 3e3e  tif"..        >>
-00006ab0: 3e20 4461 7461 7365 742e 6461 7461 7365  > Dataset.datase
-00006ac0: 745f 6c69 6b65 2873 7263 2c20 6172 7261  t_like(src, arra
-00006ad0: 792c 2064 7269 7665 723d 2247 5469 6666  y, driver="GTiff
-00006ae0: 222c 2070 6174 683d 6e61 6d65 290d 0a20  ", path=name).. 
-00006af0: 2020 2020 2020 202d 206f 7220 6372 6561         - or crea
-00006b00: 7465 2061 2072 6173 7465 7220 696e 206d  te a raster in m
-00006b10: 656d 6f72 790d 0a20 2020 2020 2020 203e  emory..        >
-00006b20: 3e3e 2061 7272 6179 203d 206e 702e 6c6f  >> array = np.lo
-00006b30: 6164 2822 5241 494e 5f35 6b2e 6e70 7922  ad("RAIN_5k.npy"
-00006b40: 290d 0a20 2020 2020 2020 203e 3e3e 2073  )..        >>> s
-00006b50: 7263 203d 2067 6461 6c2e 4f70 656e 2822  rc = gdal.Open("
-00006b60: 4445 4d2e 7469 6622 290d 0a20 2020 2020  DEM.tif")..     
-00006b70: 2020 203e 3e3e 2064 7374 203d 2044 6174     >>> dst = Dat
-00006b80: 6173 6574 2e64 6174 6173 6574 5f6c 696b  aset.dataset_lik
-00006b90: 6528 7372 632c 2061 7272 6179 2c20 6472  e(src, array, dr
-00006ba0: 6976 6572 3d22 4d45 4d22 290d 0a20 2020  iver="MEM")..   
-00006bb0: 2020 2020 2022 2222 0d0a 2020 2020 2020       """..      
-00006bc0: 2020 6966 206e 6f74 2069 7369 6e73 7461    if not isinsta
-00006bd0: 6e63 6528 6172 7261 792c 206e 702e 6e64  nce(array, np.nd
-00006be0: 6172 7261 7929 3a0d 0a20 2020 2020 2020  array):..       
-00006bf0: 2020 2020 2072 6169 7365 2054 7970 6545       raise TypeE
-00006c00: 7272 6f72 2822 6172 7261 7920 7368 6f75  rror("array shou
-00006c10: 6c64 2062 6520 6f66 2074 7970 6520 6e75  ld be of type nu
-00006c20: 6d70 7920 6172 7261 7922 290d 0a0d 0a20  mpy array").... 
-00006c30: 2020 2020 2020 2069 6620 6c65 6e28 6172         if len(ar
-00006c40: 7261 792e 7368 6170 6529 203d 3d20 323a  ray.shape) == 2:
-00006c50: 0d0a 2020 2020 2020 2020 2020 2020 6261  ..            ba
-00006c60: 6e64 7320 3d20 310d 0a20 2020 2020 2020  nds = 1..       
-00006c70: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
-00006c80: 2020 2020 6261 6e64 7320 3d20 6172 7261      bands = arra
-00006c90: 792e 7368 6170 655b 305d 0d0a 0d0a 2020  y.shape[0]....  
-00006ca0: 2020 2020 2020 6474 7970 6520 3d20 6e75        dtype = nu
-00006cb0: 6d70 795f 746f 5f67 6461 6c5f 6474 7970  mpy_to_gdal_dtyp
-00006cc0: 6528 6172 7261 7929 0d0a 0d0a 2020 2020  e(array)....    
-00006cd0: 2020 2020 6473 7420 3d20 4461 7461 7365      dst = Datase
-00006ce0: 742e 5f63 7265 6174 655f 6764 616c 5f64  t._create_gdal_d
-00006cf0: 6174 6173 6574 280d 0a20 2020 2020 2020  ataset(..       
-00006d00: 2020 2020 2073 7263 2e63 6f6c 756d 6e73       src.columns
-00006d10: 2c20 7372 632e 726f 7773 2c20 6261 6e64  , src.rows, band
-00006d20: 732c 2064 7479 7065 2c20 6472 6976 6572  s, dtype, driver
-00006d30: 3d64 7269 7665 722c 2070 6174 683d 7061  =driver, path=pa
-00006d40: 7468 0d0a 2020 2020 2020 2020 290d 0a0d  th..        )...
-00006d50: 0a20 2020 2020 2020 2064 7374 2e53 6574  .        dst.Set
-00006d60: 4765 6f54 7261 6e73 666f 726d 2873 7263  GeoTransform(src
-00006d70: 2e67 656f 7472 616e 7366 6f72 6d29 0d0a  .geotransform)..
-00006d80: 2020 2020 2020 2020 6473 742e 5365 7450          dst.SetP
-00006d90: 726f 6a65 6374 696f 6e28 7372 632e 6372  rojection(src.cr
-00006da0: 7329 0d0a 2020 2020 2020 2020 2320 7365  s)..        # se
-00006db0: 7474 696e 6720 7468 6520 4e6f 4461 7461  tting the NoData
-00006dc0: 5661 6c75 6520 646f 6573 206e 6f74 2061  Value does not a
-00006dd0: 6363 6570 7420 646f 7562 6c65 2070 7265  ccept double pre
-00006de0: 6369 7369 6f6e 206e 756d 6265 7273 0d0a  cision numbers..
-00006df0: 2020 2020 2020 2020 6473 745f 6f62 6a20          dst_obj 
-00006e00: 3d20 636c 7328 6473 7429 0d0a 2020 2020  = cls(dst)..    
-00006e10: 2020 2020 6473 745f 6f62 6a2e 5f73 6574      dst_obj._set
-00006e20: 5f6e 6f5f 6461 7461 5f76 616c 7565 286e  _no_data_value(n
-00006e30: 6f5f 6461 7461 5f76 616c 7565 3d73 7263  o_data_value=src
-00006e40: 2e6e 6f5f 6461 7461 5f76 616c 7565 5b30  .no_data_value[0
-00006e50: 5d29 0d0a 0d0a 2020 2020 2020 2020 6473  ])....        ds
-00006e60: 745f 6f62 6a2e 7261 7374 6572 2e47 6574  t_obj.raster.Get
-00006e70: 5261 7374 6572 4261 6e64 2831 292e 5772  RasterBand(1).Wr
-00006e80: 6974 6541 7272 6179 2861 7272 6179 290d  iteArray(array).
-00006e90: 0a20 2020 2020 2020 2069 6620 7061 7468  .        if path
-00006ea0: 2069 7320 6e6f 7420 4e6f 6e65 3a0d 0a20   is not None:.. 
-00006eb0: 2020 2020 2020 2020 2020 2064 7374 5f6f             dst_o
-00006ec0: 626a 2e72 6173 7465 722e 466c 7573 6843  bj.raster.FlushC
-00006ed0: 6163 6865 2829 0d0a 2020 2020 2020 2020  ache()..        
-00006ee0: 2020 2020 6473 745f 6f62 6a20 3d20 4e6f      dst_obj = No
-00006ef0: 6e65 0d0a 0d0a 2020 2020 2020 2020 7265  ne....        re
-00006f00: 7475 726e 2064 7374 5f6f 626a 0d0a 0d0a  turn dst_obj....
-00006f10: 2020 2020 6465 6620 5f67 6574 5f63 7273      def _get_crs
-00006f20: 2873 656c 6629 202d 3e20 7374 723a 0d0a  (self) -> str:..
-00006f30: 2020 2020 2020 2020 2222 2247 6574 2063          """Get c
-00006f40: 6f6f 7264 696e 6174 6520 7265 6665 7265  oordinate refere
-00006f50: 6e63 6520 7379 7374 656d 2e22 2222 0d0a  nce system."""..
-00006f60: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-00006f70: 656c 662e 7261 7374 6572 2e47 6574 5072  elf.raster.GetPr
-00006f80: 6f6a 6563 7469 6f6e 2829 0d0a 0d0a 2020  ojection()....  
-00006f90: 2020 6465 6620 7365 745f 6372 7328 7365    def set_crs(se
-00006fa0: 6c66 2c20 6372 733a 204f 7074 696f 6e61  lf, crs: Optiona
-00006fb0: 6c20 3d20 4e6f 6e65 2c20 6570 7367 3a20  l = None, epsg: 
-00006fc0: 696e 7420 3d20 4e6f 6e65 293a 0d0a 2020  int = None):..  
-00006fd0: 2020 2020 2020 2222 2273 6574 5f63 7273        """set_crs
-00006fe0: 2e0d 0a0d 0a20 2020 2020 2020 2020 2020  .....           
-00006ff0: 2053 6574 2074 6865 2043 6f6f 7264 696e   Set the Coordin
-00007000: 6174 6520 5265 6665 7265 6e63 6520 5379  ate Reference Sy
-00007010: 7374 656d 2028 4352 5329 206f 6620 610d  stem (CRS) of a.
-00007020: 0a0d 0a20 2020 2020 2020 2050 6172 616d  ...        Param
-00007030: 6574 6572 730d 0a20 2020 2020 2020 202d  eters..        -
-00007040: 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020  ---------..     
-00007050: 2020 2063 7273 3a20 5b73 7472 5d0d 0a20     crs: [str].. 
-00007060: 2020 2020 2020 2020 2020 206f 7074 696f             optio
-00007070: 6e61 6c20 6966 2065 7073 6720 6973 2073  nal if epsg is s
-00007080: 7065 6369 6669 6564 0d0a 2020 2020 2020  pecified..      
-00007090: 2020 2020 2020 574b 5420 7374 7269 6e67        WKT string
-000070a0: 2e0d 0a20 2020 2020 2020 2020 2020 2069  ...            i
-000070b0: 2e65 2e20 2747 454f 4743 535b 2257 4753  .e. 'GEOGCS["WGS
-000070c0: 2038 3422 2c44 4154 554d 5b22 5747 535f   84",DATUM["WGS_
-000070d0: 3139 3834 222c 5350 4845 524f 4944 5b22  1984",SPHEROID["
-000070e0: 5747 5320 3834 222c 3633 3738 3133 372c  WGS 84",6378137,
-000070f0: 3239 382e 3235 3732 3233 3536 332c 4155  298.257223563,AU
-00007100: 5448 4f52 4954 595b 2245 5053 4722 2c22  THORITY["EPSG","
-00007110: 3730 3330 225d 5d2c 0d0a 2020 2020 2020  7030"]],..      
-00007120: 2020 2020 2020 4155 5448 4f52 4954 595b        AUTHORITY[
-00007130: 2245 5053 4722 2c22 3633 3236 225d 5d2c  "EPSG","6326"]],
-00007140: 5052 494d 454d 5b22 4772 6565 6e77 6963  PRIMEM["Greenwic
-00007150: 6822 2c30 2c41 5554 484f 5249 5459 5b22  h",0,AUTHORITY["
-00007160: 4550 5347 222c 2238 3930 3122 5d5d 2c55  EPSG","8901"]],U
-00007170: 4e49 545b 2264 6567 7265 6522 2c0d 0a20  NIT["degree",.. 
-00007180: 2020 2020 2020 2020 2020 2030 2e30 3137             0.017
-00007190: 3435 3332 3932 3531 3939 3433 332c 4155  4532925199433,AU
-000071a0: 5448 4f52 4954 595b 2245 5053 4722 2c22  THORITY["EPSG","
-000071b0: 3931 3232 225d 5d2c 4158 4953 5b22 4c61  9122"]],AXIS["La
-000071c0: 7469 7475 6465 222c 4e4f 5254 485d 2c41  titude",NORTH],A
-000071d0: 5849 535b 224c 6f6e 6769 7475 6465 222c  XIS["Longitude",
-000071e0: 4541 5354 5d2c 4155 5448 4f52 4954 595b  EAST],AUTHORITY[
-000071f0: 2245 5053 4722 2c22 3433 3236 225d 5d27  "EPSG","4326"]]'
-00007200: 0d0a 2020 2020 2020 2020 6570 7367 3a20  ..        epsg: 
-00007210: 5b69 6e74 5d0d 0a20 2020 2020 2020 2020  [int]..         
-00007220: 2020 206f 7074 696f 6e61 6c20 6966 2063     optional if c
-00007230: 7273 2069 7320 7370 6563 6966 6965 640d  rs is specified.
-00007240: 0a20 2020 2020 2020 2020 2020 2045 5053  .            EPS
-00007250: 4720 636f 6465 2073 7065 6369 6679 696e  G code specifyin
-00007260: 6720 7468 6520 7072 6f6a 6563 7469 6f6e  g the projection
-00007270: 2e0d 0a20 2020 2020 2020 2022 2222 0d0a  ...        """..
-00007280: 2020 2020 2020 2020 2320 6669 7273 7420          # first 
-00007290: 6368 616e 6765 2074 6865 2070 726f 6a65  change the proje
-000072a0: 6374 696f 6e20 6f66 2074 6865 2067 6461  ction of the gda
-000072b0: 6c20 6461 7461 7365 7420 6f62 6a65 6374  l dataset object
-000072c0: 0d0a 2020 2020 2020 2020 2320 7365 636f  ..        # seco
-000072d0: 6e64 2063 6861 6e67 6520 7468 6520 6570  nd change the ep
-000072e0: 7367 2061 7474 7269 6275 7465 206f 6620  sg attribute of 
-000072f0: 7468 6520 4461 7461 7365 7420 6f62 6a65  the Dataset obje
-00007300: 6374 0d0a 2020 2020 2020 2020 6966 2073  ct..        if s
-00007310: 656c 662e 6472 6976 6572 5f74 7970 6520  elf.driver_type 
-00007320: 3d3d 2022 6173 6369 6922 3a0d 0a20 2020  == "ascii":..   
-00007330: 2020 2020 2020 2020 2072 6169 7365 2054           raise T
-00007340: 7970 6545 7272 6f72 280d 0a20 2020 2020  ypeError(..     
-00007350: 2020 2020 2020 2020 2020 2022 5365 7474             "Sett
-00007360: 696e 6720 4352 5320 666f 7220 4153 4349  ing CRS for ASCI
-00007370: 4920 6669 6c65 2069 7320 6e6f 7420 706f  I file is not po
-00007380: 7373 6962 6c65 2c20 796f 7520 6361 6e20  ssible, you can 
-00007390: 7361 7665 2074 6865 2066 696c 6573 2074  save the files t
-000073a0: 6f20 6120 6765 6f74 6966 6620 616e 6420  o a geotiff and 
-000073b0: 7468 656e 2072 6573 6574 2074 6865 2063  then reset the c
-000073c0: 7273 220d 0a20 2020 2020 2020 2020 2020  rs"..           
-000073d0: 2029 0d0a 2020 2020 2020 2020 656c 7365   )..        else
-000073e0: 3a0d 0a20 2020 2020 2020 2020 2020 2069  :..            i
-000073f0: 6620 6372 7320 6973 206e 6f74 204e 6f6e  f crs is not Non
-00007400: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-00007410: 2020 2020 7365 6c66 2e72 6173 7465 722e      self.raster.
-00007420: 5365 7450 726f 6a65 6374 696f 6e28 6372  SetProjection(cr
-00007430: 7329 0d0a 2020 2020 2020 2020 2020 2020  s)..            
-00007440: 2020 2020 7365 6c66 2e5f 6570 7367 203d      self._epsg =
-00007450: 2046 6561 7475 7265 436f 6c6c 6563 7469   FeatureCollecti
-00007460: 6f6e 2e67 6574 5f65 7073 675f 6672 6f6d  on.get_epsg_from
-00007470: 5f50 726a 2863 7273 290d 0a20 2020 2020  _Prj(crs)..     
-00007480: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
-00007490: 2020 2020 2020 2020 2020 2020 2020 7372                sr
-000074a0: 203d 2044 6174 6173 6574 2e5f 6372 6561   = Dataset._crea
-000074b0: 7465 5f73 725f 6672 6f6d 5f65 7073 6728  te_sr_from_epsg(
-000074c0: 6570 7367 290d 0a20 2020 2020 2020 2020  epsg)..         
-000074d0: 2020 2020 2020 2073 656c 662e 7261 7374         self.rast
-000074e0: 6572 2e53 6574 5072 6f6a 6563 7469 6f6e  er.SetProjection
-000074f0: 2873 722e 4578 706f 7274 546f 576b 7428  (sr.ExportToWkt(
-00007500: 2929 0d0a 2020 2020 2020 2020 2020 2020  ))..            
-00007510: 2020 2020 7365 6c66 2e5f 6570 7367 203d      self._epsg =
-00007520: 2065 7073 670d 0a0d 0a20 2020 2064 6566   epsg....    def
-00007530: 205f 6765 745f 6570 7367 2873 656c 6629   _get_epsg(self)
-00007540: 202d 3e20 696e 743a 0d0a 2020 2020 2020   -> int:..      
-00007550: 2020 2222 2247 6574 4550 5347 2e0d 0a0d    """GetEPSG....
-00007560: 0a20 2020 2020 2020 2020 2020 2054 6869  .            Thi
-00007570: 7320 6675 6e63 7469 6f6e 2072 6561 6473  s function reads
-00007580: 2074 6865 2070 726f 6a65 6374 696f 6e20   the projection 
-00007590: 6f66 2061 2047 454f 4743 5320 6669 6c65  of a GEOGCS file
-000075a0: 206f 7220 7469 6666 2066 696c 650d 0a0d   or tiff file...
-000075b0: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
-000075c0: 0d0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ..        ------
-000075d0: 2d0d 0a20 2020 2020 2020 2065 7073 6720  -..        epsg 
-000075e0: 3a20 5b69 6e74 6567 6572 5d0d 0a20 2020  : [integer]..   
-000075f0: 2020 2020 2020 2020 2065 7073 6720 6e75           epsg nu
-00007600: 6d62 6572 0d0a 2020 2020 2020 2020 2222  mber..        ""
-00007610: 220d 0a20 2020 2020 2020 2070 726a 203d  "..        prj =
-00007620: 2073 656c 662e 5f67 6574 5f63 7273 2829   self._get_crs()
-00007630: 0d0a 2020 2020 2020 2020 6570 7367 203d  ..        epsg =
-00007640: 2046 6561 7475 7265 436f 6c6c 6563 7469   FeatureCollecti
-00007650: 6f6e 2e67 6574 5f65 7073 675f 6672 6f6d  on.get_epsg_from
-00007660: 5f50 726a 2870 726a 290d 0a0d 0a20 2020  _Prj(prj)....   
-00007670: 2020 2020 2072 6574 7572 6e20 6570 7367       return epsg
-00007680: 0d0a 0d0a 2020 2020 6465 6620 6765 745f  ....    def get_
-00007690: 7661 7269 6162 6c65 7328 7365 6c66 293a  variables(self):
-000076a0: 0d0a 2020 2020 2020 2020 2222 220d 0a0d  ..        """...
-000076b0: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
-000076c0: 0d0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ..        ------
-000076d0: 2d0d 0a0d 0a20 2020 2020 2020 2022 2222  -....        """
-000076e0: 0d0a 2020 2020 2020 2020 7661 7269 6162  ..        variab
-000076f0: 6c65 7320 3d20 7b7d 0d0a 2020 2020 2020  les = {}..      
-00007700: 2020 666f 7220 692c 2076 6172 2069 6e20    for i, var in 
-00007710: 656e 756d 6572 6174 6528 7365 6c66 2e73  enumerate(self.s
-00007720: 7562 7365 7473 293a 0d0a 2020 2020 2020  ubsets):..      
-00007730: 2020 2020 2020 6e61 6d65 203d 2076 6172        name = var
-00007740: 5b31 5d2e 7370 6c69 7428 2220 2229 5b31  [1].split(" ")[1
-00007750: 5d0d 0a20 2020 2020 2020 2020 2020 2073  ]..            s
-00007760: 7263 203d 2067 6461 6c2e 4f70 656e 2873  rc = gdal.Open(s
-00007770: 656c 662e 7375 6273 6574 735b 695d 5b30  elf.subsets[i][0
-00007780: 5d29 0d0a 2020 2020 2020 2020 2020 2020  ])..            
-00007790: 7661 7269 6162 6c65 735b 6e61 6d65 5d20  variables[name] 
-000077a0: 3d20 4461 7461 7365 7428 7372 6329 0d0a  = Dataset(src)..
-000077b0: 0d0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-000077c0: 2076 6172 6961 626c 6573 0d0a 0d0a 2020   variables....  
-000077d0: 2020 6465 6620 636f 756e 745f 646f 6d61    def count_doma
-000077e0: 696e 5f63 656c 6c73 2873 656c 6629 3a0d  in_cells(self):.
-000077f0: 0a20 2020 2020 2020 2022 2222 436f 756e  .        """Coun
-00007800: 7420 6365 6c6c 7320 696e 7369 6465 2074  t cells inside t
-00007810: 6865 2064 6f6d 6169 6e0d 0a0d 0a20 2020  he domain....   
-00007820: 2020 2020 2052 6574 7572 6e73 0d0a 2020       Returns..  
-00007830: 2020 2020 2020 2d2d 2d2d 2d2d 2d0d 0a20        -------.. 
-00007840: 2020 2020 2020 2069 6e74 3a0d 0a20 2020         int:..   
-00007850: 2020 2020 2020 2020 204e 756d 6265 7220           Number 
-00007860: 6f66 2063 656c 6c73 0d0a 2020 2020 2020  of cells..      
-00007870: 2020 2222 220d 0a20 2020 2020 2020 2023    """..        #
-00007880: 2063 6f75 6e74 2063 656c 6c73 2069 6e73   count cells ins
-00007890: 6964 6520 7468 6520 646f 6d61 696e 0d0a  ide the domain..
-000078a0: 2020 2020 2020 2020 6172 7220 3d20 7365          arr = se
-000078b0: 6c66 2e72 6173 7465 722e 5265 6164 4173  lf.raster.ReadAs
-000078c0: 4172 7261 7928 290d 0a20 2020 2020 2020  Array()..       
-000078d0: 2064 6f6d 6169 6e5f 636f 756e 7420 3d20   domain_count = 
-000078e0: 6e70 2e73 697a 6528 6172 725b 3a2c 203a  np.size(arr[:, :
-000078f0: 5d29 202d 206e 702e 636f 756e 745f 6e6f  ]) - np.count_no
-00007900: 6e7a 6572 6f28 0d0a 2020 2020 2020 2020  nzero(..        
-00007910: 2020 2020 2861 7272 5b6e 702e 6973 636c      (arr[np.iscl
-00007920: 6f73 6528 6172 722c 2073 656c 662e 6e6f  ose(arr, self.no
-00007930: 5f64 6174 615f 7661 6c75 655b 305d 2c20  _data_value[0], 
-00007940: 7274 6f6c 3d30 2e30 3031 295d 290d 0a20  rtol=0.001)]).. 
-00007950: 2020 2020 2020 2029 0d0a 2020 2020 2020         )..      
-00007960: 2020 7265 7475 726e 2064 6f6d 6169 6e5f    return domain_
-00007970: 636f 756e 740d 0a0d 0a20 2020 2040 7374  count....    @st
-00007980: 6174 6963 6d65 7468 6f64 0d0a 2020 2020  aticmethod..    
-00007990: 6465 6620 5f63 7265 6174 655f 7372 5f66  def _create_sr_f
-000079a0: 726f 6d5f 6570 7367 2865 7073 673a 2069  rom_epsg(epsg: i
-000079b0: 6e74 203d 204e 6f6e 6529 202d 3e20 5370  nt = None) -> Sp
-000079c0: 6174 6961 6c52 6566 6572 656e 6365 3a0d  atialReference:.
-000079d0: 0a20 2020 2020 2020 2022 2222 4372 6561  .        """Crea
-000079e0: 7465 2061 2073 7061 7469 616c 2072 6566  te a spatial ref
-000079f0: 6572 656e 6365 206f 626a 6563 7420 6672  erence object fr
-00007a00: 6f6d 2065 7073 6720 6e75 6d62 6572 2e0d  om epsg number..
-00007a10: 0a0d 0a20 2020 2020 2020 2068 7474 7073  ...        https
-00007a20: 3a2f 2f67 6461 6c2e 6f72 672f 7475 746f  ://gdal.org/tuto
-00007a30: 7269 616c 732f 6f73 725f 6170 695f 7475  rials/osr_api_tu
-00007a40: 742e 6874 6d6c 0d0a 0d0a 2020 2020 2020  t.html....      
-00007a50: 2020 5061 7261 6d65 7465 7273 0d0a 2020    Parameters..  
-00007a60: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
-00007a70: 0d0a 2020 2020 2020 2020 6570 7367 3a20  ..        epsg: 
-00007a80: 5b69 6e74 5d0d 0a20 2020 2020 2020 2020  [int]..         
-00007a90: 2020 2065 7073 6720 6e75 6d62 6572 2e0d     epsg number..
-00007aa0: 0a0d 0a20 2020 2020 2020 2052 6574 7572  ...        Retur
-00007ab0: 6e73 0d0a 2020 2020 2020 2020 2d2d 2d2d  ns..        ----
-00007ac0: 2d2d 2d0d 0a20 2020 2020 2020 2053 7061  ---..        Spa
-00007ad0: 7469 616c 5265 6665 7265 6e63 6520 6f62  tialReference ob
-00007ae0: 6a65 6374 0d0a 2020 2020 2020 2020 2222  ject..        ""
-00007af0: 220d 0a20 2020 2020 2020 2073 7220 3d20  "..        sr = 
-00007b00: 6f73 722e 5370 6174 6961 6c52 6566 6572  osr.SpatialRefer
-00007b10: 656e 6365 2829 0d0a 2020 2020 2020 2020  ence()..        
-00007b20: 7372 2e49 6d70 6f72 7446 726f 6d45 5053  sr.ImportFromEPS
-00007b30: 4728 696e 7428 6570 7367 2929 0d0a 0d0a  G(int(epsg))....
-00007b40: 2020 2020 2020 2020 2320 6966 2065 7073          # if eps
-00007b50: 6720 6973 204e 6f6e 653a 0d0a 2020 2020  g is None:..    
-00007b60: 2020 2020 2320 2020 2020 7372 2e53 6574      #     sr.Set
-00007b70: 5765 6c6c 4b6e 6f77 6e47 656f 6743 5328  WellKnownGeogCS(
-00007b80: 2257 4753 3834 2229 0d0a 2020 2020 2020  "WGS84")..      
-00007b90: 2020 2320 656c 7365 3a0d 0a20 2020 2020    # else:..     
-00007ba0: 2020 2023 2020 2020 2074 7279 3a0d 0a20     #     try:.. 
-00007bb0: 2020 2020 2020 2023 2020 2020 2020 2020         #        
-00007bc0: 2069 6620 6e6f 7420 7372 2e53 6574 5765   if not sr.SetWe
-00007bd0: 6c6c 4b6e 6f77 6e47 656f 6743 5328 6570  llKnownGeogCS(ep
-00007be0: 7367 2920 3d3d 2036 3a0d 0a20 2020 2020  sg) == 6:..     
-00007bf0: 2020 2023 2020 2020 2020 2020 2020 2020     #            
-00007c00: 2073 722e 5365 7457 656c 6c4b 6e6f 776e   sr.SetWellKnown
-00007c10: 4765 6f67 4353 2865 7073 6729 0d0a 2020  GeogCS(epsg)..  
-00007c20: 2020 2020 2020 2320 2020 2020 2020 2020        #         
-00007c30: 656c 7365 3a0d 0a20 2020 2020 2020 2023  else:..        #
-00007c40: 2020 2020 2020 2020 2020 2020 2074 7279               try
-00007c50: 3a0d 0a20 2020 2020 2020 2023 2020 2020  :..        #    
-00007c60: 2020 2020 2020 2020 2020 2020 2073 722e               sr.
-00007c70: 496d 706f 7274 4672 6f6d 4550 5347 2869  ImportFromEPSG(i
-00007c80: 6e74 2865 7073 6729 290d 0a20 2020 2020  nt(epsg))..     
-00007c90: 2020 2023 2020 2020 2020 2020 2020 2020     #            
-00007ca0: 2065 7863 6570 743a 0d0a 2020 2020 2020   except:..      
-00007cb0: 2020 2320 2020 2020 2020 2020 2020 2020    #             
-00007cc0: 2020 2020 7372 2e49 6d70 6f72 7446 726f      sr.ImportFro
-00007cd0: 6d57 6b74 2865 7073 6729 0d0a 2020 2020  mWkt(epsg)..    
-00007ce0: 2020 2020 2320 2020 2020 6578 6365 7074      #     except
-00007cf0: 3a0d 0a20 2020 2020 2020 2023 2020 2020  :..        #    
-00007d00: 2020 2020 2074 7279 3a0d 0a20 2020 2020       try:..     
-00007d10: 2020 2023 2020 2020 2020 2020 2020 2020     #            
-00007d20: 2073 722e 496d 706f 7274 4672 6f6d 4550   sr.ImportFromEP
-00007d30: 5347 2869 6e74 2865 7073 6729 290d 0a20  SG(int(epsg)).. 
-00007d40: 2020 2020 2020 2023 2020 2020 2020 2020         #        
-00007d50: 2065 7863 6570 743a 0d0a 2020 2020 2020   except:..      
-00007d60: 2020 2320 2020 2020 2020 2020 2020 2020    #             
-00007d70: 7372 2e49 6d70 6f72 7446 726f 6d57 6b74  sr.ImportFromWkt
-00007d80: 2865 7073 6729 0d0a 2020 2020 2020 2020  (epsg)..        
-00007d90: 7265 7475 726e 2073 720d 0a0d 0a20 2020  return sr....   
-00007da0: 2064 6566 2067 6574 5f62 616e 645f 6e61   def get_band_na
-00007db0: 6d65 7328 7365 6c66 2920 2d3e 204c 6973  mes(self) -> Lis
-00007dc0: 745b 7374 725d 3a0d 0a20 2020 2020 2020  t[str]:..       
-00007dd0: 2022 2222 4765 7420 6261 6e64 206e 616d   """Get band nam
-00007de0: 6573 2066 726f 6d20 6261 6e64 206d 6574  es from band met
-00007df0: 6120 6461 7461 2069 6620 6578 6973 7473  a data if exists
-00007e00: 206f 7468 6572 7769 7365 2077 696c 6c20   otherwise will 
-00007e10: 7265 7475 726e 2069 6465 7820 5b31 2c32  return idex [1,2
-00007e20: 2c20 2e2e 2e5d 0d0a 0d0a 2020 2020 2020  , ...]....      
-00007e30: 2020 5061 7261 6d65 7465 7273 0d0a 2020    Parameters..  
-00007e40: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
-00007e50: 0d0a 0d0a 2020 2020 2020 2020 5265 7475  ....        Retu
-00007e60: 726e 730d 0a20 2020 2020 2020 202d 2d2d  rns..        ---
-00007e70: 2d2d 2d2d 0d0a 2020 2020 2020 2020 6c69  ----..        li
-00007e80: 7374 5b73 7472 5d0d 0a20 2020 2020 2020  st[str]..       
-00007e90: 2022 2222 0d0a 2020 2020 2020 2020 6e61   """..        na
-00007ea0: 6d65 7320 3d20 5b5d 0d0a 2020 2020 2020  mes = []..      
-00007eb0: 2020 666f 7220 6920 696e 2072 616e 6765    for i in range
-00007ec0: 2831 2c20 7365 6c66 2e72 6173 7465 722e  (1, self.raster.
-00007ed0: 5261 7374 6572 436f 756e 7420 2b20 3129  RasterCount + 1)
-00007ee0: 3a0d 0a20 2020 2020 2020 2020 2020 2062  :..            b
-00007ef0: 616e 645f 6920 3d20 7365 6c66 2e72 6173  and_i = self.ras
-00007f00: 7465 722e 4765 7452 6173 7465 7242 616e  ter.GetRasterBan
-00007f10: 6428 6929 0d0a 0d0a 2020 2020 2020 2020  d(i)....        
-00007f20: 2020 2020 6966 2062 616e 645f 692e 4765      if band_i.Ge
-00007f30: 7444 6573 6372 6970 7469 6f6e 2829 3a0d  tDescription():.
-00007f40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00007f50: 2023 2055 7365 2074 6865 2062 616e 645f   # Use the band_
-00007f60: 6920 6465 7363 7269 7074 696f 6e2e 0d0a  i description...
-00007f70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00007f80: 6e61 6d65 732e 6170 7065 6e64 2862 616e  names.append(ban
-00007f90: 645f 692e 4765 7444 6573 6372 6970 7469  d_i.GetDescripti
-00007fa0: 6f6e 2829 290d 0a20 2020 2020 2020 2020  on())..         
-00007fb0: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
-00007fc0: 2020 2020 2020 2020 2020 2320 4368 6563            # Chec
-00007fd0: 6b20 666f 7220 6d65 7465 6461 7461 2e0d  k for metedata..
-00007fe0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00007ff0: 2062 616e 645f 695f 6e61 6d65 203d 2022   band_i_name = "
-00008000: 4261 6e64 5f7b 7d22 2e66 6f72 6d61 7428  Band_{}".format(
-00008010: 6261 6e64 5f69 2e47 6574 4261 6e64 2829  band_i.GetBand()
-00008020: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-00008030: 2020 206d 6574 6164 6174 6120 3d20 6261     metadata = ba
-00008040: 6e64 5f69 2e47 6574 4461 7461 7365 7428  nd_i.GetDataset(
-00008050: 292e 4765 744d 6574 6164 6174 615f 4469  ).GetMetadata_Di
-00008060: 6374 2829 0d0a 0d0a 2020 2020 2020 2020  ct()....        
-00008070: 2020 2020 2020 2020 2320 4966 2069 6e20          # If in 
-00008080: 6d65 7461 6461 7461 2c20 7265 7475 726e  metadata, return
-00008090: 2074 6865 206d 6574 6164 6174 6120 656e   the metadata en
-000080a0: 7472 792c 2065 6c73 6520 4261 6e64 5f4e  try, else Band_N
-000080b0: 2e0d 0a20 2020 2020 2020 2020 2020 2020  ...             
-000080c0: 2020 2069 6620 6261 6e64 5f69 5f6e 616d     if band_i_nam
-000080d0: 6520 696e 206d 6574 6164 6174 6120 616e  e in metadata an
-000080e0: 6420 6d65 7461 6461 7461 5b62 616e 645f  d metadata[band_
-000080f0: 695f 6e61 6d65 5d3a 0d0a 2020 2020 2020  i_name]:..      
-00008100: 2020 2020 2020 2020 2020 2020 2020 6e61                na
-00008110: 6d65 732e 6170 7065 6e64 286d 6574 6164  mes.append(metad
-00008120: 6174 615b 6261 6e64 5f69 5f6e 616d 655d  ata[band_i_name]
-00008130: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-00008140: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
-00008150: 2020 2020 2020 2020 2020 2020 2020 6e61                na
-00008160: 6d65 732e 6170 7065 6e64 2862 616e 645f  mes.append(band_
-00008170: 695f 6e61 6d65 290d 0a0d 0a20 2020 2020  i_name)....     
-00008180: 2020 2072 6574 7572 6e20 6e61 6d65 730d     return names.
-00008190: 0a0d 0a20 2020 2064 6566 205f 6368 6563  ...    def _chec
-000081a0: 6b5f 6e6f 5f64 6174 615f 7661 6c75 6528  k_no_data_value(
-000081b0: 7365 6c66 2c20 6e6f 5f64 6174 615f 7661  self, no_data_va
-000081c0: 6c75 653a 204c 6973 7429 3a0d 0a20 2020  lue: List):..   
-000081d0: 2020 2020 2022 2222 5661 6c69 6461 7465       """Validate
-000081e0: 2054 6865 206e 6f5f 6461 7461 5f76 616c   The no_data_val
-000081f0: 7565 2077 6974 6820 7468 6520 6474 7970  ue with the dtyp
-00008200: 6520 6f66 2074 6865 206f 626a 6563 742e  e of the object.
-00008210: 0d0a 0d0a 2020 2020 2020 2020 5061 7261  ....        Para
-00008220: 6d65 7465 7273 0d0a 2020 2020 2020 2020  meters..        
-00008230: 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020  ----------..    
-00008240: 2020 2020 6e6f 5f64 6174 615f 7661 6c75      no_data_valu
-00008250: 650d 0a0d 0a20 2020 2020 2020 2052 6574  e....        Ret
-00008260: 7572 6e73 0d0a 2020 2020 2020 2020 2d2d  urns..        --
-00008270: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 206e  -----..        n
-00008280: 6f5f 6461 7461 5f76 616c 7565 3a0d 0a20  o_data_value:.. 
-00008290: 2020 2020 2020 2020 2020 2063 6f6e 7665             conve
-000082a0: 7274 2074 6865 206e 6f5f 6461 7461 5f76  rt the no_data_v
-000082b0: 616c 7565 2074 6f20 636f 6d6c 7920 7769  alue to comly wi
-000082c0: 7468 2074 6865 2064 7479 7065 0d0a 2020  th the dtype..  
-000082d0: 2020 2020 2020 2222 220d 0a20 2020 2020        """..     
-000082e0: 2020 2066 6f72 2069 2c20 7661 6c20 696e     for i, val in
-000082f0: 2065 6e75 6d65 7261 7465 2873 656c 662e   enumerate(self.
-00008300: 6474 7970 6529 3a0d 0a20 2020 2020 2020  dtype):..       
-00008310: 2020 2020 2069 6620 6764 616c 5f74 6f5f       if gdal_to_
-00008320: 6e75 6d70 795f 6474 7970 6528 7661 6c29  numpy_dtype(val)
-00008330: 2e5f 5f63 6f6e 7461 696e 735f 5f28 2266  .__contains__("f
-00008340: 6c6f 6174 2229 3a0d 0a20 2020 2020 2020  loat"):..       
-00008350: 2020 2020 2020 2020 206e 6f5f 6461 7461           no_data
-00008360: 5f76 616c 7565 5b69 5d20 3d20 280d 0a20  _value[i] = (.. 
-00008370: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008380: 2020 2066 6c6f 6174 286e 6f5f 6461 7461     float(no_data
-00008390: 5f76 616c 7565 5b69 5d29 0d0a 2020 2020  _value[i])..    
-000083a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000083b0: 6966 2028 6e6f 5f64 6174 615f 7661 6c75  if (no_data_valu
-000083c0: 655b 695d 2069 7320 6e6f 7420 4e6f 6e65  e[i] is not None
-000083d0: 2061 6e64 206e 6f74 206e 702e 6973 6e61   and not np.isna
-000083e0: 6e28 6e6f 5f64 6174 615f 7661 6c75 655b  n(no_data_value[
-000083f0: 695d 2929 0d0a 2020 2020 2020 2020 2020  i]))..          
-00008400: 2020 2020 2020 2020 2020 656c 7365 204e            else N
-00008410: 6f6e 650d 0a20 2020 2020 2020 2020 2020  one..           
-00008420: 2020 2020 2029 0d0a 2020 2020 2020 2020       )..        
-00008430: 2020 2020 656c 6966 2067 6461 6c5f 746f      elif gdal_to
-00008440: 5f6e 756d 7079 5f64 7479 7065 2876 616c  _numpy_dtype(val
-00008450: 292e 5f5f 636f 6e74 6169 6e73 5f5f 2822  ).__contains__("
-00008460: 696e 7422 293a 0d0a 2020 2020 2020 2020  int"):..        
-00008470: 2020 2020 2020 2020 6e6f 5f64 6174 615f          no_data_
-00008480: 7661 6c75 655b 695d 203d 2028 0d0a 2020  value[i] = (..  
-00008490: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000084a0: 2020 696e 7428 6e6f 5f64 6174 615f 7661    int(no_data_va
-000084b0: 6c75 655b 695d 290d 0a20 2020 2020 2020  lue[i])..       
-000084c0: 2020 2020 2020 2020 2020 2020 2069 6620               if 
-000084d0: 286e 6f5f 6461 7461 5f76 616c 7565 5b69  (no_data_value[i
-000084e0: 5d20 6973 206e 6f74 204e 6f6e 6520 616e  ] is not None an
-000084f0: 6420 6e6f 7420 6e70 2e69 736e 616e 286e  d not np.isnan(n
-00008500: 6f5f 6461 7461 5f76 616c 7565 5b69 5d29  o_data_value[i])
-00008510: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-00008520: 2020 2020 2020 2065 6c73 6520 4e6f 6e65         else None
-00008530: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00008540: 2020 290d 0a20 2020 2020 2020 2020 2020    )..           
-00008550: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
-00008560: 2020 2020 2020 2020 7261 6973 6520 5479          raise Ty
-00008570: 7065 4572 726f 7228 224e 6f44 6174 6156  peError("NoDataV
-00008580: 616c 7565 2068 6173 2061 2063 6f6d 706c  alue has a compl
-00008590: 6578 2064 6174 6120 7479 7065 2229 0d0a  ex data type")..
-000085a0: 0d0a 2020 2020 2020 2020 7265 7475 726e  ..        return
-000085b0: 206e 6f5f 6461 7461 5f76 616c 7565 0d0a   no_data_value..
-000085c0: 0d0a 2020 2020 6465 6620 5f73 6574 5f6e  ..    def _set_n
-000085d0: 6f5f 6461 7461 5f76 616c 7565 280d 0a20  o_data_value(.. 
-000085e0: 2020 2020 2020 2073 656c 662c 206e 6f5f         self, no_
-000085f0: 6461 7461 5f76 616c 7565 3a20 556e 696f  data_value: Unio
-00008600: 6e5b 416e 792c 206c 6973 745d 203d 2044  n[Any, list] = D
-00008610: 4546 4155 4c54 5f4e 4f5f 4441 5441 5f56  EFAULT_NO_DATA_V
-00008620: 414c 5545 0d0a 2020 2020 293a 0d0a 2020  ALUE..    ):..  
-00008630: 2020 2020 2020 2222 2273 6574 4e6f 4461        """setNoDa
-00008640: 7461 5661 6c75 652e 0d0a 0d0a 2020 2020  taValue.....    
-00008650: 2020 2020 2020 2020 2d20 5365 7420 7468          - Set th
-00008660: 6520 6e6f 2064 6174 6120 7661 6c75 6520  e no data value 
-00008670: 696e 2061 2061 6c6c 2072 6173 7465 7220  in a all raster 
-00008680: 6261 6e64 732e 0d0a 2020 2020 2020 2020  bands...        
-00008690: 2020 2020 2d20 4669 6c6c 7320 7468 6520      - Fills the 
-000086a0: 7768 6f6c 6520 7261 7374 6572 2077 6974  whole raster wit
-000086b0: 6820 7468 6520 6e6f 5f64 6174 615f 7661  h the no_data_va
-000086c0: 6c75 652e 0d0a 2020 2020 2020 2020 2020  lue...          
-000086d0: 2020 2d20 7573 6564 206f 6e6c 7920 7768    - used only wh
-000086e0: 656e 2063 7265 6174 696e 6720 616e 2065  en creating an e
-000086f0: 6d70 7479 2064 7269 7665 722e 0d0a 0d0a  mpty driver.....
-00008700: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
-00008710: 7273 0d0a 2020 2020 2020 2020 2d2d 2d2d  rs..        ----
-00008720: 2d2d 2d2d 2d2d 0d0a 2020 2020 2020 2020  ------..        
-00008730: 6e6f 5f64 6174 615f 7661 6c75 653a 205b  no_data_value: [
-00008740: 6e75 6d65 7269 635d 0d0a 2020 2020 2020  numeric]..      
-00008750: 2020 2020 2020 6e6f 2064 6174 6120 7661        no data va
-00008760: 6c75 6520 746f 2066 696c 6c20 7468 6520  lue to fill the 
-00008770: 6d61 736b 6564 2070 6172 7420 6f66 2074  masked part of t
-00008780: 6865 2061 7272 6179 0d0a 2020 2020 2020  he array..      
-00008790: 2020 2222 220d 0a20 2020 2020 2020 2069    """..        i
-000087a0: 6620 6e6f 7420 6973 696e 7374 616e 6365  f not isinstance
-000087b0: 286e 6f5f 6461 7461 5f76 616c 7565 2c20  (no_data_value, 
-000087c0: 6c69 7374 293a 0d0a 2020 2020 2020 2020  list):..        
-000087d0: 2020 2020 6e6f 5f64 6174 615f 7661 6c75      no_data_valu
-000087e0: 6520 3d20 5b6e 6f5f 6461 7461 5f76 616c  e = [no_data_val
-000087f0: 7565 5d20 2a20 7365 6c66 2e62 616e 645f  ue] * self.band_
-00008800: 636f 756e 740d 0a0d 0a20 2020 2020 2020  count....       
-00008810: 2073 656c 662e 5f63 6865 636b 5f6e 6f5f   self._check_no_
-00008820: 6461 7461 5f76 616c 7565 286e 6f5f 6461  data_value(no_da
-00008830: 7461 5f76 616c 7565 290d 0a0d 0a20 2020  ta_value)....   
-00008840: 2020 2020 2066 6f72 2062 616e 6420 696e       for band in
-00008850: 2072 616e 6765 2873 656c 662e 6261 6e64   range(self.band
-00008860: 5f63 6f75 6e74 293a 0d0a 2020 2020 2020  _count):..      
-00008870: 2020 2020 2020 7472 793a 0d0a 2020 2020        try:..    
-00008880: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-00008890: 2e5f 7365 745f 6e6f 5f64 6174 615f 7661  ._set_no_data_va
-000088a0: 6c75 655f 6261 636b 656e 6428 6261 6e64  lue_backend(band
-000088b0: 2c20 6e6f 5f64 6174 615f 7661 6c75 655b  , no_data_value[
-000088c0: 6261 6e64 5d29 0d0a 2020 2020 2020 2020  band])..        
-000088d0: 2020 2020 6578 6365 7074 2045 7863 6570      except Excep
-000088e0: 7469 6f6e 2061 7320 653a 0d0a 2020 2020  tion as e:..    
-000088f0: 2020 2020 2020 2020 2020 2020 6966 2073              if s
-00008900: 7472 2865 292e 5f5f 636f 6e74 6169 6e73  tr(e).__contains
-00008910: 5f5f 280d 0a20 2020 2020 2020 2020 2020  __(..           
-00008920: 2020 2020 2020 2020 2022 4174 7465 6d70           "Attemp
-00008930: 7420 746f 2077 7269 7465 2074 6f20 7265  t to write to re
-00008940: 6164 206f 6e6c 7920 6461 7461 7365 7420  ad only dataset 
-00008950: 696e 2047 4441 4c52 6173 7465 7242 616e  in GDALRasterBan
-00008960: 643a 3a46 696c 6c28 292e 220d 0a20 2020  d::Fill()."..   
-00008970: 2020 2020 2020 2020 2020 2020 2029 3a0d               ):.
-00008980: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00008990: 2020 2020 2072 6169 7365 2052 6561 644f       raise ReadO
-000089a0: 6e6c 7945 7272 6f72 280d 0a20 2020 2020  nlyError(..     
-000089b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000089c0: 2020 2022 5468 6520 4461 7461 7365 7420     "The Dataset 
-000089d0: 6973 206f 7065 6e20 7769 7468 2061 2072  is open with a r
-000089e0: 6561 6420 6f6e 6c79 2c20 706c 6561 7365  ead only, please
-000089f0: 2072 6561 6420 7468 6520 7261 7374 6572   read the raster
-00008a00: 2075 7369 6e67 2075 7064 6174 6520 220d   using update ".
-00008a10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00008a20: 2020 2020 2020 2020 2022 6163 6365 7373           "access
-00008a30: 206d 6f64 6522 0d0a 2020 2020 2020 2020   mode"..        
-00008a40: 2020 2020 2020 2020 2020 2020 290d 0a20              ).. 
-00008a50: 2020 2020 2020 2020 2020 2020 2020 2065                 e
-00008a60: 6c69 6620 7374 7228 6529 2e5f 5f63 6f6e  lif str(e).__con
-00008a70: 7461 696e 735f 5f28 0d0a 2020 2020 2020  tains__(..      
-00008a80: 2020 2020 2020 2020 2020 2020 2020 2269                "i
-00008a90: 6e20 6d65 7468 6f64 2027 4261 6e64 5f53  n method 'Band_S
-00008aa0: 6574 4e6f 4461 7461 5661 6c75 6527 2c20  etNoDataValue', 
-00008ab0: 6172 6775 6d65 6e74 2032 206f 6620 7479  argument 2 of ty
-00008ac0: 7065 2027 646f 7562 6c65 2722 0d0a 2020  pe 'double'"..  
-00008ad0: 2020 2020 2020 2020 2020 2020 2020 293a                ):
-00008ae0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00008af0: 2020 2020 2020 7365 6c66 2e5f 7365 745f        self._set_
-00008b00: 6e6f 5f64 6174 615f 7661 6c75 655f 6261  no_data_value_ba
-00008b10: 636b 656e 6428 0d0a 2020 2020 2020 2020  ckend(..        
-00008b20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008b30: 6261 6e64 2c20 6e70 2e66 6c6f 6174 3634  band, np.float64
-00008b40: 286e 6f5f 6461 7461 5f76 616c 7565 5b62  (no_data_value[b
-00008b50: 616e 645d 290d 0a20 2020 2020 2020 2020  and])..         
-00008b60: 2020 2020 2020 2020 2020 2029 0d0a 2020             )..  
-00008b70: 2020 2020 2020 2020 2020 2020 2020 656c                el
-00008b80: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
-00008b90: 2020 2020 2020 2020 2073 656c 662e 5f73           self._s
-00008ba0: 6574 5f6e 6f5f 6461 7461 5f76 616c 7565  et_no_data_value
-00008bb0: 5f62 6163 6b65 6e64 2862 616e 642c 2044  _backend(band, D
-00008bc0: 4546 4155 4c54 5f4e 4f5f 4441 5441 5f56  EFAULT_NO_DATA_V
-00008bd0: 414c 5545 290d 0a20 2020 2020 2020 2020  ALUE)..         
-00008be0: 2020 2020 2020 2020 2020 206c 6f67 6765             logge
-00008bf0: 722e 7761 726e 696e 6728 0d0a 2020 2020  r.warning(..    
-00008c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008c10: 2020 2020 2274 6865 2074 7970 6520 6f66      "the type of
-00008c20: 2074 6865 2067 6976 656e 206e 6f5f 6461   the given no_da
-00008c30: 7461 5f76 616c 7565 2064 6966 6665 7273  ta_value differs
-00008c40: 2066 726f 6d20 7468 6520 6474 7970 6520   from the dtype 
-00008c50: 6f66 2074 6865 2072 6173 7465 7222 0d0a  of the raster"..
-00008c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008c70: 2020 2020 2020 2020 6622 6e6f 5f64 6174          f"no_dat
-00008c80: 615f 7661 6c75 6520 6e6f 7720 6973 2073  a_value now is s
-00008c90: 6574 2074 6f20 7b44 4546 4155 4c54 5f4e  et to {DEFAULT_N
-00008ca0: 4f5f 4441 5441 5f56 414c 5545 7d20 696e  O_DATA_VALUE} in
-00008cb0: 2074 6865 2072 6173 7465 7222 0d0a 2020   the raster"..  
-00008cc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00008cd0: 2020 290d 0a0d 0a20 2020 2064 6566 205f    )....    def _
-00008ce0: 6361 6c63 756c 6174 655f 6262 6f78 2873  calculate_bbox(s
-00008cf0: 656c 6629 202d 3e20 4c69 7374 3a0d 0a20  elf) -> List:.. 
-00008d00: 2020 2020 2020 2022 2222 6361 6c63 756c         """calcul
-00008d10: 6174 6520 626f 756e 6469 6e67 2062 6f78  ate bounding box
-00008d20: 2222 220d 0a20 2020 2020 2020 2078 6d69  """..        xmi
-00008d30: 6e2c 2079 6d61 7820 3d20 7365 6c66 2e70  n, ymax = self.p
-00008d40: 6976 6f74 5f70 6f69 6e74 0d0a 2020 2020  ivot_point..    
-00008d50: 2020 2020 796d 696e 203d 2079 6d61 7820      ymin = ymax 
-00008d60: 2d20 7365 6c66 2e72 6f77 7320 2a20 7365  - self.rows * se
-00008d70: 6c66 2e63 656c 6c5f 7369 7a65 0d0a 2020  lf.cell_size..  
-00008d80: 2020 2020 2020 786d 6178 203d 2078 6d69        xmax = xmi
-00008d90: 6e20 2b20 7365 6c66 2e63 6f6c 756d 6e73  n + self.columns
-00008da0: 202a 2073 656c 662e 6365 6c6c 5f73 697a   * self.cell_siz
-00008db0: 650d 0a20 2020 2020 2020 2072 6574 7572  e..        retur
-00008dc0: 6e20 5b78 6d69 6e2c 2079 6d69 6e2c 2078  n [xmin, ymin, x
-00008dd0: 6d61 782c 2079 6d61 785d 0d0a 0d0a 2020  max, ymax]....  
-00008de0: 2020 6465 6620 5f63 616c 6375 6c61 7465    def _calculate
-00008df0: 5f62 6f75 6e64 7328 7365 6c66 2920 2d3e  _bounds(self) ->
-00008e00: 2047 656f 4461 7461 4672 616d 653a 0d0a   GeoDataFrame:..
-00008e10: 2020 2020 2020 2020 2222 2267 6574 2074          """get t
-00008e20: 6865 2062 626f 7820 6173 2061 2067 656f  he bbox as a geo
-00008e30: 6461 7461 6672 616d 6520 7769 7468 2061  dataframe with a
-00008e40: 2070 6f6c 7967 6f6e 2067 656f 6d65 7472   polygon geometr
-00008e50: 7922 2222 0d0a 2020 2020 2020 2020 786d  y"""..        xm
-00008e60: 696e 2c20 796d 696e 2c20 786d 6178 2c20  in, ymin, xmax, 
-00008e70: 796d 6178 203d 2073 656c 662e 5f63 616c  ymax = self._cal
-00008e80: 6375 6c61 7465 5f62 626f 7828 290d 0a20  culate_bbox().. 
-00008e90: 2020 2020 2020 2063 6f6f 7264 7320 3d20         coords = 
-00008ea0: 5b28 786d 696e 2c20 796d 6178 292c 2028  [(xmin, ymax), (
-00008eb0: 786d 696e 2c20 796d 696e 292c 2028 786d  xmin, ymin), (xm
-00008ec0: 6178 2c20 796d 696e 292c 2028 786d 6178  ax, ymin), (xmax
-00008ed0: 2c20 796d 6178 295d 0d0a 2020 2020 2020  , ymax)]..      
-00008ee0: 2020 706f 6c79 203d 2046 6561 7475 7265    poly = Feature
-00008ef0: 436f 6c6c 6563 7469 6f6e 2e63 7265 6174  Collection.creat
-00008f00: 655f 706f 6c79 676f 6e28 636f 6f72 6473  e_polygon(coords
-00008f10: 290d 0a20 2020 2020 2020 2067 6466 203d  )..        gdf =
-00008f20: 2067 7064 2e47 656f 4461 7461 4672 616d   gpd.GeoDataFram
-00008f30: 6528 6765 6f6d 6574 7279 3d5b 706f 6c79  e(geometry=[poly
-00008f40: 5d29 0d0a 2020 2020 2020 2020 6764 662e  ])..        gdf.
-00008f50: 7365 745f 6372 7328 6570 7367 3d73 656c  set_crs(epsg=sel
-00008f60: 662e 6570 7367 2c20 696e 706c 6163 653d  f.epsg, inplace=
-00008f70: 5472 7565 290d 0a20 2020 2020 2020 2072  True)..        r
-00008f80: 6574 7572 6e20 6764 660d 0a0d 0a20 2020  eturn gdf....   
-00008f90: 2064 6566 205f 7365 745f 6e6f 5f64 6174   def _set_no_dat
-00008fa0: 615f 7661 6c75 655f 6261 636b 656e 6428  a_value_backend(
-00008fb0: 7365 6c66 2c20 6261 6e64 5f69 3a20 696e  self, band_i: in
-00008fc0: 742c 206e 6f5f 6461 7461 5f76 616c 7565  t, no_data_value
-00008fd0: 3a20 416e 7929 3a0d 0a20 2020 2020 2020  : Any):..       
-00008fe0: 2022 2222 0d0a 2020 2020 2020 2020 2020   """..          
-00008ff0: 2020 2d20 6261 6e64 5f69 2073 7461 7274    - band_i start
-00009000: 7320 6672 6f6d 2030 2074 6f20 7468 6520  s from 0 to the 
-00009010: 6e75 6d62 6572 206f 6620 6261 6e64 732d  number of bands-
-00009020: 312e 0d0a 0d0a 2020 2020 2020 2020 5061  1.....        Pa
-00009030: 7261 6d65 7465 7273 0d0a 2020 2020 2020  rameters..      
-00009040: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020    ----------..  
-00009050: 2020 2020 2020 6261 6e64 5f69 3a0d 0a20        band_i:.. 
-00009060: 2020 2020 2020 2020 2020 2062 616e 6420             band 
-00009070: 696e 6465 782c 2073 7461 7274 7320 6672  index, starts fr
-00009080: 6f6d 2030 2e0d 0a20 2020 2020 2020 206e  om 0...        n
-00009090: 6f5f 6461 7461 5f76 616c 7565 3a0d 0a20  o_data_value:.. 
-000090a0: 2020 2020 2020 2020 2020 204e 756d 6572             Numer
-000090b0: 6963 616c 2076 616c 7565 2e0d 0a20 2020  ical value...   
-000090c0: 2020 2020 2022 2222 0d0a 2020 2020 2020       """..      
-000090d0: 2020 2320 6368 6563 6b20 6966 2074 6865    # check if the
-000090e0: 2064 7479 7065 206f 6620 7468 6520 6e6f   dtype of the no
-000090f0: 5f64 6174 615f 7661 6c75 6520 636f 6d70  _data_value comp
-00009100: 6c79 2077 6974 6820 7468 6520 6474 7970  ly with the dtyp
-00009110: 6520 6f66 2074 6865 2072 6173 7465 7220  e of the raster 
-00009120: 6974 7365 6c66 2e0d 0a20 2020 2020 2020  itself...       
-00009130: 206e 6f5f 6474 7970 6520 3d20 7374 7228   no_dtype = str(
-00009140: 7479 7065 286e 6f5f 6461 7461 5f76 616c  type(no_data_val
-00009150: 7565 2929 2e73 706c 6974 2822 2722 295b  ue)).split("'")[
-00009160: 315d 0d0a 2020 2020 2020 2020 706f 7465  1]..        pote
-00009170: 6e74 6961 6c5f 6474 7970 6573 203d 205b  ntial_dtypes = [
-00009180: 0d0a 2020 2020 2020 2020 2020 2020 6920  ..            i 
-00009190: 666f 7220 6920 696e 206c 6973 7428 4e55  for i in list(NU
-000091a0: 4d50 595f 4744 414c 5f44 4154 415f 5459  MPY_GDAL_DATA_TY
-000091b0: 5045 532e 6b65 7973 2829 2920 6966 2069  PES.keys()) if i
-000091c0: 2e5f 5f63 6f6e 7461 696e 735f 5f28 6e6f  .__contains__(no
-000091d0: 5f64 7479 7065 290d 0a20 2020 2020 2020  _dtype)..       
-000091e0: 205d 0d0a 2020 2020 2020 2020 706f 7465   ]..        pote
-000091f0: 6e74 6961 6c5f 6474 7970 6573 203d 205b  ntial_dtypes = [
-00009200: 4e55 4d50 595f 4744 414c 5f44 4154 415f  NUMPY_GDAL_DATA_
-00009210: 5459 5045 532e 6765 7428 6929 2066 6f72  TYPES.get(i) for
-00009220: 2069 2069 6e20 706f 7465 6e74 6961 6c5f   i in potential_
-00009230: 6474 7970 6573 5d0d 0a0d 0a20 2020 2020  dtypes]....     
-00009240: 2020 2069 6620 6e6f 5f64 6174 615f 7661     if no_data_va
-00009250: 6c75 6520 6973 206e 6f74 204e 6f6e 653a  lue is not None:
-00009260: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
-00009270: 206e 6f74 2073 656c 662e 6474 7970 655b   not self.dtype[
-00009280: 6261 6e64 5f69 5d20 696e 2070 6f74 656e  band_i] in poten
-00009290: 7469 616c 5f64 7479 7065 733a 0d0a 2020  tial_dtypes:..  
-000092a0: 2020 2020 2020 2020 2020 2020 2020 7261                ra
-000092b0: 6973 6520 4e6f 4461 7461 5661 6c75 6545  ise NoDataValueE
-000092c0: 7272 6f72 280d 0a20 2020 2020 2020 2020  rror(..         
-000092d0: 2020 2020 2020 2020 2020 2066 2254 6865             f"The
-000092e0: 2064 7479 7065 206f 6620 7468 6520 6769   dtype of the gi
-000092f0: 7665 6e20 6e6f 5f64 6174 615f 7661 6c75  ven no_data_valu
-00009300: 657b 6e6f 5f64 6174 615f 7661 6c75 657d  e{no_data_value}
-00009310: 3a20 7b6e 6f5f 6474 7970 657d 2064 6966  : {no_dtype} dif
-00009320: 6665 7273 2066 726f 6d20 7468 6520 6474  fers from the dt
-00009330: 7970 6520 6f66 2074 6865 2022 0d0a 2020  ype of the "..  
-00009340: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009350: 2020 6622 6261 6e64 3a20 7b67 6461 6c5f    f"band: {gdal_
-00009360: 746f 5f6e 756d 7079 5f64 7479 7065 2873  to_numpy_dtype(s
-00009370: 656c 662e 6474 7970 655b 6261 6e64 5f69  elf.dtype[band_i
-00009380: 5d29 7d22 0d0a 2020 2020 2020 2020 2020  ])}"..          
-00009390: 2020 2020 2020 290d 0a0d 0a20 2020 2020        )....     
-000093a0: 2020 2073 656c 662e 5f63 6861 6e67 655f     self._change_
-000093b0: 6e6f 5f64 6174 615f 7661 6c75 655f 6174  no_data_value_at
-000093c0: 7472 2862 616e 645f 692c 206e 6f5f 6461  tr(band_i, no_da
-000093d0: 7461 5f76 616c 7565 290d 0a20 2020 2020  ta_value)..     
-000093e0: 2020 2023 2069 6e69 7469 616c 697a 6520     # initialize 
-000093f0: 7468 6520 6261 6e64 2077 6974 6820 7468  the band with th
-00009400: 6520 6e6f 6461 7461 2076 616c 7565 2069  e nodata value i
-00009410: 6e73 7465 6164 206f 6620 300d 0a20 2020  nstead of 0..   
-00009420: 2020 2020 2074 7279 3a0d 0a20 2020 2020       try:..     
-00009430: 2020 2020 2020 2073 656c 662e 7261 7374         self.rast
-00009440: 6572 2e47 6574 5261 7374 6572 4261 6e64  er.GetRasterBand
-00009450: 2862 616e 645f 6920 2b20 3129 2e46 696c  (band_i + 1).Fil
-00009460: 6c28 6e6f 5f64 6174 615f 7661 6c75 6529  l(no_data_value)
-00009470: 0d0a 2020 2020 2020 2020 6578 6365 7074  ..        except
-00009480: 2045 7863 6570 7469 6f6e 2061 7320 653a   Exception as e:
-00009490: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
-000094a0: 2073 7472 2865 292e 5f5f 636f 6e74 6169   str(e).__contai
-000094b0: 6e73 5f5f 2822 2061 7267 756d 656e 7420  ns__(" argument 
-000094c0: 3220 6f66 2074 7970 6520 2764 6f75 626c  2 of type 'doubl
-000094d0: 6527 2229 3a0d 0a20 2020 2020 2020 2020  e'"):..         
-000094e0: 2020 2020 2020 2073 656c 662e 7261 7374         self.rast
-000094f0: 6572 2e47 6574 5261 7374 6572 4261 6e64  er.GetRasterBand
-00009500: 2862 616e 645f 6920 2b20 3129 2e46 696c  (band_i + 1).Fil
-00009510: 6c28 6e70 2e66 6c6f 6174 3634 286e 6f5f  l(np.float64(no_
-00009520: 6461 7461 5f76 616c 7565 2929 0d0a 2020  data_value))..  
-00009530: 2020 2020 2020 2020 2020 656c 7365 3a0d            else:.
-00009540: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00009550: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
-00009560: 7228 0d0a 2020 2020 2020 2020 2020 2020  r(..            
-00009570: 2020 2020 2020 2020 6622 4661 696c 6564          f"Failed
-00009580: 2074 6f20 6669 6c6c 2074 6865 2062 616e   to fill the ban
-00009590: 6420 7b62 616e 645f 697d 2077 6974 6820  d {band_i} with 
-000095a0: 7661 6c75 653a 207b 6e6f 5f64 6174 615f  value: {no_data_
-000095b0: 7661 6c75 657d 2c20 6265 6361 7573 6520  value}, because 
-000095c0: 6f66 207b 657d 220d 0a20 2020 2020 2020  of {e}"..       
-000095d0: 2020 2020 2020 2020 2029 0d0a 2020 2020           )..    
-000095e0: 2020 2020 2320 7570 6461 7465 2074 6865      # update the
-000095f0: 206e 6f5f 6461 7461 5f76 616c 7565 2069   no_data_value i
-00009600: 6e20 7468 6520 4461 7461 7365 7420 6f62  n the Dataset ob
-00009610: 6a65 6374 0d0a 2020 2020 2020 2020 7365  ject..        se
-00009620: 6c66 2e6e 6f5f 6461 7461 5f76 616c 7565  lf.no_data_value
-00009630: 5b62 616e 645f 695d 203d 206e 6f5f 6461  [band_i] = no_da
-00009640: 7461 5f76 616c 7565 0d0a 0d0a 2020 2020  ta_value....    
-00009650: 6465 6620 5f63 6861 6e67 655f 6e6f 5f64  def _change_no_d
-00009660: 6174 615f 7661 6c75 655f 6174 7472 2873  ata_value_attr(s
-00009670: 656c 662c 2062 616e 643a 2069 6e74 2c20  elf, band: int, 
-00009680: 6e6f 5f64 6174 615f 7661 6c75 6529 3a0d  no_data_value):.
-00009690: 0a20 2020 2020 2020 2022 2222 4368 616e  .        """Chan
-000096a0: 6765 2074 6865 206e 6f5f 6461 7461 5f76  ge the no_data_v
-000096b0: 616c 7565 2061 7474 7269 6275 7465 2e0d  alue attribute..
-000096c0: 0a0d 0a20 2020 2020 2020 2020 2020 202d  ...            -
-000096d0: 2043 6861 6e67 6520 6f6e 6c79 2074 6865   Change only the
-000096e0: 206e 6f5f 6461 7461 5f76 616c 7565 2061   no_data_value a
-000096f0: 7474 7269 6275 7465 2069 6e20 7468 6520  ttribute in the 
-00009700: 6764 616c 2044 6174 6163 7562 6520 6f62  gdal Datacube ob
-00009710: 6a65 6374 2e0d 0a20 2020 2020 2020 2020  ject...         
-00009720: 2020 202d 2043 6861 6e67 6520 7468 6520     - Change the 
-00009730: 6e6f 5f64 6174 615f 7661 6c75 6520 696e  no_data_value in
-00009740: 2074 6865 2044 6174 6173 6574 206f 626a   the Dataset obj
-00009750: 6563 7420 666f 7220 7468 6520 6769 7665  ect for the give
-00009760: 6e20 6261 6e64 2069 6e64 6578 2e0d 0a20  n band index... 
-00009770: 2020 2020 2020 2020 2020 202d 2054 6865             - The
-00009780: 2063 6f72 7265 7370 6f6e 6469 6e67 2076   corresponding v
-00009790: 616c 7565 2069 6e20 7468 6520 6172 7261  alue in the arra
-000097a0: 7920 7769 6c6c 206e 6f74 2062 6520 6368  y will not be ch
-000097b0: 616e 6765 642e 0d0a 2020 2020 2020 2020  anged...        
-000097c0: 2020 2020 2d20 4261 6e64 2069 6e64 6578      - Band index
-000097d0: 2073 7461 7274 7320 6672 6f6d 2030 0d0a   starts from 0..
-000097e0: 0d0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
-000097f0: 7465 7273 0d0a 2020 2020 2020 2020 2d2d  ters..        --
-00009800: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020  --------..      
-00009810: 2020 6261 6e64 3a20 5b69 6e74 5d0d 0a20    band: [int].. 
-00009820: 2020 2020 2020 2020 2020 2062 616e 6420             band 
-00009830: 696e 6465 7820 7374 6172 7473 2066 726f  index starts fro
-00009840: 6d20 302e 0d0a 2020 2020 2020 2020 6e6f  m 0...        no
-00009850: 5f64 6174 615f 7661 6c75 653a 205b 416e  _data_value: [An
-00009860: 795d 0d0a 2020 2020 2020 2020 2020 2020  y]..            
-00009870: 6e6f 2064 6174 6120 7661 6c75 652e 0d0a  no data value...
-00009880: 2020 2020 2020 2020 2222 220d 0a20 2020          """..   
-00009890: 2020 2020 2074 7279 3a0d 0a20 2020 2020       try:..     
-000098a0: 2020 2020 2020 2073 656c 662e 7261 7374         self.rast
-000098b0: 6572 2e47 6574 5261 7374 6572 4261 6e64  er.GetRasterBand
-000098c0: 2862 616e 6420 2b20 3129 2e53 6574 4e6f  (band + 1).SetNo
-000098d0: 4461 7461 5661 6c75 6528 6e6f 5f64 6174  DataValue(no_dat
-000098e0: 615f 7661 6c75 6529 0d0a 2020 2020 2020  a_value)..      
-000098f0: 2020 6578 6365 7074 2045 7863 6570 7469    except Excepti
-00009900: 6f6e 2061 7320 653a 0d0a 2020 2020 2020  on as e:..      
-00009910: 2020 2020 2020 6966 2073 7472 2865 292e        if str(e).
-00009920: 5f5f 636f 6e74 6169 6e73 5f5f 280d 0a20  __contains__(.. 
-00009930: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00009940: 4174 7465 6d70 7420 746f 2077 7269 7465  Attempt to write
-00009950: 2074 6f20 7265 6164 206f 6e6c 7920 6461   to read only da
-00009960: 7461 7365 7420 696e 2047 4441 4c52 6173  taset in GDALRas
-00009970: 7465 7242 616e 643a 3a46 696c 6c28 292e  terBand::Fill().
-00009980: 220d 0a20 2020 2020 2020 2020 2020 2029  "..            )
-00009990: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-000099a0: 2020 2072 6169 7365 2052 6561 644f 6e6c     raise ReadOnl
-000099b0: 7945 7272 6f72 280d 0a20 2020 2020 2020  yError(..       
-000099c0: 2020 2020 2020 2020 2020 2020 2022 5468               "Th
-000099d0: 6520 4461 7461 7365 7420 6973 206f 7065  e Dataset is ope
-000099e0: 6e20 7769 7468 2061 2072 6561 6420 6f6e  n with a read on
-000099f0: 6c79 2c20 706c 6561 7365 2072 6561 6420  ly, please read 
-00009a00: 7468 6520 7261 7374 6572 2075 7369 6e67  the raster using
-00009a10: 2075 7064 6174 6520 220d 0a20 2020 2020   update "..     
-00009a20: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00009a30: 6163 6365 7373 206d 6f64 6522 0d0a 2020  access mode"..  
-00009a40: 2020 2020 2020 2020 2020 2020 2020 290d                ).
-00009a50: 0a20 2020 2020 2020 2020 2020 2065 6c69  .            eli
-00009a60: 6620 7374 7228 6529 2e5f 5f63 6f6e 7461  f str(e).__conta
-00009a70: 696e 735f 5f28 0d0a 2020 2020 2020 2020  ins__(..        
-00009a80: 2020 2020 2020 2020 2269 6e20 6d65 7468          "in meth
-00009a90: 6f64 2027 4261 6e64 5f53 6574 4e6f 4461  od 'Band_SetNoDa
-00009aa0: 7461 5661 6c75 6527 2c20 6172 6775 6d65  taValue', argume
-00009ab0: 6e74 2032 206f 6620 7479 7065 2027 646f  nt 2 of type 'do
-00009ac0: 7562 6c65 2722 0d0a 2020 2020 2020 2020  uble'"..        
-00009ad0: 2020 2020 293a 0d0a 2020 2020 2020 2020      ):..        
-00009ae0: 2020 2020 2020 2020 7365 6c66 2e72 6173          self.ras
-00009af0: 7465 722e 4765 7452 6173 7465 7242 616e  ter.GetRasterBan
-00009b00: 6428 6261 6e64 202b 2031 292e 5365 744e  d(band + 1).SetN
-00009b10: 6f44 6174 6156 616c 7565 280d 0a20 2020  oDataValue(..   
-00009b20: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00009b30: 206e 702e 666c 6f61 7436 3428 6e6f 5f64   np.float64(no_d
-00009b40: 6174 615f 7661 6c75 6529 0d0a 2020 2020  ata_value)..    
-00009b50: 2020 2020 2020 2020 2020 2020 290d 0a20              ).. 
-00009b60: 2020 2020 2020 2073 656c 662e 5f6e 6f5f         self._no_
-00009b70: 6461 7461 5f76 616c 7565 5b62 616e 645d  data_value[band]
-00009b80: 203d 206e 6f5f 6461 7461 5f76 616c 7565   = no_data_value
-00009b90: 0d0a 0d0a 2020 2020 6465 6620 6368 616e  ....    def chan
-00009ba0: 6765 5f6e 6f5f 6461 7461 5f76 616c 7565  ge_no_data_value
-00009bb0: 2873 656c 662c 206e 6577 5f76 616c 7565  (self, new_value
-00009bc0: 3a20 416e 792c 206f 6c64 5f76 616c 7565  : Any, old_value
-00009bd0: 3a20 416e 7920 3d20 4e6f 6e65 293a 0d0a  : Any = None):..
-00009be0: 2020 2020 2020 2020 2222 2243 6861 6e67          """Chang
-00009bf0: 6520 4e6f 2044 6174 6120 5661 6c75 652e  e No Data Value.
-00009c00: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
-00009c10: 2d20 5365 7420 7468 6520 6e6f 2064 6174  - Set the no dat
-00009c20: 6120 7661 6c75 6520 696e 2061 2061 6c6c  a value in a all
-00009c30: 2072 6173 7465 7220 6261 6e64 732e 0d0a   raster bands...
-00009c40: 2020 2020 2020 2020 2020 2020 2d20 4669              - Fi
-00009c50: 6c6c 7320 7468 6520 7768 6f6c 6520 7261  lls the whole ra
-00009c60: 7374 6572 2077 6974 6820 7468 6520 6e6f  ster with the no
-00009c70: 5f64 6174 615f 7661 6c75 652e 0d0a 2020  _data_value...  
-00009c80: 2020 2020 2020 2020 2020 2d20 4368 616e            - Chan
-00009c90: 6765 2074 6865 206e 6f5f 6461 7461 5f76  ge the no_data_v
-00009ca0: 616c 7565 2069 6e20 7468 6520 6172 7261  alue in the arra
-00009cb0: 7920 696e 2061 6c6c 2062 616e 6473 2e0d  y in all bands..
-00009cc0: 0a0d 0a20 2020 2020 2020 2050 6172 616d  ...        Param
-00009cd0: 6574 6572 730d 0a20 2020 2020 2020 202d  eters..        -
-00009ce0: 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020  ---------..     
-00009cf0: 2020 206e 6577 5f76 616c 7565 3a20 5b6e     new_value: [n
-00009d00: 756d 6572 6963 5d0d 0a20 2020 2020 2020  umeric]..       
-00009d10: 2020 2020 206e 6f20 6461 7461 2076 616c       no data val
-00009d20: 7565 2074 6f20 7365 7420 696e 2074 6865  ue to set in the
-00009d30: 2072 6173 7465 7220 6261 6e64 732e 0d0a   raster bands...
-00009d40: 0d0a 2020 2020 2020 2020 6f6c 645f 7661  ..        old_va
-00009d50: 6c75 653a 205b 6e75 6d65 7269 635d 0d0a  lue: [numeric]..
-00009d60: 2020 2020 2020 2020 2020 2020 6f6c 6420              old 
-00009d70: 6e6f 2064 6174 6120 7661 6c75 6520 7468  no data value th
-00009d80: 6174 2061 7265 2061 6c72 6561 6479 2069  at are already i
-00009d90: 6e20 7468 6520 7261 7374 6572 2062 616e  n the raster ban
-00009da0: 6473 2e0d 0a20 2020 2020 2020 2022 2222  ds...        """
-00009db0: 0d0a 2020 2020 2020 2020 6966 206e 6f74  ..        if not
-00009dc0: 2069 7369 6e73 7461 6e63 6528 6e65 775f   isinstance(new_
-00009dd0: 7661 6c75 652c 206c 6973 7429 3a0d 0a20  value, list):.. 
-00009de0: 2020 2020 2020 2020 2020 206e 6577 5f76             new_v
-00009df0: 616c 7565 203d 205b 6e65 775f 7661 6c75  alue = [new_valu
-00009e00: 655d 202a 2073 656c 662e 6261 6e64 5f63  e] * self.band_c
-00009e10: 6f75 6e74 0d0a 0d0a 2020 2020 2020 2020  ount....        
-00009e20: 6966 206f 6c64 5f76 616c 7565 2069 7320  if old_value is 
-00009e30: 6e6f 7420 4e6f 6e65 2061 6e64 206e 6f74  not None and not
-00009e40: 2069 7369 6e73 7461 6e63 6528 6f6c 645f   isinstance(old_
-00009e50: 7661 6c75 652c 206c 6973 7429 3a0d 0a20  value, list):.. 
-00009e60: 2020 2020 2020 2020 2020 206f 6c64 5f76             old_v
-00009e70: 616c 7565 203d 205b 6f6c 645f 7661 6c75  alue = [old_valu
-00009e80: 655d 202a 2073 656c 662e 6261 6e64 5f63  e] * self.band_c
-00009e90: 6f75 6e74 0d0a 0d0a 2020 2020 2020 2020  ount....        
-00009ea0: 6473 7420 3d20 6764 616c 2e47 6574 4472  dst = gdal.GetDr
-00009eb0: 6976 6572 4279 4e61 6d65 2822 4d45 4d22  iverByName("MEM"
-00009ec0: 292e 4372 6561 7465 436f 7079 2822 222c  ).CreateCopy("",
-00009ed0: 2073 656c 662e 7261 7374 6572 2c20 3029   self.raster, 0)
-00009ee0: 0d0a 2020 2020 2020 2020 2320 6372 6561  ..        # crea
-00009ef0: 7465 2061 206e 6577 2064 6174 6173 6574  te a new dataset
-00009f00: 0d0a 2020 2020 2020 2020 6e65 775f 6461  ..        new_da
-00009f10: 7461 7365 7420 3d20 4461 7461 7365 7428  taset = Dataset(
-00009f20: 6473 7429 0d0a 2020 2020 2020 2020 6e65  dst)..        ne
-00009f30: 775f 6461 7461 7365 742e 5f73 6574 5f6e  w_dataset._set_n
-00009f40: 6f5f 6461 7461 5f76 616c 7565 286e 6577  o_data_value(new
-00009f50: 5f76 616c 7565 290d 0a0d 0a20 2020 2020  _value)....     
-00009f60: 2020 2066 6f72 2062 616e 6420 696e 2072     for band in r
-00009f70: 616e 6765 2873 656c 662e 6261 6e64 5f63  ange(self.band_c
-00009f80: 6f75 6e74 293a 0d0a 2020 2020 2020 2020  ount):..        
-00009f90: 2020 2020 6172 7220 3d20 7365 6c66 2e72      arr = self.r
-00009fa0: 6561 645f 6172 7261 7928 6261 6e64 290d  ead_array(band).
-00009fb0: 0a20 2020 2020 2020 2020 2020 2074 7279  .            try
-00009fc0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00009fd0: 2020 2061 7272 5b6e 702e 6973 636c 6f73     arr[np.isclos
-00009fe0: 6528 6172 722c 206f 6c64 5f76 616c 7565  e(arr, old_value
-00009ff0: 2c20 7274 6f6c 3d30 2e30 3031 295d 203d  , rtol=0.001)] =
-0000a000: 206e 6577 5f76 616c 7565 5b62 616e 645d   new_value[band]
-0000a010: 0d0a 2020 2020 2020 2020 2020 2020 6578  ..            ex
-0000a020: 6365 7074 2054 7970 6545 7272 6f72 3a0d  cept TypeError:.
-0000a030: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000a040: 2072 6169 7365 204e 6f44 6174 6156 616c   raise NoDataVal
-0000a050: 7565 4572 726f 7228 0d0a 2020 2020 2020  ueError(..      
-0000a060: 2020 2020 2020 2020 2020 2020 2020 6622                f"
-0000a070: 5468 6520 6474 7970 6520 6f66 2074 6865  The dtype of the
-0000a080: 2067 6976 656e 206e 6f5f 6461 7461 5f76   given no_data_v
-0000a090: 616c 7565 3a20 7b6e 6577 5f76 616c 7565  alue: {new_value
-0000a0a0: 5b62 616e 645d 7d20 6469 6666 6572 7320  [band]} differs 
-0000a0b0: 6672 6f6d 2074 6865 2064 7479 7065 206f  from the dtype o
-0000a0c0: 6620 7468 6520 220d 0a20 2020 2020 2020  f the "..       
-0000a0d0: 2020 2020 2020 2020 2020 2020 2066 2262               f"b
-0000a0e0: 616e 643a 207b 6764 616c 5f74 6f5f 6e75  and: {gdal_to_nu
-0000a0f0: 6d70 795f 6474 7970 6528 7365 6c66 2e64  mpy_dtype(self.d
-0000a100: 7479 7065 5b62 616e 645d 297d 220d 0a20  type[band])}".. 
-0000a110: 2020 2020 2020 2020 2020 2020 2020 2029                 )
-0000a120: 0d0a 2020 2020 2020 2020 2020 2020 6e65  ..            ne
-0000a130: 775f 6461 7461 7365 742e 7261 7374 6572  w_dataset.raster
-0000a140: 2e47 6574 5261 7374 6572 4261 6e64 2862  .GetRasterBand(b
-0000a150: 616e 6420 2b20 3129 2e57 7269 7465 4172  and + 1).WriteAr
-0000a160: 7261 7928 6172 7229 0d0a 0d0a 2020 2020  ray(arr)....    
-0000a170: 2020 2020 7365 6c66 2e5f 5f69 6e69 745f      self.__init_
-0000a180: 5f28 6e65 775f 6461 7461 7365 742e 7261  _(new_dataset.ra
-0000a190: 7374 6572 290d 0a0d 0a20 2020 2064 6566  ster)....    def
-0000a1a0: 2067 6574 5f63 656c 6c5f 636f 6f72 6473   get_cell_coords
-0000a1b0: 280d 0a20 2020 2020 2020 2073 656c 662c  (..        self,
-0000a1c0: 206c 6f63 6174 696f 6e3a 2073 7472 203d   location: str =
-0000a1d0: 2022 6365 6e74 6572 222c 206d 6173 6b3a   "center", mask:
-0000a1e0: 2062 6f6f 6c20 3d20 4661 6c73 650d 0a20   bool = False.. 
-0000a1f0: 2020 2029 202d 3e20 6e70 2e6e 6461 7272     ) -> np.ndarr
-0000a200: 6179 3a0d 0a20 2020 2020 2020 2022 2222  ay:..        """
-0000a210: 4765 7443 6f6f 7264 732e 0d0a 0d0a 2020  GetCoords.....  
-0000a220: 2020 2020 2020 5265 7475 726e 7320 7468        Returns th
-0000a230: 6520 636f 6f72 6469 6e61 7465 7320 6f66  e coordinates of
-0000a240: 2074 6865 2063 656c 6c20 6365 6e74 7265   the cell centre
-0000a250: 7320 696e 7369 6465 2074 6865 2064 6f6d  s inside the dom
-0000a260: 6169 6e20 286f 6e6c 7920 7468 6520 6365  ain (only the ce
-0000a270: 6c6c 7320 7468 6174 0d0a 2020 2020 2020  lls that..      
-0000a280: 2020 646f 6573 206e 6f74 2068 6176 6520    does not have 
-0000a290: 6e6f 6461 7461 2076 616c 7565 290d 0a0d  nodata value)...
-0000a2a0: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
-0000a2b0: 6572 730d 0a20 2020 2020 2020 202d 2d2d  ers..        ---
-0000a2c0: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
-0000a2d0: 206c 6f63 6174 696f 6e3a 205b 7374 725d   location: [str]
-0000a2e0: 0d0a 2020 2020 2020 2020 2020 2020 6c6f  ..            lo
-0000a2f0: 6361 7469 6f6e 206f 6620 7468 6520 636f  cation of the co
-0000a300: 6f72 6469 6e61 7465 7320 2263 656e 7465  ordinates "cente
-0000a310: 7222 2066 6f72 2074 6865 2063 656e 7465  r" for the cente
-0000a320: 7220 6f66 2061 2063 656c 6c2c 2063 6f72  r of a cell, cor
-0000a330: 6e65 7220 666f 7220 7468 6520 636f 726e  ner for the corn
-0000a340: 6572 206f 6620 7468 6520 6365 6c6c 2e0d  er of the cell..
-0000a350: 0a20 2020 2020 2020 2020 2020 2074 6865  .            the
-0000a360: 2063 6f72 6e65 7220 6973 2074 6865 2074   corner is the t
-0000a370: 6f70 206c 6566 7420 636f 726e 6572 2e0d  op left corner..
-0000a380: 0a20 2020 2020 2020 206d 6173 6b3a 205b  .        mask: [
-0000a390: 626f 6f6c 5d0d 0a20 2020 2020 2020 2020  bool]..         
-0000a3a0: 2020 2054 7275 6520 746f 2045 7865 636c     True to Execl
-0000a3b0: 7564 6520 7468 6520 6365 6c6c 7320 6f75  ude the cells ou
-0000a3c0: 7420 6f66 2074 6865 2064 6f61 696e 2e20  t of the doain. 
-0000a3d0: 4465 6661 756c 7420 6973 2046 616c 7365  Default is False
-0000a3e0: 2e0d 0a0d 0a20 2020 2020 2020 2052 6574  .....        Ret
-0000a3f0: 7572 6e73 0d0a 2020 2020 2020 2020 2d2d  urns..        --
-0000a400: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 2063  -----..        c
-0000a410: 6f6f 7264 7320 3a20 5b6e 702e 6e64 6172  oords : [np.ndar
-0000a420: 7261 795d 0d0a 2020 2020 2020 2020 2020  ray]..          
-0000a430: 2020 4172 7261 7920 7769 7468 2061 206c    Array with a l
-0000a440: 6973 7420 6f66 2074 6865 2063 6f6f 7264  ist of the coord
-0000a450: 696e 6174 6573 2074 6f20 6265 2069 6e74  inates to be int
-0000a460: 6572 706f 6c61 7465 642c 2077 6974 686f  erpolated, witho
-0000a470: 7574 2074 6865 204e 616e 0d0a 2020 2020  ut the Nan..    
-0000a480: 2020 2020 6d61 745f 7261 6e67 6520 3a20      mat_range : 
-0000a490: 5b6e 702e 6e64 6172 7261 795d 0d0a 2020  [np.ndarray]..  
-0000a4a0: 2020 2020 2020 2020 2020 4172 7261 7920            Array 
-0000a4b0: 7769 7468 2061 6c6c 2074 6865 2063 656e  with all the cen
-0000a4c0: 7472 6573 206f 6620 6365 6c6c 7320 696e  tres of cells in
-0000a4d0: 2074 6865 2064 6f6d 6169 6e20 6f66 2074   the domain of t
-0000a4e0: 6865 2044 454d 0d0a 2020 2020 2020 2020  he DEM..        
-0000a4f0: 2222 220d 0a20 2020 2020 2020 2023 2063  """..        # c
-0000a500: 6865 636b 2074 6865 206c 6f63 6174 696f  heck the locatio
-0000a510: 6e20 7061 7261 6d65 7465 720d 0a20 2020  n parameter..   
-0000a520: 2020 2020 206c 6f63 6174 696f 6e20 3d20       location = 
-0000a530: 6c6f 6361 7469 6f6e 2e6c 6f77 6572 2829  location.lower()
-0000a540: 0d0a 2020 2020 2020 2020 6966 206c 6f63  ..        if loc
-0000a550: 6174 696f 6e20 6e6f 7420 696e 205b 2263  ation not in ["c
-0000a560: 656e 7465 7222 2c20 2263 6f72 6e65 7222  enter", "corner"
-0000a570: 5d3a 0d0a 2020 2020 2020 2020 2020 2020  ]:..            
-0000a580: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
-0000a590: 280d 0a20 2020 2020 2020 2020 2020 2020  (..             
-0000a5a0: 2020 2022 5468 6520 6c6f 6361 7469 6f6e     "The location
-0000a5b0: 2070 6172 616d 6574 6572 2063 616e 2068   parameter can h
-0000a5c0: 6176 6520 6f6e 6520 6f66 2074 6865 7365  ave one of these
-0000a5d0: 2076 616c 7565 733a 2027 6365 6e74 6572   values: 'center
-0000a5e0: 272c 2027 636f 726e 6572 272c 2022 0d0a  ', 'corner', "..
-0000a5f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a600: 6622 6275 7420 7468 6520 7661 6c75 653a  f"but the value:
-0000a610: 207b 6c6f 6361 7469 6f6e 7d20 6973 2067   {location} is g
-0000a620: 6976 656e 2e22 0d0a 2020 2020 2020 2020  iven."..        
-0000a630: 2020 2020 290d 0a0d 0a20 2020 2020 2020      )....       
-0000a640: 2069 6620 6c6f 6361 7469 6f6e 203d 3d20   if location == 
-0000a650: 2263 656e 7465 7222 3a0d 0a20 2020 2020  "center":..     
-0000a660: 2020 2020 2020 2023 2041 6464 696e 6720         # Adding 
-0000a670: 302e 352a 6365 6c6c 2073 697a 6520 746f  0.5*cell size to
-0000a680: 2067 6574 2074 6865 2063 656e 7472 650d   get the centre.
-0000a690: 0a20 2020 2020 2020 2020 2020 2061 6464  .            add
-0000a6a0: 5f76 616c 7565 203d 2030 2e35 0d0a 2020  _value = 0.5..  
-0000a6b0: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
-0000a6c0: 2020 2020 2020 2020 2061 6464 5f76 616c           add_val
-0000a6d0: 7565 203d 2030 0d0a 2020 2020 2020 2020  ue = 0..        
-0000a6e0: 2320 4765 7474 696e 6720 6461 7461 2066  # Getting data f
-0000a6f0: 6f72 2074 6865 2077 686f 6c65 2067 7269  or the whole gri
-0000a700: 640d 0a20 2020 2020 2020 2028 0d0a 2020  d..        (..  
-0000a710: 2020 2020 2020 2020 2020 785f 696e 6974            x_init
-0000a720: 2c0d 0a20 2020 2020 2020 2020 2020 2063  ,..            c
-0000a730: 656c 6c5f 7369 7a65 5f78 2c0d 0a20 2020  ell_size_x,..   
-0000a740: 2020 2020 2020 2020 2078 795f 7370 616e           xy_span
-0000a750: 2c0d 0a20 2020 2020 2020 2020 2020 2079  ,..            y
-0000a760: 5f69 6e69 742c 0d0a 2020 2020 2020 2020  _init,..        
-0000a770: 2020 2020 7979 5f73 7061 6e2c 0d0a 2020      yy_span,..  
-0000a780: 2020 2020 2020 2020 2020 6365 6c6c 5f73            cell_s
-0000a790: 697a 655f 792c 0d0a 2020 2020 2020 2020  ize_y,..        
-0000a7a0: 2920 3d20 7365 6c66 2e67 656f 7472 616e  ) = self.geotran
-0000a7b0: 7366 6f72 6d0d 0a20 2020 2020 2020 2069  sform..        i
-0000a7c0: 6620 6365 6c6c 5f73 697a 655f 7820 213d  f cell_size_x !=
-0000a7d0: 2063 656c 6c5f 7369 7a65 5f79 3a0d 0a20   cell_size_y:.. 
-0000a7e0: 2020 2020 2020 2020 2020 2069 6620 6e70             if np
-0000a7f0: 2e61 6273 2863 656c 6c5f 7369 7a65 5f78  .abs(cell_size_x
-0000a800: 2920 213d 206e 702e 6162 7328 6365 6c6c  ) != np.abs(cell
-0000a810: 5f73 697a 655f 7929 3a0d 0a20 2020 2020  _size_y):..     
-0000a820: 2020 2020 2020 2020 2020 206c 6f67 6765             logge
-0000a830: 722e 7761 726e 696e 6728 0d0a 2020 2020  r.warning(..    
-0000a840: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000a850: 6622 5468 6520 6769 7665 6e20 7261 7374  f"The given rast
-0000a860: 6572 2064 6f65 7320 6e6f 7420 6861 7665  er does not have
-0000a870: 2061 2073 7175 6172 6520 6365 6c6c 732c   a square cells,
-0000a880: 2074 6865 2063 656c 6c20 7369 7a65 2069   the cell size i
-0000a890: 7320 7b63 656c 6c5f 7369 7a65 5f78 7d2a  s {cell_size_x}*
-0000a8a0: 7b63 656c 6c5f 7369 7a65 5f79 7d20 220d  {cell_size_y} ".
-0000a8b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000a8c0: 2029 0d0a 0d0a 2020 2020 2020 2020 2320   )....        # 
-0000a8d0: 6461 7461 2069 6e20 7468 6520 6172 7261  data in the arra
-0000a8e0: 790d 0a20 2020 2020 2020 206e 6f5f 7661  y..        no_va
-0000a8f0: 6c20 3d20 7365 6c66 2e6e 6f5f 6461 7461  l = self.no_data
-0000a900: 5f76 616c 7565 5b30 5d0d 0a20 2020 2020  _value[0]..     
-0000a910: 2020 2061 7272 203d 2073 656c 662e 7265     arr = self.re
-0000a920: 6164 5f61 7272 6179 2862 616e 643d 3029  ad_array(band=0)
-0000a930: 0d0a 2020 2020 2020 2020 6966 206d 6173  ..        if mas
-0000a940: 6b20 6973 206e 6f74 204e 6f6e 6520 616e  k is not None an
-0000a950: 6420 6e6f 5f76 616c 206e 6f74 2069 6e20  d no_val not in 
-0000a960: 6172 723a 0d0a 2020 2020 2020 2020 2020  arr:..          
-0000a970: 2020 6c6f 6767 6572 2e77 6172 6e69 6e67    logger.warning
-0000a980: 280d 0a20 2020 2020 2020 2020 2020 2020  (..             
-0000a990: 2020 2022 5468 6520 6e6f 2064 6174 6120     "The no data 
-0000a9a0: 7661 6c75 6520 646f 6573 206e 6f74 2065  value does not e
-0000a9b0: 7869 7374 2069 6e20 7468 6520 6261 6e64  xist in the band
-0000a9c0: 2c20 736f 2061 6c6c 2074 6865 2063 656c  , so all the cel
-0000a9d0: 6c73 2077 696c 6c20 6265 2063 6f73 6964  ls will be cosid
-0000a9e0: 6572 6564 2061 6e64 2074 6865 2022 0d0a  ered and the "..
-0000a9f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000aa00: 226d 6173 6b20 7769 6c6c 206e 6f74 2062  "mask will not b
-0000aa10: 6520 636f 7369 6465 7265 642e 220d 0a20  e cosidered.".. 
-0000aa20: 2020 2020 2020 2020 2020 2029 0d0a 0d0a             )....
-0000aa30: 2020 2020 2020 2020 6966 206d 6173 6b3a          if mask:
-0000aa40: 0d0a 2020 2020 2020 2020 2020 2020 6d61  ..            ma
-0000aa50: 736b 203d 205b 6e6f 5f76 616c 5d0d 0a20  sk = [no_val].. 
-0000aa60: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
-0000aa70: 2020 2020 2020 2020 2020 6d61 736b 203d            mask =
-0000aa80: 204e 6f6e 650d 0a20 2020 2020 2020 2069   None..        i
-0000aa90: 6e64 6963 6573 203d 2067 6574 5f69 6e64  ndices = get_ind
-0000aaa0: 6963 6573 3228 6172 722c 206d 6173 6b3d  ices2(arr, mask=
-0000aab0: 6d61 736b 290d 0a0d 0a20 2020 2020 2020  mask)....       
-0000aac0: 2023 2065 7865 636c 7564 6520 7468 6520   # execlude the 
-0000aad0: 6e6f 5f64 6174 615f 7661 6c75 6573 2063  no_data_values c
-0000aae0: 656c 6c73 2e0d 0a20 2020 2020 2020 2066  ells...        f
-0000aaf0: 3120 3d20 5b69 5b30 5d20 666f 7220 6920  1 = [i[0] for i 
-0000ab00: 696e 2069 6e64 6963 6573 5d0d 0a20 2020  in indices]..   
-0000ab10: 2020 2020 2066 3220 3d20 5b69 5b31 5d20       f2 = [i[1] 
-0000ab20: 666f 7220 6920 696e 2069 6e64 6963 6573  for i in indices
-0000ab30: 5d0d 0a20 2020 2020 2020 2078 203d 205b  ]..        x = [
-0000ab40: 785f 696e 6974 202b 2063 656c 6c5f 7369  x_init + cell_si
-0000ab50: 7a65 5f78 202a 2028 6920 2b20 6164 645f  ze_x * (i + add_
-0000ab60: 7661 6c75 6529 2066 6f72 2069 2069 6e20  value) for i in 
-0000ab70: 6632 5d0d 0a20 2020 2020 2020 2079 203d  f2]..        y =
-0000ab80: 205b 795f 696e 6974 202b 2063 656c 6c5f   [y_init + cell_
-0000ab90: 7369 7a65 5f79 202a 2028 6920 2b20 6164  size_y * (i + ad
-0000aba0: 645f 7661 6c75 6529 2066 6f72 2069 2069  d_value) for i i
-0000abb0: 6e20 6631 5d0d 0a20 2020 2020 2020 2063  n f1]..        c
-0000abc0: 6f6f 7264 7320 3d20 6e70 2e61 7272 6179  oords = np.array
-0000abd0: 286c 6973 7428 7a69 7028 782c 2079 2929  (list(zip(x, y))
-0000abe0: 290d 0a0d 0a20 2020 2020 2020 2072 6574  )....        ret
-0000abf0: 7572 6e20 636f 6f72 6473 0d0a 0d0a 2020  urn coords....  
-0000ac00: 2020 6465 6620 6765 745f 6365 6c6c 5f70    def get_cell_p
-0000ac10: 6f6c 7967 6f6e 7328 7365 6c66 2c20 6d61  olygons(self, ma
-0000ac20: 736b 3d46 616c 7365 2920 2d3e 2047 656f  sk=False) -> Geo
-0000ac30: 4461 7461 4672 616d 653a 0d0a 2020 2020  DataFrame:..    
-0000ac40: 2020 2020 2222 2247 6574 2061 2070 6f6c      """Get a pol
-0000ac50: 7967 6f6e 2073 6861 7065 6c79 2067 656f  ygon shapely geo
-0000ac60: 6d65 7472 7920 666f 7220 7468 6520 7261  metry for the ra
-0000ac70: 7374 6572 2063 656c 6c73 2e0d 0a0d 0a20  ster cells..... 
-0000ac80: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
-0000ac90: 730d 0a20 2020 2020 2020 202d 2d2d 2d2d  s..        -----
-0000aca0: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 206d  -----..        m
-0000acb0: 6173 6b3a 205b 626f 6f6c 5d0d 0a20 2020  ask: [bool]..   
-0000acc0: 2020 2020 2020 2020 2054 7275 6520 746f           True to
-0000acd0: 2067 6574 2074 6865 2070 6f6c 7967 6f6e   get the polygon
-0000ace0: 7320 6f66 2074 6865 2063 656c 6c73 2069  s of the cells i
-0000acf0: 6e73 6964 6520 7468 6520 646f 6d61 696e  nside the domain
-0000ad00: 2e0d 0a0d 0a20 2020 2020 2020 2052 6574  .....        Ret
-0000ad10: 7572 6e73 0d0a 2020 2020 2020 2020 2d2d  urns..        --
-0000ad20: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 2047  -----..        G
-0000ad30: 656f 4461 7461 4672 616d 653a 0d0a 2020  eoDataFrame:..  
-0000ad40: 2020 2020 2020 2020 2020 7769 7468 2074            with t
-0000ad50: 776f 2063 6f6c 756d 6e73 2c20 6765 6f6d  wo columns, geom
-0000ad60: 6574 7279 2c20 616e 6420 6964 0d0a 2020  etry, and id..  
-0000ad70: 2020 2020 2020 2222 220d 0a20 2020 2020        """..     
-0000ad80: 2020 2063 6f6f 7264 7320 3d20 7365 6c66     coords = self
-0000ad90: 2e67 6574 5f63 656c 6c5f 636f 6f72 6473  .get_cell_coords
-0000ada0: 286c 6f63 6174 696f 6e3d 2263 6f72 6e65  (location="corne
-0000adb0: 7222 2c20 6d61 736b 3d6d 6173 6b29 0d0a  r", mask=mask)..
-0000adc0: 2020 2020 2020 2020 6365 6c6c 5f73 697a          cell_siz
-0000add0: 6520 3d20 7365 6c66 2e67 656f 7472 616e  e = self.geotran
-0000ade0: 7366 6f72 6d5b 315d 0d0a 2020 2020 2020  sform[1]..      
-0000adf0: 2020 6570 7367 203d 2073 656c 662e 5f67    epsg = self._g
-0000ae00: 6574 5f65 7073 6728 290d 0a20 2020 2020  et_epsg()..     
-0000ae10: 2020 2078 203d 206e 702e 7a65 726f 7328     x = np.zeros(
-0000ae20: 2863 6f6f 7264 732e 7368 6170 655b 305d  (coords.shape[0]
-0000ae30: 2c20 3429 290d 0a20 2020 2020 2020 2079  , 4))..        y
-0000ae40: 203d 206e 702e 7a65 726f 7328 2863 6f6f   = np.zeros((coo
-0000ae50: 7264 732e 7368 6170 655b 305d 2c20 3429  rds.shape[0], 4)
-0000ae60: 290d 0a20 2020 2020 2020 2023 2066 696c  )..        # fil
-0000ae70: 6c20 7468 6520 746f 7020 6c65 6674 2063  l the top left c
-0000ae80: 6f72 6e65 7220 706f 696e 740d 0a20 2020  orner point..   
-0000ae90: 2020 2020 2078 5b3a 2c20 305d 203d 2063       x[:, 0] = c
-0000aea0: 6f6f 7264 735b 3a2c 2030 5d0d 0a20 2020  oords[:, 0]..   
-0000aeb0: 2020 2020 2079 5b3a 2c20 305d 203d 2063       y[:, 0] = c
-0000aec0: 6f6f 7264 735b 3a2c 2031 5d0d 0a20 2020  oords[:, 1]..   
-0000aed0: 2020 2020 2023 2066 696c 6c20 7468 6520       # fill the 
-0000aee0: 746f 7020 7269 6768 740d 0a20 2020 2020  top right..     
-0000aef0: 2020 2078 5b3a 2c20 315d 203d 2078 5b3a     x[:, 1] = x[:
-0000af00: 2c20 305d 202b 2063 656c 6c5f 7369 7a65  , 0] + cell_size
-0000af10: 0d0a 2020 2020 2020 2020 795b 3a2c 2031  ..        y[:, 1
-0000af20: 5d20 3d20 795b 3a2c 2030 5d0d 0a20 2020  ] = y[:, 0]..   
-0000af30: 2020 2020 2023 2066 696c 6c20 7468 6520       # fill the 
-0000af40: 626f 7474 6f6d 2072 6967 6874 0d0a 2020  bottom right..  
-0000af50: 2020 2020 2020 785b 3a2c 2032 5d20 3d20        x[:, 2] = 
-0000af60: 785b 3a2c 2030 5d20 2b20 6365 6c6c 5f73  x[:, 0] + cell_s
-0000af70: 697a 650d 0a20 2020 2020 2020 2079 5b3a  ize..        y[:
-0000af80: 2c20 325d 203d 2079 5b3a 2c20 305d 202d  , 2] = y[:, 0] -
-0000af90: 2063 656c 6c5f 7369 7a65 0d0a 0d0a 2020   cell_size....  
-0000afa0: 2020 2020 2020 2320 6669 6c6c 2074 6865        # fill the
-0000afb0: 2062 6f74 746f 6d20 6c65 6674 0d0a 2020   bottom left..  
-0000afc0: 2020 2020 2020 785b 3a2c 2033 5d20 3d20        x[:, 3] = 
-0000afd0: 785b 3a2c 2030 5d0d 0a20 2020 2020 2020  x[:, 0]..       
-0000afe0: 2079 5b3a 2c20 335d 203d 2079 5b3a 2c20   y[:, 3] = y[:, 
-0000aff0: 305d 202d 2063 656c 6c5f 7369 7a65 0d0a  0] - cell_size..
-0000b000: 0d0a 2020 2020 2020 2020 636f 6f72 6473  ..        coords
-0000b010: 5f74 7570 6c65 7320 3d20 5b6c 6973 7428  _tuples = [list(
-0000b020: 7a69 7028 785b 3a2c 2069 5d2c 2079 5b3a  zip(x[:, i], y[:
-0000b030: 2c20 695d 2929 2066 6f72 2069 2069 6e20  , i])) for i in 
-0000b040: 7261 6e67 6528 3429 5d0d 0a20 2020 2020  range(4)]..     
-0000b050: 2020 2070 6f6c 7973 5f63 6f6f 7264 7320     polys_coords 
-0000b060: 3d20 5b0d 0a20 2020 2020 2020 2020 2020  = [..           
-0000b070: 2028 0d0a 2020 2020 2020 2020 2020 2020   (..            
-0000b080: 2020 2020 636f 6f72 6473 5f74 7570 6c65      coords_tuple
-0000b090: 735b 305d 5b69 5d2c 0d0a 2020 2020 2020  s[0][i],..      
-0000b0a0: 2020 2020 2020 2020 2020 636f 6f72 6473            coords
-0000b0b0: 5f74 7570 6c65 735b 315d 5b69 5d2c 0d0a  _tuples[1][i],..
-0000b0c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000b0d0: 636f 6f72 6473 5f74 7570 6c65 735b 325d  coords_tuples[2]
-0000b0e0: 5b69 5d2c 0d0a 2020 2020 2020 2020 2020  [i],..          
-0000b0f0: 2020 2020 2020 636f 6f72 6473 5f74 7570        coords_tup
-0000b100: 6c65 735b 335d 5b69 5d2c 0d0a 2020 2020  les[3][i],..    
-0000b110: 2020 2020 2020 2020 290d 0a20 2020 2020          )..     
-0000b120: 2020 2020 2020 2066 6f72 2069 2069 6e20         for i in 
-0000b130: 7261 6e67 6528 6c65 6e28 7829 290d 0a20  range(len(x)).. 
-0000b140: 2020 2020 2020 205d 0d0a 2020 2020 2020         ]..      
-0000b150: 2020 706f 6c79 676f 6e73 203d 206c 6973    polygons = lis
-0000b160: 7428 6d61 7028 4665 6174 7572 6543 6f6c  t(map(FeatureCol
-0000b170: 6c65 6374 696f 6e2e 6372 6561 7465 5f70  lection.create_p
-0000b180: 6f6c 7967 6f6e 2c20 706f 6c79 735f 636f  olygon, polys_co
-0000b190: 6f72 6473 2929 0d0a 2020 2020 2020 2020  ords))..        
-0000b1a0: 6764 6620 3d20 6770 642e 4765 6f44 6174  gdf = gpd.GeoDat
-0000b1b0: 6146 7261 6d65 2867 656f 6d65 7472 793d  aFrame(geometry=
-0000b1c0: 706f 6c79 676f 6e73 290d 0a20 2020 2020  polygons)..     
-0000b1d0: 2020 2067 6466 2e73 6574 5f63 7273 2865     gdf.set_crs(e
-0000b1e0: 7073 673d 6570 7367 2c20 696e 706c 6163  psg=epsg, inplac
-0000b1f0: 653d 5472 7565 290d 0a20 2020 2020 2020  e=True)..       
-0000b200: 2067 6466 5b22 6964 225d 203d 2067 6466   gdf["id"] = gdf
-0000b210: 2e69 6e64 6578 0d0a 2020 2020 2020 2020  .index..        
-0000b220: 7265 7475 726e 2067 6466 0d0a 0d0a 2020  return gdf....  
-0000b230: 2020 6465 6620 6765 745f 6365 6c6c 5f70    def get_cell_p
-0000b240: 6f69 6e74 7328 7365 6c66 2c20 6c6f 6361  oints(self, loca
-0000b250: 7469 6f6e 3a20 7374 7220 3d20 2263 656e  tion: str = "cen
-0000b260: 7465 7222 2c20 6d61 736b 3d46 616c 7365  ter", mask=False
-0000b270: 2920 2d3e 2047 656f 4461 7461 4672 616d  ) -> GeoDataFram
-0000b280: 653a 0d0a 2020 2020 2020 2020 2222 2247  e:..        """G
-0000b290: 6574 2061 2070 6f69 6e74 2073 6861 7065  et a point shape
-0000b2a0: 6c79 2067 656f 6d65 7472 7920 666f 7220  ly geometry for 
-0000b2b0: 7468 6520 7261 7374 6572 2063 656c 6c73  the raster cells
-0000b2c0: 2063 656e 7465 7220 706f 696e 742e 0d0a   center point...
-0000b2d0: 0d0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
-0000b2e0: 7465 7273 0d0a 2020 2020 2020 2020 2d2d  ters..        --
-0000b2f0: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020  --------..      
-0000b300: 2020 6c6f 6361 7469 6f6e 3a20 5b73 7472    location: [str
-0000b310: 5d0d 0a20 2020 2020 2020 2020 2020 206c  ]..            l
-0000b320: 6f63 6174 696f 6e20 6f66 2074 6865 2070  ocation of the p
-0000b330: 6f69 6e74 2c20 5b22 636f 726e 6572 222c  oint, ["corner",
-0000b340: 2022 6365 6e74 6572 225d 2e20 4465 6661   "center"]. Defa
-0000b350: 756c 7420 6973 2022 6365 6e74 6572 222e  ult is "center".
-0000b360: 0d0a 2020 2020 2020 2020 6d61 736b 3a20  ..        mask: 
-0000b370: 5b62 6f6f 6c5d 0d0a 2020 2020 2020 2020  [bool]..        
-0000b380: 2020 2020 5472 7565 2074 6f20 6765 7420      True to get 
-0000b390: 7468 6520 706f 6c79 676f 6e73 206f 6620  the polygons of 
-0000b3a0: 7468 6520 6365 6c6c 7320 696e 7369 6465  the cells inside
-0000b3b0: 2074 6865 2064 6f6d 6169 6e2e 0d0a 0d0a   the domain.....
-0000b3c0: 2020 2020 2020 2020 5265 7475 726e 730d          Returns.
-0000b3d0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-0000b3e0: 0d0a 2020 2020 2020 2020 4765 6f44 6174  ..        GeoDat
-0000b3f0: 6146 7261 6d65 3a0d 0a20 2020 2020 2020  aFrame:..       
-0000b400: 2020 2020 2077 6974 6820 7477 6f20 636f       with two co
-0000b410: 6c75 6d6e 732c 2067 656f 6d65 7472 792c  lumns, geometry,
-0000b420: 2061 6e64 2069 640d 0a20 2020 2020 2020   and id..       
-0000b430: 2022 2222 0d0a 2020 2020 2020 2020 636f   """..        co
-0000b440: 6f72 6473 203d 2073 656c 662e 6765 745f  ords = self.get_
-0000b450: 6365 6c6c 5f63 6f6f 7264 7328 6c6f 6361  cell_coords(loca
-0000b460: 7469 6f6e 3d6c 6f63 6174 696f 6e2c 206d  tion=location, m
-0000b470: 6173 6b3d 6d61 736b 290d 0a20 2020 2020  ask=mask)..     
-0000b480: 2020 2065 7073 6720 3d20 7365 6c66 2e5f     epsg = self._
-0000b490: 6765 745f 6570 7367 2829 0d0a 0d0a 2020  get_epsg()....  
-0000b4a0: 2020 2020 2020 636f 6f72 6473 5f74 7570        coords_tup
-0000b4b0: 6c65 7320 3d20 6c69 7374 287a 6970 2863  les = list(zip(c
-0000b4c0: 6f6f 7264 735b 3a2c 2030 5d2c 2063 6f6f  oords[:, 0], coo
-0000b4d0: 7264 735b 3a2c 2031 5d29 290d 0a20 2020  rds[:, 1]))..   
-0000b4e0: 2020 2020 2070 6f69 6e74 7320 3d20 4665       points = Fe
-0000b4f0: 6174 7572 6543 6f6c 6c65 6374 696f 6e2e  atureCollection.
-0000b500: 6372 6561 7465 5f70 6f69 6e74 2863 6f6f  create_point(coo
-0000b510: 7264 735f 7475 706c 6573 290d 0a20 2020  rds_tuples)..   
-0000b520: 2020 2020 2067 6466 203d 2067 7064 2e47       gdf = gpd.G
-0000b530: 656f 4461 7461 4672 616d 6528 6765 6f6d  eoDataFrame(geom
-0000b540: 6574 7279 3d70 6f69 6e74 7329 0d0a 2020  etry=points)..  
-0000b550: 2020 2020 2020 6764 662e 7365 745f 6372        gdf.set_cr
-0000b560: 7328 6570 7367 3d65 7073 672c 2069 6e70  s(epsg=epsg, inp
-0000b570: 6c61 6365 3d54 7275 6529 0d0a 2020 2020  lace=True)..    
-0000b580: 2020 2020 6764 665b 2269 6422 5d20 3d20      gdf["id"] = 
-0000b590: 6764 662e 696e 6465 780d 0a20 2020 2020  gdf.index..     
-0000b5a0: 2020 2072 6574 7572 6e20 6764 660d 0a0d     return gdf...
-0000b5b0: 0a20 2020 2064 6566 2074 6f5f 6669 6c65  .    def to_file
-0000b5c0: 2873 656c 662c 2070 6174 683a 2073 7472  (self, path: str
-0000b5d0: 2c20 6261 6e64 3a20 696e 7420 3d20 3029  , band: int = 0)
-0000b5e0: 202d 3e20 4e6f 6e65 3a0d 0a20 2020 2020   -> None:..     
-0000b5f0: 2020 2022 2222 5361 7665 2074 6f20 6765     """Save to ge
-0000b600: 6f74 6966 6620 666f 726d 6174 2e0d 0a0d  otiff format....
-0000b610: 0a20 2020 2020 2020 2020 2020 2073 6176  .            sav
-0000b620: 6520 7361 7665 7320 6120 7261 7374 6572  e saves a raster
-0000b630: 2074 6f20 6120 7061 7468 2c20 7468 6520   to a path, the 
-0000b640: 7479 7065 206f 6620 7468 6520 6472 6976  type of the driv
-0000b650: 6572 2028 6765 6f72 6966 662f 6e65 7463  er (georiff/netc
-0000b660: 6466 2f61 7363 6969 2920 7769 6c6c 2062  df/ascii) will b
-0000b670: 6520 696d 706c 6965 6420 6672 6f6d 2074  e implied from t
-0000b680: 6865 0d0a 2020 2020 2020 2020 2020 2020  he..            
-0000b690: 6578 7465 6e73 696f 6e20 6174 2074 6865  extension at the
-0000b6a0: 2065 6e64 206f 6620 7468 6520 6769 7665   end of the give
-0000b6b0: 6e20 7061 7468 2e0d 0a0d 0a20 2020 2020  n path.....     
-0000b6c0: 2020 2050 6172 616d 6574 6572 730d 0a20     Parameters.. 
-0000b6d0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
-0000b6e0: 2d0d 0a20 2020 2020 2020 2070 6174 683a  -..        path:
-0000b6f0: 205b 7374 7269 6e67 5d0d 0a20 2020 2020   [string]..     
-0000b700: 2020 2020 2020 2061 2070 6174 6820 696e         a path in
-0000b710: 636c 7564 6e67 2074 6865 206e 616d 6520  cludng the name 
-0000b720: 6f66 2074 6865 2072 6173 7465 7220 616e  of the raster an
-0000b730: 6420 6578 7465 6e74 696f 6e2e 0d0a 2020  d extention...  
-0000b740: 2020 2020 2020 2020 2020 3e3e 3e20 7061            >>> pa
-0000b750: 7468 203d 2022 6461 7461 2f63 726f 7070  th = "data/cropp
-0000b760: 6564 2e74 6966 220d 0a20 2020 2020 2020  ed.tif"..       
-0000b770: 2062 616e 643a 205b 696e 745d 0d0a 2020   band: [int]..  
-0000b780: 2020 2020 2020 2020 2020 6261 6e64 2069            band i
-0000b790: 6e64 6578 2c20 6e65 6564 6564 206f 6e6c  ndex, needed onl
-0000b7a0: 7920 696e 2063 6173 6520 6f66 2061 7363  y in case of asc
-0000b7b0: 6969 2064 7269 7665 7273 2e20 4465 6661  ii drivers. Defa
-0000b7c0: 756c 7420 6973 2030 2e0d 0a0d 0a20 2020  ult is 0.....   
-0000b7d0: 2020 2020 2045 7861 6d70 6c65 730d 0a20       Examples.. 
-0000b7e0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d0d         --------.
-0000b7f0: 0a20 2020 2020 2020 203e 3e3e 2072 6173  .        >>> ras
-0000b800: 7465 725f 6f62 6a20 3d20 4461 7461 7365  ter_obj = Datase
-0000b810: 742e 7265 6164 5f66 696c 6528 2270 6174  t.read_file("pat
-0000b820: 682f 746f 2f66 696c 652f 2a2a 2a2e 7469  h/to/file/***.ti
-0000b830: 6622 290d 0a20 2020 2020 2020 203e 3e3e  f")..        >>>
-0000b840: 206f 7574 7075 745f 7061 7468 203d 2022   output_path = "
-0000b850: 6578 616d 706c 6573 2f47 4953 2f64 6174  examples/GIS/dat
-0000b860: 612f 7361 7665 5f72 6173 7465 725f 7465  a/save_raster_te
-0000b870: 7374 2e74 6966 220d 0a20 2020 2020 2020  st.tif"..       
-0000b880: 203e 3e3e 2072 6173 7465 725f 6f62 6a2e   >>> raster_obj.
-0000b890: 746f 5f66 696c 6528 6f75 7470 7574 5f70  to_file(output_p
-0000b8a0: 6174 6829 0d0a 2020 2020 2020 2020 2222  ath)..        ""
-0000b8b0: 220d 0a20 2020 2020 2020 2069 6620 6e6f  "..        if no
-0000b8c0: 7420 6973 696e 7374 616e 6365 2870 6174  t isinstance(pat
-0000b8d0: 682c 2073 7472 293a 0d0a 2020 2020 2020  h, str):..      
-0000b8e0: 2020 2020 2020 7261 6973 6520 5479 7065        raise Type
-0000b8f0: 4572 726f 7228 2270 6174 6820 696e 7075  Error("path inpu
-0000b900: 7420 7368 6f75 6c64 2062 6520 7374 7269  t should be stri
-0000b910: 6e67 2074 7970 6522 290d 0a0d 0a20 2020  ng type")....   
-0000b920: 2020 2020 2065 7874 656e 7369 6f6e 203d       extension =
-0000b930: 2070 6174 682e 7370 6c69 7428 222e 2229   path.split(".")
-0000b940: 5b2d 315d 0d0a 2020 2020 2020 2020 6472  [-1]..        dr
-0000b950: 6976 6572 203d 2043 4154 414c 4f47 2e67  iver = CATALOG.g
-0000b960: 6574 5f64 7269 7665 725f 6e61 6d65 5f62  et_driver_name_b
-0000b970: 795f 6578 7465 6e73 696f 6e28 6578 7465  y_extension(exte
-0000b980: 6e73 696f 6e29 0d0a 2020 2020 2020 2020  nsion)..        
-0000b990: 2320 6966 206e 6f74 2043 4154 414c 4f47  # if not CATALOG
-0000b9a0: 2e65 7869 7374 7328 6472 6976 6572 293a  .exists(driver):
-0000b9b0: 0d0a 2020 2020 2020 2020 2320 2020 2020  ..        #     
-0000b9c0: 7261 6973 6520 4472 6976 6572 4e6f 7445  raise DriverNotE
-0000b9d0: 7869 7374 4572 726f 7228 6622 5468 6520  xistError(f"The 
-0000b9e0: 6769 7665 6e20 6472 6976 6572 3a20 7b64  given driver: {d
-0000b9f0: 7269 7665 727d 2064 6f65 7320 6e6f 7420  river} does not 
-0000ba00: 6578 6973 7422 290d 0a20 2020 2020 2020  exist")..       
-0000ba10: 2064 7269 7665 725f 6e61 6d65 203d 2043   driver_name = C
-0000ba20: 4154 414c 4f47 2e67 6574 5f67 6461 6c5f  ATALOG.get_gdal_
-0000ba30: 6e61 6d65 2864 7269 7665 7229 0d0a 0d0a  name(driver)....
-0000ba40: 2020 2020 2020 2020 6966 2064 7269 7665          if drive
-0000ba50: 7220 3d3d 2022 6173 6369 6922 3a0d 0a20  r == "ascii":.. 
-0000ba60: 2020 2020 2020 2020 2020 2061 7272 203d             arr =
-0000ba70: 2073 656c 662e 7265 6164 5f61 7272 6179   self.read_array
-0000ba80: 2862 616e 643d 6261 6e64 290d 0a20 2020  (band=band)..   
-0000ba90: 2020 2020 2020 2020 206e 6f5f 6461 7461           no_data
-0000baa0: 5f76 616c 7565 203d 2073 656c 662e 6e6f  _value = self.no
-0000bab0: 5f64 6174 615f 7661 6c75 655b 6261 6e64  _data_value[band
-0000bac0: 5d0d 0a20 2020 2020 2020 2020 2020 2078  ]..            x
-0000bad0: 6d69 6e2c 2079 6d69 6e2c 205f 2c20 5f20  min, ymin, _, _ 
-0000bae0: 3d20 7365 6c66 2e62 626f 780d 0a20 2020  = self.bbox..   
-0000baf0: 2020 2020 2020 2020 205f 696f 2e74 6f5f           _io.to_
-0000bb00: 6173 6369 6928 6172 722c 2073 656c 662e  ascii(arr, self.
-0000bb10: 6365 6c6c 5f73 697a 652c 2078 6d69 6e2c  cell_size, xmin,
-0000bb20: 2079 6d69 6e2c 206e 6f5f 6461 7461 5f76   ymin, no_data_v
-0000bb30: 616c 7565 2c20 7061 7468 290d 0a20 2020  alue, path)..   
-0000bb40: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
-0000bb50: 2020 2020 2020 2020 6473 7420 3d20 6764          dst = gd
-0000bb60: 616c 2e47 6574 4472 6976 6572 4279 4e61  al.GetDriverByNa
-0000bb70: 6d65 2864 7269 7665 725f 6e61 6d65 292e  me(driver_name).
-0000bb80: 4372 6561 7465 436f 7079 2870 6174 682c  CreateCopy(path,
-0000bb90: 2073 656c 662e 7261 7374 6572 2c20 3029   self.raster, 0)
-0000bba0: 0d0a 2020 2020 2020 2020 2020 2020 6473  ..            ds
-0000bbb0: 7420 3d20 4e6f 6e65 2020 2320 466c 7573  t = None  # Flus
-0000bbc0: 6820 7468 6520 6461 7461 7365 7420 746f  h the dataset to
-0000bbd0: 2064 6973 6b0d 0a20 2020 2020 2020 2020   disk..         
-0000bbe0: 2020 2023 2070 7269 6e74 2074 6f20 676f     # print to go
-0000bbf0: 2061 726f 756e 6420 7468 6520 6173 7369   around the assi
-0000bc00: 676e 6564 2062 7574 206e 6576 6572 2075  gned but never u
-0000bc10: 7365 6420 7072 652d 636f 6d6d 6974 2069  sed pre-commit i
-0000bc20: 7373 7565 0d0a 2020 2020 2020 2020 2020  ssue..          
-0000bc30: 2020 7072 696e 7428 6473 7429 0d0a 0d0a    print(dst)....
-0000bc40: 2020 2020 6465 6620 746f 5f70 6f6c 7967      def to_polyg
-0000bc50: 6f6e 280d 0a20 2020 2020 2020 2073 656c  on(..        sel
-0000bc60: 662c 0d0a 2020 2020 2020 2020 6261 6e64  f,..        band
-0000bc70: 3a20 696e 7420 3d20 302c 0d0a 2020 2020  : int = 0,..    
-0000bc80: 2020 2020 636f 6c5f 6e61 6d65 3a20 416e      col_name: An
-0000bc90: 7920 3d20 2269 6422 2c0d 0a20 2020 2020  y = "id",..     
-0000bca0: 2020 2070 6174 683a 2073 7472 203d 204e     path: str = N
-0000bcb0: 6f6e 652c 0d0a 2020 2020 2020 2020 6472  one,..        dr
-0000bcc0: 6976 6572 3a20 7374 7220 3d20 226d 656d  iver: str = "mem
-0000bcd0: 6f72 7922 2c0d 0a20 2020 2029 202d 3e20  ory",..    ) -> 
-0000bce0: 556e 696f 6e5b 4765 6f44 6174 6146 7261  Union[GeoDataFra
-0000bcf0: 6d65 2c20 4e6f 6e65 5d3a 0d0a 2020 2020  me, None]:..    
-0000bd00: 2020 2020 2222 2270 6f6c 7967 6f6e 697a      """polygoniz
-0000bd10: 652e 0d0a 0d0a 2020 2020 2020 2020 2020  e.....          
-0000bd20: 2020 5261 7374 6572 546f 506f 6c79 676f    RasterToPolygo
-0000bd30: 6e20 7461 6b65 7320 6120 6764 616c 2044  n takes a gdal D
-0000bd40: 6174 6163 7562 6520 6f62 6a65 6374 2061  atacube object a
-0000bd50: 6e64 2067 726f 7570 206e 6569 6768 626f  nd group neighbo
-0000bd60: 7269 6e67 2063 656c 6c73 2077 6974 6820  ring cells with 
-0000bd70: 7468 6520 7361 6d65 2076 616c 7565 2069  the same value i
-0000bd80: 6e74 6f20 6f6e 650d 0a20 2020 2020 2020  nto one..       
-0000bd90: 2020 2020 2070 6f6c 7967 6f6e 2c20 7468       polygon, th
-0000bda0: 6520 7265 7375 6c74 6564 2076 6563 746f  e resulted vecto
-0000bdb0: 7220 7769 6c6c 2062 6520 7361 7665 6420  r will be saved 
-0000bdc0: 746f 2064 6973 6b20 6173 2061 2067 656f  to disk as a geo
-0000bdd0: 6a73 6f6e 2066 696c 650d 0a0d 0a20 2020  json file....   
-0000bde0: 2020 2020 2050 6172 616d 6574 6572 730d       Parameters.
-0000bdf0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-0000be00: 2d2d 2d0d 0a20 2020 2020 2020 2062 616e  ---..        ban
-0000be10: 643a 205b 696e 745d 0d0a 2020 2020 2020  d: [int]..      
-0000be20: 2020 2020 2020 7261 7374 6572 2062 616e        raster ban
-0000be30: 6420 696e 6465 7820 5b31 2c32 2c33 2c2e  d index [1,2,3,.
-0000be40: 2e5d 0d0a 2020 2020 2020 2020 7061 7468  .]..        path
-0000be50: 3a5b 7374 725d 0d0a 2020 2020 2020 2020  :[str]..        
-0000be60: 2020 2020 7061 7468 2077 6865 7265 2079      path where y
-0000be70: 6f75 2077 616e 7420 746f 2073 6176 6520  ou want to save 
-0000be80: 7468 6520 706f 6c79 676f 6e2c 2074 6865  the polygon, the
-0000be90: 2070 6174 6820 7368 6f75 6c64 2069 6e63   path should inc
-0000bea0: 6c75 6465 2074 6865 2065 7874 656e 7369  lude the extensi
-0000beb0: 6f6e 2061 7420 7468 6520 656e 640d 0a20  on at the end.. 
-0000bec0: 2020 2020 2020 2020 2020 2028 692e 652e             (i.e.
-0000bed0: 2070 6174 682f 7665 6374 6f72 5f6e 616d   path/vector_nam
-0000bee0: 652e 6765 6f6a 736f 6e29 0d0a 2020 2020  e.geojson)..    
-0000bef0: 2020 2020 636f 6c5f 6e61 6d65 3a0d 0a20      col_name:.. 
-0000bf00: 2020 2020 2020 2020 2020 206e 616d 6520             name 
-0000bf10: 6f66 2074 6865 2063 6f6c 756d 6e20 7768  of the column wh
-0000bf20: 6572 6520 7468 6520 7261 7374 6572 2064  ere the raster d
-0000bf30: 6174 6120 7769 6c6c 2062 6520 7374 6f72  ata will be stor
-0000bf40: 6564 2e0d 0a20 2020 2020 2020 2064 7269  ed...        dri
-0000bf50: 7665 723a 205b 7374 725d 0d0a 2020 2020  ver: [str]..    
-0000bf60: 2020 2020 2020 2020 7665 6374 6f72 2064          vector d
-0000bf70: 7269 7665 722c 2066 6f72 2061 6c6c 2070  river, for all p
-0000bf80: 6f73 7369 626c 6520 6472 6976 6572 7320  ossible drivers 
-0000bf90: 6368 6563 6b20 6874 7470 733a 2f2f 6764  check https://gd
-0000bfa0: 616c 2e6f 7267 2f64 7269 7665 7273 2f76  al.org/drivers/v
-0000bfb0: 6563 746f 722f 696e 6465 782e 6874 6d6c  ector/index.html
-0000bfc0: 202e 0d0a 2020 2020 2020 2020 2020 2020   ...            
-0000bfd0: 4465 6661 756c 7420 6973 2022 4765 6f4a  Default is "GeoJ
-0000bfe0: 534f 4e22 2e0d 0a0d 0a20 2020 2020 2020  SON".....       
-0000bff0: 2052 6574 7572 6e73 0d0a 2020 2020 2020   Returns..      
-0000c000: 2020 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020    -------..     
-0000c010: 2020 204e 6f6e 650d 0a20 2020 2020 2020     None..       
-0000c020: 2022 2222 0d0a 2020 2020 2020 2020 6261   """..        ba
-0000c030: 6e64 203d 2073 656c 662e 7261 7374 6572  nd = self.raster
-0000c040: 2e47 6574 5261 7374 6572 4261 6e64 2862  .GetRasterBand(b
-0000c050: 616e 6420 2b20 3129 0d0a 2020 2020 2020  and + 1)..      
-0000c060: 2020 7372 7320 3d20 6f73 722e 5370 6174    srs = osr.Spat
-0000c070: 6961 6c52 6566 6572 656e 6365 2877 6b74  ialReference(wkt
-0000c080: 3d73 656c 662e 6372 7329 0d0a 2020 2020  =self.crs)..    
-0000c090: 2020 2020 6966 2070 6174 6820 6973 204e      if path is N
-0000c0a0: 6f6e 653a 0d0a 2020 2020 2020 2020 2020  one:..          
-0000c0b0: 2020 6473 745f 6c61 7965 726e 616d 6520    dst_layername 
-0000c0c0: 3d20 2269 6422 0d0a 2020 2020 2020 2020  = "id"..        
-0000c0d0: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
-0000c0e0: 2020 2064 7374 5f6c 6179 6572 6e61 6d65     dst_layername
-0000c0f0: 203d 2070 6174 682e 7370 6c69 7428 222e   = path.split(".
-0000c100: 2229 5b30 5d2e 7370 6c69 7428 222f 2229  ")[0].split("/")
-0000c110: 5b2d 315d 0d0a 0d0a 2020 2020 2020 2020  [-1]....        
-0000c120: 6473 745f 6473 203d 2046 6561 7475 7265  dst_ds = Feature
-0000c130: 436f 6c6c 6563 7469 6f6e 2e63 7265 6174  Collection.creat
-0000c140: 655f 6473 2864 7269 7665 722c 2070 6174  e_ds(driver, pat
-0000c150: 6829 0d0a 2020 2020 2020 2020 6473 745f  h)..        dst_
-0000c160: 6c61 7965 7220 3d20 6473 745f 6473 2e43  layer = dst_ds.C
-0000c170: 7265 6174 654c 6179 6572 2864 7374 5f6c  reateLayer(dst_l
-0000c180: 6179 6572 6e61 6d65 2c20 7372 733d 7372  ayername, srs=sr
-0000c190: 7329 0d0a 2020 2020 2020 2020 6474 7970  s)..        dtyp
-0000c1a0: 6520 3d20 6764 616c 5f74 6f5f 6f67 725f  e = gdal_to_ogr_
-0000c1b0: 6474 7970 6528 7365 6c66 2e72 6173 7465  dtype(self.raste
-0000c1c0: 7229 0d0a 2020 2020 2020 2020 6e65 7746  r)..        newF
-0000c1d0: 6965 6c64 203d 206f 6772 2e46 6965 6c64  ield = ogr.Field
-0000c1e0: 4465 666e 2863 6f6c 5f6e 616d 652c 2064  Defn(col_name, d
-0000c1f0: 7479 7065 290d 0a20 2020 2020 2020 2064  type)..        d
-0000c200: 7374 5f6c 6179 6572 2e43 7265 6174 6546  st_layer.CreateF
-0000c210: 6965 6c64 286e 6577 4669 656c 6429 0d0a  ield(newField)..
-0000c220: 2020 2020 2020 2020 6764 616c 2e50 6f6c          gdal.Pol
-0000c230: 7967 6f6e 697a 6528 6261 6e64 2c20 6261  ygonize(band, ba
-0000c240: 6e64 2c20 6473 745f 6c61 7965 722c 2030  nd, dst_layer, 0
-0000c250: 2c20 5b5d 2c20 6361 6c6c 6261 636b 3d4e  , [], callback=N
-0000c260: 6f6e 6529 0d0a 2020 2020 2020 2020 6966  one)..        if
-0000c270: 2070 6174 683a 0d0a 2020 2020 2020 2020   path:..        
-0000c280: 2020 2020 6473 745f 6c61 7965 7220 3d20      dst_layer = 
-0000c290: 4e6f 6e65 0d0a 2020 2020 2020 2020 2020  None..          
-0000c2a0: 2020 6473 745f 6473 203d 204e 6f6e 650d    dst_ds = None.
-0000c2b0: 0a20 2020 2020 2020 2065 6c73 653a 0d0a  .        else:..
-0000c2c0: 2020 2020 2020 2020 2020 2020 7665 6374              vect
-0000c2d0: 6f72 203d 2046 6561 7475 7265 436f 6c6c  or = FeatureColl
-0000c2e0: 6563 7469 6f6e 2864 7374 5f64 7329 0d0a  ection(dst_ds)..
-0000c2f0: 2020 2020 2020 2020 2020 2020 6764 6620              gdf 
-0000c300: 3d20 7665 6374 6f72 2e5f 6473 5f74 6f5f  = vector._ds_to_
-0000c310: 6764 6628 290d 0a20 2020 2020 2020 2020  gdf()..         
-0000c320: 2020 2072 6574 7572 6e20 6764 660d 0a0d     return gdf...
-0000c330: 0a20 2020 2064 6566 2074 6f5f 6765 6f64  .    def to_geod
-0000c340: 6174 6166 7261 6d65 280d 0a20 2020 2020  ataframe(..     
-0000c350: 2020 2073 656c 662c 0d0a 2020 2020 2020     self,..      
-0000c360: 2020 7665 6374 6f72 5f6d 6173 6b3a 2055    vector_mask: U
-0000c370: 6e69 6f6e 5b73 7472 2c20 4765 6f44 6174  nion[str, GeoDat
-0000c380: 6146 7261 6d65 5d20 3d20 4e6f 6e65 2c0d  aFrame] = None,.
-0000c390: 0a20 2020 2020 2020 2061 6464 5f67 656f  .        add_geo
-0000c3a0: 6d65 7472 793a 2073 7472 203d 204e 6f6e  metry: str = Non
-0000c3b0: 652c 0d0a 2020 2020 2020 2020 7469 6c65  e,..        tile
-0000c3c0: 3a20 626f 6f6c 203d 2046 616c 7365 2c0d  : bool = False,.
-0000c3d0: 0a20 2020 2020 2020 2074 696c 655f 7369  .        tile_si
-0000c3e0: 7a65 3a20 696e 7420 3d20 3135 3030 2c0d  ze: int = 1500,.
-0000c3f0: 0a20 2020 2029 202d 3e20 556e 696f 6e5b  .    ) -> Union[
-0000c400: 4461 7461 4672 616d 652c 2047 656f 4461  DataFrame, GeoDa
-0000c410: 7461 4672 616d 655d 3a0d 0a20 2020 2020  taFrame]:..     
-0000c420: 2020 2022 2222 436f 6e76 6572 7420 6120     """Convert a 
-0000c430: 7261 7374 6572 2074 6f20 6120 4765 6f44  raster to a GeoD
-0000c440: 6174 6146 7261 6d65 2e0d 0a0d 0a20 2020  ataFrame.....   
-0000c450: 2020 2020 2020 2020 2054 6865 2066 756e           The fun
-0000c460: 6374 696f 6e20 646f 2074 6865 2066 6f6c  ction do the fol
-0000c470: 6c6f 7769 6e67 0d0a 2020 2020 2020 2020  lowing..        
-0000c480: 2020 2020 2d20 466c 6174 7465 6e20 7468      - Flatten th
-0000c490: 6520 6172 7261 7920 696e 2065 6163 6820  e array in each 
-0000c4a0: 6261 6e64 2069 6e20 7468 6520 7261 7374  band in the rast
-0000c4b0: 6572 2074 6865 6e20 6d61 736b 2074 6865  er then mask the
-0000c4c0: 2076 616c 7565 7320 6966 2061 2076 6563   values if a vec
-0000c4d0: 746f 725f 6d61 736b 0d0a 2020 2020 2020  tor_mask..      
-0000c4e0: 2020 2020 2020 6669 6c65 2069 7320 6769        file is gi
-0000c4f0: 7665 6e20 6f74 6865 7277 6973 6520 6974  ven otherwise it
-0000c500: 2077 696c 6c20 666c 6174 7465 6e20 616c   will flatten al
-0000c510: 6c20 7661 6c75 6573 2e0d 0a20 2020 2020  l values...     
-0000c520: 2020 2020 2020 202d 2050 7574 2074 6865         - Put the
-0000c530: 2076 616c 7565 7320 666f 7220 6561 6368   values for each
-0000c540: 2062 616e 6420 696e 2061 2063 6f6c 756d   band in a colum
-0000c550: 6e20 696e 2061 2064 6174 6166 7261 6d65  n in a dataframe
-0000c560: 2075 6e64 6572 2074 6865 206e 616d 6520   under the name 
-0000c570: 6f66 2074 6865 2072 6173 7465 7220 6261  of the raster ba
-0000c580: 6e64 2c20 6275 7420 6966 206e 6f20 6d65  nd, but if no me
-0000c590: 7461 0d0a 2020 2020 2020 2020 2020 2020  ta..            
-0000c5a0: 6461 7461 2069 6e20 7468 6520 7261 7374  data in the rast
-0000c5b0: 6572 2062 616e 6420 6578 6973 7473 2c20  er band exists, 
-0000c5c0: 616e 2069 6e64 6578 206e 756d 6265 7220  an index number 
-0000c5d0: 7769 6c6c 2062 6520 7573 6564 205b 312c  will be used [1,
-0000c5e0: 2032 2c20 332c 202e 2e2e 5d0d 0a20 2020   2, 3, ...]..   
-0000c5f0: 2020 2020 2020 2020 202d 2054 6865 2066           - The f
-0000c600: 756e 6374 696f 6e20 6861 7320 6120 6164  unction has a ad
-0000c610: 645f 6765 6f6d 6574 7279 2070 6172 616d  d_geometry param
-0000c620: 6574 6572 2077 6974 6820 7477 6f20 706f  eter with two po
-0000c630: 7373 6962 6c65 2076 616c 7565 7320 5b22  ssible values ["
-0000c640: 706f 696e 7422 2c20 2270 6f6c 7967 6f6e  point", "polygon
-0000c650: 225d 2c20 7768 6963 6820 796f 7520 6361  "], which you ca
-0000c660: 6e0d 0a20 2020 2020 2020 2020 2020 2073  n..            s
-0000c670: 7065 6369 6679 2074 6865 2074 7970 6520  pecify the type 
-0000c680: 6f66 2073 6861 7065 6c79 2067 656f 6d65  of shapely geome
-0000c690: 7472 7920 796f 7520 7761 6e74 2074 6f20  try you want to 
-0000c6a0: 6372 6561 7465 2066 726f 6d20 6561 6368  create from each
-0000c6b0: 2063 656c 6c2c 0d0a 2020 2020 2020 2020   cell,..        
-0000c6c0: 2020 2020 2020 2020 2d20 4966 2070 6f69          - If poi
-0000c6d0: 6e74 2069 7320 6368 6f73 656e 2c20 7468  nt is chosen, th
-0000c6e0: 6520 6372 6561 7465 6420 706f 696e 7420  e created point 
-0000c6f0: 7769 6c6c 2062 6520 6174 2074 6865 2063  will be at the c
-0000c700: 656e 7465 7220 6f66 2065 6163 6820 6365  enter of each ce
-0000c710: 6c6c 0d0a 2020 2020 2020 2020 2020 2020  ll..            
-0000c720: 2020 2020 2d20 4966 2061 2070 6f6c 7967      - If a polyg
-0000c730: 6f6e 2069 7320 6368 6f73 656e 2c20 6120  on is chosen, a 
-0000c740: 7371 7561 7265 2070 6f6c 7967 6f6e 2077  square polygon w
-0000c750: 696c 6c20 6265 2063 7265 6174 6564 2074  ill be created t
-0000c760: 6861 7420 636f 7665 7273 2074 6865 2065  hat covers the e
-0000c770: 6e74 6972 6520 6365 6c6c 2e0d 0a0d 0a20  ntire cell..... 
-0000c780: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
-0000c790: 730d 0a20 2020 2020 2020 202d 2d2d 2d2d  s..        -----
-0000c7a0: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 2076  -----..        v
-0000c7b0: 6563 746f 725f 6d61 736b 203a 204f 7074  ector_mask : Opt
-0000c7c0: 696f 6e61 6c5b 4765 6f44 6174 6146 7261  ional[GeoDataFra
-0000c7d0: 6d65 2f73 7472 5d0d 0a20 2020 2020 2020  me/str]..       
-0000c7e0: 2020 2020 2047 656f 4461 7461 4672 616d       GeoDataFram
-0000c7f0: 6520 666f 7220 7468 6520 7665 6374 6f72  e for the vector
-0000c800: 5f6d 6173 6b20 6669 6c65 2070 6174 6820  _mask file path 
-0000c810: 746f 2076 6563 746f 725f 6d61 736b 2066  to vector_mask f
-0000c820: 696c 652e 2049 6620 6769 7665 6e2c 2069  ile. If given, i
-0000c830: 7420 7769 6c6c 2062 6520 7573 6564 2074  t will be used t
-0000c840: 6f20 636c 6970 2074 6865 2072 6173 7465  o clip the raste
-0000c850: 720d 0a20 2020 2020 2020 2061 6464 5f67  r..        add_g
-0000c860: 656f 6d65 7472 793a 205b 7374 725d 0d0a  eometry: [str]..
-0000c870: 2020 2020 2020 2020 2020 2020 2250 6f6c              "Pol
-0000c880: 7967 6f6e 222c 206f 7220 2250 6f69 6e74  ygon", or "Point
-0000c890: 2220 6966 2079 6f75 2077 616e 7420 746f  " if you want to
-0000c8a0: 2061 6464 2061 2070 6f6c 7967 6f6e 2067   add a polygon g
-0000c8b0: 656f 6d65 7472 7920 6f66 2074 6865 2063  eometry of the c
-0000c8c0: 656c 6c73 2061 7320 2063 6f6c 756d 6e20  ells as  column 
-0000c8d0: 696e 2064 6174 6166 7261 6d65 2e0d 0a20  in dataframe... 
-0000c8e0: 2020 2020 2020 2020 2020 2044 6566 6175             Defau
-0000c8f0: 6c74 2069 7320 4e6f 6e65 2e0d 0a20 2020  lt is None...   
-0000c900: 2020 2020 2074 696c 653a 205b 626f 6f6c       tile: [bool
-0000c910: 5d0d 0a20 2020 2020 2020 2020 2020 2054  ]..            T
-0000c920: 7275 6520 746f 2075 7365 2074 696c 6573  rue to use tiles
-0000c930: 2069 6e20 6578 7472 6163 7469 6e67 2074   in extracting t
-0000c940: 6865 2076 616c 7565 7320 6672 6f6d 2074  he values from t
-0000c950: 6865 2072 6173 7465 722e 2044 6566 6175  he raster. Defau
-0000c960: 6c74 2069 7320 4661 6c73 652e 0d0a 2020  lt is False...  
-0000c970: 2020 2020 2020 7469 6c65 5f73 697a 653a        tile_size:
-0000c980: 205b 696e 745d 0d0a 2020 2020 2020 2020   [int]..        
-0000c990: 2020 2020 7469 6c65 2073 697a 652e 2044      tile size. D
-0000c9a0: 6566 6175 6c74 2069 7320 3135 3030 2e0d  efault is 1500..
-0000c9b0: 0a0d 0a20 2020 2020 2020 2052 6574 7572  ...        Retur
-0000c9c0: 6e73 0d0a 2020 2020 2020 2020 2d2d 2d2d  ns..        ----
-0000c9d0: 2d2d 2d0d 0a20 2020 2020 2020 2044 6174  ---..        Dat
-0000c9e0: 6146 7261 6d65 2f47 656f 4461 7461 4672  aFrame/GeoDataFr
-0000c9f0: 616d 650d 0a20 2020 2020 2020 2020 2020  ame..           
-0000ca00: 2063 6f6c 756d 6e64 4c3a 0d0a 2020 2020   columndL:..    
-0000ca10: 2020 2020 2020 2020 2020 2020 3e3e 3e20              >>> 
-0000ca20: 7072 696e 7428 6764 662e 636f 6c75 6d6e  print(gdf.column
-0000ca30: 7329 0d0a 2020 2020 2020 2020 2020 2020  s)..            
-0000ca40: 2020 2020 3e3e 3e20 496e 6465 7828 5b27      >>> Index(['
-0000ca50: 4261 6e64 5f31 272c 2027 6765 6f6d 6574  Band_1', 'geomet
-0000ca60: 7279 275d 2c20 6474 7970 653d 276f 626a  ry'], dtype='obj
-0000ca70: 6563 7427 290d 0a0d 0a20 2020 2020 2020  ect')....       
-0000ca80: 2074 6865 2072 6573 756c 7465 6420 6765   the resulted ge
-0000ca90: 6f64 6174 6166 7261 6d65 2077 696c 6c20  odataframe will 
-0000caa0: 6861 7665 2074 6865 2062 616e 6420 7661  have the band va
-0000cab0: 6c75 6520 756e 6465 7220 7468 6520 6e61  lue under the na
-0000cac0: 6d65 206f 6620 7468 6520 6261 6e64 2028  me of the band (
-0000cad0: 6966 2074 6865 2072 6173 7465 7220 6669  if the raster fi
-0000cae0: 6c65 2068 6173 2061 206d 6574 6164 6174  le has a metadat
-0000caf0: 612c 0d0a 2020 2020 2020 2020 6966 206e  a,..        if n
-0000cb00: 6f74 2c20 7468 6520 6261 6e64 7320 7769  ot, the bands wi
-0000cb10: 6c6c 2062 6520 696e 6465 7865 6420 6672  ll be indexed fr
-0000cb20: 6f6d 2031 2074 6f20 7468 6520 6e75 6d62  om 1 to the numb
-0000cb30: 6572 206f 6620 6261 6e64 7329 0d0a 2020  er of bands)..  
-0000cb40: 2020 2020 2020 2222 220d 0a20 2020 2020        """..     
-0000cb50: 2020 2074 656d 705f 6469 7220 3d20 4e6f     temp_dir = No
-0000cb60: 6e65 0d0a 0d0a 2020 2020 2020 2020 2320  ne....        # 
-0000cb70: 4765 7420 7261 7374 6572 2062 616e 6420  Get raster band 
-0000cb80: 6e61 6d65 732e 206f 7065 6e20 7468 6520  names. open the 
-0000cb90: 6461 7461 7365 7420 7573 696e 6720 6764  dataset using gd
-0000cba0: 616c 2e4f 7065 6e0d 0a20 2020 2020 2020  al.Open..       
-0000cbb0: 2062 616e 645f 6e61 6d65 7320 3d20 7365   band_names = se
-0000cbc0: 6c66 2e67 6574 5f62 616e 645f 6e61 6d65  lf.get_band_name
-0000cbd0: 7328 290d 0a0d 0a20 2020 2020 2020 2023  s()....        #
-0000cbe0: 2043 7265 6174 6520 6120 6d61 736b 2066   Create a mask f
-0000cbf0: 726f 6d20 7468 6520 7069 7865 6c73 2074  rom the pixels t
-0000cc00: 6f75 6368 6564 2062 7920 7468 6520 7665  ouched by the ve
-0000cc10: 6374 6f72 5f6d 6173 6b2e 0d0a 2020 2020  ctor_mask...    
-0000cc20: 2020 2020 6966 2076 6563 746f 725f 6d61      if vector_ma
-0000cc30: 736b 2069 7320 6e6f 7420 4e6f 6e65 3a0d  sk is not None:.
-0000cc40: 0a20 2020 2020 2020 2020 2020 2023 2043  .            # C
-0000cc50: 7265 6174 6520 6120 7465 6d70 6f72 6172  reate a temporar
-0000cc60: 7920 6469 7265 6374 6f72 7920 666f 7220  y directory for 
-0000cc70: 6669 6c65 732e 0d0a 2020 2020 2020 2020  files...        
-0000cc80: 2020 2020 7465 6d70 5f64 6972 203d 2074      temp_dir = t
-0000cc90: 656d 7066 696c 652e 6d6b 6474 656d 7028  empfile.mkdtemp(
-0000cca0: 290d 0a20 2020 2020 2020 2020 2020 206e  )..            n
-0000ccb0: 6577 5f76 6563 746f 725f 7061 7468 203d  ew_vector_path =
-0000ccc0: 206f 732e 7061 7468 2e6a 6f69 6e28 7465   os.path.join(te
-0000ccd0: 6d70 5f64 6972 2c20 6622 7b75 7569 642e  mp_dir, f"{uuid.
-0000cce0: 7575 6964 3128 297d 2229 0d0a 0d0a 2020  uuid1()}")....  
-0000ccf0: 2020 2020 2020 2020 2020 2320 7265 6164            # read
-0000cd00: 2074 6865 2076 6563 746f 7220 7769 7468   the vector with
-0000cd10: 2067 656f 7061 6e64 6173 0d0a 2020 2020   geopandas..    
-0000cd20: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
-0000cd30: 7461 6e63 6528 7665 6374 6f72 5f6d 6173  tance(vector_mas
-0000cd40: 6b2c 2047 656f 4461 7461 4672 616d 6529  k, GeoDataFrame)
-0000cd50: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-0000cd60: 2020 2076 6563 746f 7220 3d20 4665 6174     vector = Feat
-0000cd70: 7572 6543 6f6c 6c65 6374 696f 6e28 7665  ureCollection(ve
-0000cd80: 6374 6f72 5f6d 6173 6b29 0d0a 2020 2020  ctor_mask)..    
-0000cd90: 2020 2020 2020 2020 656c 6966 2069 7369          elif isi
-0000cda0: 6e73 7461 6e63 6528 7665 6374 6f72 5f6d  nstance(vector_m
-0000cdb0: 6173 6b2c 2046 6561 7475 7265 436f 6c6c  ask, FeatureColl
-0000cdc0: 6563 7469 6f6e 293a 0d0a 2020 2020 2020  ection):..      
-0000cdd0: 2020 2020 2020 2020 2020 7665 6374 6f72            vector
-0000cde0: 203d 2076 6563 746f 725f 6d61 736b 0d0a   = vector_mask..
-0000cdf0: 2020 2020 2020 2020 2020 2020 656c 7365              else
-0000ce00: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-0000ce10: 2020 2072 6169 7365 2054 7970 6545 7272     raise TypeErr
-0000ce20: 6f72 280d 0a20 2020 2020 2020 2020 2020  or(..           
-0000ce30: 2020 2020 2020 2020 2066 2254 6865 2076           f"The v
-0000ce40: 6563 746f 725f 6d61 736b 2073 686f 756c  ector_mask shoul
-0000ce50: 6420 6265 206f 6620 7479 7065 3a20 5b47  d be of type: [G
-0000ce60: 656f 4461 7461 4672 616d 652f 4665 6174  eoDataFrame/Feat
-0000ce70: 7572 6543 6f6c 6c65 6374 696f 6e5d 2c20  ureCollection], 
-0000ce80: 6769 7665 6e3a 2022 0d0a 2020 2020 2020  given: "..      
-0000ce90: 2020 2020 2020 2020 2020 2020 2020 6622                f"
-0000cea0: 7b74 7970 6528 7665 6374 6f72 5f6d 6173  {type(vector_mas
-0000ceb0: 6b29 7d22 0d0a 2020 2020 2020 2020 2020  k)}"..          
-0000cec0: 2020 2020 2020 290d 0a0d 0a20 2020 2020        )....     
-0000ced0: 2020 2020 2020 2023 2061 6464 2061 2075         # add a u
-0000cee0: 6e69 7175 6520 7661 6c75 6520 666f 7220  nique value for 
-0000cef0: 6561 6368 2072 6f77 7320 746f 2075 7365  each rows to use
-0000cf00: 2069 7420 746f 2072 6173 7465 7269 7a65   it to rasterize
-0000cf10: 2074 6865 2076 6563 746f 720d 0a20 2020   the vector..   
-0000cf20: 2020 2020 2020 2020 2076 6563 746f 722e           vector.
-0000cf30: 6665 6174 7572 655b 2262 7572 6e5f 7661  feature["burn_va
-0000cf40: 6c75 6522 5d20 3d20 6c69 7374 2872 616e  lue"] = list(ran
-0000cf50: 6765 2831 2c20 6c65 6e28 7665 6374 6f72  ge(1, len(vector
-0000cf60: 2e66 6561 7475 7265 2920 2b20 3129 290d  .feature) + 1)).
-0000cf70: 0a20 2020 2020 2020 2020 2020 2023 2073  .            # s
-0000cf80: 6176 6520 7468 6520 6e65 7720 7665 6374  ave the new vect
-0000cf90: 6f72 2074 6f20 6469 736b 2074 6f20 7265  or to disk to re
-0000cfa0: 6164 2069 7420 7769 7468 206f 6772 206c  ad it with ogr l
-0000cfb0: 6174 6572 0d0a 2020 2020 2020 2020 2020  ater..          
-0000cfc0: 2020 7665 6374 6f72 2e66 6561 7475 7265    vector.feature
-0000cfd0: 2e74 6f5f 6669 6c65 286e 6577 5f76 6563  .to_file(new_vec
-0000cfe0: 746f 725f 7061 7468 2c20 6472 6976 6572  tor_path, driver
-0000cff0: 3d22 4765 6f4a 534f 4e22 290d 0a0d 0a20  ="GeoJSON").... 
-0000d000: 2020 2020 2020 2020 2020 2023 2072 6173             # ras
-0000d010: 7465 7269 7a65 2074 6865 2076 6563 746f  terize the vecto
-0000d020: 7220 6279 2062 7572 6e69 6e67 2074 6865  r by burning the
-0000d030: 2075 6e69 7175 6520 7661 6c75 6573 2061   unique values a
-0000d040: 7320 6365 6c6c 2076 616c 7565 732e 0d0a  s cell values...
-0000d050: 2020 2020 2020 2020 2020 2020 2320 7261              # ra
-0000d060: 7374 6572 697a 6564 5f76 6563 746f 725f  sterized_vector_
-0000d070: 7061 7468 203d 206f 732e 7061 7468 2e6a  path = os.path.j
-0000d080: 6f69 6e28 7465 6d70 5f64 6972 2c20 6622  oin(temp_dir, f"
-0000d090: 7b75 7569 642e 7575 6964 3128 297d 2e74  {uuid.uuid1()}.t
-0000d0a0: 6966 2229 0d0a 2020 2020 2020 2020 2020  if")..          
-0000d0b0: 2020 7261 7374 6572 697a 6564 5f76 6563    rasterized_vec
-0000d0c0: 746f 7220 3d20 7665 6374 6f72 2e74 6f5f  tor = vector.to_
-0000d0d0: 6461 7461 7365 7428 0d0a 2020 2020 2020  dataset(..      
-0000d0e0: 2020 2020 2020 2020 2020 6461 7461 7365            datase
-0000d0f0: 743d 7365 6c66 2c20 636f 6c75 6d6e 5f6e  t=self, column_n
-0000d100: 616d 653d 2262 7572 6e5f 7661 6c75 6522  ame="burn_value"
-0000d110: 0d0a 2020 2020 2020 2020 2020 2020 2920  ..            ) 
-0000d120: 2023 2072 6173 7465 7269 7a65 645f 7665   # rasterized_ve
-0000d130: 6374 6f72 5f70 6174 682c 0d0a 2020 2020  ctor_path,..    
-0000d140: 2020 2020 2020 2020 6966 2061 6464 5f67          if add_g
-0000d150: 656f 6d65 7472 793a 0d0a 2020 2020 2020  eometry:..      
-0000d160: 2020 2020 2020 2020 2020 6966 2061 6464            if add
-0000d170: 5f67 656f 6d65 7472 792e 6c6f 7765 7228  _geometry.lower(
-0000d180: 2920 3d3d 2022 706f 696e 7422 3a0d 0a20  ) == "point":.. 
-0000d190: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d1a0: 2020 2063 6f6f 7264 7320 3d20 7261 7374     coords = rast
-0000d1b0: 6572 697a 6564 5f76 6563 746f 722e 6765  erized_vector.ge
-0000d1c0: 745f 6365 6c6c 5f70 6f69 6e74 7328 6d61  t_cell_points(ma
-0000d1d0: 736b 3d54 7275 6529 0d0a 2020 2020 2020  sk=True)..      
-0000d1e0: 2020 2020 2020 2020 2020 656c 7365 3a0d            else:.
-0000d1f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000d200: 2020 2020 2063 6f6f 7264 7320 3d20 7261       coords = ra
-0000d210: 7374 6572 697a 6564 5f76 6563 746f 722e  sterized_vector.
-0000d220: 6765 745f 6365 6c6c 5f70 6f6c 7967 6f6e  get_cell_polygon
-0000d230: 7328 6d61 736b 3d54 7275 6529 0d0a 0d0a  s(mask=True)....
-0000d240: 2020 2020 2020 2020 2020 2020 2320 4c6f              # Lo
-0000d250: 6f70 206f 7665 7220 6d61 736b 2076 616c  op over mask val
-0000d260: 7565 7320 746f 2065 7874 7261 6374 2070  ues to extract p
-0000d270: 6978 656c 732e 0d0a 2020 2020 2020 2020  ixels...        
-0000d280: 2020 2020 2320 4461 7461 4672 616d 6573      # DataFrames
-0000d290: 206f 6620 6561 6368 2074 696c 652e 0d0a   of each tile...
-0000d2a0: 2020 2020 2020 2020 2020 2020 6466 5f6c              df_l
-0000d2b0: 6973 7420 3d20 5b5d 0d0a 2020 2020 2020  ist = []..      
-0000d2c0: 2020 2020 2020 6d61 736b 5f61 7272 203d        mask_arr =
-0000d2d0: 2072 6173 7465 7269 7a65 645f 7665 6374   rasterized_vect
-0000d2e0: 6f72 2e72 6173 7465 722e 4765 7452 6173  or.raster.GetRas
-0000d2f0: 7465 7242 616e 6428 3129 2e52 6561 6441  terBand(1).ReadA
-0000d300: 7341 7272 6179 2829 0d0a 0d0a 2020 2020  sArray()....    
-0000d310: 2020 2020 2020 2020 666f 7220 6172 7220          for arr 
-0000d320: 696e 2073 656c 662e 6765 745f 7469 6c65  in self.get_tile
-0000d330: 2874 696c 655f 7369 7a65 293a 0d0a 0d0a  (tile_size):....
-0000d340: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d350: 6d61 736b 5f64 6673 203d 205b 5d0d 0a20  mask_dfs = [].. 
-0000d360: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-0000d370: 6f72 206d 6173 6b5f 7661 6c20 696e 2076  or mask_val in v
-0000d380: 6563 746f 722e 6665 6174 7572 655b 2262  ector.feature["b
-0000d390: 7572 6e5f 7661 6c75 6522 5d2e 7661 6c75  urn_value"].valu
-0000d3a0: 6573 3a0d 0a20 2020 2020 2020 2020 2020  es:..           
-0000d3b0: 2020 2020 2020 2020 2023 2045 7874 7261           # Extra
-0000d3c0: 6374 206f 6e6c 7920 6d61 736b 6564 2070  ct only masked p
-0000d3d0: 6978 656c 732e 0d0a 2020 2020 2020 2020  ixels...        
-0000d3e0: 2020 2020 2020 2020 2020 2020 666c 6174              flat
-0000d3f0: 7465 6e5f 6d61 736b 6564 5f76 616c 7565  ten_masked_value
-0000d400: 7320 3d20 6765 745f 7069 7865 6c73 280d  s = get_pixels(.
-0000d410: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000d420: 2020 2020 2020 2020 2061 7272 2c20 6d61           arr, ma
-0000d430: 736b 5f61 7272 2c20 6d61 736b 5f76 616c  sk_arr, mask_val
-0000d440: 3d6d 6173 6b5f 7661 6c0d 0a20 2020 2020  =mask_val..     
-0000d450: 2020 2020 2020 2020 2020 2020 2020 2029                 )
-0000d460: 2e74 7261 6e73 706f 7365 2829 0d0a 2020  .transpose()..  
-0000d470: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d480: 2020 6669 645f 7078 203d 206e 702e 6f6e    fid_px = np.on
-0000d490: 6573 2866 6c61 7474 656e 5f6d 6173 6b65  es(flatten_maske
-0000d4a0: 645f 7661 6c75 6573 2e73 6861 7065 5b30  d_values.shape[0
-0000d4b0: 5d29 202a 206d 6173 6b5f 7661 6c0d 0a0d  ]) * mask_val...
-0000d4c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000d4d0: 2020 2020 2023 2043 7265 6174 6520 6120       # Create a 
-0000d4e0: 4461 7461 4672 616d 6520 6f66 206d 6173  DataFrame of mas
-0000d4f0: 6b65 6420 666c 6174 7465 6e5f 6d61 736b  ked flatten_mask
-0000d500: 6564 5f76 616c 7565 7320 616e 6420 7468  ed_values and th
-0000d510: 6569 7220 4649 442e 0d0a 2020 2020 2020  eir FID...      
-0000d520: 2020 2020 2020 2020 2020 2020 2020 6d61                ma
-0000d530: 736b 5f64 6620 3d20 7064 2e44 6174 6146  sk_df = pd.DataF
-0000d540: 7261 6d65 2866 6c61 7474 656e 5f6d 6173  rame(flatten_mas
-0000d550: 6b65 645f 7661 6c75 6573 2c20 636f 6c75  ked_values, colu
-0000d560: 6d6e 733d 6261 6e64 5f6e 616d 6573 290d  mns=band_names).
-0000d570: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000d580: 2020 2020 206d 6173 6b5f 6466 5b22 6275       mask_df["bu
-0000d590: 726e 5f76 616c 7565 225d 203d 2066 6964  rn_value"] = fid
-0000d5a0: 5f70 780d 0a20 2020 2020 2020 2020 2020  _px..           
-0000d5b0: 2020 2020 2020 2020 206d 6173 6b5f 6466           mask_df
-0000d5c0: 732e 6170 7065 6e64 286d 6173 6b5f 6466  s.append(mask_df
-0000d5d0: 290d 0a0d 0a20 2020 2020 2020 2020 2020  )....           
-0000d5e0: 2020 2020 2023 2043 6f6e 6361 7420 7468       # Concat th
-0000d5f0: 6520 6d61 736b 2044 6174 6146 7261 6d65  e mask DataFrame
-0000d600: 732e 0d0a 2020 2020 2020 2020 2020 2020  s...            
-0000d610: 2020 2020 6d61 736b 5f64 6620 3d20 7064      mask_df = pd
-0000d620: 2e63 6f6e 6361 7428 6d61 736b 5f64 6673  .concat(mask_dfs
-0000d630: 290d 0a0d 0a20 2020 2020 2020 2020 2020  )....           
-0000d640: 2020 2020 2023 204a 6f69 6e20 7769 7468       # Join with
-0000d650: 2070 6978 656c 7320 7769 7468 2076 6563   pixels with vec
-0000d660: 746f 7220 6174 7472 6962 7574 6573 2075  tor attributes u
-0000d670: 7369 6e67 2074 6865 2046 4944 2e0d 0a20  sing the FID... 
-0000d680: 2020 2020 2020 2020 2020 2020 2020 2064                 d
-0000d690: 665f 6c69 7374 2e61 7070 656e 6428 0d0a  f_list.append(..
-0000d6a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d6b0: 2020 2020 6d61 736b 5f64 662e 6d65 7267      mask_df.merg
-0000d6c0: 6528 7665 6374 6f72 2e66 6561 7475 7265  e(vector.feature
-0000d6d0: 2c20 686f 773d 226c 6566 7422 2c20 6f6e  , how="left", on
-0000d6e0: 3d22 6275 726e 5f76 616c 7565 2229 0d0a  ="burn_value")..
-0000d6f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d700: 290d 0a0d 0a20 2020 2020 2020 2020 2020  )....           
-0000d710: 2023 204d 6572 6765 2061 6c6c 2074 6865   # Merge all the
-0000d720: 2074 696c 6573 2e0d 0a20 2020 2020 2020   tiles...       
-0000d730: 2020 2020 206f 7574 5f64 6620 3d20 7064       out_df = pd
-0000d740: 2e63 6f6e 6361 7428 6466 5f6c 6973 7429  .concat(df_list)
-0000d750: 0d0a 2020 2020 2020 2020 656c 7365 3a0d  ..        else:.
-0000d760: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-0000d770: 7469 6c65 3a0d 0a20 2020 2020 2020 2020  tile:..         
-0000d780: 2020 2020 2020 2064 665f 6c69 7374 203d         df_list =
-0000d790: 205b 5d20 2023 2044 6174 6146 7261 6d65   []  # DataFrame
-0000d7a0: 7320 6f66 2065 6163 6820 7469 6c65 2e0d  s of each tile..
-0000d7b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000d7c0: 2066 6f72 2061 7272 2069 6e20 4461 7461   for arr in Data
-0000d7d0: 7365 742e 6765 745f 7469 6c65 2873 656c  set.get_tile(sel
-0000d7e0: 662e 7261 7374 6572 293a 0d0a 2020 2020  f.raster):..    
-0000d7f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d800: 2320 4173 7375 6d65 206d 756c 7469 6261  # Assume multiba
-0000d810: 6e64 0d0a 2020 2020 2020 2020 2020 2020  nd..            
-0000d820: 2020 2020 2020 2020 6964 7820 3d20 2831          idx = (1
-0000d830: 2c20 3229 0d0a 2020 2020 2020 2020 2020  , 2)..          
-0000d840: 2020 2020 2020 2020 2020 6966 2061 7272            if arr
-0000d850: 2e6e 6469 6d20 3d3d 2032 3a0d 0a20 2020  .ndim == 2:..   
-0000d860: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d870: 2020 2020 2023 2048 616e 646c 6520 7369       # Handle si
-0000d880: 6e67 6c65 2062 616e 6420 7261 7374 6572  ngle band raster
-0000d890: 730d 0a20 2020 2020 2020 2020 2020 2020  s..             
-0000d8a0: 2020 2020 2020 2020 2020 2069 6478 203d             idx =
-0000d8b0: 2028 302c 2031 290d 0a0d 0a20 2020 2020   (0, 1)....     
-0000d8c0: 2020 2020 2020 2020 2020 2020 2020 206d                 m
-0000d8d0: 6173 6b5f 6172 7220 3d20 6e70 2e6f 6e65  ask_arr = np.one
-0000d8e0: 7328 2861 7272 2e73 6861 7065 5b69 6478  s((arr.shape[idx
-0000d8f0: 5b30 5d5d 2c20 6172 722e 7368 6170 655b  [0]], arr.shape[
-0000d900: 6964 785b 315d 5d29 290d 0a20 2020 2020  idx[1]]))..     
-0000d910: 2020 2020 2020 2020 2020 2020 2020 2070                 p
-0000d920: 6978 656c 7320 3d20 6765 745f 7069 7865  ixels = get_pixe
-0000d930: 6c73 2861 7272 2c20 6d61 736b 5f61 7272  ls(arr, mask_arr
-0000d940: 292e 7472 616e 7370 6f73 6528 290d 0a20  ).transpose().. 
-0000d950: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0000d960: 2020 2064 665f 6c69 7374 2e61 7070 656e     df_list.appen
-0000d970: 6428 7064 2e44 6174 6146 7261 6d65 2870  d(pd.DataFrame(p
-0000d980: 6978 656c 732c 2063 6f6c 756d 6e73 3d62  ixels, columns=b
-0000d990: 616e 645f 6e61 6d65 7329 290d 0a0d 0a20  and_names)).... 
-0000d9a0: 2020 2020 2020 2020 2020 2020 2020 2023                 #
-0000d9b0: 204d 6572 6765 2061 6c6c 2074 6865 2074   Merge all the t
-0000d9c0: 696c 6573 2e0d 0a20 2020 2020 2020 2020  iles...         
-0000d9d0: 2020 2020 2020 206f 7574 5f64 6620 3d20         out_df = 
-0000d9e0: 7064 2e63 6f6e 6361 7428 6466 5f6c 6973  pd.concat(df_lis
-0000d9f0: 7429 0d0a 2020 2020 2020 2020 2020 2020  t)..            
-0000da00: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
-0000da10: 2020 2020 2020 2023 2057 6172 6e69 6e67         # Warning
-0000da20: 3a20 6e6f 7420 6368 6563 6b65 6420 7965  : not checked ye
-0000da30: 7420 666f 7220 6d75 6c74 6920 6261 6e64  t for multi band
-0000da40: 730d 0a20 2020 2020 2020 2020 2020 2020  s..             
-0000da50: 2020 2061 7272 203d 2073 656c 662e 7261     arr = self.ra
-0000da60: 7374 6572 2e52 6561 6441 7341 7272 6179  ster.ReadAsArray
-0000da70: 2829 0d0a 2020 2020 2020 2020 2020 2020  ()..            
-0000da80: 2020 2020 7069 7865 6c73 203d 2061 7272      pixels = arr
-0000da90: 2e66 6c61 7474 656e 2829 0d0a 2020 2020  .flatten()..    
-0000daa0: 2020 2020 2020 2020 2020 2020 6f75 745f              out_
-0000dab0: 6466 203d 2070 642e 4461 7461 4672 616d  df = pd.DataFram
-0000dac0: 6528 7069 7865 6c73 2c20 636f 6c75 6d6e  e(pixels, column
-0000dad0: 733d 6261 6e64 5f6e 616d 6573 290d 0a0d  s=band_names)...
-0000dae0: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-0000daf0: 6164 645f 6765 6f6d 6574 7279 3a0d 0a20  add_geometry:.. 
-0000db00: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-0000db10: 6620 6164 645f 6765 6f6d 6574 7279 2e6c  f add_geometry.l
-0000db20: 6f77 6572 2829 203d 3d20 2270 6f69 6e74  ower() == "point
-0000db30: 223a 0d0a 2020 2020 2020 2020 2020 2020  ":..            
-0000db40: 2020 2020 2020 2020 636f 6f72 6473 203d          coords =
-0000db50: 2073 656c 662e 6765 745f 6365 6c6c 5f70   self.get_cell_p
-0000db60: 6f69 6e74 7328 6d61 736b 3d54 7275 6529  oints(mask=True)
-0000db70: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0000db80: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
-0000db90: 2020 2020 2020 2020 2020 2020 2063 6f6f               coo
-0000dba0: 7264 7320 3d20 7365 6c66 2e67 6574 5f63  rds = self.get_c
-0000dbb0: 656c 6c5f 706f 6c79 676f 6e73 286d 6173  ell_polygons(mas
-0000dbc0: 6b3d 5472 7565 290d 0a0d 0a20 2020 2020  k=True)....     
-0000dbd0: 2020 206f 7574 5f64 6620 3d20 6f75 745f     out_df = out_
-0000dbe0: 6466 2e64 726f 7028 636f 6c75 6d6e 733d  df.drop(columns=
-0000dbf0: 5b22 6275 726e 5f76 616c 7565 222c 2022  ["burn_value", "
-0000dc00: 6765 6f6d 6574 7279 225d 2c20 6572 726f  geometry"], erro
-0000dc10: 7273 3d22 6967 6e6f 7265 2229 0d0a 2020  rs="ignore")..  
-0000dc20: 2020 2020 2020 6966 2061 6464 5f67 656f        if add_geo
-0000dc30: 6d65 7472 793a 0d0a 2020 2020 2020 2020  metry:..        
-0000dc40: 2020 2020 6f75 745f 6466 203d 2067 7064      out_df = gpd
-0000dc50: 2e47 656f 4461 7461 4672 616d 6528 6f75  .GeoDataFrame(ou
-0000dc60: 745f 6466 2c20 6765 6f6d 6574 7279 3d63  t_df, geometry=c
-0000dc70: 6f6f 7264 735b 2267 656f 6d65 7472 7922  oords["geometry"
-0000dc80: 5d29 0d0a 0d0a 2020 2020 2020 2020 2320  ])....        # 
-0000dc90: 544f 444f 206d 6173 6b20 6e6f 2064 6174  TODO mask no dat
-0000dca0: 6120 7661 6c75 6573 2e0d 0a0d 0a20 2020  a values.....   
-0000dcb0: 2020 2020 2023 2052 656d 6f76 6520 7465       # Remove te
-0000dcc0: 6d70 6f72 6172 7920 6669 6c65 732e 0d0a  mporary files...
-0000dcd0: 2020 2020 2020 2020 6966 2074 656d 705f          if temp_
-0000dce0: 6469 7220 6973 206e 6f74 204e 6f6e 653a  dir is not None:
-0000dcf0: 0d0a 2020 2020 2020 2020 2020 2020 7368  ..            sh
-0000dd00: 7574 696c 2e72 6d74 7265 6528 7465 6d70  util.rmtree(temp
-0000dd10: 5f64 6972 2c20 6967 6e6f 7265 5f65 7272  _dir, ignore_err
-0000dd20: 6f72 733d 5472 7565 290d 0a0d 0a20 2020  ors=True)....   
-0000dd30: 2020 2020 2023 2052 6574 7572 6e20 6472       # Return dr
-0000dd40: 6f70 7069 6e67 2061 6e79 2065 7874 7261  opping any extra
-0000dd50: 2063 6f6c 732e 0d0a 2020 2020 2020 2020   cols...        
-0000dd60: 7265 7475 726e 206f 7574 5f64 660d 0a0d  return out_df...
-0000dd70: 0a20 2020 2064 6566 2061 7070 6c79 2873  .    def apply(s
-0000dd80: 656c 662c 2066 756e 2c20 6261 6e64 3a20  elf, fun, band: 
-0000dd90: 696e 7420 3d20 3029 3a0d 0a20 2020 2020  int = 0):..     
-0000dda0: 2020 2022 2222 6d61 7041 6c67 6562 7261     """mapAlgebra
-0000ddb0: 2e0d 0a0d 0a20 2020 2020 2020 202d 206d  .....        - m
-0000ddc0: 6170 416c 6765 6272 6120 6578 6563 7574  apAlgebra execut
-0000ddd0: 6573 2061 206d 6174 6865 6d61 7469 6361  es a mathematica
-0000dde0: 6c20 6f70 6572 6174 696f 6e20 6f6e 2072  l operation on r
-0000ddf0: 6173 7465 7220 6172 7261 7920 616e 6420  aster array and 
-0000de00: 7265 7475 726e 730d 0a20 2020 2020 2020  returns..       
-0000de10: 2074 6865 2072 6573 756c 740d 0a20 2020   the result..   
-0000de20: 2020 2020 202d 2054 6865 206d 6170 416c       - The mapAl
-0000de30: 6765 6272 6120 6578 6563 7574 6573 2074  gebra executes t
-0000de40: 6865 2066 756e 6374 696f 6e20 6f6e 6c79  he function only
-0000de50: 206f 6e20 6f6e 6520 6365 6c6c 2061 7420   on one cell at 
-0000de60: 6120 7469 6d65 2e0d 0a0d 0a20 2020 2020  a time.....     
-0000de70: 2020 2050 6172 616d 6574 6572 730d 0a20     Parameters.. 
-0000de80: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
-0000de90: 2d0d 0a20 2020 2020 2020 2066 756e 3a20  -..        fun: 
-0000dea0: 5b66 756e 6374 696f 6e5d 0d0a 2020 2020  [function]..    
-0000deb0: 2020 2020 2020 2020 6465 6669 6e65 6420          defined 
-0000dec0: 6675 6e63 7469 6f6e 2074 6861 7420 7461  function that ta
-0000ded0: 6b65 7320 6f6e 6520 696e 7075 7420 7768  kes one input wh
-0000dee0: 6963 6820 6973 2074 6865 2063 656c 6c20  ich is the cell 
-0000def0: 7661 6c75 652e 0d0a 2020 2020 2020 2020  value...        
-0000df00: 6261 6e64 3a20 5b69 6e74 5d0d 0a20 2020  band: [int]..   
-0000df10: 2020 2020 2020 2020 2062 616e 6420 6e75           band nu
-0000df20: 6d62 6572 2e0d 0a0d 0a20 2020 2020 2020  mber.....       
-0000df30: 2052 6574 7572 6e73 0d0a 2020 2020 2020   Returns..      
-0000df40: 2020 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020    -------..     
-0000df50: 2020 2044 6174 6163 7562 650d 0a20 2020     Datacube..   
-0000df60: 2020 2020 2020 2020 2067 6461 6c20 6461           gdal da
-0000df70: 7461 7365 7420 6f62 6a65 6374 0d0a 0d0a  taset object....
-0000df80: 2020 2020 2020 2020 4578 616d 706c 6573          Examples
-0000df90: 0d0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ..        ------
-0000dfa0: 2d2d 0d0a 2020 2020 2020 2020 3e3e 3e20  --..        >>> 
-0000dfb0: 7372 635f 7261 7374 6572 203d 2067 6461  src_raster = gda
-0000dfc0: 6c2e 4f70 656e 2822 6576 6170 2e74 6966  l.Open("evap.tif
-0000dfd0: 2229 0d0a 2020 2020 2020 2020 3e3e 3e20  ")..        >>> 
-0000dfe0: 6675 6e63 203d 206e 702e 6162 730d 0a20  func = np.abs.. 
-0000dff0: 2020 2020 2020 203e 3e3e 206e 6577 5f72         >>> new_r
-0000e000: 6173 7465 7220 3d20 4461 7461 7365 742e  aster = Dataset.
-0000e010: 6170 706c 7928 7372 635f 7261 7374 6572  apply(src_raster
-0000e020: 2c20 6675 6e63 290d 0a20 2020 2020 2020  , func)..       
-0000e030: 2022 2222 0d0a 2020 2020 2020 2020 6966   """..        if
-0000e040: 206e 6f74 2063 616c 6c61 626c 6528 6675   not callable(fu
-0000e050: 6e29 3a0d 0a20 2020 2020 2020 2020 2020  n):..           
-0000e060: 2072 6169 7365 2054 7970 6545 7272 6f72   raise TypeError
-0000e070: 2822 7365 636f 6e64 2061 7267 756d 656e  ("second argumen
-0000e080: 7420 7368 6f75 6c64 2062 6520 6120 6675  t should be a fu
-0000e090: 6e63 7469 6f6e 2229 0d0a 0d0a 2020 2020  nction")....    
-0000e0a0: 2020 2020 6e6f 5f64 6174 615f 7661 6c75      no_data_valu
-0000e0b0: 6520 3d20 7365 6c66 2e6e 6f5f 6461 7461  e = self.no_data
-0000e0c0: 5f76 616c 7565 5b62 616e 645d 0d0a 2020  _value[band]..  
-0000e0d0: 2020 2020 2020 7372 635f 6172 7261 7920        src_array 
-0000e0e0: 3d20 7365 6c66 2e72 6561 645f 6172 7261  = self.read_arra
-0000e0f0: 7928 6261 6e64 290d 0a20 2020 2020 2020  y(band)..       
-0000e100: 2064 7479 7065 203d 2073 656c 662e 6474   dtype = self.dt
-0000e110: 7970 655b 6261 6e64 5d0d 0a0d 0a20 2020  ype[band]....   
-0000e120: 2020 2020 2023 2066 696c 6c20 7468 6520       # fill the 
-0000e130: 6e65 7720 6172 7261 7920 7769 7468 2074  new array with t
-0000e140: 6865 206e 6f64 6174 6120 7661 6c75 650d  he nodata value.
-0000e150: 0a20 2020 2020 2020 206e 6577 5f61 7272  .        new_arr
-0000e160: 6179 203d 206e 702e 6f6e 6573 2828 7365  ay = np.ones((se
-0000e170: 6c66 2e72 6f77 732c 2073 656c 662e 636f  lf.rows, self.co
-0000e180: 6c75 6d6e 7329 2920 2a20 6e6f 5f64 6174  lumns)) * no_dat
-0000e190: 615f 7661 6c75 650d 0a20 2020 2020 2020  a_value..       
-0000e1a0: 2023 2065 7865 6375 7465 2074 6865 2066   # execute the f
-0000e1b0: 756e 6374 696f 6e20 6f6e 2065 6163 6820  unction on each 
-0000e1c0: 6365 6c6c 0d0a 2020 2020 2020 2020 2320  cell..        # 
-0000e1d0: 544f 444f 3a20 6f70 7469 6d69 7a65 2065  TODO: optimize e
-0000e1e0: 7865 6375 7469 6e67 2061 2066 756e 6374  xecuting a funct
-0000e1f0: 696f 6e20 6f76 6572 2061 2077 686f 6c65  ion over a whole
-0000e200: 2061 7272 6179 0d0a 2020 2020 2020 2020   array..        
-0000e210: 666f 7220 6920 696e 2072 616e 6765 2873  for i in range(s
-0000e220: 656c 662e 726f 7773 293a 0d0a 2020 2020  elf.rows):..    
-0000e230: 2020 2020 2020 2020 666f 7220 6a20 696e          for j in
-0000e240: 2072 616e 6765 2873 656c 662e 636f 6c75   range(self.colu
-0000e250: 6d6e 7329 3a0d 0a20 2020 2020 2020 2020  mns):..         
-0000e260: 2020 2020 2020 2069 6620 6e6f 7420 6e70         if not np
-0000e270: 2e69 7363 6c6f 7365 2873 7263 5f61 7272  .isclose(src_arr
-0000e280: 6179 5b69 2c20 6a5d 2c20 6e6f 5f64 6174  ay[i, j], no_dat
-0000e290: 615f 7661 6c75 652c 2072 746f 6c3d 302e  a_value, rtol=0.
-0000e2a0: 3030 3129 3a0d 0a20 2020 2020 2020 2020  001):..         
-0000e2b0: 2020 2020 2020 2020 2020 206e 6577 5f61             new_a
-0000e2c0: 7272 6179 5b69 2c20 6a5d 203d 2066 756e  rray[i, j] = fun
-0000e2d0: 2873 7263 5f61 7272 6179 5b69 2c20 6a5d  (src_array[i, j]
-0000e2e0: 290d 0a0d 0a20 2020 2020 2020 2023 2063  )....        # c
-0000e2f0: 7265 6174 6520 7468 6520 6f75 7470 7574  reate the output
-0000e300: 2072 6173 7465 720d 0a20 2020 2020 2020   raster..       
-0000e310: 2064 7374 203d 2044 6174 6173 6574 2e5f   dst = Dataset._
-0000e320: 6372 6561 7465 5f67 6461 6c5f 6461 7461  create_gdal_data
-0000e330: 7365 7428 0d0a 2020 2020 2020 2020 2020  set(..          
-0000e340: 2020 7365 6c66 2e63 6f6c 756d 6e73 2c20    self.columns, 
-0000e350: 7365 6c66 2e72 6f77 732c 2031 2c20 6474  self.rows, 1, dt
-0000e360: 7970 652c 2064 7269 7665 723d 224d 454d  ype, driver="MEM
-0000e370: 220d 0a20 2020 2020 2020 2029 0d0a 2020  "..        )..  
-0000e380: 2020 2020 2020 2320 7365 7420 7468 6520        # set the 
-0000e390: 6765 6f74 7261 6e73 666f 726d 0d0a 2020  geotransform..  
-0000e3a0: 2020 2020 2020 6473 742e 5365 7447 656f        dst.SetGeo
-0000e3b0: 5472 616e 7366 6f72 6d28 7365 6c66 2e67  Transform(self.g
-0000e3c0: 656f 7472 616e 7366 6f72 6d29 0d0a 2020  eotransform)..  
-0000e3d0: 2020 2020 2020 2320 7365 7420 7468 6520        # set the 
-0000e3e0: 7072 6f6a 6563 7469 6f6e 0d0a 2020 2020  projection..    
-0000e3f0: 2020 2020 6473 742e 5365 7450 726f 6a65      dst.SetProje
-0000e400: 6374 696f 6e28 7365 6c66 2e63 7273 290d  ction(self.crs).
-0000e410: 0a20 2020 2020 2020 2064 7374 5f6f 626a  .        dst_obj
-0000e420: 203d 2044 6174 6173 6574 2864 7374 290d   = Dataset(dst).
-0000e430: 0a20 2020 2020 2020 2064 7374 5f6f 626a  .        dst_obj
-0000e440: 2e5f 7365 745f 6e6f 5f64 6174 615f 7661  ._set_no_data_va
-0000e450: 6c75 6528 6e6f 5f64 6174 615f 7661 6c75  lue(no_data_valu
-0000e460: 653d 6e6f 5f64 6174 615f 7661 6c75 6529  e=no_data_value)
-0000e470: 0d0a 2020 2020 2020 2020 6473 745f 6f62  ..        dst_ob
-0000e480: 6a2e 7261 7374 6572 2e47 6574 5261 7374  j.raster.GetRast
-0000e490: 6572 4261 6e64 2862 616e 6420 2b20 3129  erBand(band + 1)
-0000e4a0: 2e57 7269 7465 4172 7261 7928 6e65 775f  .WriteArray(new_
-0000e4b0: 6172 7261 7929 0d0a 0d0a 2020 2020 2020  array)....      
-0000e4c0: 2020 7265 7475 726e 2064 7374 5f6f 626a    return dst_obj
-0000e4d0: 0d0a 0d0a 2020 2020 6465 6620 6669 6c6c  ....    def fill
-0000e4e0: 280d 0a20 2020 2020 2020 2073 656c 662c  (..        self,
-0000e4f0: 2076 616c 3a20 556e 696f 6e5b 666c 6f61   val: Union[floa
-0000e500: 742c 2069 6e74 5d2c 2064 7269 7665 723a  t, int], driver:
-0000e510: 2073 7472 203d 2022 4d45 4d22 2c20 7061   str = "MEM", pa
-0000e520: 7468 3a20 7374 7220 3d20 4e6f 6e65 0d0a  th: str = None..
-0000e530: 2020 2020 2920 2d3e 2055 6e69 6f6e 5b4e      ) -> Union[N
-0000e540: 6f6e 652c 2067 6461 6c2e 4461 7461 7365  one, gdal.Datase
-0000e550: 745d 3a0d 0a20 2020 2020 2020 2022 2222  t]:..        """
-0000e560: 4669 6c6c 2e0d 0a0d 0a20 2020 2020 2020  Fill.....       
-0000e570: 2020 2020 2046 696c 6c20 7461 6b65 7320       Fill takes 
-0000e580: 6120 7261 7374 6572 2061 6e64 2066 696c  a raster and fil
-0000e590: 6c20 6974 2077 6974 6820 6f6e 6520 7661  l it with one va
-0000e5a0: 6c75 650d 0a0d 0a20 2020 2020 2020 2050  lue....        P
-0000e5b0: 6172 616d 6574 6572 730d 0a20 2020 2020  arameters..     
-0000e5c0: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20     ----------.. 
-0000e5d0: 2020 2020 2020 2076 616c 3a20 5b6e 756d         val: [num
-0000e5e0: 6572 6963 5d0d 0a20 2020 2020 2020 2020  eric]..         
-0000e5f0: 2020 206e 756d 6572 6963 2076 616c 7565     numeric value
-0000e600: 0d0a 2020 2020 2020 2020 6472 6976 6572  ..        driver
-0000e610: 3a20 5b73 7472 5d0d 0a20 2020 2020 2020  : [str]..       
-0000e620: 2020 2020 2064 7269 7665 7220 7479 7065       driver type
-0000e630: 205b 2247 5469 6666 222c 2022 4d45 4d22   ["GTiff", "MEM"
-0000e640: 5d0d 0a20 2020 2020 2020 2070 6174 6820  ]..        path 
-0000e650: 3a20 5b73 7472 5d0d 0a20 2020 2020 2020  : [str]..       
-0000e660: 2020 2020 2070 6174 6820 696e 636c 7564       path includ
-0000e670: 696e 6720 7468 6520 6578 7465 6e73 696f  ing the extensio
-0000e680: 6e20 282e 7469 6629 0d0a 0d0a 2020 2020  n (.tif)....    
-0000e690: 2020 2020 5265 7475 726e 730d 0a20 2020      Returns..   
-0000e6a0: 2020 2020 202d 2d2d 2d2d 2d2d 0d0a 2020       -------..  
-0000e6b0: 2020 2020 2020 7261 7374 6572 203a 205b        raster : [
-0000e6c0: 4e6f 6e65 2f67 6461 6c2e 4461 7461 6375  None/gdal.Datacu
-0000e6d0: 6265 5d0d 0a20 2020 2020 2020 2020 2020  be]..           
-0000e6e0: 2069 6620 7468 6520 7261 7374 6572 2069   if the raster i
-0000e6f0: 7320 7361 7665 6420 6469 7265 6374 6c79  s saved directly
-0000e700: 2074 6f20 7468 6520 7061 7468 2079 6f75   to the path you
-0000e710: 2070 726f 7669 6465 6420 7468 6520 7265   provided the re
-0000e720: 7475 726e 6564 2076 616c 7565 2077 696c  turned value wil
-0000e730: 6c20 6265 204e 6f6e 652c 206f 7468 6572  l be None, other
-0000e740: 7769 7365 2074 6865 0d0a 2020 2020 2020  wise the..      
-0000e750: 2020 2020 2020 7265 7475 726e 6564 2076        returned v
-0000e760: 616c 7565 2077 696c 6c20 6265 2074 6865  alue will be the
-0000e770: 2067 6461 6c2e 4461 7461 6375 6265 2069   gdal.Datacube i
-0000e780: 7473 656c 662e 0d0a 2020 2020 2020 2020  tself...        
-0000e790: 2222 220d 0a20 2020 2020 2020 206e 6f5f  """..        no_
-0000e7a0: 6461 7461 5f76 616c 7565 203d 2073 656c  data_value = sel
-0000e7b0: 662e 6e6f 5f64 6174 615f 7661 6c75 655b  f.no_data_value[
-0000e7c0: 305d 0d0a 2020 2020 2020 2020 7372 635f  0]..        src_
-0000e7d0: 6172 7261 7920 3d20 7365 6c66 2e72 6173  array = self.ras
-0000e7e0: 7465 722e 5265 6164 4173 4172 7261 7928  ter.ReadAsArray(
-0000e7f0: 290d 0a0d 0a20 2020 2020 2020 2069 6620  )....        if 
-0000e800: 6e6f 5f64 6174 615f 7661 6c75 6520 6973  no_data_value is
-0000e810: 204e 6f6e 653a 0d0a 2020 2020 2020 2020   None:..        
-0000e820: 2020 2020 6e6f 5f64 6174 615f 7661 6c75      no_data_valu
-0000e830: 6520 3d20 6e70 2e6e 616e 0d0a 0d0a 2020  e = np.nan....  
-0000e840: 2020 2020 2020 6966 206e 6f74 206e 702e        if not np.
-0000e850: 6973 6e61 6e28 6e6f 5f64 6174 615f 7661  isnan(no_data_va
-0000e860: 6c75 6529 3a0d 0a20 2020 2020 2020 2020  lue):..         
-0000e870: 2020 2073 7263 5f61 7272 6179 5b7e 6e70     src_array[~np
-0000e880: 2e69 7363 6c6f 7365 2873 7263 5f61 7272  .isclose(src_arr
-0000e890: 6179 2c20 6e6f 5f64 6174 615f 7661 6c75  ay, no_data_valu
-0000e8a0: 652c 2072 746f 6c3d 302e 3030 3030 3031  e, rtol=0.000001
-0000e8b0: 295d 203d 2076 616c 0d0a 2020 2020 2020  )] = val..      
-0000e8c0: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
-0000e8d0: 2020 2020 2073 7263 5f61 7272 6179 5b7e       src_array[~
-0000e8e0: 6e70 2e69 736e 616e 2873 7263 5f61 7272  np.isnan(src_arr
-0000e8f0: 6179 295d 203d 2076 616c 0d0a 2020 2020  ay)] = val..    
-0000e900: 2020 2020 6473 7420 3d20 4461 7461 7365      dst = Datase
-0000e910: 742e 6461 7461 7365 745f 6c69 6b65 2873  t.dataset_like(s
-0000e920: 656c 662c 2073 7263 5f61 7272 6179 2c20  elf, src_array, 
-0000e930: 6472 6976 6572 3d64 7269 7665 722c 2070  driver=driver, p
-0000e940: 6174 683d 7061 7468 290d 0a20 2020 2020  ath=path)..     
-0000e950: 2020 2072 6574 7572 6e20 6473 740d 0a0d     return dst...
-0000e960: 0a20 2020 2064 6566 2072 6573 616d 706c  .    def resampl
-0000e970: 6528 7365 6c66 2c20 6365 6c6c 5f73 697a  e(self, cell_siz
-0000e980: 653a 2055 6e69 6f6e 5b69 6e74 2c20 666c  e: Union[int, fl
-0000e990: 6f61 745d 2c20 6d65 7468 6f64 3a20 7374  oat], method: st
-0000e9a0: 7220 3d20 226e 6561 7265 7374 206e 6569  r = "nearest nei
-0000e9b0: 626f 7572 2229 3a0d 0a20 2020 2020 2020  bour"):..       
-0000e9c0: 2022 2222 7265 7361 6d70 6c65 2e0d 0a0d   """resample....
-0000e9d0: 0a20 2020 2020 2020 2072 6573 616d 706c  .        resampl
-0000e9e0: 6520 6d65 7468 6f64 2072 6570 726f 6a65  e method reproje
-0000e9f0: 6374 2061 2072 6173 7465 7220 746f 2061  ct a raster to a
-0000ea00: 6e79 2070 726f 6a65 6374 696f 6e0d 0a20  ny projection.. 
-0000ea10: 2020 2020 2020 2028 6465 6661 756c 7420         (default 
-0000ea20: 7468 6520 5747 5338 3420 7765 6220 6d65  the WGS84 web me
-0000ea30: 7263 6174 6f72 2070 726f 6a65 6374 696f  rcator projectio
-0000ea40: 6e2c 2077 6974 686f 7574 2072 6573 616d  n, without resam
-0000ea50: 706c 696e 6729 0d0a 2020 2020 2020 2020  pling)..        
-0000ea60: 5468 6520 6675 6e63 7469 6f6e 2072 6574  The function ret
-0000ea70: 7572 6e73 2061 2047 4441 4c20 696e 2d6d  urns a GDAL in-m
-0000ea80: 656d 6f72 7920 6669 6c65 206f 626a 6563  emory file objec
-0000ea90: 742c 2077 6865 7265 2079 6f75 2063 616e  t, where you can
-0000eaa0: 2052 6561 6441 7341 7272 6179 2065 7463   ReadAsArray etc
-0000eab0: 2e0d 0a0d 0a20 2020 2020 2020 2050 6172  .....        Par
-0000eac0: 616d 6574 6572 730d 0a20 2020 2020 2020  ameters..       
-0000ead0: 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020   ----------..   
-0000eae0: 2020 2020 2063 656c 6c5f 7369 7a65 203a       cell_size :
-0000eaf0: 205b 696e 7465 6765 725d 0d0a 2020 2020   [integer]..    
-0000eb00: 2020 2020 2020 2020 206e 6577 2063 656c           new cel
-0000eb10: 6c20 7369 7a65 2074 6f20 7265 7361 6d70  l size to resamp
-0000eb20: 6c65 2074 6865 2072 6173 7465 722e 0d0a  le the raster...
-0000eb30: 2020 2020 2020 2020 2020 2020 2864 6566              (def
-0000eb40: 6175 6c74 2065 6d70 7479 2073 6f20 7261  ault empty so ra
-0000eb50: 7374 6572 2077 696c 6c20 6e6f 7420 6265  ster will not be
-0000eb60: 2072 6573 616d 706c 6564 290d 0a20 2020   resampled)..   
-0000eb70: 2020 2020 206d 6574 686f 6420 3a20 5b53       method : [S
-0000eb80: 7472 696e 675d 0d0a 2020 2020 2020 2020  tring]..        
-0000eb90: 2020 2020 7265 7361 6d70 6c69 6e67 2074      resampling t
-0000eba0: 6563 686e 6971 7565 2064 6566 6175 6c74  echnique default
-0000ebb0: 2069 7320 224e 6561 7265 7374 220d 0a20   is "Nearest".. 
-0000ebc0: 2020 2020 2020 2020 2020 2068 7474 7073             https
-0000ebd0: 3a2f 2f67 6973 6765 6f67 7261 7068 792e  ://gisgeography.
-0000ebe0: 636f 6d2f 7261 7374 6572 2d72 6573 616d  com/raster-resam
-0000ebf0: 706c 696e 672f 0d0a 2020 2020 2020 2020  pling/..        
-0000ec00: 2020 2020 226e 6561 7265 7374 206e 6569      "nearest nei
-0000ec10: 626f 7572 2220 666f 7220 6e65 6172 6573  bour" for neares
-0000ec20: 7420 6e65 6967 6862 6f75 722c 2263 7562  t neighbour,"cub
-0000ec30: 6963 2220 666f 7220 6375 6269 6320 636f  ic" for cubic co
-0000ec40: 6e76 6f6c 7574 696f 6e2c 0d0a 2020 2020  nvolution,..    
-0000ec50: 2020 2020 2020 2020 2262 696c 696e 6561          "bilinea
-0000ec60: 7222 2066 6f72 2062 696c 696e 6561 720d  r" for bilinear.
-0000ec70: 0a0d 0a20 2020 2020 2020 2052 6574 7572  ...        Retur
-0000ec80: 6e73 0d0a 2020 2020 2020 2020 2d2d 2d2d  ns..        ----
-0000ec90: 2d2d 2d0d 0a20 2020 2020 2020 2072 6173  ---..        ras
-0000eca0: 7465 7220 3a20 5b44 6174 6173 6574 5d0d  ter : [Dataset].
-0000ecb0: 0a20 2020 2020 2020 2020 2020 2020 4461  .             Da
-0000ecc0: 7461 7365 7420 6f62 6a65 6374 2e0d 0a20  taset object... 
-0000ecd0: 2020 2020 2020 2022 2222 0d0a 2020 2020         """..    
-0000ece0: 2020 2020 6966 206e 6f74 2069 7369 6e73      if not isins
-0000ecf0: 7461 6e63 6528 6d65 7468 6f64 2c20 7374  tance(method, st
-0000ed00: 7229 3a0d 0a20 2020 2020 2020 2020 2020  r):..           
-0000ed10: 2072 6169 7365 2054 7970 6545 7272 6f72   raise TypeError
-0000ed20: 280d 0a20 2020 2020 2020 2020 2020 2020  (..             
-0000ed30: 2020 2022 2070 6c65 6173 6520 656e 7465     " please ente
-0000ed40: 7220 636f 7272 6563 7420 6d65 7468 6f64  r correct method
-0000ed50: 206d 6f72 6520 696e 666f 726d 6174 696f   more informatio
-0000ed60: 6e20 7365 6520 646f 636d 656e 7461 7469  n see docmentati
-0000ed70: 6f6e 2022 0d0a 2020 2020 2020 2020 2020  on "..          
-0000ed80: 2020 290d 0a20 2020 2020 2020 2069 6620    )..        if 
-0000ed90: 6d65 7468 6f64 206e 6f74 2069 6e20 494e  method not in IN
-0000eda0: 5445 5250 4f4c 4154 494f 4e5f 4d45 5448  TERPOLATION_METH
-0000edb0: 4f44 532e 6b65 7973 2829 3a0d 0a20 2020  ODS.keys():..   
-0000edc0: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
-0000edd0: 616c 7565 4572 726f 7228 0d0a 2020 2020  alueError(..    
-0000ede0: 2020 2020 2020 2020 2020 2020 6622 5468              f"Th
-0000edf0: 6520 6769 7665 6e20 696e 7465 7270 6f6c  e given interpol
-0000ee00: 6174 696f 6e20 6d65 7468 6f64 2064 6f65  ation method doe
-0000ee10: 7320 6e6f 7420 6578 6973 742c 2065 7869  s not exist, exi
-0000ee20: 7374 696e 6720 6d65 7468 6f64 7320 6172  sting methods ar
-0000ee30: 6520 7b49 4e54 4552 504f 4c41 5449 4f4e  e {INTERPOLATION
-0000ee40: 5f4d 4554 484f 4453 2e6b 6579 7328 297d  _METHODS.keys()}
-0000ee50: 220d 0a20 2020 2020 2020 2020 2020 2029  "..            )
-0000ee60: 0d0a 0d0a 2020 2020 2020 2020 6d65 7468  ....        meth
-0000ee70: 6f64 203d 2049 4e54 4552 504f 4c41 5449  od = INTERPOLATI
-0000ee80: 4f4e 5f4d 4554 484f 4453 2e67 6574 286d  ON_METHODS.get(m
-0000ee90: 6574 686f 6429 0d0a 0d0a 2020 2020 2020  ethod)....      
-0000eea0: 2020 7372 5f73 7263 203d 206f 7372 2e53    sr_src = osr.S
-0000eeb0: 7061 7469 616c 5265 6665 7265 6e63 6528  patialReference(
-0000eec0: 776b 743d 7365 6c66 2e63 7273 290d 0a0d  wkt=self.crs)...
-0000eed0: 0a20 2020 2020 2020 2075 6c78 203d 2073  .        ulx = s
-0000eee0: 656c 662e 6765 6f74 7261 6e73 666f 726d  elf.geotransform
-0000eef0: 5b30 5d0d 0a20 2020 2020 2020 2075 6c79  [0]..        uly
-0000ef00: 203d 2073 656c 662e 6765 6f74 7261 6e73   = self.geotrans
-0000ef10: 666f 726d 5b33 5d0d 0a20 2020 2020 2020  form[3]..       
-0000ef20: 2023 2074 7261 6e73 666f 726d 2074 6865   # transform the
-0000ef30: 2072 6967 6874 206c 6f77 6572 2063 6f72   right lower cor
-0000ef40: 6e65 7220 706f 696e 740d 0a20 2020 2020  ner point..     
-0000ef50: 2020 206c 7278 203d 2073 656c 662e 6765     lrx = self.ge
-0000ef60: 6f74 7261 6e73 666f 726d 5b30 5d20 2b20  otransform[0] + 
-0000ef70: 7365 6c66 2e67 656f 7472 616e 7366 6f72  self.geotransfor
-0000ef80: 6d5b 315d 202a 2073 656c 662e 636f 6c75  m[1] * self.colu
-0000ef90: 6d6e 730d 0a20 2020 2020 2020 206c 7279  mns..        lry
-0000efa0: 203d 2073 656c 662e 6765 6f74 7261 6e73   = self.geotrans
-0000efb0: 666f 726d 5b33 5d20 2b20 7365 6c66 2e67  form[3] + self.g
-0000efc0: 656f 7472 616e 7366 6f72 6d5b 355d 202a  eotransform[5] *
-0000efd0: 2073 656c 662e 726f 7773 0d0a 0d0a 2020   self.rows....  
-0000efe0: 2020 2020 2020 2320 6e65 7720 6765 6f74        # new geot
-0000eff0: 7261 6e73 666f 726d 0d0a 2020 2020 2020  ransform..      
-0000f000: 2020 6e65 775f 6765 6f20 3d20 280d 0a20    new_geo = (.. 
-0000f010: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0000f020: 6765 6f74 7261 6e73 666f 726d 5b30 5d2c  geotransform[0],
-0000f030: 0d0a 2020 2020 2020 2020 2020 2020 6365  ..            ce
-0000f040: 6c6c 5f73 697a 652c 0d0a 2020 2020 2020  ll_size,..      
-0000f050: 2020 2020 2020 7365 6c66 2e67 656f 7472        self.geotr
-0000f060: 616e 7366 6f72 6d5b 325d 2c0d 0a20 2020  ansform[2],..   
-0000f070: 2020 2020 2020 2020 2073 656c 662e 6765           self.ge
-0000f080: 6f74 7261 6e73 666f 726d 5b33 5d2c 0d0a  otransform[3],..
-0000f090: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0000f0a0: 2e67 656f 7472 616e 7366 6f72 6d5b 345d  .geotransform[4]
-0000f0b0: 2c0d 0a20 2020 2020 2020 2020 2020 202d  ,..            -
-0000f0c0: 3120 2a20 6365 6c6c 5f73 697a 652c 0d0a  1 * cell_size,..
-0000f0d0: 2020 2020 2020 2020 290d 0a20 2020 2020          )..     
-0000f0e0: 2020 2023 2063 7265 6174 6520 6120 6e65     # create a ne
-0000f0f0: 7720 7261 7374 6572 0d0a 2020 2020 2020  w raster..      
-0000f100: 2020 636f 6c73 203d 2069 6e74 286e 702e    cols = int(np.
-0000f110: 726f 756e 6428 6162 7328 6c72 7820 2d20  round(abs(lrx - 
-0000f120: 756c 7829 202f 2063 656c 6c5f 7369 7a65  ulx) / cell_size
-0000f130: 2929 0d0a 2020 2020 2020 2020 726f 7773  ))..        rows
-0000f140: 203d 2069 6e74 286e 702e 726f 756e 6428   = int(np.round(
-0000f150: 6162 7328 756c 7920 2d20 6c72 7929 202f  abs(uly - lry) /
-0000f160: 2063 656c 6c5f 7369 7a65 2929 0d0a 2020   cell_size))..  
-0000f170: 2020 2020 2020 6474 7970 6520 3d20 7365        dtype = se
-0000f180: 6c66 2e64 7479 7065 5b30 5d0d 0a20 2020  lf.dtype[0]..   
-0000f190: 2020 2020 2062 616e 6473 203d 2073 656c       bands = sel
-0000f1a0: 662e 6261 6e64 5f63 6f75 6e74 0d0a 0d0a  f.band_count....
-0000f1b0: 2020 2020 2020 2020 6473 7420 3d20 4461          dst = Da
-0000f1c0: 7461 7365 742e 5f63 7265 6174 655f 6764  taset._create_gd
-0000f1d0: 616c 5f64 6174 6173 6574 2863 6f6c 732c  al_dataset(cols,
-0000f1e0: 2072 6f77 732c 2062 616e 6473 2c20 6474   rows, bands, dt
-0000f1f0: 7970 6529 0d0a 2020 2020 2020 2020 2320  ype)..        # 
-0000f200: 7365 7420 7468 6520 6765 6f74 7261 6e73  set the geotrans
-0000f210: 666f 726d 0d0a 2020 2020 2020 2020 6473  form..        ds
-0000f220: 742e 5365 7447 656f 5472 616e 7366 6f72  t.SetGeoTransfor
-0000f230: 6d28 6e65 775f 6765 6f29 0d0a 2020 2020  m(new_geo)..    
-0000f240: 2020 2020 2320 7365 7420 7468 6520 7072      # set the pr
-0000f250: 6f6a 6563 7469 6f6e 0d0a 2020 2020 2020  ojection..      
-0000f260: 2020 6473 742e 5365 7450 726f 6a65 6374    dst.SetProject
-0000f270: 696f 6e28 7372 5f73 7263 2e45 7870 6f72  ion(sr_src.Expor
-0000f280: 7454 6f57 6b74 2829 290d 0a20 2020 2020  tToWkt())..     
-0000f290: 2020 2064 7374 5f6f 626a 203d 2044 6174     dst_obj = Dat
-0000f2a0: 6173 6574 2864 7374 290d 0a20 2020 2020  aset(dst)..     
-0000f2b0: 2020 2023 2073 6574 2074 6865 206e 6f20     # set the no 
-0000f2c0: 6461 7461 2076 616c 7565 0d0a 2020 2020  data value..    
-0000f2d0: 2020 2020 6473 745f 6f62 6a2e 5f73 6574      dst_obj._set
-0000f2e0: 5f6e 6f5f 6461 7461 5f76 616c 7565 2873  _no_data_value(s
-0000f2f0: 656c 662e 6e6f 5f64 6174 615f 7661 6c75  elf.no_data_valu
-0000f300: 6529 0d0a 2020 2020 2020 2020 2320 7065  e)..        # pe
-0000f310: 7266 6f72 6d20 7468 6520 7072 6f6a 6563  rform the projec
-0000f320: 7469 6f6e 2026 2072 6573 616d 706c 696e  tion & resamplin
-0000f330: 670d 0a20 2020 2020 2020 2067 6461 6c2e  g..        gdal.
-0000f340: 5265 7072 6f6a 6563 7449 6d61 6765 280d  ReprojectImage(.
-0000f350: 0a20 2020 2020 2020 2020 2020 2073 656c  .            sel
-0000f360: 662e 7261 7374 6572 2c0d 0a20 2020 2020  f.raster,..     
-0000f370: 2020 2020 2020 2064 7374 5f6f 626a 2e72         dst_obj.r
-0000f380: 6173 7465 722c 0d0a 2020 2020 2020 2020  aster,..        
-0000f390: 2020 2020 7372 5f73 7263 2e45 7870 6f72      sr_src.Expor
-0000f3a0: 7454 6f57 6b74 2829 2c0d 0a20 2020 2020  tToWkt(),..     
-0000f3b0: 2020 2020 2020 2073 725f 7372 632e 4578         sr_src.Ex
-0000f3c0: 706f 7274 546f 576b 7428 292c 0d0a 2020  portToWkt(),..  
-0000f3d0: 2020 2020 2020 2020 2020 6d65 7468 6f64            method
-0000f3e0: 2c0d 0a20 2020 2020 2020 2029 0d0a 0d0a  ,..        )....
-0000f3f0: 2020 2020 2020 2020 7265 7475 726e 2064          return d
-0000f400: 7374 5f6f 626a 0d0a 0d0a 2020 2020 6465  st_obj....    de
-0000f410: 6620 746f 5f63 7273 280d 0a20 2020 2020  f to_crs(..     
-0000f420: 2020 2073 656c 662c 0d0a 2020 2020 2020     self,..      
-0000f430: 2020 746f 5f65 7073 673a 2069 6e74 2c0d    to_epsg: int,.
-0000f440: 0a20 2020 2020 2020 206d 6574 686f 643a  .        method:
-0000f450: 2073 7472 203d 2022 6e65 6172 6573 7420   str = "nearest 
-0000f460: 6e65 6962 6f75 7222 2c0d 0a20 2020 2020  neibour",..     
-0000f470: 2020 206d 6169 6e74 6169 6e5f 616c 6967     maintain_alig
-0000f480: 686d 656e 743a 2069 6e74 203d 2046 616c  hment: int = Fal
-0000f490: 7365 2c0d 0a20 2020 2029 3a0d 0a20 2020  se,..    ):..   
-0000f4a0: 2020 2020 2022 2222 746f 5f65 7073 672e       """to_epsg.
-0000f4b0: 0d0a 0d0a 2020 2020 2020 2020 746f 5f65  ....        to_e
-0000f4c0: 7073 6720 7265 7072 6f6a 6563 7473 2061  psg reprojects a
-0000f4d0: 2072 6173 7465 7220 746f 2061 6e79 2070   raster to any p
-0000f4e0: 726f 6a65 6374 696f 6e0d 0a20 2020 2020  rojection..     
-0000f4f0: 2020 2028 6465 6661 756c 7420 7468 6520     (default the 
-0000f500: 5747 5338 3420 7765 6220 6d65 7263 6174  WGS84 web mercat
-0000f510: 6f72 2070 726f 6a65 6374 696f 6e2c 2077  or projection, w
-0000f520: 6974 686f 7574 2072 6573 616d 706c 696e  ithout resamplin
-0000f530: 6729 0d0a 0d0a 2020 2020 2020 2020 5061  g)....        Pa
-0000f540: 7261 6d65 7465 7273 0d0a 2020 2020 2020  rameters..      
-0000f550: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020    ----------..  
-0000f560: 2020 2020 2020 746f 5f65 7073 673a 205b        to_epsg: [
-0000f570: 696e 7465 6765 725d 0d0a 2020 2020 2020  integer]..      
-0000f580: 2020 2020 2020 7265 6665 7265 6e63 6520        reference 
-0000f590: 6e75 6d62 6572 2074 6f20 7468 6520 6e65  number to the ne
-0000f5a0: 7720 7072 6f6a 6563 7469 6f6e 2028 6874  w projection (ht
-0000f5b0: 7470 733a 2f2f 6570 7367 2e69 6f2f 290d  tps://epsg.io/).
-0000f5c0: 0a20 2020 2020 2020 2020 2020 2028 6465  .            (de
-0000f5d0: 6661 756c 7420 3338 3537 2074 6865 2072  fault 3857 the r
-0000f5e0: 6566 6572 656e 6365 206e 6f20 6f66 2057  eference no of W
-0000f5f0: 4753 3834 2077 6562 206d 6572 6361 746f  GS84 web mercato
-0000f600: 7220 290d 0a20 2020 2020 2020 206d 6574  r )..        met
-0000f610: 686f 643a 205b 5374 7269 6e67 5d0d 0a20  hod: [String].. 
-0000f620: 2020 2020 2020 2020 2020 2072 6573 616d             resam
-0000f630: 706c 696e 6720 7465 6368 6e69 7175 6520  pling technique 
-0000f640: 6465 6661 756c 7420 6973 2022 4e65 6172  default is "Near
-0000f650: 6573 7422 0d0a 2020 2020 2020 2020 2020  est"..          
-0000f660: 2020 6874 7470 733a 2f2f 6769 7367 656f    https://gisgeo
-0000f670: 6772 6170 6879 2e63 6f6d 2f72 6173 7465  graphy.com/raste
-0000f680: 722d 7265 7361 6d70 6c69 6e67 2f0d 0a20  r-resampling/.. 
-0000f690: 2020 2020 2020 2020 2020 2022 6e65 6172             "near
-0000f6a0: 6573 7420 6e65 6962 6f75 7222 2066 6f72  est neibour" for
-0000f6b0: 206e 6561 7265 7374 206e 6569 6768 626f   nearest neighbo
-0000f6c0: 7572 2c22 6375 6269 6322 2066 6f72 2063  ur,"cubic" for c
-0000f6d0: 7562 6963 2063 6f6e 766f 6c75 7469 6f6e  ubic convolution
-0000f6e0: 2c0d 0a20 2020 2020 2020 2020 2020 2022  ,..            "
-0000f6f0: 6269 6c69 6e65 6172 2220 666f 7220 6269  bilinear" for bi
-0000f700: 6c69 6e65 6172 0d0a 2020 2020 2020 2020  linear..        
-0000f710: 6d61 696e 7461 696e 5f61 6c69 6768 6d65  maintain_alighme
-0000f720: 6e74 203a 205b 626f 6f6c 5d0d 0a20 2020  nt : [bool]..   
-0000f730: 2020 2020 2020 2020 2054 7275 6520 746f           True to
-0000f740: 206d 6169 6e74 6169 6e20 7468 6520 6e75   maintain the nu
-0000f750: 6d62 6572 206f 6620 726f 7773 2061 6e64  mber of rows and
-0000f760: 2063 6f6c 756d 6e73 206f 6620 7468 6520   columns of the 
-0000f770: 7261 7374 6572 2074 6865 2073 616d 6520  raster the same 
-0000f780: 6166 7465 7220 7265 7072 6f6a 6563 7469  after reprojecti
-0000f790: 6f6e 2e20 4465 6661 756c 7420 6973 2046  on. Default is F
-0000f7a0: 616c 7365 2e0d 0a0d 0a20 2020 2020 2020  alse.....       
-0000f7b0: 2052 6574 7572 6e73 0d0a 2020 2020 2020   Returns..      
-0000f7c0: 2020 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020    -------..     
-0000f7d0: 2020 2072 6173 7465 723a 0d0a 2020 2020     raster:..    
-0000f7e0: 2020 2020 2020 2020 6764 616c 2064 6174          gdal dat
-0000f7f0: 6173 6574 2028 796f 7520 6361 6e20 7265  aset (you can re
-0000f800: 6164 2069 7420 6279 2052 6561 6441 7341  ad it by ReadAsA
-0000f810: 7272 6179 290d 0a0d 0a20 2020 2020 2020  rray)....       
-0000f820: 2045 7861 6d70 6c65 730d 0a20 2020 2020   Examples..     
-0000f830: 2020 202d 2d2d 2d2d 2d2d 2d0d 0a20 2020     --------..   
-0000f840: 2020 2020 203e 3e3e 2066 726f 6d20 7079       >>> from py
-0000f850: 7261 6d69 6473 2e64 6174 6173 6574 2069  ramids.dataset i
-0000f860: 6d70 6f72 7420 4461 7461 7365 740d 0a20  mport Dataset.. 
-0000f870: 2020 2020 2020 203e 3e3e 2073 7263 203d         >>> src =
-0000f880: 2044 6174 6173 6574 2e72 6561 645f 6669   Dataset.read_fi
-0000f890: 6c65 2822 7061 7468 2f72 6173 7465 725f  le("path/raster_
-0000f8a0: 6e61 6d65 2e74 6966 2229 0d0a 2020 2020  name.tif")..    
-0000f8b0: 2020 2020 3e3e 3e20 7072 6f6a 6563 7465      >>> projecte
-0000f8c0: 645f 7261 7374 6572 203d 2073 7263 2e74  d_raster = src.t
-0000f8d0: 6f5f 6372 7328 746f 5f65 7073 673d 3338  o_crs(to_epsg=38
-0000f8e0: 3537 290d 0a20 2020 2020 2020 2022 2222  57)..        """
-0000f8f0: 0d0a 2020 2020 2020 2020 6966 206e 6f74  ..        if not
-0000f900: 2069 7369 6e73 7461 6e63 6528 746f 5f65   isinstance(to_e
-0000f910: 7073 672c 2069 6e74 293a 0d0a 2020 2020  psg, int):..    
-0000f920: 2020 2020 2020 2020 7261 6973 6520 5479          raise Ty
-0000f930: 7065 4572 726f 7228 0d0a 2020 2020 2020  peError(..      
-0000f940: 2020 2020 2020 2020 2020 2270 6c65 6173            "pleas
-0000f950: 6520 656e 7465 7220 636f 7272 6563 7420  e enter correct 
-0000f960: 696e 7465 6765 7220 6e75 6d62 6572 2066  integer number f
-0000f970: 6f72 2074 6f5f 6570 7367 206d 6f72 6520  or to_epsg more 
-0000f980: 696e 666f 726d 6174 696f 6e20 220d 0a20  information ".. 
-0000f990: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-0000f9a0: 2268 7474 7073 3a2f 2f65 7073 672e 696f  "https://epsg.io
-0000f9b0: 2f2c 2067 6976 656e 207b 7479 7065 2874  /, given {type(t
-0000f9c0: 6f5f 6570 7367 297d 220d 0a20 2020 2020  o_epsg)}"..     
-0000f9d0: 2020 2020 2020 2029 0d0a 2020 2020 2020         )..      
-0000f9e0: 2020 6966 206e 6f74 2069 7369 6e73 7461    if not isinsta
-0000f9f0: 6e63 6528 6d65 7468 6f64 2c20 7374 7229  nce(method, str)
-0000fa00: 3a0d 0a20 2020 2020 2020 2020 2020 2072  :..            r
-0000fa10: 6169 7365 2054 7970 6545 7272 6f72 280d  aise TypeError(.
-0000fa20: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0000fa30: 2022 706c 6561 7365 2065 6e74 6572 2063   "please enter c
-0000fa40: 6f72 7265 6374 206d 6574 686f 6420 6d6f  orrect method mo
-0000fa50: 7265 2069 6e66 6f72 6d61 7469 6f6e 2073  re information s
-0000fa60: 6565 2022 2022 646f 636d 656e 7461 7469  ee " "docmentati
-0000fa70: 6f6e 2022 0d0a 2020 2020 2020 2020 2020  on "..          
-0000fa80: 2020 290d 0a20 2020 2020 2020 2069 6620    )..        if 
-0000fa90: 6d65 7468 6f64 206e 6f74 2069 6e20 494e  method not in IN
-0000faa0: 5445 5250 4f4c 4154 494f 4e5f 4d45 5448  TERPOLATION_METH
-0000fab0: 4f44 532e 6b65 7973 2829 3a0d 0a20 2020  ODS.keys():..   
-0000fac0: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
-0000fad0: 616c 7565 4572 726f 7228 0d0a 2020 2020  alueError(..    
-0000fae0: 2020 2020 2020 2020 2020 2020 6622 5468              f"Th
-0000faf0: 6520 6769 7665 6e20 696e 7465 7270 6f6c  e given interpol
-0000fb00: 6174 696f 6e20 6d65 7468 6f64 2064 6f65  ation method doe
-0000fb10: 7320 6e6f 7420 6578 6973 742c 2065 7869  s not exist, exi
-0000fb20: 7374 696e 6720 6d65 7468 6f64 7320 6172  sting methods ar
-0000fb30: 6520 7b49 4e54 4552 504f 4c41 5449 4f4e  e {INTERPOLATION
-0000fb40: 5f4d 4554 484f 4453 2e6b 6579 7328 297d  _METHODS.keys()}
-0000fb50: 220d 0a20 2020 2020 2020 2020 2020 2029  "..            )
-0000fb60: 0d0a 0d0a 2020 2020 2020 2020 6d65 7468  ....        meth
-0000fb70: 6f64 203d 2049 4e54 4552 504f 4c41 5449  od = INTERPOLATI
-0000fb80: 4f4e 5f4d 4554 484f 4453 2e67 6574 286d  ON_METHODS.get(m
-0000fb90: 6574 686f 6429 0d0a 0d0a 2020 2020 2020  ethod)....      
-0000fba0: 2020 6966 206d 6169 6e74 6169 6e5f 616c    if maintain_al
-0000fbb0: 6967 686d 656e 743a 0d0a 2020 2020 2020  ighment:..      
-0000fbc0: 2020 2020 2020 6473 745f 6f62 6a20 3d20        dst_obj = 
-0000fbd0: 7365 6c66 2e5f 7265 7072 6f6a 6563 745f  self._reproject_
-0000fbe0: 7769 7468 5f52 6570 726f 6a65 6374 496d  with_ReprojectIm
-0000fbf0: 6167 6528 746f 5f65 7073 672c 206d 6574  age(to_epsg, met
-0000fc00: 686f 6429 0d0a 2020 2020 2020 2020 656c  hod)..        el
-0000fc10: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
-0000fc20: 2064 7374 203d 2067 6461 6c2e 5761 7270   dst = gdal.Warp
-0000fc30: 2822 222c 2073 656c 662e 7261 7374 6572  ("", self.raster
-0000fc40: 2c20 6473 7453 5253 3d66 2245 5053 473a  , dstSRS=f"EPSG:
-0000fc50: 7b74 6f5f 6570 7367 7d22 2c20 666f 726d  {to_epsg}", form
-0000fc60: 6174 3d22 5652 5422 290d 0a20 2020 2020  at="VRT")..     
-0000fc70: 2020 2020 2020 2064 7374 5f6f 626a 203d         dst_obj =
-0000fc80: 2044 6174 6173 6574 2864 7374 290d 0a0d   Dataset(dst)...
-0000fc90: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0000fca0: 6473 745f 6f62 6a0d 0a0d 0a20 2020 2064  dst_obj....    d
-0000fcb0: 6566 205f 7265 7072 6f6a 6563 745f 7769  ef _reproject_wi
-0000fcc0: 7468 5f52 6570 726f 6a65 6374 496d 6167  th_ReprojectImag
-0000fcd0: 6528 0d0a 2020 2020 2020 2020 7365 6c66  e(..        self
-0000fce0: 2c20 746f 5f65 7073 673a 2069 6e74 2c20  , to_epsg: int, 
-0000fcf0: 6d65 7468 6f64 3a20 7374 7220 3d20 226e  method: str = "n
-0000fd00: 6561 7265 7374 206e 6569 626f 7572 220d  earest neibour".
-0000fd10: 0a20 2020 2029 202d 3e20 6f62 6a65 6374  .    ) -> object
-0000fd20: 3a0d 0a20 2020 2020 2020 2073 7263 5f67  :..        src_g
-0000fd30: 7420 3d20 7365 6c66 2e67 656f 7472 616e  t = self.geotran
-0000fd40: 7366 6f72 6d0d 0a20 2020 2020 2020 2073  sform..        s
-0000fd50: 7263 5f78 203d 2073 656c 662e 636f 6c75  rc_x = self.colu
-0000fd60: 6d6e 730d 0a20 2020 2020 2020 2073 7263  mns..        src
-0000fd70: 5f79 203d 2073 656c 662e 726f 7773 0d0a  _y = self.rows..
-0000fd80: 0d0a 2020 2020 2020 2020 7372 635f 7372  ..        src_sr
-0000fd90: 203d 206f 7372 2e53 7061 7469 616c 5265   = osr.SpatialRe
-0000fda0: 6665 7265 6e63 6528 776b 743d 7365 6c66  ference(wkt=self
-0000fdb0: 2e63 7273 290d 0a20 2020 2020 2020 2073  .crs)..        s
-0000fdc0: 7263 5f65 7073 6720 3d20 7365 6c66 2e65  rc_epsg = self.e
-0000fdd0: 7073 670d 0a0d 0a20 2020 2020 2020 2023  psg....        #
-0000fde0: 2323 2064 6973 7469 6e61 7469 6f6e 2072  ## distination r
-0000fdf0: 6173 7465 720d 0a20 2020 2020 2020 2023  aster..        #
-0000fe00: 2073 7061 7469 616c 2072 6566 0d0a 2020   spatial ref..  
-0000fe10: 2020 2020 2020 6473 745f 7372 203d 2073        dst_sr = s
-0000fe20: 656c 662e 5f63 7265 6174 655f 7372 5f66  elf._create_sr_f
-0000fe30: 726f 6d5f 6570 7367 2874 6f5f 6570 7367  rom_epsg(to_epsg
-0000fe40: 290d 0a0d 0a20 2020 2020 2020 2023 2069  )....        # i
-0000fe50: 6e20 6361 7365 2074 6865 2073 6f75 7263  n case the sourc
-0000fe60: 6520 6372 7320 6973 2047 4353 2061 6e64  e crs is GCS and
-0000fe70: 206c 6f6e 6769 7475 6465 2069 7320 696e   longitude is in
-0000fe80: 2074 6865 2077 6573 7420 6865 6d69 7370   the west hemisp
-0000fe90: 6865 7265 2067 6461 6c0d 0a20 2020 2020  here gdal..     
-0000fea0: 2020 2023 2072 6561 6473 206c 6f6e 6769     # reads longi
-0000feb0: 7475 6465 2066 726f 6d20 3020 746f 2033  tude from 0 to 3
-0000fec0: 3630 2061 6e64 2074 7261 6e73 666f 726d  60 and transform
-0000fed0: 6174 696f 6e20 6661 6374 6f72 2077 6f6e  ation factor won
-0000fee0: 7420 776f 726b 2077 6974 6820 7661 6c75  t work with valu
-0000fef0: 6573 0d0a 2020 2020 2020 2020 2320 6772  es..        # gr
-0000ff00: 6561 7465 7220 7468 616e 2031 3830 0d0a  eater than 180..
-0000ff10: 2020 2020 2020 2020 6966 2073 7263 5f65          if src_e
-0000ff20: 7073 6720 213d 2074 6f5f 6570 7367 3a0d  psg != to_epsg:.
-0000ff30: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-0000ff40: 7372 635f 6570 7367 203d 3d20 2234 3332  src_epsg == "432
-0000ff50: 3622 2061 6e64 2073 7263 5f67 745b 305d  6" and src_gt[0]
-0000ff60: 203e 2031 3830 3a0d 0a20 2020 2020 2020   > 180:..       
-0000ff70: 2020 2020 2020 2020 206c 6e67 5f6e 6577           lng_new
-0000ff80: 203d 2073 7263 5f67 745b 305d 202d 2033   = src_gt[0] - 3
-0000ff90: 3630 0d0a 2020 2020 2020 2020 2020 2020  60..            
-0000ffa0: 2020 2020 2320 7472 616e 7366 6f72 6d61      # transforma
-0000ffb0: 7469 6f6e 2066 6163 746f 7273 0d0a 2020  tion factors..  
-0000ffc0: 2020 2020 2020 2020 2020 2020 2020 7478                tx
-0000ffd0: 203d 206f 7372 2e43 6f6f 7264 696e 6174   = osr.Coordinat
-0000ffe0: 6554 7261 6e73 666f 726d 6174 696f 6e28  eTransformation(
-0000fff0: 7372 635f 7372 2c20 6473 745f 7372 290d  src_sr, dst_sr).
-00010000: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00010010: 2023 2074 7261 6e73 666f 726d 2074 6865   # transform the
-00010020: 2072 6967 6874 2075 7070 6572 2063 6f72   right upper cor
-00010030: 6e65 7220 706f 696e 740d 0a20 2020 2020  ner point..     
-00010040: 2020 2020 2020 2020 2020 2028 756c 782c             (ulx,
-00010050: 2075 6c79 2c20 756c 7a29 203d 2074 782e   uly, ulz) = tx.
-00010060: 5472 616e 7366 6f72 6d50 6f69 6e74 286c  TransformPoint(l
-00010070: 6e67 5f6e 6577 2c20 7372 635f 6774 5b33  ng_new, src_gt[3
-00010080: 5d29 0d0a 2020 2020 2020 2020 2020 2020  ])..            
-00010090: 2020 2020 2320 7472 616e 7366 6f72 6d20      # transform 
-000100a0: 7468 6520 7269 6768 7420 6c6f 7765 7220  the right lower 
-000100b0: 636f 726e 6572 2070 6f69 6e74 0d0a 2020  corner point..  
-000100c0: 2020 2020 2020 2020 2020 2020 2020 286c                (l
-000100d0: 7278 2c20 6c72 792c 206c 727a 2920 3d20  rx, lry, lrz) = 
-000100e0: 7478 2e54 7261 6e73 666f 726d 506f 696e  tx.TransformPoin
-000100f0: 7428 0d0a 2020 2020 2020 2020 2020 2020  t(..            
-00010100: 2020 2020 2020 2020 6c6e 675f 6e65 7720          lng_new 
-00010110: 2b20 7372 635f 6774 5b31 5d20 2a20 7372  + src_gt[1] * sr
-00010120: 635f 782c 2073 7263 5f67 745b 335d 202b  c_x, src_gt[3] +
-00010130: 2073 7263 5f67 745b 355d 202a 2073 7263   src_gt[5] * src
-00010140: 5f79 0d0a 2020 2020 2020 2020 2020 2020  _y..            
-00010150: 2020 2020 290d 0a20 2020 2020 2020 2020      )..         
-00010160: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
-00010170: 2020 2020 2020 2020 2020 7873 203d 205b            xs = [
-00010180: 7372 635f 6774 5b30 5d2c 2073 7263 5f67  src_gt[0], src_g
-00010190: 745b 305d 202b 2073 7263 5f67 745b 315d  t[0] + src_gt[1]
-000101a0: 202a 2073 7263 5f78 5d0d 0a20 2020 2020   * src_x]..     
-000101b0: 2020 2020 2020 2020 2020 2079 7320 3d20             ys = 
-000101c0: 5b73 7263 5f67 745b 335d 2c20 7372 635f  [src_gt[3], src_
-000101d0: 6774 5b33 5d20 2b20 7372 635f 6774 5b35  gt[3] + src_gt[5
-000101e0: 5d20 2a20 7372 635f 795d 0d0a 0d0a 2020  ] * src_y]....  
-000101f0: 2020 2020 2020 2020 2020 2020 2020 5b75                [u
-00010200: 6c79 2c20 6c72 795d 2c20 5b75 6c78 2c20  ly, lry], [ulx, 
-00010210: 6c72 785d 203d 2046 6561 7475 7265 436f  lrx] = FeatureCo
-00010220: 6c6c 6563 7469 6f6e 2e72 6570 726f 6a65  llection.reproje
-00010230: 6374 5f70 6f69 6e74 7328 0d0a 2020 2020  ct_points(..    
-00010240: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010250: 7973 2c20 7873 2c20 6672 6f6d 5f65 7073  ys, xs, from_eps
-00010260: 673d 7372 635f 6570 7367 2c20 746f 5f65  g=src_epsg, to_e
-00010270: 7073 673d 746f 5f65 7073 670d 0a20 2020  psg=to_epsg..   
-00010280: 2020 2020 2020 2020 2020 2020 2029 0d0a               )..
-00010290: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000102a0: 2320 6f6c 6420 7472 616e 7366 6f72 6d0d  # old transform.
-000102b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000102c0: 2023 2023 2074 7261 6e73 666f 726d 2074   # # transform t
-000102d0: 6865 2072 6967 6874 2075 7070 6572 2063  he right upper c
-000102e0: 6f72 6e65 7220 706f 696e 740d 0a20 2020  orner point..   
-000102f0: 2020 2020 2020 2020 2020 2020 2023 2028               # (
-00010300: 756c 782c 2075 6c79 2c20 756c 7a29 203d  ulx, uly, ulz) =
-00010310: 2074 782e 5472 616e 7366 6f72 6d50 6f69   tx.TransformPoi
-00010320: 6e74 2873 7263 5f67 745b 305d 2c20 7372  nt(src_gt[0], sr
-00010330: 635f 6774 5b33 5d29 0d0a 2020 2020 2020  c_gt[3])..      
-00010340: 2020 2020 2020 2020 2020 2320 2320 7472            # # tr
-00010350: 616e 7366 6f72 6d20 7468 6520 7269 6768  ansform the righ
-00010360: 7420 6c6f 7765 7220 636f 726e 6572 2070  t lower corner p
-00010370: 6f69 6e74 0d0a 2020 2020 2020 2020 2020  oint..          
-00010380: 2020 2020 2020 2320 286c 7278 2c20 6c72        # (lrx, lr
-00010390: 792c 206c 727a 2920 3d20 7478 2e54 7261  y, lrz) = tx.Tra
-000103a0: 6e73 666f 726d 506f 696e 7428 0d0a 2020  nsformPoint(..  
-000103b0: 2020 2020 2020 2020 2020 2020 2020 2320                # 
-000103c0: 2020 2020 7372 635f 6774 5b30 5d20 2b20      src_gt[0] + 
-000103d0: 7372 635f 6774 5b31 5d20 2a20 7372 635f  src_gt[1] * src_
-000103e0: 782c 2073 7263 5f67 745b 335d 202b 2073  x, src_gt[3] + s
-000103f0: 7263 5f67 745b 355d 202a 2073 7263 5f79  rc_gt[5] * src_y
-00010400: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00010410: 2020 2320 290d 0a0d 0a20 2020 2020 2020    # )....       
-00010420: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
-00010430: 2020 2020 756c 7820 3d20 7372 635f 6774      ulx = src_gt
-00010440: 5b30 5d0d 0a20 2020 2020 2020 2020 2020  [0]..           
-00010450: 2075 6c79 203d 2073 7263 5f67 745b 335d   uly = src_gt[3]
-00010460: 0d0a 2020 2020 2020 2020 2020 2020 6c72  ..            lr
-00010470: 7820 3d20 7372 635f 6774 5b30 5d20 2b20  x = src_gt[0] + 
-00010480: 7372 635f 6774 5b31 5d20 2a20 7372 635f  src_gt[1] * src_
-00010490: 780d 0a20 2020 2020 2020 2020 2020 206c  x..            l
-000104a0: 7279 203d 2073 7263 5f67 745b 335d 202b  ry = src_gt[3] +
-000104b0: 2073 7263 5f67 745b 355d 202a 2073 7263   src_gt[5] * src
-000104c0: 5f79 0d0a 0d0a 2020 2020 2020 2020 2320  _y....        # 
-000104d0: 6765 7420 7468 6520 6365 6c6c 2073 697a  get the cell siz
-000104e0: 6520 696e 2074 6865 2073 6f75 7263 6520  e in the source 
-000104f0: 7261 7374 6572 2061 6e64 2063 6f6e 7665  raster and conve
-00010500: 7274 2069 7420 746f 2074 6865 206e 6577  rt it to the new
-00010510: 2063 7273 0d0a 2020 2020 2020 2020 2320   crs..        # 
-00010520: 7820 636f 6f72 6469 6e61 7465 7320 6f72  x coordinates or
-00010530: 206c 6f6e 6769 7475 6465 730d 0a20 2020   longitudes..   
-00010540: 2020 2020 2078 7320 3d20 5b73 7263 5f67       xs = [src_g
-00010550: 745b 305d 2c20 7372 635f 6774 5b30 5d20  t[0], src_gt[0] 
-00010560: 2b20 7372 635f 6774 5b31 5d5d 0d0a 2020  + src_gt[1]]..  
-00010570: 2020 2020 2020 2320 7920 636f 6f72 6469        # y coordi
-00010580: 6e61 7465 7320 6f72 206c 6174 6974 7564  nates or latitud
-00010590: 6573 0d0a 2020 2020 2020 2020 7973 203d  es..        ys =
-000105a0: 205b 7372 635f 6774 5b33 5d2c 2073 7263   [src_gt[3], src
-000105b0: 5f67 745b 335d 5d0d 0a0d 0a20 2020 2020  _gt[3]]....     
-000105c0: 2020 2069 6620 7372 635f 6570 7367 2021     if src_epsg !
-000105d0: 3d20 746f 5f65 7073 673a 0d0a 2020 2020  = to_epsg:..    
-000105e0: 2020 2020 2020 2020 2320 7472 616e 7366          # transf
-000105f0: 6f72 6d20 7468 6520 7477 6f20 706f 696e  orm the two poin
-00010600: 7473 2063 6f6f 7264 696e 6174 6573 2074  ts coordinates t
-00010610: 6f20 7468 6520 6e65 7720 6372 7320 746f  o the new crs to
-00010620: 2063 616c 6375 6c61 7465 2074 6865 206e   calculate the n
-00010630: 6577 2063 656c 6c20 7369 7a65 0d0a 2020  ew cell size..  
-00010640: 2020 2020 2020 2020 2020 6e65 775f 7973            new_ys
-00010650: 2c20 6e65 775f 7873 203d 2046 6561 7475  , new_xs = Featu
-00010660: 7265 436f 6c6c 6563 7469 6f6e 2e72 6570  reCollection.rep
-00010670: 726f 6a65 6374 5f70 6f69 6e74 7328 0d0a  roject_points(..
-00010680: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00010690: 7973 2c20 7873 2c20 6672 6f6d 5f65 7073  ys, xs, from_eps
-000106a0: 673d 7372 635f 6570 7367 2c20 746f 5f65  g=src_epsg, to_e
-000106b0: 7073 673d 746f 5f65 7073 672c 2070 7265  psg=to_epsg, pre
-000106c0: 6369 7369 6f6e 3d36 0d0a 2020 2020 2020  cision=6..      
-000106d0: 2020 2020 2020 290d 0a20 2020 2020 2020        )..       
-000106e0: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
-000106f0: 2020 2020 6e65 775f 7873 203d 2078 730d      new_xs = xs.
-00010700: 0a20 2020 2020 2020 2020 2020 2023 206e  .            # n
-00010710: 6577 5f79 7320 3d20 7973 0d0a 0d0a 2020  ew_ys = ys....  
-00010720: 2020 2020 2020 2320 544f 444f 3a20 7468        # TODO: th
-00010730: 6520 6675 6e63 7469 6f6e 2064 6f65 7320  e function does 
-00010740: 6e6f 7420 616c 7761 7973 206d 6169 6e74  not always maint
-00010750: 6169 6e20 616c 6967 6e6d 656e 742c 2062  ain alignment, b
-00010760: 6173 6564 206f 6e20 7468 6520 636f 6e76  ased on the conv
-00010770: 6572 7369 6f6e 206f 6620 7468 6520 6365  ersion of the ce
-00010780: 6c6c 5f73 697a 6520 616e 6420 7468 650d  ll_size and the.
-00010790: 0a20 2020 2020 2020 2023 2070 6976 6f74  .        # pivot
-000107a0: 2070 6f69 6e74 0d0a 2020 2020 2020 2020   point..        
-000107b0: 7069 7865 6c5f 7370 6163 696e 6720 3d20  pixel_spacing = 
-000107c0: 6e70 2e61 6273 286e 6577 5f78 735b 305d  np.abs(new_xs[0]
-000107d0: 202d 206e 6577 5f78 735b 315d 290d 0a0d   - new_xs[1])...
-000107e0: 0a20 2020 2020 2020 2023 2063 7265 6174  .        # creat
-000107f0: 6520 6120 6e65 7720 7261 7374 6572 0d0a  e a new raster..
-00010800: 2020 2020 2020 2020 636f 6c73 203d 2069          cols = i
-00010810: 6e74 286e 702e 726f 756e 6428 6162 7328  nt(np.round(abs(
-00010820: 6c72 7820 2d20 756c 7829 202f 2070 6978  lrx - ulx) / pix
-00010830: 656c 5f73 7061 6369 6e67 2929 0d0a 2020  el_spacing))..  
-00010840: 2020 2020 2020 726f 7773 203d 2069 6e74        rows = int
-00010850: 286e 702e 726f 756e 6428 6162 7328 756c  (np.round(abs(ul
-00010860: 7920 2d20 6c72 7929 202f 2070 6978 656c  y - lry) / pixel
-00010870: 5f73 7061 6369 6e67 2929 0d0a 0d0a 2020  _spacing))....  
-00010880: 2020 2020 2020 6474 7970 6520 3d20 7365        dtype = se
-00010890: 6c66 2e64 7479 7065 5b30 5d0d 0a20 2020  lf.dtype[0]..   
-000108a0: 2020 2020 2064 7374 203d 2044 6174 6173       dst = Datas
-000108b0: 6574 2e5f 6372 6561 7465 5f67 6461 6c5f  et._create_gdal_
-000108c0: 6461 7461 7365 7428 636f 6c73 2c20 726f  dataset(cols, ro
-000108d0: 7773 2c20 7365 6c66 2e62 616e 645f 636f  ws, self.band_co
-000108e0: 756e 742c 2064 7479 7065 290d 0a0d 0a20  unt, dtype).... 
-000108f0: 2020 2020 2020 2023 206e 6577 2067 656f         # new geo
-00010900: 7472 616e 7366 6f72 6d0d 0a20 2020 2020  transform..     
-00010910: 2020 206e 6577 5f67 656f 203d 2028 0d0a     new_geo = (..
-00010920: 2020 2020 2020 2020 2020 2020 756c 782c              ulx,
-00010930: 0d0a 2020 2020 2020 2020 2020 2020 7069  ..            pi
-00010940: 7865 6c5f 7370 6163 696e 672c 0d0a 2020  xel_spacing,..  
-00010950: 2020 2020 2020 2020 2020 7372 635f 6774            src_gt
-00010960: 5b32 5d2c 0d0a 2020 2020 2020 2020 2020  [2],..          
-00010970: 2020 756c 792c 0d0a 2020 2020 2020 2020    uly,..        
-00010980: 2020 2020 7372 635f 6774 5b34 5d2c 0d0a      src_gt[4],..
-00010990: 2020 2020 2020 2020 2020 2020 6e70 2e73              np.s
-000109a0: 6967 6e28 7372 635f 6774 5b2d 315d 2920  ign(src_gt[-1]) 
-000109b0: 2a20 7069 7865 6c5f 7370 6163 696e 672c  * pixel_spacing,
-000109c0: 0d0a 2020 2020 2020 2020 290d 0a20 2020  ..        )..   
-000109d0: 2020 2020 2023 2073 6574 2074 6865 2067       # set the g
-000109e0: 656f 7472 616e 7366 6f72 6d0d 0a20 2020  eotransform..   
-000109f0: 2020 2020 2064 7374 2e53 6574 4765 6f54       dst.SetGeoT
-00010a00: 7261 6e73 666f 726d 286e 6577 5f67 656f  ransform(new_geo
-00010a10: 290d 0a20 2020 2020 2020 2023 2073 6574  )..        # set
-00010a20: 2074 6865 2070 726f 6a65 6374 696f 6e0d   the projection.
-00010a30: 0a20 2020 2020 2020 2064 7374 2e53 6574  .        dst.Set
-00010a40: 5072 6f6a 6563 7469 6f6e 2864 7374 5f73  Projection(dst_s
-00010a50: 722e 4578 706f 7274 546f 576b 7428 2929  r.ExportToWkt())
-00010a60: 0d0a 2020 2020 2020 2020 2320 7365 7420  ..        # set 
-00010a70: 7468 6520 6e6f 2064 6174 6120 7661 6c75  the no data valu
-00010a80: 650d 0a20 2020 2020 2020 2064 7374 5f6f  e..        dst_o
-00010a90: 626a 203d 2044 6174 6173 6574 2864 7374  bj = Dataset(dst
-00010aa0: 290d 0a20 2020 2020 2020 2064 7374 5f6f  )..        dst_o
-00010ab0: 626a 2e5f 7365 745f 6e6f 5f64 6174 615f  bj._set_no_data_
-00010ac0: 7661 6c75 6528 7365 6c66 2e6e 6f5f 6461  value(self.no_da
-00010ad0: 7461 5f76 616c 7565 290d 0a20 2020 2020  ta_value)..     
-00010ae0: 2020 2023 2070 6572 666f 726d 2074 6865     # perform the
-00010af0: 2070 726f 6a65 6374 696f 6e20 2620 7265   projection & re
-00010b00: 7361 6d70 6c69 6e67 0d0a 2020 2020 2020  sampling..      
-00010b10: 2020 6764 616c 2e52 6570 726f 6a65 6374    gdal.Reproject
-00010b20: 496d 6167 6528 0d0a 2020 2020 2020 2020  Image(..        
-00010b30: 2020 2020 7365 6c66 2e72 6173 7465 722c      self.raster,
-00010b40: 0d0a 2020 2020 2020 2020 2020 2020 6473  ..            ds
-00010b50: 745f 6f62 6a2e 7261 7374 6572 2c0d 0a20  t_obj.raster,.. 
-00010b60: 2020 2020 2020 2020 2020 2073 7263 5f73             src_s
-00010b70: 722e 4578 706f 7274 546f 576b 7428 292c  r.ExportToWkt(),
-00010b80: 0d0a 2020 2020 2020 2020 2020 2020 6473  ..            ds
-00010b90: 745f 7372 2e45 7870 6f72 7454 6f57 6b74  t_sr.ExportToWkt
-00010ba0: 2829 2c0d 0a20 2020 2020 2020 2020 2020  (),..           
-00010bb0: 206d 6574 686f 642c 0d0a 2020 2020 2020   method,..      
-00010bc0: 2020 290d 0a20 2020 2020 2020 2072 6574    )..        ret
-00010bd0: 7572 6e20 6473 745f 6f62 6a0d 0a0d 0a20  urn dst_obj.... 
-00010be0: 2020 2064 6566 2066 696c 6c5f 6761 7073     def fill_gaps
-00010bf0: 2873 656c 662c 206d 6173 6b2c 2073 7263  (self, mask, src
-00010c00: 5f61 7272 6179 293a 0d0a 2020 2020 2020  _array):..      
-00010c10: 2020 2222 2266 696c 6c5f 6761 7073 2e0d    """fill_gaps..
-00010c20: 0a0d 0a20 2020 2020 2020 2050 6172 616d  ...        Param
-00010c30: 6574 6572 730d 0a20 2020 2020 2020 202d  eters..        -
-00010c40: 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020  ---------..     
-00010c50: 2020 206d 6173 6b3a 205b 6e70 2e6e 6461     mask: [np.nda
-00010c60: 7272 6179 5d0d 0a20 2020 2020 2020 2073  rray]..        s
-00010c70: 7263 5f61 7272 6179 3a20 5b6e 702e 6e64  rc_array: [np.nd
-00010c80: 6172 7261 795d 0d0a 0d0a 2020 2020 2020  array]....      
-00010c90: 2020 5265 7475 726e 730d 0a20 2020 2020    Returns..     
-00010ca0: 2020 202d 2d2d 2d2d 2d2d 0d0a 2020 2020     -------..    
-00010cb0: 2020 2020 6e70 2e6e 6461 7272 6179 0d0a      np.ndarray..
-00010cc0: 2020 2020 2020 2020 2222 220d 0a20 2020          """..   
-00010cd0: 2020 2020 2023 2061 6c69 676e 2066 756e       # align fun
-00010ce0: 6374 696f 6e20 6f6e 6c79 2065 7175 6174  ction only equat
-00010cf0: 6520 7468 6520 6e6f 206f 6620 726f 7773  e the no of rows
-00010d00: 2061 6e64 2063 6f6c 756d 6e73 206f 6e6c   and columns onl
-00010d10: 790d 0a20 2020 2020 2020 2023 206d 6174  y..        # mat
-00010d20: 6368 206e 6f64 6174 6176 616c 7565 2069  ch nodatavalue i
-00010d30: 6e73 6572 7473 206e 6f64 6174 6176 616c  nserts nodataval
-00010d40: 7565 2069 6e20 7372 6320 7261 7374 6572  ue in src raster
-00010d50: 2074 6f20 616c 6c20 706c 6163 6573 206c   to all places l
-00010d60: 696b 6520 6d61 736b 0d0a 2020 2020 2020  ike mask..      
-00010d70: 2020 2320 7374 696c 6c20 706c 6163 6573    # still places
-00010d80: 2074 6861 7420 6861 7320 6e6f 6461 7461   that has nodata
-00010d90: 7661 6c75 6520 696e 2074 6865 2073 7263  value in the src
-00010da0: 2072 6173 7465 7220 6275 7420 6974 2069   raster but it i
-00010db0: 7320 6e6f 7420 6e6f 6461 7461 7661 6c75  s not nodatavalu
-00010dc0: 6520 696e 2074 6865 206d 6173 6b0d 0a20  e in the mask.. 
-00010dd0: 2020 2020 2020 2023 2061 6e64 206e 6f77         # and now
-00010de0: 2068 6173 2074 6f20 6265 2066 696c 6c65   has to be fille
-00010df0: 6420 7769 7468 2076 616c 7565 730d 0a20  d with values.. 
-00010e00: 2020 2020 2020 2023 2063 6f6d 7061 7265         # compare
-00010e10: 206e 6f20 6f66 2065 6c65 6d65 6e74 2074   no of element t
-00010e20: 6861 7420 6973 206e 6f74 206e 6f64 6174  hat is not nodat
-00010e30: 6176 616c 7565 2069 6e20 626f 7468 2072  avalue in both r
-00010e40: 6173 7465 7273 2074 6f20 6d61 6b65 2073  asters to make s
-00010e50: 7572 6520 7468 6579 2061 7265 206d 6174  ure they are mat
-00010e60: 6368 6564 0d0a 2020 2020 2020 2020 2320  ched..        # 
-00010e70: 6966 2062 6f74 6820 696e 7075 7473 2061  if both inputs a
-00010e80: 7265 2072 6173 7465 7273 0d0a 2020 2020  re rasters..    
-00010e90: 2020 2020 6d61 736b 5f61 7272 6179 203d      mask_array =
-00010ea0: 206d 6173 6b2e 7265 6164 5f61 7272 6179   mask.read_array
-00010eb0: 2829 0d0a 2020 2020 2020 2020 726f 7720  ()..        row 
-00010ec0: 3d20 6d61 736b 2e72 6f77 730d 0a20 2020  = mask.rows..   
-00010ed0: 2020 2020 2063 6f6c 203d 206d 6173 6b2e       col = mask.
-00010ee0: 636f 6c75 6d6e 730d 0a20 2020 2020 2020  columns..       
-00010ef0: 206d 6173 6b5f 6e6f 7661 6c20 3d20 6d61   mask_noval = ma
-00010f00: 736b 2e6e 6f5f 6461 7461 5f76 616c 7565  sk.no_data_value
-00010f10: 5b30 5d0d 0a0d 0a20 2020 2020 2020 2069  [0]....        i
-00010f20: 6620 6973 696e 7374 616e 6365 286d 6173  f isinstance(mas
-00010f30: 6b2c 2044 6174 6173 6574 2920 616e 6420  k, Dataset) and 
-00010f40: 6973 696e 7374 616e 6365 2873 656c 662c  isinstance(self,
-00010f50: 2044 6174 6173 6574 293a 0d0a 2020 2020   Dataset):..    
-00010f60: 2020 2020 2020 2020 2320 7468 6572 6520          # there 
-00010f70: 6d69 6768 7420 6265 2063 656c 6c73 2074  might be cells t
-00010f80: 6861 7420 6172 6520 6f75 7420 6f66 2064  hat are out of d
-00010f90: 6f6d 6169 6e20 696e 2074 6865 2073 7263  omain in the src
-00010fa0: 2062 7574 206e 6f74 206f 7574 206f 6620   but not out of 
-00010fb0: 646f 6d61 696e 2069 6e20 7468 6520 6d61  domain in the ma
-00010fc0: 736b 0d0a 2020 2020 2020 2020 2020 2020  sk..            
-00010fd0: 2320 736f 2063 6861 6e67 6520 616c 6c20  # so change all 
-00010fe0: 7468 6520 7372 635f 6e6f 7661 6c20 746f  the src_noval to
-00010ff0: 206d 6173 6b5f 6e6f 7661 6c20 696e 2074   mask_noval in t
-00011000: 6865 2073 7263 5f61 7272 6179 0d0a 2020  he src_array..  
-00011010: 2020 2020 2020 2020 2020 2320 7372 635f            # src_
-00011020: 6172 7261 795b 6e70 2e69 7363 6c6f 7365  array[np.isclose
-00011030: 2873 7263 5f61 7272 6179 2c20 7365 6c66  (src_array, self
-00011040: 2e6e 6f5f 6461 7461 5f76 616c 7565 5b30  .no_data_value[0
-00011050: 5d2c 2072 746f 6c3d 302e 3030 3129 5d20  ], rtol=0.001)] 
-00011060: 3d20 6d61 736b 5f6e 6f76 616c 0d0a 2020  = mask_noval..  
-00011070: 2020 2020 2020 2020 2020 2320 7468 656e            # then
-00011080: 2063 6f75 6e74 2074 6865 6d20 286f 7574   count them (out
-00011090: 206f 6620 646f 6d61 696e 2063 656c 6c73   of domain cells
-000110a0: 2920 696e 2074 6865 2073 7263 5f61 7272  ) in the src_arr
-000110b0: 6179 0d0a 2020 2020 2020 2020 2020 2020  ay..            
-000110c0: 656c 656d 5f73 7263 203d 2073 7263 5f61  elem_src = src_a
-000110d0: 7272 6179 2e73 697a 6520 2d20 6e70 2e63  rray.size - np.c
-000110e0: 6f75 6e74 5f6e 6f6e 7a65 726f 280d 0a20  ount_nonzero(.. 
-000110f0: 2020 2020 2020 2020 2020 2020 2020 2028                 (
-00011100: 7372 635f 6172 7261 795b 6e70 2e69 7363  src_array[np.isc
-00011110: 6c6f 7365 2873 7263 5f61 7272 6179 2c20  lose(src_array, 
-00011120: 7365 6c66 2e6e 6f5f 6461 7461 5f76 616c  self.no_data_val
-00011130: 7565 5b30 5d2c 2072 746f 6c3d 302e 3030  ue[0], rtol=0.00
-00011140: 3129 5d29 0d0a 2020 2020 2020 2020 2020  1)])..          
-00011150: 2020 290d 0a20 2020 2020 2020 2020 2020    )..           
-00011160: 2023 2063 6f75 6e74 2074 6865 206f 7574   # count the out
-00011170: 206f 6620 646f 6d69 616e 2063 656c 6c73   of domian cells
-00011180: 2069 6e20 7468 6520 6d61 736b 0d0a 2020   in the mask..  
-00011190: 2020 2020 2020 2020 2020 656c 656d 5f6d            elem_m
-000111a0: 6173 6b20 3d20 6d61 736b 5f61 7272 6179  ask = mask_array
-000111b0: 2e73 697a 6520 2d20 6e70 2e63 6f75 6e74  .size - np.count
-000111c0: 5f6e 6f6e 7a65 726f 280d 0a20 2020 2020  _nonzero(..     
-000111d0: 2020 2020 2020 2020 2020 2028 6d61 736b             (mask
-000111e0: 5f61 7272 6179 5b6e 702e 6973 636c 6f73  _array[np.isclos
-000111f0: 6528 6d61 736b 5f61 7272 6179 2c20 6d61  e(mask_array, ma
-00011200: 736b 5f6e 6f76 616c 2c20 7274 6f6c 3d30  sk_noval, rtol=0
-00011210: 2e30 3031 295d 290d 0a20 2020 2020 2020  .001)])..       
-00011220: 2020 2020 2029 0d0a 0d0a 2020 2020 2020       )....      
-00011230: 2020 2020 2020 2320 6966 206e 6f74 2065        # if not e
-00011240: 7175 616c 2074 6865 6e20 7374 6f72 6520  qual then store 
-00011250: 696e 6469 6365 7320 6f66 2074 686f 7365  indices of those
-00011260: 2063 656c 6c73 2074 6861 7420 646f 6573   cells that does
-00011270: 6e27 7420 6d61 7463 6873 0d0a 2020 2020  n't matchs..    
-00011280: 2020 2020 2020 2020 6966 2065 6c65 6d5f          if elem_
-00011290: 6d61 736b 203e 2065 6c65 6d5f 7372 633a  mask > elem_src:
-000112a0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000112b0: 2020 726f 7773 203d 205b 0d0a 2020 2020    rows = [..    
-000112c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000112d0: 690d 0a20 2020 2020 2020 2020 2020 2020  i..             
-000112e0: 2020 2020 2020 2066 6f72 2069 2069 6e20         for i in 
-000112f0: 7261 6e67 6528 726f 7729 0d0a 2020 2020  range(row)..    
-00011300: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011310: 666f 7220 6a20 696e 2072 616e 6765 2863  for j in range(c
-00011320: 6f6c 290d 0a20 2020 2020 2020 2020 2020  ol)..           
-00011330: 2020 2020 2020 2020 2069 6620 6e70 2e69           if np.i
-00011340: 7363 6c6f 7365 2873 7263 5f61 7272 6179  sclose(src_array
-00011350: 5b69 2c20 6a5d 2c20 7365 6c66 2e6e 6f5f  [i, j], self.no_
-00011360: 6461 7461 5f76 616c 7565 5b30 5d2c 2072  data_value[0], r
-00011370: 746f 6c3d 302e 3030 3129 0d0a 2020 2020  tol=0.001)..    
-00011380: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00011390: 616e 6420 6e6f 7420 6e70 2e69 7363 6c6f  and not np.isclo
-000113a0: 7365 286d 6173 6b5f 6172 7261 795b 692c  se(mask_array[i,
-000113b0: 206a 5d2c 206d 6173 6b5f 6e6f 7661 6c2c   j], mask_noval,
-000113c0: 2072 746f 6c3d 302e 3030 3129 0d0a 2020   rtol=0.001)..  
-000113d0: 2020 2020 2020 2020 2020 2020 2020 5d0d                ].
-000113e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000113f0: 2063 6f6c 7320 3d20 5b0d 0a20 2020 2020   cols = [..     
-00011400: 2020 2020 2020 2020 2020 2020 2020 206a                 j
-00011410: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00011420: 2020 2020 2020 666f 7220 6920 696e 2072        for i in r
-00011430: 616e 6765 2872 6f77 290d 0a20 2020 2020  ange(row)..     
-00011440: 2020 2020 2020 2020 2020 2020 2020 2066                 f
-00011450: 6f72 206a 2069 6e20 7261 6e67 6528 636f  or j in range(co
-00011460: 6c29 0d0a 2020 2020 2020 2020 2020 2020  l)..            
-00011470: 2020 2020 2020 2020 6966 206e 702e 6973          if np.is
-00011480: 636c 6f73 6528 7372 635f 6172 7261 795b  close(src_array[
-00011490: 692c 206a 5d2c 2073 656c 662e 6e6f 5f64  i, j], self.no_d
-000114a0: 6174 615f 7661 6c75 655b 305d 2c20 7274  ata_value[0], rt
-000114b0: 6f6c 3d30 2e30 3031 290d 0a20 2020 2020  ol=0.001)..     
-000114c0: 2020 2020 2020 2020 2020 2020 2020 2061                 a
-000114d0: 6e64 206e 6f74 206e 702e 6973 636c 6f73  nd not np.isclos
-000114e0: 6528 6d61 736b 5f61 7272 6179 5b69 2c20  e(mask_array[i, 
-000114f0: 6a5d 2c20 6d61 736b 5f6e 6f76 616c 2c20  j], mask_noval, 
-00011500: 7274 6f6c 3d30 2e30 3031 290d 0a20 2020  rtol=0.001)..   
-00011510: 2020 2020 2020 2020 2020 2020 205d 0d0a               ]..
-00011520: 2020 2020 2020 2020 2020 2020 2320 696e              # in
-00011530: 7465 7270 6f6c 6174 6520 7468 6f73 6520  terpolate those 
-00011540: 6d69 7373 696e 6720 6365 6c6c 7320 6279  missing cells by
-00011550: 206e 6561 7265 7374 206e 6569 6768 626f   nearest neighbo
-00011560: 7572 0d0a 2020 2020 2020 2020 2020 2020  ur..            
-00011570: 6966 2065 6c65 6d5f 6d61 736b 203e 2065  if elem_mask > e
-00011580: 6c65 6d5f 7372 633a 0d0a 2020 2020 2020  lem_src:..      
-00011590: 2020 2020 2020 2020 2020 7372 635f 6172            src_ar
-000115a0: 7261 7920 3d20 4461 7461 7365 742e 5f6e  ray = Dataset._n
-000115b0: 6561 7265 7374 5f6e 6569 6768 626f 7572  earest_neighbour
-000115c0: 280d 0a20 2020 2020 2020 2020 2020 2020  (..             
-000115d0: 2020 2020 2020 2073 7263 5f61 7272 6179         src_array
-000115e0: 2c20 7365 6c66 2e6e 6f5f 6461 7461 5f76  , self.no_data_v
-000115f0: 616c 7565 5b30 5d2c 2072 6f77 732c 2063  alue[0], rows, c
-00011600: 6f6c 730d 0a20 2020 2020 2020 2020 2020  ols..           
-00011610: 2020 2020 2029 0d0a 2020 2020 2020 2020       )..        
-00011620: 2020 2020 7265 7475 726e 2073 7263 5f61      return src_a
-00011630: 7272 6179 0d0a 0d0a 2020 2020 6465 6620  rray....    def 
-00011640: 5f63 726f 705f 616c 6c69 676e 6564 280d  _crop_alligned(.
-00011650: 0a20 2020 2020 2020 2073 656c 662c 0d0a  .        self,..
-00011660: 2020 2020 2020 2020 6d61 736b 3a20 556e          mask: Un
-00011670: 696f 6e5b 6764 616c 2e44 6174 6173 6574  ion[gdal.Dataset
-00011680: 2c20 6e70 2e6e 6461 7272 6179 5d2c 0d0a  , np.ndarray],..
-00011690: 2020 2020 2020 2020 6d61 736b 5f6e 6f76          mask_nov
-000116a0: 616c 3a20 556e 696f 6e5b 696e 742c 2066  al: Union[int, f
-000116b0: 6c6f 6174 5d20 3d20 4e6f 6e65 2c0d 0a20  loat] = None,.. 
-000116c0: 2020 2020 2020 2066 696c 6c5f 6761 7073         fill_gaps
-000116d0: 3a20 626f 6f6c 203d 2046 616c 7365 2c0d  : bool = False,.
-000116e0: 0a20 2020 2029 202d 3e20 556e 696f 6e5b  .    ) -> Union[
-000116f0: 6e70 2e6e 6461 7272 6179 2c20 6764 616c  np.ndarray, gdal
-00011700: 2e44 6174 6173 6574 5d3a 0d0a 2020 2020  .Dataset]:..    
-00011710: 2020 2020 2222 2263 726f 7041 6c6c 6967      """cropAllig
-00011720: 6e65 642e 0d0a 0d0a 2020 2020 2020 2020  ned.....        
-00011730: 6372 6f70 416c 6c69 676e 6564 2063 6c69  cropAlligned cli
-00011740: 702f 6372 6f70 2028 6d61 7463 6865 7320  p/crop (matches 
-00011750: 7468 6520 6c6f 6361 7469 6f6e 206f 6620  the location of 
-00011760: 6e6f 6461 7461 2076 616c 7565 2066 726f  nodata value fro
-00011770: 6d20 6d61 736b 2074 6f20 7372 630d 0a20  m mask to src.. 
-00011780: 2020 2020 2020 2072 6173 7465 7229 2c0d         raster),.
-00011790: 0a20 2020 2020 2020 2020 2020 202d 2042  .            - B
-000117a0: 6f74 6820 7261 7374 6572 7320 6861 7665  oth rasters have
-000117b0: 2074 6f20 6861 7665 2074 6865 2073 616d   to have the sam
-000117c0: 6520 6469 6d65 6e73 696f 6e73 2028 6e6f  e dimensions (no
-000117d0: 206f 6620 726f 7773 2026 2063 6f6c 756d   of rows & colum
-000117e0: 6e73 290d 0a20 2020 2020 2020 2020 2020  ns)..           
-000117f0: 2073 6f20 4d61 7463 6852 6173 7465 7241   so MatchRasterA
-00011800: 6c69 676e 6d65 6e74 2073 686f 756c 6420  lignment should 
-00011810: 6265 2075 7365 6420 7072 696f 7220 746f  be used prior to
-00011820: 2074 6869 7320 6675 6e63 7469 6f6e 2074   this function t
-00011830: 6f20 616c 6967 6e20 626f 7468 0d0a 2020  o align both..  
-00011840: 2020 2020 2020 2020 2020 7261 7374 6572            raster
-00011850: 730d 0a0d 0a20 2020 2020 2020 2050 6172  s....        Par
-00011860: 616d 6574 6572 730d 0a20 2020 2020 2020  ameters..       
-00011870: 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020   ----------..   
-00011880: 2020 2020 206d 6173 6b3a 205b 4461 7461       mask: [Data
-00011890: 7365 742f 6e70 2e6e 6461 7272 6179 5d0d  set/np.ndarray].
-000118a0: 0a20 2020 2020 2020 2020 2020 206d 6173  .            mas
-000118b0: 6b20 7261 7374 6572 2074 6f20 6765 7420  k raster to get 
-000118c0: 7468 6520 6c6f 6361 7469 6f6e 206f 6620  the location of 
-000118d0: 7468 6520 4e6f 4461 7461 5661 6c75 6520  the NoDataValue 
-000118e0: 616e 640d 0a20 2020 2020 2020 2020 2020  and..           
-000118f0: 2077 6865 7265 2069 7420 6973 2069 6e20   where it is in 
-00011900: 7468 6520 6172 7261 790d 0a20 2020 2020  the array..     
-00011910: 2020 206d 6173 6b5f 6e6f 7661 6c3a 205b     mask_noval: [
-00011920: 6e75 6d65 7269 635d 0d0a 2020 2020 2020  numeric]..      
-00011930: 2020 2020 2020 696e 2063 6173 6520 7468        in case th
-00011940: 6520 6d61 736b 2069 7320 6e70 2e6e 6461  e mask is np.nda
-00011950: 7272 6179 2c20 7468 6520 6d61 736b 5f6e  rray, the mask_n
-00011960: 6f76 616c 2068 6176 6520 746f 2062 6520  oval have to be 
-00011970: 6769 7665 6e2e 0d0a 2020 2020 2020 2020  given...        
-00011980: 6669 6c6c 5f67 6170 733a 205b 626f 6f6c  fill_gaps: [bool
-00011990: 5d0d 0a20 2020 2020 2020 2020 2020 2044  ]..            D
-000119a0: 6566 6175 6c74 2069 7320 4661 6c73 652e  efault is False.
-000119b0: 0d0a 0d0a 2020 2020 2020 2020 5265 7475  ....        Retu
-000119c0: 726e 730d 0a20 2020 2020 2020 202d 2d2d  rns..        ---
-000119d0: 2d2d 2d2d 0d0a 2020 2020 2020 2020 6473  ----..        ds
-000119e0: 743a 205b 6764 616c 2e64 6174 6173 6574  t: [gdal.dataset
-000119f0: 5d0d 0a20 2020 2020 2020 2020 2020 2074  ]..            t
-00011a00: 6865 2073 6563 6f6e 6420 7261 7374 6572  he second raster
-00011a10: 2077 6974 6820 4e6f 4461 7461 5661 6c75   with NoDataValu
-00011a20: 6520 7374 6f72 6564 2069 6e20 6974 7320  e stored in its 
-00011a30: 6365 6c6c 730d 0a20 2020 2020 2020 2020  cells..         
-00011a40: 2020 2065 7861 6374 6c79 2074 6865 2073     exactly the s
-00011a50: 616d 6520 6c69 6b65 2073 7263 2072 6173  ame like src ras
-00011a60: 7465 720d 0a20 2020 2020 2020 2022 2222  ter..        """
-00011a70: 0d0a 2020 2020 2020 2020 6966 2069 7369  ..        if isi
-00011a80: 6e73 7461 6e63 6528 6d61 736b 2c20 4461  nstance(mask, Da
-00011a90: 7461 7365 7429 3a0d 0a20 2020 2020 2020  taset):..       
-00011aa0: 2020 2020 206d 6173 6b5f 6774 203d 206d       mask_gt = m
-00011ab0: 6173 6b2e 6765 6f74 7261 6e73 666f 726d  ask.geotransform
-00011ac0: 0d0a 2020 2020 2020 2020 2020 2020 6d61  ..            ma
-00011ad0: 736b 5f65 7073 6720 3d20 6d61 736b 2e65  sk_epsg = mask.e
-00011ae0: 7073 670d 0a20 2020 2020 2020 2020 2020  psg..           
-00011af0: 2072 6f77 203d 206d 6173 6b2e 726f 7773   row = mask.rows
-00011b00: 0d0a 2020 2020 2020 2020 2020 2020 636f  ..            co
-00011b10: 6c20 3d20 6d61 736b 2e63 6f6c 756d 6e73  l = mask.columns
-00011b20: 0d0a 2020 2020 2020 2020 2020 2020 6d61  ..            ma
-00011b30: 736b 5f6e 6f76 616c 203d 206d 6173 6b2e  sk_noval = mask.
-00011b40: 6e6f 5f64 6174 615f 7661 6c75 655b 305d  no_data_value[0]
-00011b50: 0d0a 2020 2020 2020 2020 2020 2020 6d61  ..            ma
-00011b60: 736b 5f61 7272 6179 203d 206d 6173 6b2e  sk_array = mask.
-00011b70: 7265 6164 5f61 7272 6179 2829 0d0a 2020  read_array()..  
-00011b80: 2020 2020 2020 656c 6966 2069 7369 6e73        elif isins
-00011b90: 7461 6e63 6528 6d61 736b 2c20 6e70 2e6e  tance(mask, np.n
-00011ba0: 6461 7272 6179 293a 0d0a 2020 2020 2020  darray):..      
-00011bb0: 2020 2020 2020 6966 206d 6173 6b5f 6e6f        if mask_no
-00011bc0: 7661 6c20 6973 204e 6f6e 653a 0d0a 2020  val is None:..  
-00011bd0: 2020 2020 2020 2020 2020 2020 2020 7261                ra
-00011be0: 6973 6520 5661 6c75 6545 7272 6f72 280d  ise ValueError(.
-00011bf0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00011c00: 2020 2020 2022 596f 7520 6861 7665 2074       "You have t
-00011c10: 6f20 656e 7465 7220 7468 6520 7661 6c75  o enter the valu
-00011c20: 6520 6f66 2074 6865 206e 6f5f 7661 6c20  e of the no_val 
-00011c30: 7061 7261 6d65 7465 7220 7768 656e 2074  parameter when t
-00011c40: 6865 206d 6173 6b20 6973 2061 206e 756d  he mask is a num
-00011c50: 7079 2061 7272 6179 220d 0a20 2020 2020  py array"..     
-00011c60: 2020 2020 2020 2020 2020 2029 0d0a 2020             )..  
-00011c70: 2020 2020 2020 2020 2020 6d61 736b 5f61            mask_a
-00011c80: 7272 6179 203d 206d 6173 6b2e 636f 7079  rray = mask.copy
-00011c90: 2829 0d0a 2020 2020 2020 2020 2020 2020  ()..            
-00011ca0: 726f 772c 2063 6f6c 203d 206d 6173 6b2e  row, col = mask.
-00011cb0: 7368 6170 650d 0a20 2020 2020 2020 2065  shape..        e
-00011cc0: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
-00011cd0: 2020 7261 6973 6520 5479 7065 4572 726f    raise TypeErro
-00011ce0: 7228 0d0a 2020 2020 2020 2020 2020 2020  r(..            
-00011cf0: 2020 2020 2254 6865 2073 6563 6f6e 6420      "The second 
-00011d00: 7061 7261 6d65 7465 7220 276d 6173 6b27  parameter 'mask'
-00011d10: 2068 6173 2074 6f20 6265 2065 6974 6865   has to be eithe
-00011d20: 7220 6764 616c 2e44 6174 6163 7562 6520  r gdal.Datacube 
-00011d30: 6f72 206e 756d 7079 2061 7272 6179 220d  or numpy array".
-00011d40: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00011d50: 2066 2267 6976 656e 202d 207b 7479 7065   f"given - {type
-00011d60: 286d 6173 6b29 7d22 0d0a 2020 2020 2020  (mask)}"..      
-00011d70: 2020 2020 2020 290d 0a0d 0a20 2020 2020        )....     
-00011d80: 2020 2062 616e 645f 636f 756e 7420 3d20     band_count = 
-00011d90: 7365 6c66 2e62 616e 645f 636f 756e 740d  self.band_count.
-00011da0: 0a20 2020 2020 2020 2073 7263 5f73 7265  .        src_sre
-00011db0: 6620 3d20 6f73 722e 5370 6174 6961 6c52  f = osr.SpatialR
-00011dc0: 6566 6572 656e 6365 2877 6b74 3d73 656c  eference(wkt=sel
-00011dd0: 662e 6372 7329 0d0a 2020 2020 2020 2020  f.crs)..        
-00011de0: 7372 635f 6172 7261 7920 3d20 7365 6c66  src_array = self
-00011df0: 2e72 6561 645f 6172 7261 7928 290d 0a0d  .read_array()...
-00011e00: 0a20 2020 2020 2020 2069 6620 6e6f 7420  .        if not 
-00011e10: 726f 7720 3d3d 2073 656c 662e 726f 7773  row == self.rows
-00011e20: 206f 7220 6e6f 7420 636f 6c20 3d3d 2073   or not col == s
-00011e30: 656c 662e 636f 6c75 6d6e 733a 0d0a 2020  elf.columns:..  
-00011e40: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-00011e50: 5661 6c75 6545 7272 6f72 280d 0a20 2020  ValueError(..   
-00011e60: 2020 2020 2020 2020 2020 2020 2022 5477               "Tw
-00011e70: 6f20 7261 7374 6572 7320 6861 7320 6469  o rasters has di
-00011e80: 6666 6572 656e 7420 6e75 6d62 6572 206f  fferent number o
-00011e90: 6620 636f 6c75 6d6e 7320 6f72 2072 6f77  f columns or row
-00011ea0: 7320 706c 6561 7365 2072 6573 616d 706c  s please resampl
-00011eb0: 6520 6f72 206d 6174 6368 2062 6f74 6820  e or match both 
-00011ec0: 7261 7374 6572 7322 0d0a 2020 2020 2020  rasters"..      
-00011ed0: 2020 2020 2020 290d 0a0d 0a20 2020 2020        )....     
-00011ee0: 2020 2069 6620 6973 696e 7374 616e 6365     if isinstance
-00011ef0: 286d 6173 6b2c 2044 6174 6173 6574 293a  (mask, Dataset):
-00011f00: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
-00011f10: 2028 0d0a 2020 2020 2020 2020 2020 2020   (..            
-00011f20: 2020 2020 6e6f 7420 7365 6c66 2e70 6976      not self.piv
-00011f30: 6f74 5f70 6f69 6e74 203d 3d20 6d61 736b  ot_point == mask
-00011f40: 2e70 6976 6f74 5f70 6f69 6e74 0d0a 2020  .pivot_point..  
-00011f50: 2020 2020 2020 2020 2020 2020 2020 6f72                or
-00011f60: 206e 6f74 2073 656c 662e 6365 6c6c 5f73   not self.cell_s
-00011f70: 697a 6520 3d3d 206d 6173 6b2e 6365 6c6c  ize == mask.cell
-00011f80: 5f73 697a 650d 0a20 2020 2020 2020 2020  _size..         
-00011f90: 2020 2029 3a0d 0a20 2020 2020 2020 2020     ):..         
-00011fa0: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
-00011fb0: 7565 4572 726f 7228 0d0a 2020 2020 2020  ueError(..      
-00011fc0: 2020 2020 2020 2020 2020 2020 2020 226c                "l
-00011fd0: 6f63 6174 696f 6e20 6f66 2075 7070 6572  ocation of upper
-00011fe0: 206c 6566 7420 636f 726e 6572 206f 6620   left corner of 
-00011ff0: 626f 7468 2072 6173 7465 7273 2061 7265  both rasters are
-00012000: 206e 6f74 2074 6865 2073 616d 6520 6f72   not the same or
-00012010: 2063 656c 6c20 7369 7a65 2069 7320 220d   cell size is ".
-00012020: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00012030: 2020 2020 2022 6469 6666 6572 656e 7420       "different 
-00012040: 706c 6561 7365 206d 6174 6368 2062 6f74  please match bot
-00012050: 6820 7261 7374 6572 7320 6669 7273 7420  h rasters first 
-00012060: 220d 0a20 2020 2020 2020 2020 2020 2020  "..             
-00012070: 2020 2029 0d0a 0d0a 2020 2020 2020 2020     )....        
-00012080: 2020 2020 6966 206e 6f74 206d 6173 6b5f      if not mask_
-00012090: 6570 7367 203d 3d20 7365 6c66 2e65 7073  epsg == self.eps
-000120a0: 673a 0d0a 2020 2020 2020 2020 2020 2020  g:..            
-000120b0: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
-000120c0: 7272 6f72 280d 0a20 2020 2020 2020 2020  rror(..         
-000120d0: 2020 2020 2020 2020 2020 2022 4461 7461             "Data
-000120e0: 7365 7420 4120 2620 4220 6172 6520 7573  set A & B are us
-000120f0: 696e 6720 6469 6666 6572 656e 7420 636f  ing different co
-00012100: 6f72 6469 6e61 7465 2073 7973 7465 6d20  ordinate system 
-00012110: 706c 6561 7365 2072 6570 726f 6a65 6374  please reproject
-00012120: 206f 6e65 206f 6620 7468 656d 2074 6f20   one of them to 
-00012130: 220d 0a20 2020 2020 2020 2020 2020 2020  "..             
-00012140: 2020 2020 2020 2022 7468 6520 6f74 6865         "the othe
-00012150: 7220 7261 7374 6572 2063 6f6f 7264 696e  r raster coordin
-00012160: 6174 6520 7379 7374 656d 220d 0a20 2020  ate system"..   
-00012170: 2020 2020 2020 2020 2020 2020 2029 0d0a               )..
-00012180: 0d0a 2020 2020 2020 2020 6966 2062 616e  ..        if ban
-00012190: 645f 636f 756e 7420 3e20 313a 0d0a 2020  d_count > 1:..  
-000121a0: 2020 2020 2020 2020 2020 666f 7220 6261            for ba
-000121b0: 6e64 2069 6e20 7261 6e67 6528 7365 6c66  nd in range(self
-000121c0: 2e62 616e 645f 636f 756e 7429 3a0d 0a20  .band_count):.. 
-000121d0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-000121e0: 6620 6d61 736b 5f6e 6f76 616c 2069 7320  f mask_noval is 
-000121f0: 4e6f 6e65 3a0d 0a20 2020 2020 2020 2020  None:..         
-00012200: 2020 2020 2020 2020 2020 2073 7263 5f61             src_a
-00012210: 7272 6179 5b62 616e 642c 206e 702e 6973  rray[band, np.is
-00012220: 6e61 6e28 6d61 736b 5f61 7272 6179 295d  nan(mask_array)]
-00012230: 203d 2073 656c 662e 6e6f 5f64 6174 615f   = self.no_data_
-00012240: 7661 6c75 655b 6261 6e64 5d0d 0a20 2020  value[band]..   
-00012250: 2020 2020 2020 2020 2020 2020 2065 6c73               els
-00012260: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-00012270: 2020 2020 2020 2020 7372 635f 6172 7261          src_arra
-00012280: 795b 0d0a 2020 2020 2020 2020 2020 2020  y[..            
-00012290: 2020 2020 2020 2020 2020 2020 6261 6e64              band
-000122a0: 2c20 6e70 2e69 7363 6c6f 7365 286d 6173  , np.isclose(mas
-000122b0: 6b5f 6172 7261 792c 206d 6173 6b5f 6e6f  k_array, mask_no
-000122c0: 7661 6c2c 2072 746f 6c3d 302e 3030 3129  val, rtol=0.001)
-000122d0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000122e0: 2020 2020 2020 5d20 3d20 7365 6c66 2e6e        ] = self.n
-000122f0: 6f5f 6461 7461 5f76 616c 7565 5b62 616e  o_data_value[ban
-00012300: 645d 0d0a 2020 2020 2020 2020 656c 7365  d]..        else
-00012310: 3a0d 0a20 2020 2020 2020 2020 2020 2069  :..            i
-00012320: 6620 6d61 736b 5f6e 6f76 616c 2069 7320  f mask_noval is 
-00012330: 4e6f 6e65 3a0d 0a20 2020 2020 2020 2020  None:..         
-00012340: 2020 2020 2020 2073 7263 5f61 7272 6179         src_array
-00012350: 5b6e 702e 6973 6e61 6e28 6d61 736b 5f61  [np.isnan(mask_a
-00012360: 7272 6179 295d 203d 2073 656c 662e 6e6f  rray)] = self.no
-00012370: 5f64 6174 615f 7661 6c75 655b 305d 0d0a  _data_value[0]..
-00012380: 2020 2020 2020 2020 2020 2020 656c 7365              else
-00012390: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-000123a0: 2020 2073 7263 5f61 7272 6179 5b0d 0a20     src_array[.. 
-000123b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000123c0: 2020 206e 702e 6973 636c 6f73 6528 6d61     np.isclose(ma
-000123d0: 736b 5f61 7272 6179 2c20 6d61 736b 5f6e  sk_array, mask_n
-000123e0: 6f76 616c 2c20 7274 6f6c 3d30 2e30 3031  oval, rtol=0.001
-000123f0: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
-00012400: 2020 205d 203d 2073 656c 662e 6e6f 5f64     ] = self.no_d
-00012410: 6174 615f 7661 6c75 655b 305d 0d0a 0d0a  ata_value[0]....
-00012420: 2020 2020 2020 2020 6966 2066 696c 6c5f          if fill_
-00012430: 6761 7073 3a0d 0a20 2020 2020 2020 2020  gaps:..         
-00012440: 2020 2073 7263 5f61 7272 6179 203d 2073     src_array = s
-00012450: 656c 662e 6669 6c6c 5f67 6170 7328 6d61  elf.fill_gaps(ma
-00012460: 736b 2c20 7372 635f 6172 7261 7929 0d0a  sk, src_array)..
-00012470: 0d0a 2020 2020 2020 2020 6473 7420 3d20  ..        dst = 
-00012480: 4461 7461 7365 742e 5f63 7265 6174 655f  Dataset._create_
-00012490: 6764 616c 5f64 6174 6173 6574 280d 0a20  gdal_dataset(.. 
-000124a0: 2020 2020 2020 2020 2020 2063 6f6c 2c20             col, 
-000124b0: 726f 772c 2062 616e 645f 636f 756e 742c  row, band_count,
-000124c0: 2073 656c 662e 6474 7970 655b 305d 2c20   self.dtype[0], 
-000124d0: 6472 6976 6572 3d22 4d45 4d22 0d0a 2020  driver="MEM"..  
-000124e0: 2020 2020 2020 290d 0a20 2020 2020 2020        )..       
-000124f0: 2023 2062 7574 2077 6974 6820 6c6f 7420   # but with lot 
-00012500: 6f66 2063 6f6d 7075 7461 7469 6f6e 0d0a  of computation..
-00012510: 2020 2020 2020 2020 2320 6966 2074 6865          # if the
-00012520: 206d 6173 6b20 6973 2061 6e20 6172 7261   mask is an arra
-00012530: 7920 616e 6420 7468 6520 6d61 736b 5f67  y and the mask_g
-00012540: 7420 6973 206e 6f74 2064 6566 696e 6564  t is not defined
-00012550: 2075 7365 2074 6865 2073 7263 5f67 7420   use the src_gt 
-00012560: 6173 2062 6f74 6820 7468 6520 6d61 736b  as both the mask
-00012570: 2061 6e64 2074 6865 2073 7263 0d0a 2020   and the src..  
-00012580: 2020 2020 2020 2320 6172 6520 616c 6967        # are alig
-00012590: 6e65 6420 736f 2074 6865 7920 6861 7665  ned so they have
-000125a0: 2074 6865 2073 616d 2067 740d 0a20 2020   the sam gt..   
-000125b0: 2020 2020 2074 7279 3a0d 0a20 2020 2020       try:..     
-000125c0: 2020 2020 2020 2023 2073 6574 2074 6865         # set the
-000125d0: 2067 656f 7472 616e 7366 6f72 6d0d 0a20   geotransform.. 
-000125e0: 2020 2020 2020 2020 2020 2064 7374 2e53             dst.S
-000125f0: 6574 4765 6f54 7261 6e73 666f 726d 286d  etGeoTransform(m
-00012600: 6173 6b5f 6774 290d 0a20 2020 2020 2020  ask_gt)..       
-00012610: 2020 2020 2023 2073 6574 2074 6865 2070       # set the p
-00012620: 726f 6a65 6374 696f 6e0d 0a20 2020 2020  rojection..     
-00012630: 2020 2020 2020 2064 7374 2e53 6574 5072         dst.SetPr
-00012640: 6f6a 6563 7469 6f6e 286d 6173 6b2e 6372  ojection(mask.cr
-00012650: 7329 0d0a 2020 2020 2020 2020 6578 6365  s)..        exce
-00012660: 7074 2055 6e62 6f75 6e64 4c6f 6361 6c45  pt UnboundLocalE
-00012670: 7272 6f72 3a0d 0a20 2020 2020 2020 2020  rror:..         
-00012680: 2020 2064 7374 2e53 6574 4765 6f54 7261     dst.SetGeoTra
-00012690: 6e73 666f 726d 2873 656c 662e 6765 6f74  nsform(self.geot
-000126a0: 7261 6e73 666f 726d 290d 0a20 2020 2020  ransform)..     
-000126b0: 2020 2020 2020 2064 7374 2e53 6574 5072         dst.SetPr
-000126c0: 6f6a 6563 7469 6f6e 2873 7263 5f73 7265  ojection(src_sre
-000126d0: 662e 4578 706f 7274 546f 576b 7428 2929  f.ExportToWkt())
-000126e0: 0d0a 0d0a 2020 2020 2020 2020 6473 745f  ....        dst_
-000126f0: 6f62 6a20 3d20 4461 7461 7365 7428 6473  obj = Dataset(ds
-00012700: 7429 0d0a 2020 2020 2020 2020 2320 7365  t)..        # se
-00012710: 7420 7468 6520 6e6f 2064 6174 6120 7661  t the no data va
-00012720: 6c75 650d 0a20 2020 2020 2020 2064 7374  lue..        dst
-00012730: 5f6f 626a 2e5f 7365 745f 6e6f 5f64 6174  _obj._set_no_dat
-00012740: 615f 7661 6c75 6528 7365 6c66 2e6e 6f5f  a_value(self.no_
-00012750: 6461 7461 5f76 616c 7565 290d 0a20 2020  data_value)..   
-00012760: 2020 2020 2069 6620 6261 6e64 5f63 6f75       if band_cou
-00012770: 6e74 203e 2031 3a0d 0a20 2020 2020 2020  nt > 1:..       
-00012780: 2020 2020 2066 6f72 2062 616e 6420 696e       for band in
-00012790: 2072 616e 6765 2862 616e 645f 636f 756e   range(band_coun
-000127a0: 7429 3a0d 0a20 2020 2020 2020 2020 2020  t):..           
-000127b0: 2020 2020 2064 7374 5f6f 626a 2e72 6173       dst_obj.ras
-000127c0: 7465 722e 4765 7452 6173 7465 7242 616e  ter.GetRasterBan
-000127d0: 6428 6261 6e64 202b 2031 292e 5772 6974  d(band + 1).Writ
-000127e0: 6541 7272 6179 2873 7263 5f61 7272 6179  eArray(src_array
-000127f0: 5b62 616e 642c 203a 2c20 3a5d 290d 0a20  [band, :, :]).. 
-00012800: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
-00012810: 2020 2020 2020 2020 2020 6473 745f 6f62            dst_ob
-00012820: 6a2e 7261 7374 6572 2e47 6574 5261 7374  j.raster.GetRast
-00012830: 6572 4261 6e64 2831 292e 5772 6974 6541  erBand(1).WriteA
-00012840: 7272 6179 2873 7263 5f61 7272 6179 290d  rray(src_array).
-00012850: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00012860: 6473 745f 6f62 6a0d 0a0d 0a20 2020 2064  dst_obj....    d
-00012870: 6566 205f 6368 6563 6b5f 616c 6967 6e6d  ef _check_alignm
-00012880: 656e 7428 7365 6c66 2c20 6d61 736b 2920  ent(self, mask) 
-00012890: 2d3e 2062 6f6f 6c3a 0d0a 2020 2020 2020  -> bool:..      
-000128a0: 2020 2222 2243 6865 636b 2069 6620 7261    """Check if ra
-000128b0: 7374 6572 2069 7320 616c 6967 6e65 6420  ster is aligned 
-000128c0: 7769 7468 2061 2067 6976 656e 206d 6173  with a given mas
-000128d0: 6b20 7261 7374 6572 2222 220d 0a20 2020  k raster"""..   
-000128e0: 2020 2020 2069 6620 6e6f 7420 6973 696e       if not isin
-000128f0: 7374 616e 6365 286d 6173 6b2c 2044 6174  stance(mask, Dat
-00012900: 6173 6574 293a 0d0a 2020 2020 2020 2020  aset):..        
-00012910: 2020 2020 7261 6973 6520 5479 7065 4572      raise TypeEr
-00012920: 726f 7228 2254 6865 2073 6563 6f6e 6420  ror("The second 
-00012930: 7061 7261 6d65 7465 7220 7368 6f75 6c64  parameter should
-00012940: 2062 6520 6120 4461 7461 7365 7422 290d   be a Dataset").
-00012950: 0a0d 0a20 2020 2020 2020 2072 6574 7572  ...        retur
-00012960: 6e20 7365 6c66 2e72 6f77 7320 3d3d 206d  n self.rows == m
-00012970: 6173 6b2e 726f 7773 2061 6e64 2073 656c  ask.rows and sel
-00012980: 662e 636f 6c75 6d6e 7320 3d3d 206d 6173  f.columns == mas
-00012990: 6b2e 636f 6c75 6d6e 730d 0a0d 0a20 2020  k.columns....   
-000129a0: 2064 6566 2061 6c69 676e 280d 0a20 2020   def align(..   
-000129b0: 2020 2020 2073 656c 662c 0d0a 2020 2020       self,..    
-000129c0: 2020 2020 616c 6967 6e6d 656e 745f 7372      alignment_sr
-000129d0: 632c 0d0a 2020 2020 2920 2d3e 2067 6461  c,..    ) -> gda
-000129e0: 6c2e 4461 7461 7365 743a 0d0a 2020 2020  l.Dataset:..    
-000129f0: 2020 2020 2222 2261 6c69 676e 2e0d 0a0d      """align....
-00012a00: 0a20 2020 2020 2020 2061 6c69 676e 206d  .        align m
-00012a10: 6574 686f 6420 636f 7069 6573 2074 6865  ethod copies the
-00012a20: 2066 6f6c 6c6f 7769 6e67 2064 6174 610d   following data.
-00012a30: 0a20 2020 2020 2020 2020 2020 202d 2054  .            - T
-00012a40: 6865 2063 6f6f 7264 696e 6174 6520 7379  he coordinate sy
-00012a50: 7374 656d 0d0a 2020 2020 2020 2020 2020  stem..          
-00012a60: 2020 2d20 5468 6520 6e75 6d62 6572 206f    - The number o
-00012a70: 6620 6f66 2072 6f77 7320 2620 636f 6c75  f of rows & colu
-00012a80: 6d6e 730d 0a20 2020 2020 2020 2020 2020  mns..           
-00012a90: 202d 2063 656c 6c20 7369 7a65 0d0a 2020   - cell size..  
-00012aa0: 2020 2020 2020 6672 6f6d 2061 6c69 676e        from align
-00012ab0: 6d65 6e74 5f73 7263 2074 6f20 6120 6461  ment_src to a da
-00012ac0: 7461 5f73 7263 2072 6173 7465 7220 2874  ta_src raster (t
-00012ad0: 6865 2073 6f75 7263 6520 6f66 2064 6174  he source of dat
-00012ae0: 6120 7661 6c75 6573 2069 6e20 6365 6c6c  a values in cell
-00012af0: 7329 0d0a 0d0a 2020 2020 2020 2020 7468  s)....        th
-00012b00: 6520 7265 7375 6c74 2077 696c 6c20 6265  e result will be
-00012b10: 2061 2072 6173 7465 7220 7769 7468 2074   a raster with t
-00012b20: 6865 2073 616d 6520 7374 7275 6374 7572  he same structur
-00012b30: 6520 6c69 6b65 2061 6c69 676e 6d65 6e74  e like alignment
-00012b40: 5f73 7263 2062 7574 2077 6974 680d 0a20  _src but with.. 
-00012b50: 2020 2020 2020 2076 616c 7565 7320 6672         values fr
-00012b60: 6f6d 2064 6174 615f 7372 6320 7573 696e  om data_src usin
-00012b70: 6720 4e65 6172 6573 7420 4e65 6967 6862  g Nearest Neighb
-00012b80: 6f75 7220 696e 7465 7270 6f6c 6174 696f  our interpolatio
-00012b90: 6e20 616c 676f 7269 7468 6d0d 0a0d 0a20  n algorithm.... 
-00012ba0: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
-00012bb0: 730d 0a20 2020 2020 2020 202d 2d2d 2d2d  s..        -----
-00012bc0: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 2061  -----..        a
-00012bd0: 6c69 676e 6d65 6e74 5f73 7263 203a 205b  lignment_src : [
-00012be0: 4461 7461 7365 745d 0d0a 2020 2020 2020  Dataset]..      
-00012bf0: 2020 2020 2020 7370 6174 6961 6c20 696e        spatial in
-00012c00: 666f 726d 6174 696f 6e20 736f 7572 6365  formation source
-00012c10: 2072 6173 7465 7220 746f 2067 6574 2074   raster to get t
-00012c20: 6865 2073 7061 7469 616c 2069 6e66 6f72  he spatial infor
-00012c30: 6d61 7469 6f6e 0d0a 2020 2020 2020 2020  mation..        
-00012c40: 2020 2020 2863 6f6f 7264 696e 6174 6520      (coordinate 
-00012c50: 7379 7374 656d 2c20 6e6f 206f 6620 726f  system, no of ro
-00012c60: 7773 2026 2063 6f6c 756d 6e73 290d 0a20  ws & columns).. 
-00012c70: 2020 2020 2020 2020 2020 2064 6174 6120             data 
-00012c80: 7661 6c75 6573 2073 6f75 7263 6520 7261  values source ra
-00012c90: 7374 6572 2074 6f20 6765 7420 7468 6520  ster to get the 
-00012ca0: 6461 7461 2028 7661 6c75 6573 206f 6620  data (values of 
-00012cb0: 6561 6368 2063 656c 6c29 0d0a 0d0a 2020  each cell)....  
-00012cc0: 2020 2020 2020 5265 7475 726e 730d 0a20        Returns.. 
-00012cd0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 0d0a         -------..
-00012ce0: 2020 2020 2020 2020 6473 7420 3a20 5b44          dst : [D
-00012cf0: 6174 6173 6574 5d0d 0a20 2020 2020 2020  ataset]..       
-00012d00: 2020 2020 2044 6174 6173 6574 206f 626a       Dataset obj
-00012d10: 6563 740d 0a0d 0a20 2020 2020 2020 2045  ect....        E
-00012d20: 7861 6d70 6c65 730d 0a20 2020 2020 2020  xamples..       
-00012d30: 202d 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020   --------..     
-00012d40: 2020 203e 3e3e 2041 203d 2067 6461 6c2e     >>> A = gdal.
-00012d50: 4f70 656e 2822 6578 616d 706c 6573 2f47  Open("examples/G
-00012d60: 4953 2f64 6174 612f 6163 6334 3030 302e  IS/data/acc4000.
-00012d70: 7469 6622 290d 0a20 2020 2020 2020 203e  tif")..        >
-00012d80: 3e3e 2042 203d 2067 6461 6c2e 4f70 656e  >> B = gdal.Open
-00012d90: 2822 6578 616d 706c 6573 2f47 4953 2f64  ("examples/GIS/d
-00012da0: 6174 612f 736f 696c 5f72 6173 7465 722e  ata/soil_raster.
-00012db0: 7469 6622 290d 0a20 2020 2020 2020 203e  tif")..        >
-00012dc0: 3e3e 2052 6173 7465 7242 4d61 7463 6865  >> RasterBMatche
-00012dd0: 6420 3d20 4461 7461 7365 742e 616c 6967  d = Dataset.alig
-00012de0: 6e28 412c 4229 0d0a 2020 2020 2020 2020  n(A,B)..        
-00012df0: 2222 220d 0a20 2020 2020 2020 2069 6620  """..        if 
-00012e00: 6973 696e 7374 616e 6365 2861 6c69 676e  isinstance(align
-00012e10: 6d65 6e74 5f73 7263 2c20 4461 7461 7365  ment_src, Datase
-00012e20: 7429 3a0d 0a20 2020 2020 2020 2020 2020  t):..           
-00012e30: 2073 7263 203d 2061 6c69 676e 6d65 6e74   src = alignment
-00012e40: 5f73 7263 0d0a 2020 2020 2020 2020 656c  _src..        el
-00012e50: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
-00012e60: 2072 6169 7365 2054 7970 6545 7272 6f72   raise TypeError
-00012e70: 280d 0a20 2020 2020 2020 2020 2020 2020  (..             
-00012e80: 2020 2022 4669 7273 7420 7061 7261 6d65     "First parame
-00012e90: 7465 7220 7368 6f75 6c64 2062 6520 6120  ter should be a 
-00012ea0: 4461 7461 7365 7420 7265 6164 2075 7369  Dataset read usi
-00012eb0: 6e67 2044 6174 6173 6574 2e6f 7065 6e52  ng Dataset.openR
-00012ec0: 6173 7465 7220 6f72 2061 2070 6174 6820  aster or a path 
-00012ed0: 746f 2074 6865 2072 6173 7465 722c 2022  to the raster, "
-00012ee0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00012ef0: 2020 6622 6769 7665 6e20 7b74 7970 6528    f"given {type(
-00012f00: 616c 6967 6e6d 656e 745f 7372 6329 7d22  alignment_src)}"
-00012f10: 0d0a 2020 2020 2020 2020 2020 2020 290d  ..            ).
-00012f20: 0a0d 0a20 2020 2020 2020 2023 2072 6570  ...        # rep
-00012f30: 726f 6a65 6374 2074 6865 2072 6173 7465  roject the raste
-00012f40: 7220 746f 206d 6174 6368 2074 6865 2070  r to match the p
-00012f50: 726f 6a65 6374 696f 6e20 6f66 2061 6c69  rojection of ali
-00012f60: 676e 6d65 6e74 5f73 7263 0d0a 2020 2020  gnment_src..    
-00012f70: 2020 2020 6966 206e 6f74 2073 656c 662e      if not self.
-00012f80: 6570 7367 203d 3d20 7372 632e 6570 7367  epsg == src.epsg
-00012f90: 3a0d 0a20 2020 2020 2020 2020 2020 2072  :..            r
-00012fa0: 6570 726f 6a65 6374 6564 5f52 6173 7465  eprojected_Raste
-00012fb0: 7242 203d 2073 656c 662e 746f 5f63 7273  rB = self.to_crs
-00012fc0: 2873 7263 2e65 7073 6729 0d0a 2020 2020  (src.epsg)..    
-00012fd0: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
-00012fe0: 2020 2020 2020 2072 6570 726f 6a65 6374         reproject
-00012ff0: 6564 5f52 6173 7465 7242 203d 2073 656c  ed_RasterB = sel
-00013000: 660d 0a20 2020 2020 2020 2023 2063 7265  f..        # cre
-00013010: 6174 6520 6120 6e65 7720 7261 7374 6572  ate a new raster
-00013020: 0d0a 2020 2020 2020 2020 6473 7420 3d20  ..        dst = 
-00013030: 4461 7461 7365 742e 5f63 7265 6174 655f  Dataset._create_
-00013040: 6764 616c 5f64 6174 6173 6574 280d 0a20  gdal_dataset(.. 
-00013050: 2020 2020 2020 2020 2020 2073 7263 2e63             src.c
-00013060: 6f6c 756d 6e73 2c20 7372 632e 726f 7773  olumns, src.rows
-00013070: 2c20 7365 6c66 2e62 616e 645f 636f 756e  , self.band_coun
-00013080: 742c 2073 7263 2e64 7479 7065 5b30 5d2c  t, src.dtype[0],
-00013090: 2064 7269 7665 723d 224d 454d 220d 0a20   driver="MEM".. 
-000130a0: 2020 2020 2020 2029 0d0a 2020 2020 2020         )..      
-000130b0: 2020 2320 7365 7420 7468 6520 6765 6f74    # set the geot
-000130c0: 7261 6e73 666f 726d 0d0a 2020 2020 2020  ransform..      
-000130d0: 2020 6473 742e 5365 7447 656f 5472 616e    dst.SetGeoTran
-000130e0: 7366 6f72 6d28 7372 632e 6765 6f74 7261  sform(src.geotra
-000130f0: 6e73 666f 726d 290d 0a20 2020 2020 2020  nsform)..       
-00013100: 2023 2073 6574 2074 6865 2070 726f 6a65   # set the proje
-00013110: 6374 696f 6e0d 0a20 2020 2020 2020 2064  ction..        d
-00013120: 7374 2e53 6574 5072 6f6a 6563 7469 6f6e  st.SetProjection
-00013130: 2873 7263 2e63 7273 290d 0a20 2020 2020  (src.crs)..     
-00013140: 2020 2023 2073 6574 2074 6865 206e 6f20     # set the no 
-00013150: 6461 7461 2076 616c 7565 0d0a 2020 2020  data value..    
-00013160: 2020 2020 6473 745f 6f62 6a20 3d20 4461      dst_obj = Da
-00013170: 7461 7365 7428 6473 7429 0d0a 2020 2020  taset(dst)..    
-00013180: 2020 2020 6473 745f 6f62 6a2e 5f73 6574      dst_obj._set
-00013190: 5f6e 6f5f 6461 7461 5f76 616c 7565 2873  _no_data_value(s
-000131a0: 7263 2e6e 6f5f 6461 7461 5f76 616c 7565  rc.no_data_value
-000131b0: 290d 0a20 2020 2020 2020 2023 2070 6572  )..        # per
-000131c0: 666f 726d 2074 6865 2070 726f 6a65 6374  form the project
-000131d0: 696f 6e20 2620 7265 7361 6d70 6c69 6e67  ion & resampling
-000131e0: 0d0a 2020 2020 2020 2020 6d65 7468 6f64  ..        method
-000131f0: 203d 2067 6461 6c2e 4752 415f 4e65 6172   = gdal.GRA_Near
-00013200: 6573 744e 6569 6768 626f 7572 0d0a 2020  estNeighbour..  
-00013210: 2020 2020 2020 2320 7265 7361 6d70 6c65        # resample
-00013220: 2074 6865 2072 6570 726f 6a65 6374 6564   the reprojected
-00013230: 5f52 6173 7465 7242 0d0a 2020 2020 2020  _RasterB..      
-00013240: 2020 6764 616c 2e52 6570 726f 6a65 6374    gdal.Reproject
-00013250: 496d 6167 6528 0d0a 2020 2020 2020 2020  Image(..        
-00013260: 2020 2020 7265 7072 6f6a 6563 7465 645f      reprojected_
-00013270: 5261 7374 6572 422e 7261 7374 6572 2c0d  RasterB.raster,.
-00013280: 0a20 2020 2020 2020 2020 2020 2064 7374  .            dst
-00013290: 5f6f 626a 2e72 6173 7465 722c 0d0a 2020  _obj.raster,..  
-000132a0: 2020 2020 2020 2020 2020 7372 632e 6372            src.cr
-000132b0: 732c 0d0a 2020 2020 2020 2020 2020 2020  s,..            
-000132c0: 7372 632e 6372 732c 0d0a 2020 2020 2020  src.crs,..      
-000132d0: 2020 2020 2020 6d65 7468 6f64 2c0d 0a20        method,.. 
-000132e0: 2020 2020 2020 2029 0d0a 0d0a 2020 2020         )....    
-000132f0: 2020 2020 7265 7475 726e 2064 7374 5f6f      return dst_o
-00013300: 626a 0d0a 0d0a 2020 2020 6465 6620 5f63  bj....    def _c
-00013310: 726f 705f 7769 7468 5f72 6173 7465 7228  rop_with_raster(
-00013320: 0d0a 2020 2020 2020 2020 7365 6c66 2c0d  ..        self,.
-00013330: 0a20 2020 2020 2020 206d 6173 6b3a 2055  .        mask: U
-00013340: 6e69 6f6e 5b67 6461 6c2e 4461 7461 7365  nion[gdal.Datase
-00013350: 742c 2073 7472 5d2c 0d0a 2020 2020 2920  t, str],..    ) 
-00013360: 2d3e 2067 6461 6c2e 4461 7461 7365 743a  -> gdal.Dataset:
-00013370: 0d0a 2020 2020 2020 2020 2222 2263 726f  ..        """cro
-00013380: 702e 0d0a 0d0a 2020 2020 2020 2020 2020  p.....          
-00013390: 2020 6372 6f70 206d 6574 686f 6420 6372    crop method cr
-000133a0: 6f70 7320 6120 7261 7374 6572 2075 7369  ops a raster usi
-000133b0: 6e67 2061 6e6f 7468 6572 2072 6173 7465  ng another raste
-000133c0: 7220 2862 6f74 6820 7261 7374 6572 7320  r (both rasters 
-000133d0: 646f 6573 206e 6f74 2068 6176 6520 746f  does not have to
-000133e0: 2062 6520 616c 6967 6e65 6429 2e0d 0a0d   be aligned)....
-000133f0: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
-00013400: 6572 730d 0a20 2020 2020 2020 202d 2d2d  ers..        ---
-00013410: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020  --------..      
-00013420: 2020 6d61 736b 203a 205b 7374 7269 6e67    mask : [string
-00013430: 2f44 6174 6173 6574 5d0d 0a20 2020 2020  /Dataset]..     
-00013440: 2020 2020 2020 2074 6865 2072 6173 7465         the raste
-00013450: 7220 796f 7520 7761 6e74 2074 6f20 7573  r you want to us
-00013460: 6520 6173 2061 206d 6173 6b20 746f 2063  e as a mask to c
-00013470: 726f 7020 6f74 6865 7220 7261 7374 6572  rop other raster
-00013480: 2c0d 0a20 2020 2020 2020 2020 2020 2074  ,..            t
-00013490: 6865 206d 6173 6b20 6361 6e20 6265 2061  he mask can be a
-000134a0: 6c73 6f20 6120 7061 7468 206f 7220 6120  lso a path or a 
-000134b0: 6764 616c 206f 626a 6563 742e 0d0a 0d0a  gdal object.....
-000134c0: 2020 2020 2020 2020 5265 7475 726e 730d          Returns.
-000134d0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-000134e0: 0d0a 2020 2020 2020 2020 6473 7420 3a20  ..        dst : 
-000134f0: 5b44 6174 6173 6574 5d0d 0a20 2020 2020  [Dataset]..     
-00013500: 2020 2020 2020 2074 6865 2063 726f 7070         the cropp
-00013510: 6564 2072 6173 7465 7220 7769 6c6c 2062  ed raster will b
-00013520: 6520 7265 7475 726e 6564 2c20 6966 2074  e returned, if t
-00013530: 6865 2073 6176 6520 7061 7261 6d65 7465  he save paramete
-00013540: 7220 7761 7320 5472 7565 2c0d 0a20 2020  r was True,..   
-00013550: 2020 2020 2020 2020 2074 6865 2063 726f           the cro
-00013560: 7070 6564 2072 6173 7465 7220 7769 6c6c  pped raster will
-00013570: 2061 6c73 6f20 6265 2073 6176 6564 2074   also be saved t
-00013580: 6f20 6469 736b 2069 6e20 7468 6520 4f75  o disk in the Ou
-00013590: 7470 7574 5061 7468 0d0a 2020 2020 2020  tputPath..      
-000135a0: 2020 2020 2020 6469 7265 6374 6f72 792e        directory.
-000135b0: 0d0a 2020 2020 2020 2020 2222 220d 0a20  ..        """.. 
-000135c0: 2020 2020 2020 2023 2067 6574 2069 6e66         # get inf
-000135d0: 6f72 6d61 7469 6f6e 2066 726f 6d20 7468  ormation from th
-000135e0: 6520 6d61 736b 2072 6173 7465 720d 0a20  e mask raster.. 
-000135f0: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
-00013600: 616e 6365 286d 6173 6b2c 2073 7472 293a  ance(mask, str):
-00013610: 0d0a 2020 2020 2020 2020 2020 2020 6d61  ..            ma
-00013620: 736b 203d 2044 6174 6173 6574 2e72 6561  sk = Dataset.rea
-00013630: 645f 6669 6c65 286d 6173 6b29 0d0a 2020  d_file(mask)..  
-00013640: 2020 2020 2020 656c 6966 2069 7369 6e73        elif isins
-00013650: 7461 6e63 6528 6d61 736b 2c20 4461 7461  tance(mask, Data
-00013660: 7365 7429 3a0d 0a20 2020 2020 2020 2020  set):..         
-00013670: 2020 206d 6173 6b20 3d20 6d61 736b 0d0a     mask = mask..
-00013680: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
-00013690: 2020 2020 2020 2020 2020 2072 6169 7365             raise
-000136a0: 2054 7970 6545 7272 6f72 280d 0a20 2020   TypeError(..   
-000136b0: 2020 2020 2020 2020 2020 2020 2022 5365               "Se
-000136c0: 636f 6e64 2070 6172 616d 6574 6572 2068  cond parameter h
-000136d0: 6173 2074 6f20 6265 2065 6974 6865 7220  as to be either 
-000136e0: 7061 7468 2074 6f20 7468 6520 6d61 736b  path to the mask
-000136f0: 2072 6173 7465 7220 6f72 2061 2067 6461   raster or a gda
-00013700: 6c2e 4461 7461 6375 6265 206f 626a 6563  l.Datacube objec
-00013710: 7422 0d0a 2020 2020 2020 2020 2020 2020  t"..            
-00013720: 290d 0a20 2020 2020 2020 2069 6620 6e6f  )..        if no
-00013730: 7420 7365 6c66 2e5f 6368 6563 6b5f 616c  t self._check_al
-00013740: 6967 6e6d 656e 7428 6d61 736b 293a 0d0a  ignment(mask):..
-00013750: 2020 2020 2020 2020 2020 2020 2320 6669              # fi
-00013760: 7273 7420 616c 6967 6e20 7468 6520 6d61  rst align the ma
-00013770: 736b 2077 6974 6820 7468 6520 7372 6320  sk with the src 
-00013780: 7261 7374 6572 0d0a 2020 2020 2020 2020  raster..        
-00013790: 2020 2020 6d61 736b 203d 206d 6173 6b2e      mask = mask.
-000137a0: 616c 6967 6e28 7365 6c66 290d 0a20 2020  align(self)..   
-000137b0: 2020 2020 2023 2063 726f 7020 7468 6520       # crop the 
-000137c0: 7372 6320 7261 7374 6572 2077 6974 6820  src raster with 
-000137d0: 7468 6520 616c 6967 6e65 6420 6d61 736b  the aligned mask
-000137e0: 0d0a 2020 2020 2020 2020 6473 745f 6f62  ..        dst_ob
-000137f0: 6a20 3d20 7365 6c66 2e5f 6372 6f70 5f61  j = self._crop_a
-00013800: 6c6c 6967 6e65 6428 6d61 736b 290d 0a0d  lligned(mask)...
-00013810: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00013820: 6473 745f 6f62 6a0d 0a0d 0a20 2020 2064  dst_obj....    d
-00013830: 6566 205f 6372 6f70 5f77 6974 685f 706f  ef _crop_with_po
-00013840: 6c79 676f 6e28 7365 6c66 2c20 706f 6c79  lygon(self, poly
-00013850: 3a20 4765 6f44 6174 6146 7261 6d65 293a  : GeoDataFrame):
-00013860: 0d0a 2020 2020 2020 2020 2222 2263 726f  ..        """cro
-00013870: 7057 6974 6850 6f6c 7967 6f6e 2e0d 0a0d  pWithPolygon....
-00013880: 0a20 2020 2020 2020 2020 2020 2063 6c69  .            cli
-00013890: 7020 7468 6520 5261 7374 6572 206f 626a  p the Raster obj
-000138a0: 6563 7420 7573 696e 6720 6120 706f 6c79  ect using a poly
-000138b0: 676f 6e20 7665 6374 6f72 2e0d 0a0d 0a20  gon vector..... 
-000138c0: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
-000138d0: 730d 0a20 2020 2020 2020 202d 2d2d 2d2d  s..        -----
-000138e0: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 2070  -----..        p
-000138f0: 6f6c 793a 205b 506f 6c79 676f 6e20 4765  oly: [Polygon Ge
-00013900: 6f44 6174 6146 7261 6d65 5d0d 0a20 2020  oDataFrame]..   
-00013910: 2020 2020 2020 2020 2047 656f 6461 7461           Geodata
-00013920: 4672 616d 6520 7769 7468 2061 2067 656f  Frame with a geo
-00013930: 6d65 7472 7920 6f66 2070 6f6c 7967 6f6e  metry of polygon
-00013940: 2074 7970 652e 0d0a 2020 2020 2020 2020   type...        
-00013950: 5265 7475 726e 730d 0a20 2020 2020 2020  Returns..       
-00013960: 202d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020   -------..      
-00013970: 2020 4461 7461 7365 740d 0a20 2020 2020    Dataset..     
-00013980: 2020 2022 2222 0d0a 2020 2020 2020 2020     """..        
-00013990: 6966 206e 6f74 2069 7369 6e73 7461 6e63  if not isinstanc
-000139a0: 6528 706f 6c79 2c20 4765 6f44 6174 6146  e(poly, GeoDataF
-000139b0: 7261 6d65 293a 0d0a 2020 2020 2020 2020  rame):..        
-000139c0: 2020 2020 7261 6973 6520 5479 7065 4572      raise TypeEr
-000139d0: 726f 7228 0d0a 2020 2020 2020 2020 2020  ror(..          
-000139e0: 2020 2020 2020 2254 6865 2073 6563 6f6e        "The secon
-000139f0: 6420 7061 7261 6d65 7465 723a 2070 6f6c  d parameter: pol
-00013a00: 7920 7368 6f75 6c64 2062 6520 6f66 2074  y should be of t
-00013a10: 7970 6520 4765 6f44 6174 6146 7261 6d65  ype GeoDataFrame
-00013a20: 2022 0d0a 2020 2020 2020 2020 2020 2020   "..            
-00013a30: 290d 0a0d 0a20 2020 2020 2020 2070 6f6c  )....        pol
-00013a40: 795f 6570 7367 203d 2070 6f6c 792e 6372  y_epsg = poly.cr
-00013a50: 732e 746f 5f65 7073 6728 290d 0a20 2020  s.to_epsg()..   
-00013a60: 2020 2020 2073 7263 5f65 7073 6720 3d20       src_epsg = 
-00013a70: 7365 6c66 2e65 7073 670d 0a20 2020 2020  self.epsg..     
-00013a80: 2020 2069 6620 706f 6c79 5f65 7073 6720     if poly_epsg 
-00013a90: 213d 2073 7263 5f65 7073 673a 0d0a 2020  != src_epsg:..  
-00013aa0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-00013ab0: 5661 6c75 6545 7272 6f72 280d 0a20 2020  ValueError(..   
-00013ac0: 2020 2020 2020 2020 2020 2020 2022 5072               "Pr
-00013ad0: 6f6a 6563 7469 6f6e 2045 7272 6f72 3a20  ojection Error: 
-00013ae0: 7468 6520 7261 7374 6572 2061 6e64 2076  the raster and v
-00013af0: 6563 746f 7220 706f 6c79 676f 6e20 6861  ector polygon ha
-00013b00: 7665 2064 6966 6665 7265 6e74 2070 726f  ve different pro
-00013b10: 6a65 6374 696f 6e20 706c 6561 7365 2022  jection please "
-00013b20: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00013b30: 2020 2275 6e69 6679 2070 726f 6a65 6374    "unify project
-00013b40: 696f 6e22 0d0a 2020 2020 2020 2020 2020  ion"..          
-00013b50: 2020 290d 0a20 2020 2020 2020 2076 6563    )..        vec
-00013b60: 746f 7220 3d20 4665 6174 7572 6543 6f6c  tor = FeatureCol
-00013b70: 6c65 6374 696f 6e28 706f 6c79 290d 0a20  lection(poly).. 
-00013b80: 2020 2020 2020 206d 6173 6b20 3d20 7665         mask = ve
-00013b90: 6374 6f72 2e74 6f5f 6461 7461 7365 7428  ctor.to_dataset(
-00013ba0: 6461 7461 7365 743d 7365 6c66 290d 0a20  dataset=self).. 
-00013bb0: 2020 2020 2020 2063 726f 7070 6564 5f6f         cropped_o
-00013bc0: 626a 203d 2073 656c 662e 5f63 726f 705f  bj = self._crop_
-00013bd0: 7769 7468 5f72 6173 7465 7228 6d61 736b  with_raster(mask
-00013be0: 290d 0a0d 0a20 2020 2020 2020 2023 2078  )....        # x
-00013bf0: 6d69 6e2c 2079 6d69 6e2c 2078 6d61 782c  min, ymin, xmax,
-00013c00: 2079 6d61 7820 3d20 706f 6c79 2e62 6f75   ymax = poly.bou
-00013c10: 6e64 732e 7661 6c75 6573 2e74 6f6c 6973  nds.values.tolis
-00013c20: 7428 295b 305d 0d0a 2020 2020 2020 2020  t()[0]..        
-00013c30: 2320 7769 6e64 6f77 203d 2028 786d 696e  # window = (xmin
-00013c40: 2c20 796d 6178 2c20 786d 6178 2c20 796d  , ymax, xmax, ym
-00013c50: 696e 290d 0a20 2020 2020 2020 2023 2023  in)..        # #
-00013c60: 2067 6461 6c2e 5472 616e 736c 6174 654f   gdal.TranslateO
-00013c70: 7074 696f 6e73 2864 7374 2c20 7373 2c20  ptions(dst, ss, 
-00013c80: 7072 6f6a 5769 6e3d 7769 6e64 6f77 290d  projWin=window).
-00013c90: 0a20 2020 2020 2020 2023 2023 2063 6f70  .        # # cop
-00013ca0: 7920 7468 6520 7372 6320 7261 7374 6572  y the src raster
-00013cb0: 0d0a 2020 2020 2020 2020 2320 6472 7620  ..        # drv 
-00013cc0: 3d20 6764 616c 2e47 6574 4472 6976 6572  = gdal.GetDriver
-00013cd0: 4279 4e61 6d65 2822 4d45 4d22 290d 0a20  ByName("MEM").. 
-00013ce0: 2020 2020 2020 2023 2064 7374 203d 2064         # dst = d
-00013cf0: 7276 2e43 7265 6174 6543 6f70 7928 2222  rv.CreateCopy(""
-00013d00: 2c20 7365 6c66 2e72 6173 7465 722c 2030  , self.raster, 0
-00013d10: 290d 0a20 2020 2020 2020 2023 2074 7279  )..        # try
-00013d20: 3a0d 0a20 2020 2020 2020 2023 2020 2020  :..        #    
-00013d30: 2067 6461 6c2e 5472 616e 736c 6174 6528   gdal.Translate(
-00013d40: 6473 742c 2073 656c 662e 7261 7374 6572  dst, self.raster
-00013d50: 2c20 7072 6f6a 5769 6e3d 7769 6e64 6f77  , projWin=window
-00013d60: 290d 0a20 2020 2020 2020 2023 2065 7863  )..        # exc
-00013d70: 6570 7420 5275 6e74 696d 6545 7272 6f72  ept RuntimeError
-00013d80: 3a0d 0a20 2020 2020 2020 2023 2020 2020  :..        #    
-00013d90: 2070 6173 730d 0a0d 0a20 2020 2020 2020   pass....       
-00013da0: 2023 2063 726f 7070 6564 5f6f 626a 203d   # cropped_obj =
-00013db0: 2044 6174 6173 6574 2864 7374 290d 0a0d   Dataset(dst)...
-00013dc0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-00013dd0: 6372 6f70 7065 645f 6f62 6a0d 0a0d 0a20  cropped_obj.... 
-00013de0: 2020 2064 6566 2063 726f 7028 7365 6c66     def crop(self
-00013df0: 2c20 6d61 736b 3a20 556e 696f 6e5b 4765  , mask: Union[Ge
-00013e00: 6f44 6174 6146 7261 6d65 5d29 3a0d 0a20  oDataFrame]):.. 
-00013e10: 2020 2020 2020 2022 2222 0d0a 0d0a 2020         """....  
-00013e20: 2020 2020 2020 2020 2020 636c 6970 2074            clip t
-00013e30: 6865 2044 6174 6173 6574 206f 626a 6563  he Dataset objec
-00013e40: 7420 7573 696e 6720 6120 706f 6c79 676f  t using a polygo
-00013e50: 6e2f 616e 6f74 6865 7220 7261 7374 6572  n/another raster
-00013e60: 2028 626f 7468 2072 6173 7465 7273 2064   (both rasters d
-00013e70: 6f65 7320 6e6f 7420 6861 7665 2074 6f20  oes not have to 
-00013e80: 6265 2061 6c69 676e 6564 292e 0d0a 0d0a  be aligned).....
-00013e90: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
-00013ea0: 7273 0d0a 2020 2020 2020 2020 2d2d 2d2d  rs..        ----
-00013eb0: 2d2d 2d2d 2d2d 0d0a 2020 2020 2020 2020  ------..        
-00013ec0: 6d61 736b 3a20 5b50 6f6c 7967 6f6e 2047  mask: [Polygon G
-00013ed0: 656f 4461 7461 4672 616d 652f 4461 7461  eoDataFrame/Data
-00013ee0: 7365 7420 6f62 6a65 6374 5d0d 0a20 2020  set object]..   
-00013ef0: 2020 2020 2020 2020 2047 656f 6461 7461           Geodata
-00013f00: 4672 616d 6520 7769 7468 2061 2067 656f  Frame with a geo
-00013f10: 6d65 7472 7920 6f66 2070 6f6c 7967 6f6e  metry of polygon
-00013f20: 2074 7970 650d 0a0d 0a20 2020 2020 2020   type....       
-00013f30: 2052 6574 7572 6e73 0d0a 2020 2020 2020   Returns..      
-00013f40: 2020 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020    -------..     
-00013f50: 2020 2044 6174 6173 6574 204f 626a 6563     Dataset Objec
-00013f60: 740d 0a20 2020 2020 2020 2022 2222 0d0a  t..        """..
-00013f70: 2020 2020 2020 2020 6966 2069 7369 6e73          if isins
-00013f80: 7461 6e63 6528 6d61 736b 2c20 4765 6f44  tance(mask, GeoD
-00013f90: 6174 6146 7261 6d65 293a 0d0a 2020 2020  ataFrame):..    
-00013fa0: 2020 2020 2020 2020 6473 7420 3d20 7365          dst = se
-00013fb0: 6c66 2e5f 6372 6f70 5f77 6974 685f 706f  lf._crop_with_po
-00013fc0: 6c79 676f 6e28 6d61 736b 290d 0a20 2020  lygon(mask)..   
-00013fd0: 2020 2020 2065 6c69 6620 6973 696e 7374       elif isinst
-00013fe0: 616e 6365 286d 6173 6b2c 2044 6174 6173  ance(mask, Datas
-00013ff0: 6574 293a 0d0a 2020 2020 2020 2020 2020  et):..          
-00014000: 2020 6473 7420 3d20 7365 6c66 2e5f 6372    dst = self._cr
-00014010: 6f70 5f77 6974 685f 7261 7374 6572 286d  op_with_raster(m
-00014020: 6173 6b29 0d0a 2020 2020 2020 2020 656c  ask)..        el
-00014030: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
-00014040: 2072 6169 7365 2054 7970 6545 7272 6f72   raise TypeError
-00014050: 280d 0a20 2020 2020 2020 2020 2020 2020  (..             
-00014060: 2020 2022 5468 6520 7365 636f 6e64 2070     "The second p
-00014070: 6172 616d 6574 6572 3a20 6d61 736b 2063  arameter: mask c
-00014080: 6f75 6c64 2062 6520 6569 7468 6572 2047  ould be either G
-00014090: 656f 4461 7461 4672 616d 6520 6f72 2044  eoDataFrame or D
-000140a0: 6174 6173 6574 206f 626a 6563 7422 0d0a  ataset object"..
-000140b0: 2020 2020 2020 2020 2020 2020 290d 0a0d              )...
-000140c0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-000140d0: 6473 740d 0a0d 0a20 2020 2040 7374 6174  dst....    @stat
-000140e0: 6963 6d65 7468 6f64 0d0a 2020 2020 6465  icmethod..    de
-000140f0: 6620 5f6e 6561 7265 7374 5f6e 6569 6768  f _nearest_neigh
-00014100: 626f 7572 280d 0a20 2020 2020 2020 2061  bour(..        a
-00014110: 7272 6179 3a20 6e70 2e6e 6461 7272 6179  rray: np.ndarray
-00014120: 2c20 6e6f 6461 7461 7661 6c75 653a 2055  , nodatavalue: U
-00014130: 6e69 6f6e 5b66 6c6f 6174 2c20 696e 745d  nion[float, int]
-00014140: 2c20 726f 7773 3a20 6c69 7374 2c20 636f  , rows: list, co
-00014150: 6c73 3a20 6c69 7374 0d0a 2020 2020 2920  ls: list..    ) 
-00014160: 2d3e 206e 702e 6e64 6172 7261 793a 0d0a  -> np.ndarray:..
-00014170: 2020 2020 2020 2020 2222 226e 6561 7265          """neare
-00014180: 7374 4e65 6967 6862 6f75 722e 0d0a 0d0a  stNeighbour.....
-00014190: 2020 2020 2020 2020 2020 2020 2d20 6669              - fi
-000141a0: 6c6c 7320 7468 6520 6365 6c6c 7320 6f66  lls the cells of
-000141b0: 2061 2067 6976 656e 2069 6e64 6963 6573   a given indices
-000141c0: 2069 6e20 726f 7773 2061 6e64 2063 6f6c   in rows and col
-000141d0: 7320 7769 7468 2074 6865 2076 616c 7565  s with the value
-000141e0: 206f 6620 7468 6520 6e65 6172 6573 740d   of the nearest.
-000141f0: 0a20 2020 2020 2020 2020 2020 206e 6569  .            nei
-00014200: 6768 626f 7572 2e0d 0a20 2020 2020 2020  ghbour...       
-00014210: 2020 2020 202d 2053 7320 7468 6520 7261       - Ss the ra
-00014220: 7374 6572 2067 7269 6420 6973 2073 7175  ster grid is squ
-00014230: 6172 6520 736f 2074 6865 2034 2070 6572  are so the 4 per
-00014240: 7065 6e64 6963 756c 6172 2064 6972 6563  pendicular direc
-00014250: 7469 6f6e 2061 7265 206f 6620 7468 6520  tion are of the 
-00014260: 7361 6d65 2070 726f 7869 6d69 7479 2073  same proximity s
-00014270: 6f20 7468 6520 6675 6e63 7469 6f6e 0d0a  o the function..
-00014280: 2020 2020 2020 2020 2020 2020 6769 7665              give
-00014290: 7320 7072 696f 7269 7479 2074 6f20 7468  s priority to th
-000142a0: 6520 7269 6768 7420 7468 656e 206c 6566  e right then lef
-000142b0: 7420 7468 656e 2062 6f74 746f 6d20 7468  t then bottom th
-000142c0: 656e 2074 6f70 2061 6e64 2074 6865 2073  en top and the s
-000142d0: 616d 6520 666f 7220 3435 2064 6567 7265  ame for 45 degre
-000142e0: 6520 696e 636c 696e 6564 2064 6972 6563  e inclined direc
-000142f0: 7469 6f6e 0d0a 2020 2020 2020 2020 2020  tion..          
-00014300: 2020 7269 6768 7420 626f 7474 6f6d 2074    right bottom t
-00014310: 6865 6e20 6c65 6674 2062 6f74 746f 6d20  hen left bottom 
-00014320: 7468 656e 206c 6566 7420 546f 7020 7468  then left Top th
-00014330: 656e 2072 6967 6874 2054 6f70 2e0d 0a0d  en right Top....
-00014340: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
-00014350: 6572 730d 0a20 2020 2020 2020 202d 2d2d  ers..        ---
-00014360: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
-00014370: 2061 7272 6179 3a20 5b6e 756d 7079 2e61   array: [numpy.a
-00014380: 7272 6179 5d0d 0a20 2020 2020 2020 2020  rray]..         
-00014390: 2020 2041 7272 6179 2074 6f20 6669 6c6c     Array to fill
-000143a0: 2073 6f6d 6520 6f66 2069 7473 2063 656c   some of its cel
-000143b0: 6c73 2077 6974 6820 4e65 6172 6573 7420  ls with Nearest 
-000143c0: 7661 6c75 652e 0d0a 2020 2020 2020 2020  value...        
-000143d0: 6e6f 6461 7461 7661 6c75 653a 205b 666c  nodatavalue: [fl
-000143e0: 6f61 7433 325d 0d0a 2020 2020 2020 2020  oat32]..        
-000143f0: 2020 2020 7661 6c75 6520 7374 6f72 6564      value stored
-00014400: 2069 6e20 6365 6c6c 7320 7468 6174 2069   in cells that i
-00014410: 7320 6f75 7420 6f66 2074 6865 2064 6f6d  s out of the dom
-00014420: 6169 6e0d 0a20 2020 2020 2020 2072 6f77  ain..        row
-00014430: 733a 205b 4c69 7374 5d0d 0a20 2020 2020  s: [List]..     
-00014440: 2020 2020 2020 206c 6973 7420 6f66 2074         list of t
-00014450: 6865 2072 6f77 7320 696e 6465 7820 6f66  he rows index of
-00014460: 2074 6865 2063 656c 6c73 2079 6f75 2077   the cells you w
-00014470: 616e 7420 746f 2066 696c 6c20 6974 2077  ant to fill it w
-00014480: 6974 680d 0a20 2020 2020 2020 2020 2020  ith..           
-00014490: 206e 6561 7265 7374 206e 6569 6768 626f   nearest neighbo
-000144a0: 7572 2e0d 0a20 2020 2020 2020 2063 6f6c  ur...        col
-000144b0: 733a 205b 4c69 7374 5d0d 0a20 2020 2020  s: [List]..     
-000144c0: 2020 2020 2020 206c 6973 7420 6f66 2074         list of t
-000144d0: 6865 2063 6f6c 756d 6e20 696e 6465 7820  he column index 
-000144e0: 6f66 2074 6865 2063 656c 6c73 2079 6f75  of the cells you
-000144f0: 2077 616e 7420 746f 2066 696c 6c20 6974   want to fill it
-00014500: 2077 6974 680d 0a20 2020 2020 2020 2020   with..         
-00014510: 2020 206e 6561 7265 7374 206e 6569 6768     nearest neigh
-00014520: 626f 7572 2e0d 0a0d 0a20 2020 2020 2020  bour.....       
-00014530: 2052 6574 7572 6e73 0d0a 2020 2020 2020   Returns..      
-00014540: 2020 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020    -------..     
-00014550: 2020 2061 7272 6179 3a20 5b6e 756d 7079     array: [numpy
-00014560: 2061 7272 6179 5d0d 0a20 2020 2020 2020   array]..       
-00014570: 2020 2020 2043 656c 6c73 206f 6620 6769       Cells of gi
-00014580: 7665 6e20 696e 6469 6365 7320 7769 6c6c  ven indices will
-00014590: 2062 6520 6669 6c6c 6564 2077 6974 6820   be filled with 
-000145a0: 7661 6c75 6520 6f66 2074 6865 204e 6561  value of the Nea
-000145b0: 7265 7374 206e 6569 6768 626f 7572 0d0a  rest neighbour..
-000145c0: 0d0a 2020 2020 2020 2020 4578 616d 706c  ..        Exampl
-000145d0: 6573 0d0a 2020 2020 2020 2020 2d2d 2d2d  es..        ----
-000145e0: 2d2d 2d2d 0d0a 2020 2020 2020 2020 3e3e  ----..        >>
-000145f0: 3e20 7261 7374 6572 203d 2067 6461 6c2e  > raster = gdal.
-00014600: 4f70 656e 2822 6465 6d2e 7469 6622 290d  Open("dem.tif").
-00014610: 0a20 2020 2020 2020 203e 3e3e 2072 6571  .        >>> req
-00014620: 5f72 6f77 7320 3d20 5b33 2c31 325d 0d0a  _rows = [3,12]..
-00014630: 2020 2020 2020 2020 3e3e 3e20 7265 715f          >>> req_
-00014640: 636f 6c73 203d 205b 392c 325d 0d0a 2020  cols = [9,2]..  
-00014650: 2020 2020 2020 3e3e 3e20 6e65 775f 6172        >>> new_ar
-00014660: 7261 7920 3d20 4461 7461 7365 742e 5f6e  ray = Dataset._n
-00014670: 6561 7265 7374 5f6e 6569 6768 626f 7572  earest_neighbour
-00014680: 2872 6173 7465 722c 2072 6571 5f72 6f77  (raster, req_row
-00014690: 732c 2072 6571 5f63 6f6c 7329 0d0a 2020  s, req_cols)..  
-000146a0: 2020 2020 2020 2222 220d 0a20 2020 2020        """..     
-000146b0: 2020 2069 6620 6e6f 7420 6973 696e 7374     if not isinst
-000146c0: 616e 6365 2861 7272 6179 2c20 6e70 2e6e  ance(array, np.n
-000146d0: 6461 7272 6179 293a 0d0a 2020 2020 2020  darray):..      
-000146e0: 2020 2020 2020 7261 6973 6520 5479 7065        raise Type
-000146f0: 4572 726f 7228 0d0a 2020 2020 2020 2020  Error(..        
-00014700: 2020 2020 2020 2020 2273 7263 2073 686f          "src sho
-00014710: 756c 6420 6265 2072 6561 6420 7573 696e  uld be read usin
-00014720: 6720 6764 616c 2028 6764 616c 2064 6174  g gdal (gdal dat
-00014730: 6173 6574 2070 6c65 6173 6520 7265 6164  aset please read
-00014740: 2069 7420 7573 696e 6720 6764 616c 206c   it using gdal l
-00014750: 6962 7261 7279 2920 220d 0a20 2020 2020  ibrary) "..     
-00014760: 2020 2020 2020 2029 0d0a 2020 2020 2020         )..      
-00014770: 2020 6966 206e 6f74 2069 7369 6e73 7461    if not isinsta
-00014780: 6e63 6528 726f 7773 2c20 6c69 7374 293a  nce(rows, list):
-00014790: 0d0a 2020 2020 2020 2020 2020 2020 7261  ..            ra
-000147a0: 6973 6520 5479 7065 4572 726f 7228 2272  ise TypeError("r
-000147b0: 6f77 7320 696e 7075 7420 6861 7320 746f  ows input has to
-000147c0: 2062 6520 6f66 2074 7970 6520 6c69 7374   be of type list
-000147d0: 2229 0d0a 2020 2020 2020 2020 6966 206e  ")..        if n
-000147e0: 6f74 2069 7369 6e73 7461 6e63 6528 636f  ot isinstance(co
-000147f0: 6c73 2c20 6c69 7374 293a 0d0a 2020 2020  ls, list):..    
-00014800: 2020 2020 2020 2020 7261 6973 6520 5479          raise Ty
-00014810: 7065 4572 726f 7228 2263 6f6c 7320 696e  peError("cols in
-00014820: 7075 7420 6861 7320 746f 2062 6520 6f66  put has to be of
-00014830: 2074 7970 6520 6c69 7374 2229 0d0a 0d0a   type list")....
-00014840: 2020 2020 2020 2020 2320 2020 2061 7272          #    arr
-00014850: 6179 3d72 6173 7465 722e 5265 6164 4173  ay=raster.ReadAs
-00014860: 4172 7261 7928 290d 0a20 2020 2020 2020  Array()..       
-00014870: 2023 2020 2020 6e6f 6461 7461 7661 6c75   #    nodatavalu
-00014880: 653d 6e70 2e66 6c6f 6174 3332 2872 6173  e=np.float32(ras
-00014890: 7465 722e 4765 7452 6173 7465 7242 616e  ter.GetRasterBan
-000148a0: 6428 3129 2e47 6574 4e6f 4461 7461 5661  d(1).GetNoDataVa
-000148b0: 6c75 6528 2929 0d0a 0d0a 2020 2020 2020  lue())....      
-000148c0: 2020 6e6f 5f72 6f77 7320 3d20 6e70 2e73    no_rows = np.s
-000148d0: 6861 7065 2861 7272 6179 295b 305d 0d0a  hape(array)[0]..
-000148e0: 2020 2020 2020 2020 6e6f 5f63 6f6c 7320          no_cols 
-000148f0: 3d20 6e70 2e73 6861 7065 2861 7272 6179  = np.shape(array
-00014900: 295b 315d 0d0a 0d0a 2020 2020 2020 2020  )[1]....        
-00014910: 666f 7220 6920 696e 2072 616e 6765 286c  for i in range(l
-00014920: 656e 2872 6f77 7329 293a 0d0a 2020 2020  en(rows)):..    
-00014930: 2020 2020 2020 2020 2320 6769 7665 2074          # give t
-00014940: 6865 2063 656c 6c20 7468 6520 7661 6c75  he cell the valu
-00014950: 6520 6f66 2074 6865 2063 656c 6c20 7468  e of the cell th
-00014960: 6174 2069 7320 6174 2074 6865 2072 6967  at is at the rig
-00014970: 6874 0d0a 2020 2020 2020 2020 2020 2020  ht..            
-00014980: 6966 2061 7272 6179 5b72 6f77 735b 695d  if array[rows[i]
-00014990: 2c20 636f 6c73 5b69 5d20 2b20 315d 2021  , cols[i] + 1] !
-000149a0: 3d20 6e6f 6461 7461 7661 6c75 6520 616e  = nodatavalue an
-000149b0: 6420 636f 6c73 5b69 5d20 2b20 3120 3c3d  d cols[i] + 1 <=
-000149c0: 206e 6f5f 636f 6c73 3a0d 0a20 2020 2020   no_cols:..     
-000149d0: 2020 2020 2020 2020 2020 2061 7272 6179             array
-000149e0: 5b72 6f77 735b 695d 2c20 636f 6c73 5b69  [rows[i], cols[i
-000149f0: 5d5d 203d 2061 7272 6179 5b72 6f77 735b  ]] = array[rows[
-00014a00: 695d 2c20 636f 6c73 5b69 5d20 2b20 315d  i], cols[i] + 1]
-00014a10: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
-00014a20: 656c 6966 2061 7272 6179 5b72 6f77 735b  elif array[rows[
-00014a30: 695d 2c20 636f 6c73 5b69 5d20 2d20 315d  i], cols[i] - 1]
-00014a40: 2021 3d20 6e6f 6461 7461 7661 6c75 6520   != nodatavalue 
-00014a50: 616e 6420 636f 6c73 5b69 5d20 2d20 3120  and cols[i] - 1 
-00014a60: 3e20 303a 0d0a 2020 2020 2020 2020 2020  > 0:..          
-00014a70: 2020 2020 2020 2320 6769 7665 2074 6865        # give the
-00014a80: 2063 656c 6c20 7468 6520 7661 6c75 6520   cell the value 
-00014a90: 6f66 2074 6865 2063 656c 6c20 7468 6174  of the cell that
-00014aa0: 2069 7320 6174 2074 6865 206c 6566 740d   is at the left.
-00014ab0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00014ac0: 2061 7272 6179 5b72 6f77 735b 695d 2c20   array[rows[i], 
-00014ad0: 636f 6c73 5b69 5d5d 203d 2061 7272 6179  cols[i]] = array
-00014ae0: 5b72 6f77 735b 695d 2c20 636f 6c73 5b69  [rows[i], cols[i
-00014af0: 5d20 2d20 315d 0d0a 0d0a 2020 2020 2020  ] - 1]....      
-00014b00: 2020 2020 2020 656c 6966 2061 7272 6179        elif array
-00014b10: 5b72 6f77 735b 695d 202d 2031 2c20 636f  [rows[i] - 1, co
-00014b20: 6c73 5b69 5d5d 2021 3d20 6e6f 6461 7461  ls[i]] != nodata
-00014b30: 7661 6c75 6520 616e 6420 726f 7773 5b69  value and rows[i
-00014b40: 5d20 2d20 3120 3e20 303a 0d0a 2020 2020  ] - 1 > 0:..    
-00014b50: 2020 2020 2020 2020 2020 2020 2320 6769              # gi
-00014b60: 7665 2074 6865 2063 656c 6c20 7468 6520  ve the cell the 
-00014b70: 7661 6c75 6520 6f66 2074 6865 2063 656c  value of the cel
-00014b80: 6c20 7468 6174 2069 7320 6174 2074 6865  l that is at the
-00014b90: 2062 6f74 746f 6d0d 0a20 2020 2020 2020   bottom..       
-00014ba0: 2020 2020 2020 2020 2061 7272 6179 5b72           array[r
-00014bb0: 6f77 735b 695d 2c20 636f 6c73 5b69 5d5d  ows[i], cols[i]]
-00014bc0: 203d 2061 7272 6179 5b72 6f77 735b 695d   = array[rows[i]
-00014bd0: 202d 2031 2c20 636f 6c73 5b69 5d5d 0d0a   - 1, cols[i]]..
-00014be0: 0d0a 2020 2020 2020 2020 2020 2020 656c  ..            el
-00014bf0: 6966 2061 7272 6179 5b72 6f77 735b 695d  if array[rows[i]
-00014c00: 202b 2031 2c20 636f 6c73 5b69 5d5d 2021   + 1, cols[i]] !
-00014c10: 3d20 6e6f 6461 7461 7661 6c75 6520 616e  = nodatavalue an
-00014c20: 6420 726f 7773 5b69 5d20 2b20 3120 3c3d  d rows[i] + 1 <=
-00014c30: 206e 6f5f 726f 7773 3a0d 0a20 2020 2020   no_rows:..     
-00014c40: 2020 2020 2020 2020 2020 2023 2067 6976             # giv
-00014c50: 6520 7468 6520 6365 6c6c 2074 6865 2076  e the cell the v
-00014c60: 616c 7565 206f 6620 7468 6520 6365 6c6c  alue of the cell
-00014c70: 2074 6861 7420 6973 2061 7420 7468 6520   that is at the 
-00014c80: 546f 700d 0a20 2020 2020 2020 2020 2020  Top..           
-00014c90: 2020 2020 2061 7272 6179 5b72 6f77 735b       array[rows[
-00014ca0: 695d 2c20 636f 6c73 5b69 5d5d 203d 2061  i], cols[i]] = a
-00014cb0: 7272 6179 5b72 6f77 735b 695d 202b 2031  rray[rows[i] + 1
-00014cc0: 2c20 636f 6c73 5b69 5d5d 0d0a 0d0a 2020  , cols[i]]....  
-00014cd0: 2020 2020 2020 2020 2020 656c 6966 2028            elif (
-00014ce0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00014cf0: 2020 6172 7261 795b 726f 7773 5b69 5d20    array[rows[i] 
-00014d00: 2d20 312c 2063 6f6c 735b 695d 202b 2031  - 1, cols[i] + 1
-00014d10: 5d20 213d 206e 6f64 6174 6176 616c 7565  ] != nodatavalue
-00014d20: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00014d30: 2020 616e 6420 726f 7773 5b69 5d20 2d20    and rows[i] - 
-00014d40: 3120 3e20 300d 0a20 2020 2020 2020 2020  1 > 0..         
-00014d50: 2020 2020 2020 2061 6e64 2063 6f6c 735b         and cols[
-00014d60: 695d 202b 2031 203c 3d20 6e6f 5f63 6f6c  i] + 1 <= no_col
-00014d70: 730d 0a20 2020 2020 2020 2020 2020 2029  s..            )
-00014d80: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-00014d90: 2020 2023 2067 6976 6520 7468 6520 6365     # give the ce
-00014da0: 6c6c 2074 6865 2076 616c 7565 206f 6620  ll the value of 
-00014db0: 7468 6520 6365 6c6c 2074 6861 7420 6973  the cell that is
-00014dc0: 2061 7420 7468 6520 7269 6768 7420 626f   at the right bo
-00014dd0: 7474 6f6d 0d0a 2020 2020 2020 2020 2020  ttom..          
-00014de0: 2020 2020 2020 6172 7261 795b 726f 7773        array[rows
-00014df0: 5b69 5d2c 2063 6f6c 735b 695d 5d20 3d20  [i], cols[i]] = 
-00014e00: 6172 7261 795b 726f 7773 5b69 5d20 2d20  array[rows[i] - 
-00014e10: 312c 2063 6f6c 735b 695d 202b 2031 5d0d  1, cols[i] + 1].
-00014e20: 0a0d 0a20 2020 2020 2020 2020 2020 2065  ...            e
-00014e30: 6c69 6620 280d 0a20 2020 2020 2020 2020  lif (..         
-00014e40: 2020 2020 2020 2061 7272 6179 5b72 6f77         array[row
-00014e50: 735b 695d 202d 2031 2c20 636f 6c73 5b69  s[i] - 1, cols[i
-00014e60: 5d20 2d20 315d 2021 3d20 6e6f 6461 7461  ] - 1] != nodata
-00014e70: 7661 6c75 650d 0a20 2020 2020 2020 2020  value..         
-00014e80: 2020 2020 2020 2061 6e64 2072 6f77 735b         and rows[
-00014e90: 695d 202d 2031 203e 2030 0d0a 2020 2020  i] - 1 > 0..    
-00014ea0: 2020 2020 2020 2020 2020 2020 616e 6420              and 
-00014eb0: 636f 6c73 5b69 5d20 2d20 3120 3e20 300d  cols[i] - 1 > 0.
-00014ec0: 0a20 2020 2020 2020 2020 2020 2029 3a0d  .            ):.
-00014ed0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00014ee0: 2023 2067 6976 6520 7468 6520 6365 6c6c   # give the cell
-00014ef0: 2074 6865 2076 616c 7565 206f 6620 7468   the value of th
-00014f00: 6520 6365 6c6c 2074 6861 7420 6973 2061  e cell that is a
-00014f10: 7420 7468 6520 6c65 6674 2062 6f74 746f  t the left botto
-00014f20: 6d0d 0a20 2020 2020 2020 2020 2020 2020  m..             
-00014f30: 2020 2061 7272 6179 5b72 6f77 735b 695d     array[rows[i]
-00014f40: 2c20 636f 6c73 5b69 5d5d 203d 2061 7272  , cols[i]] = arr
-00014f50: 6179 5b72 6f77 735b 695d 202d 2031 2c20  ay[rows[i] - 1, 
-00014f60: 636f 6c73 5b69 5d20 2d20 315d 0d0a 0d0a  cols[i] - 1]....
-00014f70: 2020 2020 2020 2020 2020 2020 656c 6966              elif
-00014f80: 2028 0d0a 2020 2020 2020 2020 2020 2020   (..            
-00014f90: 2020 2020 6172 7261 795b 726f 7773 5b69      array[rows[i
-00014fa0: 5d20 2b20 312c 2063 6f6c 735b 695d 202d  ] + 1, cols[i] -
-00014fb0: 2031 5d20 213d 206e 6f64 6174 6176 616c   1] != nodataval
-00014fc0: 7565 0d0a 2020 2020 2020 2020 2020 2020  ue..            
-00014fd0: 2020 2020 616e 6420 726f 7773 5b69 5d20      and rows[i] 
-00014fe0: 2b20 3120 3c3d 206e 6f5f 726f 7773 0d0a  + 1 <= no_rows..
-00014ff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015000: 616e 6420 636f 6c73 5b69 5d20 2d20 3120  and cols[i] - 1 
-00015010: 3e20 300d 0a20 2020 2020 2020 2020 2020  > 0..           
-00015020: 2029 3a0d 0a20 2020 2020 2020 2020 2020   ):..           
-00015030: 2020 2020 2023 2067 6976 6520 7468 6520       # give the 
-00015040: 6365 6c6c 2074 6865 2076 616c 7565 206f  cell the value o
-00015050: 6620 7468 6520 6365 6c6c 2074 6861 7420  f the cell that 
-00015060: 6973 2061 7420 7468 6520 6c65 6674 2054  is at the left T
-00015070: 6f70 0d0a 2020 2020 2020 2020 2020 2020  op..            
-00015080: 2020 2020 6172 7261 795b 726f 7773 5b69      array[rows[i
-00015090: 5d2c 2063 6f6c 735b 695d 5d20 3d20 6172  ], cols[i]] = ar
-000150a0: 7261 795b 726f 7773 5b69 5d20 2b20 312c  ray[rows[i] + 1,
-000150b0: 2063 6f6c 735b 695d 202d 2031 5d0d 0a0d   cols[i] - 1]...
-000150c0: 0a20 2020 2020 2020 2020 2020 2065 6c69  .            eli
-000150d0: 6620 280d 0a20 2020 2020 2020 2020 2020  f (..           
-000150e0: 2020 2020 2061 7272 6179 5b72 6f77 735b       array[rows[
-000150f0: 695d 202b 2031 2c20 636f 6c73 5b69 5d20  i] + 1, cols[i] 
-00015100: 2b20 315d 2021 3d20 6e6f 6461 7461 7661  + 1] != nodatava
-00015110: 6c75 650d 0a20 2020 2020 2020 2020 2020  lue..           
-00015120: 2020 2020 2061 6e64 2072 6f77 735b 695d       and rows[i]
-00015130: 202b 2031 203c 3d20 6e6f 5f72 6f77 730d   + 1 <= no_rows.
-00015140: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00015150: 2061 6e64 2063 6f6c 735b 695d 202b 2031   and cols[i] + 1
-00015160: 203c 3d20 6e6f 5f63 6f6c 730d 0a20 2020   <= no_cols..   
-00015170: 2020 2020 2020 2020 2029 3a0d 0a20 2020           ):..   
-00015180: 2020 2020 2020 2020 2020 2020 2023 2067               # g
-00015190: 6976 6520 7468 6520 6365 6c6c 2074 6865  ive the cell the
-000151a0: 2076 616c 7565 206f 6620 7468 6520 6365   value of the ce
-000151b0: 6c6c 2074 6861 7420 6973 2061 7420 7468  ll that is at th
-000151c0: 6520 7269 6768 7420 546f 700d 0a20 2020  e right Top..   
-000151d0: 2020 2020 2020 2020 2020 2020 2061 7272               arr
-000151e0: 6179 5b72 6f77 735b 695d 2c20 636f 6c73  ay[rows[i], cols
-000151f0: 5b69 5d5d 203d 2061 7272 6179 5b72 6f77  [i]] = array[row
-00015200: 735b 695d 202b 2031 2c20 636f 6c73 5b69  s[i] + 1, cols[i
-00015210: 5d20 2b20 315d 0d0a 2020 2020 2020 2020  ] + 1]..        
-00015220: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
-00015230: 2020 2020 2020 2020 2020 2070 7269 6e74             print
-00015240: 2822 7468 6520 6365 6c6c 2069 7320 6973  ("the cell is is
-00015250: 6f6c 6174 6564 2028 4e6f 2073 7572 726f  olated (No surro
-00015260: 756e 6469 6e67 2063 656c 6c73 2065 7869  unding cells exi
-00015270: 7374 2922 290d 0a20 2020 2020 2020 2072  st)")..        r
-00015280: 6574 7572 6e20 6172 7261 790d 0a0d 0a20  eturn array.... 
-00015290: 2020 2064 6566 206c 6f63 6174 655f 706f     def locate_po
-000152a0: 696e 7473 280d 0a20 2020 2020 2020 2073  ints(..        s
-000152b0: 656c 662c 0d0a 2020 2020 2020 2020 706f  elf,..        po
-000152c0: 696e 7473 3a20 556e 696f 6e5b 4765 6f44  ints: Union[GeoD
-000152d0: 6174 6146 7261 6d65 2c20 4665 6174 7572  ataFrame, Featur
-000152e0: 6543 6f6c 6c65 6374 696f 6e2c 2044 6174  eCollection, Dat
-000152f0: 6146 7261 6d65 5d2c 0d0a 2020 2020 2920  aFrame],..    ) 
-00015300: 2d3e 206e 702e 6e64 6172 7261 793a 0d0a  -> np.ndarray:..
-00015310: 2020 2020 2020 2020 2222 226e 6561 7265          """neare
-00015320: 7374 4365 6c6c 2e0d 0a0d 0a20 2020 2020  stCell.....     
-00015330: 2020 2020 2020 206e 6561 7265 7374 4365         nearestCe
-00015340: 6c6c 2063 616c 6375 6c61 7465 7320 7468  ll calculates th
-00015350: 6520 7468 6520 696e 6469 6365 7320 2872  e the indices (r
-00015360: 6f77 732c 2063 6f6c 2920 6f66 206e 6561  ows, col) of nea
-00015370: 7265 7374 2063 656c 6c20 696e 2061 2067  rest cell in a g
-00015380: 6976 656e 0d0a 2020 2020 2020 2020 2020  iven..          
-00015390: 2020 7261 7374 6572 2074 6f20 6120 7374    raster to a st
-000153a0: 6174 696f 6e0d 0a20 2020 2020 2020 2020  ation..         
-000153b0: 2020 2063 6f6f 7264 696e 6174 6520 7379     coordinate sy
-000153c0: 7374 656d 206f 6620 7468 6520 7261 7374  stem of the rast
-000153d0: 6572 2068 6173 2074 6f20 6265 2070 726f  er has to be pro
-000153e0: 6a65 6374 6564 2074 6f20 6265 2061 626c  jected to be abl
-000153f0: 6520 746f 2063 616c 6375 6c61 7465 0d0a  e to calculate..
-00015400: 2020 2020 2020 2020 2020 2020 7468 6520              the 
-00015410: 6469 7374 616e 6365 0d0a 0d0a 2020 2020  distance....    
-00015420: 2020 2020 5061 7261 6d65 7465 7273 0d0a      Parameters..
-00015430: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-00015440: 2d2d 0d0a 2020 2020 2020 2020 706f 696e  --..        poin
-00015450: 7473 3a20 5b44 6174 6166 7261 6d65 5d0d  ts: [Dataframe].
-00015460: 0a20 2020 2020 2020 2020 2020 2064 6174  .            dat
-00015470: 6166 7261 6d65 2077 6974 6820 504f 494e  aframe with POIN
-00015480: 5420 6765 6f6d 6574 7279 2e0d 0a0d 0a20  T geometry..... 
-00015490: 2020 2020 2020 2052 6574 7572 6e73 0d0a         Returns..
-000154a0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d0d          -------.
-000154b0: 0a20 2020 2020 2020 2061 7272 6179 3a0d  .        array:.
-000154c0: 0a20 2020 2020 2020 2020 2020 2061 7272  .            arr
-000154d0: 6179 2077 6974 6820 6120 7368 6170 6520  ay with a shape 
-000154e0: 2861 6e79 2c20 3229 2c20 666f 7220 7468  (any, 2), for th
-000154f0: 6520 726f 772c 2063 6f6c 756d 6e20 696e  e row, column in
-00015500: 6469 6365 7320 696e 2074 6865 2061 7272  dices in the arr
-00015510: 6179 2e0d 0a20 2020 2020 2020 2020 2020  ay...           
-00015520: 2061 7272 6179 285b 5b20 352c 2020 345d   array([[ 5,  4]
-00015530: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-00015540: 2020 2020 2020 5b20 322c 2020 395d 2c0d        [ 2,  9],.
-00015550: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00015560: 2020 2020 5b20 352c 2020 395d 5d29 0d0a      [ 5,  9]])..
-00015570: 2020 2020 2020 2020 2222 220d 0a20 2020          """..   
-00015580: 2020 2020 2069 6620 6973 696e 7374 616e       if isinstan
-00015590: 6365 2870 6f69 6e74 732c 2047 656f 4461  ce(points, GeoDa
-000155a0: 7461 4672 616d 6529 3a0d 0a20 2020 2020  taFrame):..     
-000155b0: 2020 2020 2020 2070 6f69 6e74 7320 3d20         points = 
-000155c0: 4665 6174 7572 6543 6f6c 6c65 6374 696f  FeatureCollectio
-000155d0: 6e28 706f 696e 7473 290d 0a20 2020 2020  n(points)..     
-000155e0: 2020 2065 6c69 6620 6973 696e 7374 616e     elif isinstan
-000155f0: 6365 2870 6f69 6e74 732c 2044 6174 6146  ce(points, DataF
-00015600: 7261 6d65 293a 0d0a 2020 2020 2020 2020  rame):..        
-00015610: 2020 2020 6966 2061 6c6c 2865 6c65 6d20      if all(elem 
-00015620: 6e6f 7420 696e 2070 6f69 6e74 732e 636f  not in points.co
-00015630: 6c75 6d6e 7320 666f 7220 656c 656d 2069  lumns for elem i
-00015640: 6e20 5b22 7822 2c20 2279 225d 293a 0d0a  n ["x", "y"]):..
-00015650: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00015660: 7261 6973 6520 5661 6c75 6545 7272 6f72  raise ValueError
-00015670: 280d 0a20 2020 2020 2020 2020 2020 2020  (..             
-00015680: 2020 2020 2020 2022 4966 2074 6865 2069         "If the i
-00015690: 6e70 7574 2069 6e20 6120 4461 7461 4672  nput in a DataFr
-000156a0: 616d 652c 2069 7420 7368 6f75 6c64 2068  ame, it should h
-000156b0: 6176 6520 7477 6f20 636f 6c75 6d6e 7320  ave two columns 
-000156c0: 782c 2061 6e64 2079 220d 0a20 2020 2020  x, and y"..     
-000156d0: 2020 2020 2020 2020 2020 2029 0d0a 2020             )..  
-000156e0: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
-000156f0: 2020 2020 2020 2020 2069 6620 6e6f 7420           if not 
-00015700: 6973 696e 7374 616e 6365 2870 6f69 6e74  isinstance(point
-00015710: 732c 2046 6561 7475 7265 436f 6c6c 6563  s, FeatureCollec
-00015720: 7469 6f6e 293a 0d0a 2020 2020 2020 2020  tion):..        
-00015730: 2020 2020 2020 2020 7261 6973 6520 5479          raise Ty
-00015740: 7065 4572 726f 7228 0d0a 2020 2020 2020  peError(..      
-00015750: 2020 2020 2020 2020 2020 2020 2020 6622                f"
-00015760: 706c 6561 7365 2063 6865 636b 2070 6f69  please check poi
-00015770: 6e74 7320 696e 7075 7420 6974 2073 686f  nts input it sho
-00015780: 756c 6420 6265 2047 656f 4461 7461 4672  uld be GeoDataFr
-00015790: 616d 652f 4665 6174 7572 6543 6f6c 6c65  ame/FeatureColle
-000157a0: 6374 696f 6e20 2d20 6769 7665 6e20 7b74  ction - given {t
-000157b0: 7970 6528 706f 696e 7473 297d 220d 0a20  ype(points)}".. 
-000157c0: 2020 2020 2020 2020 2020 2020 2020 2029                 )
-000157d0: 0d0a 2020 2020 2020 2020 6966 206e 6f74  ..        if not
-000157e0: 2069 7369 6e73 7461 6e63 6528 706f 696e   isinstance(poin
-000157f0: 7473 2c20 4461 7461 4672 616d 6529 3a0d  ts, DataFrame):.
-00015800: 0a20 2020 2020 2020 2020 2020 2023 2067  .            # g
-00015810: 6574 2074 6865 2078 2c20 7920 636f 6f72  et the x, y coor
-00015820: 6469 6e61 7465 732e 0d0a 2020 2020 2020  dinates...      
-00015830: 2020 2020 2020 706f 696e 7473 2e78 7928        points.xy(
-00015840: 290d 0a20 2020 2020 2020 2020 2020 2070  )..            p
-00015850: 6f69 6e74 7320 3d20 706f 696e 7473 2e66  oints = points.f
-00015860: 6561 7475 7265 2e6c 6f63 5b3a 2c20 5b22  eature.loc[:, ["
-00015870: 7822 2c20 2279 225d 5d2e 7661 6c75 6573  x", "y"]].values
-00015880: 0d0a 2020 2020 2020 2020 656c 7365 3a0d  ..        else:.
-00015890: 0a20 2020 2020 2020 2020 2020 2070 6f69  .            poi
-000158a0: 6e74 7320 3d20 706f 696e 7473 2e6c 6f63  nts = points.loc
-000158b0: 5b3a 2c20 5b22 7822 2c20 2279 225d 5d2e  [:, ["x", "y"]].
-000158c0: 7661 6c75 6573 0d0a 0d0a 2020 2020 2020  values....      
-000158d0: 2020 2320 7369 6e63 6520 6669 7273 7420    # since first 
-000158e0: 726f 7720 6973 2078 2d63 6f6f 7264 7320  row is x-coords 
-000158f0: 736f 2074 6865 2066 6972 7374 2063 6f6c  so the first col
-00015900: 756d 6e20 696e 2074 6865 2069 6e64 6963  umn in the indic
-00015910: 6573 2069 7320 7468 6520 636f 6c75 6d6e  es is the column
-00015920: 2069 6e64 6578 0d0a 2020 2020 2020 2020   index..        
-00015930: 696e 6469 6365 7320 3d20 6c6f 6361 7465  indices = locate
-00015940: 5f76 616c 7565 7328 706f 696e 7473 2c20  _values(points, 
-00015950: 7365 6c66 2e78 2c20 7365 6c66 2e79 290d  self.x, self.y).
-00015960: 0a20 2020 2020 2020 2023 2072 6561 7272  .        # rearr
-00015970: 616e 6765 2074 6865 2063 6f6c 756d 6e73  ange the columns
-00015980: 2074 6f20 6d61 6b65 2074 6865 2072 6f77   to make the row
-00015990: 2069 6e64 6578 2066 6972 7374 0d0a 2020   index first..  
-000159a0: 2020 2020 2020 696e 6469 6365 7320 3d20        indices = 
-000159b0: 696e 6469 6365 735b 3a2c 205b 312c 2030  indices[:, [1, 0
-000159c0: 5d5d 0d0a 2020 2020 2020 2020 7265 7475  ]]..        retu
-000159d0: 726e 2069 6e64 6963 6573 0d0a 0d0a 2020  rn indices....  
-000159e0: 2020 6465 6620 6578 7472 6163 7428 0d0a    def extract(..
-000159f0: 2020 2020 2020 2020 7365 6c66 2c0d 0a20          self,.. 
-00015a00: 2020 2020 2020 2065 7863 6c75 6465 5f76         exclude_v
-00015a10: 616c 7565 3a20 416e 7920 3d20 4e6f 6e65  alue: Any = None
-00015a20: 2c0d 0a20 2020 2020 2020 2066 6561 7475  ,..        featu
-00015a30: 7265 3a20 556e 696f 6e5b 4665 6174 7572  re: Union[Featur
-00015a40: 6543 6f6c 6c65 6374 696f 6e2c 2047 656f  eCollection, Geo
-00015a50: 4461 7461 4672 616d 655d 203d 204e 6f6e  DataFrame] = Non
-00015a60: 652c 0d0a 2020 2020 2920 2d3e 204c 6973  e,..    ) -> Lis
-00015a70: 743a 0d0a 2020 2020 2020 2020 2222 2245  t:..        """E
-00015a80: 7874 7261 6374 2e0d 0a0d 0a20 2020 2020  xtract.....     
-00015a90: 2020 2020 2020 202d 2045 7874 7261 6374         - Extract
-00015aa0: 206d 6574 686f 6420 6765 7420 616c 6c20   method get all 
-00015ab0: 7468 6520 7661 6c75 6573 2069 6e20 6120  the values in a 
-00015ac0: 7261 7374 6572 2c20 616e 6420 6578 636c  raster, and excl
-00015ad0: 7564 6520 7468 6520 7661 6c75 6573 2069  ude the values i
-00015ae0: 6e20 7468 6520 6578 636c 7564 655f 7661  n the exclude_va
-00015af0: 6c75 6520 7061 7261 6d65 7465 722e 0d0a  lue parameter...
-00015b00: 2020 2020 2020 2020 2020 2020 2d20 4966              - If
-00015b10: 2074 6865 2066 6561 7475 7265 2070 6172   the feature par
-00015b20: 616d 6574 6572 2069 7320 6769 7665 6e20  ameter is given 
-00015b30: 7468 6520 7261 7374 6572 2077 696c 6c20  the raster will 
-00015b40: 6265 2063 6c69 7065 6420 746f 2074 6865  be cliped to the
-00015b50: 2065 7874 656e 7420 6f66 2074 6865 2067   extent of the g
-00015b60: 6976 656e 2066 6561 7475 7265 2061 6e64  iven feature and
-00015b70: 2074 6865 0d0a 2020 2020 2020 2020 2020   the..          
-00015b80: 2020 7661 6c75 6573 2077 6974 6869 6e20    values within 
-00015b90: 7468 6520 6665 6174 7572 6520 6172 6520  the feature are 
-00015ba0: 6578 7472 6163 7465 642e 0d0a 0d0a 2020  extracted.....  
-00015bb0: 2020 2020 2020 5061 7261 6d65 7465 7273        Parameters
-00015bc0: 0d0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ..        ------
-00015bd0: 2d2d 2d2d 0d0a 2020 2020 2020 2020 6578  ----..        ex
-00015be0: 636c 7564 655f 7661 6c75 653a 205b 4e75  clude_value: [Nu
-00015bf0: 6d65 7269 635d 0d0a 2020 2020 2020 2020  meric]..        
-00015c00: 2020 2020 7661 6c75 6573 2079 6f75 2077      values you w
-00015c10: 616e 7420 746f 2065 7863 6c75 6465 2066  ant to exclude f
-00015c20: 726f 6d20 6578 7465 6163 7465 6420 7661  rom exteacted va
-00015c30: 6c75 6573 0d0a 2020 2020 2020 2020 6665  lues..        fe
-00015c40: 6174 7572 653a 205b 4665 6174 7572 6543  ature: [FeatureC
-00015c50: 6f6c 6c65 6374 696f 6e2f 4765 6f44 6174  ollection/GeoDat
-00015c60: 6146 7261 6d65 5d0d 0a20 2020 2020 2020  aFrame]..       
-00015c70: 2020 2020 2076 6563 746f 7220 6669 6c65       vector file
-00015c80: 2063 6f6e 7461 696e 7320 6765 6f6d 6574   contains geomet
-00015c90: 7269 6573 2079 6f75 2077 616e 7420 746f  ries you want to
-00015ca0: 2065 7874 7261 6374 2074 6865 2076 616c   extract the val
-00015cb0: 7565 7320 6174 2074 6865 6972 206c 6f63  ues at their loc
-00015cc0: 6174 696f 6e2e 2044 6566 6175 6c74 2069  ation. Default i
-00015cd0: 7320 4e6f 6e65 2e0d 0a20 2020 2020 2020  s None...       
-00015ce0: 2022 2222 0d0a 2020 2020 2020 2020 6172   """..        ar
-00015cf0: 7220 3d20 7365 6c66 2e72 6561 645f 6172  r = self.read_ar
-00015d00: 7261 7928 290d 0a20 2020 2020 2020 206e  ray()..        n
-00015d10: 6f5f 6461 7461 5f76 616c 7565 203d 2028  o_data_value = (
-00015d20: 0d0a 2020 2020 2020 2020 2020 2020 7365  ..            se
-00015d30: 6c66 2e6e 6f5f 6461 7461 5f76 616c 7565  lf.no_data_value
-00015d40: 5b30 5d20 6966 2073 656c 662e 6e6f 5f64  [0] if self.no_d
-00015d50: 6174 615f 7661 6c75 655b 305d 2069 7320  ata_value[0] is 
-00015d60: 6e6f 7420 4e6f 6e65 2065 6c73 6520 6e70  not None else np
-00015d70: 2e6e 616e 0d0a 2020 2020 2020 2020 290d  .nan..        ).
-00015d80: 0a20 2020 2020 2020 2069 6620 6665 6174  .        if feat
-00015d90: 7572 6520 6973 204e 6f6e 653a 0d0a 2020  ure is None:..  
-00015da0: 2020 2020 2020 2020 2020 6d61 736b 203d            mask =
-00015db0: 2028 0d0a 2020 2020 2020 2020 2020 2020   (..            
-00015dc0: 2020 2020 5b6e 6f5f 6461 7461 5f76 616c      [no_data_val
-00015dd0: 7565 2c20 6578 636c 7564 655f 7661 6c75  ue, exclude_valu
-00015de0: 655d 0d0a 2020 2020 2020 2020 2020 2020  e]..            
-00015df0: 2020 2020 6966 2065 7863 6c75 6465 5f76      if exclude_v
-00015e00: 616c 7565 2069 7320 6e6f 7420 4e6f 6e65  alue is not None
-00015e10: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00015e20: 2020 656c 7365 205b 6e6f 5f64 6174 615f    else [no_data_
-00015e30: 7661 6c75 655d 0d0a 2020 2020 2020 2020  value]..        
-00015e40: 2020 2020 290d 0a20 2020 2020 2020 2020      )..         
-00015e50: 2020 2076 616c 7565 7320 3d20 6765 745f     values = get_
-00015e60: 7069 7865 6c73 3228 6172 722c 206d 6173  pixels2(arr, mas
-00015e70: 6b29 0d0a 2020 2020 2020 2020 656c 7365  k)..        else
-00015e80: 3a0d 0a20 2020 2020 2020 2020 2020 2069  :..            i
-00015e90: 6e64 6963 6573 203d 2073 656c 662e 6c6f  ndices = self.lo
-00015ea0: 6361 7465 5f70 6f69 6e74 7328 6665 6174  cate_points(feat
-00015eb0: 7572 6529 0d0a 2020 2020 2020 2020 2020  ure)..          
-00015ec0: 2020 7661 6c75 6573 203d 2061 7272 5b69    values = arr[i
-00015ed0: 6e64 6963 6573 5b3a 2c20 305d 2c20 696e  ndices[:, 0], in
-00015ee0: 6469 6365 735b 3a2c 2031 5d5d 0d0a 2020  dices[:, 1]]..  
-00015ef0: 2020 2020 2020 7265 7475 726e 2076 616c        return val
-00015f00: 7565 730d 0a0d 0a20 2020 2064 6566 206f  ues....    def o
-00015f10: 7665 726c 6179 280d 0a20 2020 2020 2020  verlay(..       
-00015f20: 2073 656c 662c 0d0a 2020 2020 2020 2020   self,..        
-00015f30: 636c 6173 7365 735f 6d61 702c 0d0a 2020  classes_map,..  
-00015f40: 2020 2020 2020 6261 6e64 3a20 696e 7420        band: int 
-00015f50: 3d20 302c 0d0a 2020 2020 2020 2020 6578  = 0,..        ex
-00015f60: 636c 7564 655f 7661 6c75 653a 2055 6e69  clude_value: Uni
-00015f70: 6f6e 5b66 6c6f 6174 2c20 696e 745d 203d  on[float, int] =
-00015f80: 204e 6f6e 652c 0d0a 2020 2020 2920 2d3e   None,..    ) ->
-00015f90: 2044 6963 745b 4c69 7374 5b66 6c6f 6174   Dict[List[float
-00015fa0: 5d2c 204c 6973 745b 666c 6f61 745d 5d3a  ], List[float]]:
-00015fb0: 0d0a 2020 2020 2020 2020 2222 224f 7665  ..        """Ove
-00015fc0: 726c 6179 2e0d 0a0d 0a20 2020 2020 2020  rlay.....       
-00015fd0: 2020 2020 206f 7665 726c 6179 2065 7874       overlay ext
-00015fe0: 7261 6374 7320 616c 6c20 7468 6520 7661  racts all the va
-00015ff0: 6c75 6573 2069 6e20 7261 7374 6572 2066  lues in raster f
-00016000: 696c 652c 2069 6620 796f 7520 6861 7665  ile, if you have
-00016010: 2074 776f 206d 6170 7320 6f6e 6520 7769   two maps one wi
-00016020: 7468 2063 6c61 7373 6573 2c20 616e 6420  th classes, and 
-00016030: 7468 6520 6f74 6865 7220 6d61 700d 0a20  the other map.. 
-00016040: 2020 2020 2020 2020 2020 2063 6f6e 7461             conta
-00016050: 696e 7320 616e 7920 7479 7065 206f 6620  ins any type of 
-00016060: 7661 6c75 6573 2c20 616e 6420 796f 7520  values, and you 
-00016070: 7761 6e74 2074 6f20 6b6e 6f77 2074 6865  want to know the
-00016080: 2076 616c 7565 7320 696e 2065 6163 6820   values in each 
-00016090: 636c 6173 732e 0d0a 0d0a 2020 2020 2020  class.....      
-000160a0: 2020 5061 7261 6d65 7465 7273 0d0a 2020    Parameters..  
-000160b0: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
-000160c0: 0d0a 2020 2020 2020 2020 636c 6173 7365  ..        classe
-000160d0: 735f 6d61 703a 205b 4461 7461 7365 745d  s_map: [Dataset]
-000160e0: 0d0a 2020 2020 2020 2020 2020 2020 4461  ..            Da
-000160f0: 7461 7365 7420 4f62 6a65 6374 2066 6f72  taset Object for
-00016100: 2074 6865 2072 6173 7465 7220 7468 6174   the raster that
-00016110: 2068 6176 6520 636c 6173 7365 7320 796f   have classes yo
-00016120: 7520 7761 6e74 2074 6f20 6f76 6572 6c61  u want to overla
-00016130: 7920 7769 7468 2074 6865 2072 6173 7465  y with the raste
-00016140: 722e 0d0a 2020 2020 2020 2020 6261 6e64  r...        band
-00016150: 3a20 5b69 6e74 5d0d 0a20 2020 2020 2020  : [int]..       
-00016160: 2020 2020 2069 6620 7468 6520 7261 7374       if the rast
-00016170: 6572 2069 7320 6d75 6c74 692d 6261 6e64  er is multi-band
-00016180: 2072 6173 7465 7220 6368 6f6f 7365 2074   raster choose t
-00016190: 6865 2062 616e 6420 796f 7520 7761 6e74  he band you want
-000161a0: 2074 6f20 6f76 6572 6c61 7920 7769 7468   to overlay with
-000161b0: 2074 6865 2063 6c61 7373 6573 206d 6170   the classes map
-000161c0: 2e20 4465 6661 756c 7420 6973 2030 2e0d  . Default is 0..
-000161d0: 0a20 2020 2020 2020 2065 7863 6c75 6465  .        exclude
-000161e0: 5f76 616c 7565 3a20 5b4e 756d 6572 6963  _value: [Numeric
-000161f0: 5d0d 0a20 2020 2020 2020 2020 2020 2076  ]..            v
-00016200: 616c 7565 7320 796f 7520 7761 6e74 2074  alues you want t
-00016210: 6f20 6578 636c 7564 6520 6672 6f6d 2065  o exclude from e
-00016220: 7874 7261 6374 6564 2076 616c 7565 732e  xtracted values.
-00016230: 0d0a 0d0a 2020 2020 2020 2020 5265 7475  ....        Retu
-00016240: 726e 730d 0a20 2020 2020 2020 202d 2d2d  rns..        ---
-00016250: 2d2d 2d2d 0d0a 2020 2020 2020 2020 4469  ----..        Di
-00016260: 6374 696f 6e61 7279 3a0d 0a20 2020 2020  ctionary:..     
-00016270: 2020 2020 2020 2064 6963 746f 6e61 7279         dictonary
-00016280: 2077 6974 6820 6120 6c69 7374 206f 6620   with a list of 
-00016290: 7661 6c75 6573 2069 6e20 7468 6520 6261  values in the ba
-000162a0: 7365 6d61 7020 6173 206b 6579 7320 616e  semap as keys an
-000162b0: 6420 666f 7220 6561 6368 206b 6579 2061  d for each key a
-000162c0: 206c 6973 7420 6f66 2061 6c6c 2074 6865   list of all the
-000162d0: 2069 6e74 6572 7365 6374 6564 0d0a 2020   intersected..  
-000162e0: 2020 2020 2020 2020 2020 7661 6c75 6573            values
-000162f0: 2069 6e20 7468 6520 6d61 7073 2066 726f   in the maps fro
-00016300: 6d20 7468 6520 7061 7468 2e0d 0a20 2020  m the path...   
-00016310: 2020 2020 2022 2222 0d0a 2020 2020 2020       """..      
-00016320: 2020 6966 206e 6f74 2073 656c 662e 5f63    if not self._c
-00016330: 6865 636b 5f61 6c69 676e 6d65 6e74 2863  heck_alignment(c
-00016340: 6c61 7373 6573 5f6d 6170 293a 0d0a 2020  lasses_map):..  
-00016350: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-00016360: 416c 6967 6e6d 656e 7445 7272 6f72 280d  AlignmentError(.
-00016370: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00016380: 2022 5468 6520 636c 6173 7320 4461 7461   "The class Data
-00016390: 7365 7420 6973 206e 6f74 2061 6c69 676e  set is not align
-000163a0: 6564 2077 6974 6820 7468 6520 6375 7272  ed with the curr
-000163b0: 656e 7420 7261 7374 6572 2c20 706c 6173  ent raster, plas
-000163c0: 6520 7573 6520 7468 6520 6d65 7468 6f64  e use the method
-000163d0: 2022 0d0a 2020 2020 2020 2020 2020 2020   "..            
-000163e0: 2020 2020 2227 616c 6967 6e27 2074 6f20      "'align' to 
-000163f0: 616c 6967 6e20 626f 7468 2072 6173 7465  align both raste
-00016400: 7273 2e22 0d0a 2020 2020 2020 2020 2020  rs."..          
-00016410: 2020 290d 0a20 2020 2020 2020 2061 7272    )..        arr
-00016420: 203d 2073 656c 662e 7265 6164 5f61 7272   = self.read_arr
-00016430: 6179 2862 616e 643d 6261 6e64 290d 0a20  ay(band=band).. 
-00016440: 2020 2020 2020 206e 6f5f 6461 7461 5f76         no_data_v
-00016450: 616c 7565 203d 2028 0d0a 2020 2020 2020  alue = (..      
-00016460: 2020 2020 2020 7365 6c66 2e6e 6f5f 6461        self.no_da
-00016470: 7461 5f76 616c 7565 5b30 5d20 6966 2073  ta_value[0] if s
-00016480: 656c 662e 6e6f 5f64 6174 615f 7661 6c75  elf.no_data_valu
-00016490: 655b 305d 2069 7320 6e6f 7420 4e6f 6e65  e[0] is not None
-000164a0: 2065 6c73 6520 6e70 2e6e 616e 0d0a 2020   else np.nan..  
-000164b0: 2020 2020 2020 290d 0a20 2020 2020 2020        )..       
-000164c0: 206d 6173 6b20 3d20 280d 0a20 2020 2020   mask = (..     
-000164d0: 2020 2020 2020 205b 6e6f 5f64 6174 615f         [no_data_
-000164e0: 7661 6c75 652c 2065 7863 6c75 6465 5f76  value, exclude_v
-000164f0: 616c 7565 5d0d 0a20 2020 2020 2020 2020  alue]..         
-00016500: 2020 2069 6620 6578 636c 7564 655f 7661     if exclude_va
-00016510: 6c75 6520 6973 206e 6f74 204e 6f6e 650d  lue is not None.
-00016520: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
-00016530: 6520 5b6e 6f5f 6461 7461 5f76 616c 7565  e [no_data_value
-00016540: 5d0d 0a20 2020 2020 2020 2029 0d0a 2020  ]..        )..  
-00016550: 2020 2020 2020 696e 6420 3d20 6765 745f        ind = get_
-00016560: 696e 6469 6365 7332 2861 7272 2c20 6d61  indices2(arr, ma
-00016570: 736b 290d 0a20 2020 2020 2020 2063 6c61  sk)..        cla
-00016580: 7373 6573 203d 2063 6c61 7373 6573 5f6d  sses = classes_m
-00016590: 6170 2e72 6561 645f 6172 7261 7928 290d  ap.read_array().
-000165a0: 0a20 2020 2020 2020 2076 616c 7565 7320  .        values 
-000165b0: 3d20 6469 6374 2829 0d0a 0d0a 2020 2020  = dict()....    
-000165c0: 2020 2020 2320 6578 7472 6163 7420 7661      # extract va
-000165d0: 6c75 6573 0d0a 2020 2020 2020 2020 666f  lues..        fo
-000165e0: 7220 692c 2069 6e64 5f69 2069 6e20 656e  r i, ind_i in en
-000165f0: 756d 6572 6174 6528 696e 6429 3a0d 0a20  umerate(ind):.. 
-00016600: 2020 2020 2020 2020 2020 2023 2066 6972             # fir
-00016610: 7374 2063 6865 636b 2069 6620 7468 6520  st check if the 
-00016620: 7375 622d 6261 7369 6e20 6861 7320 6120  sub-basin has a 
-00016630: 6c69 7374 2069 6e20 7468 6520 6469 6374  list in the dict
-00016640: 2069 6620 6e6f 7420 6372 6561 7465 2061   if not create a
-00016650: 206c 6973 740d 0a20 2020 2020 2020 2020   list..         
-00016660: 2020 206b 6579 203d 2063 6c61 7373 6573     key = classes
-00016670: 5b69 6e64 5f69 5b30 5d2c 2069 6e64 5f69  [ind_i[0], ind_i
-00016680: 5b31 5d5d 0d0a 2020 2020 2020 2020 2020  [1]]..          
-00016690: 2020 6966 206b 6579 206e 6f74 2069 6e20    if key not in 
-000166a0: 6c69 7374 2876 616c 7565 732e 6b65 7973  list(values.keys
-000166b0: 2829 293a 0d0a 2020 2020 2020 2020 2020  ()):..          
-000166c0: 2020 2020 2020 7661 6c75 6573 5b6b 6579        values[key
-000166d0: 5d20 3d20 6c69 7374 2829 0d0a 0d0a 2020  ] = list()....  
-000166e0: 2020 2020 2020 2020 2020 7661 6c75 6573            values
-000166f0: 5b6b 6579 5d2e 6170 7065 6e64 2861 7272  [key].append(arr
-00016700: 5b69 6e64 5f69 5b30 5d2c 2069 6e64 5f69  [ind_i[0], ind_i
-00016710: 5b31 5d5d 290d 0a0d 0a20 2020 2020 2020  [1]])....       
-00016720: 2072 6574 7572 6e20 7661 6c75 6573 0d0a   return values..
-00016730: 0d0a 2020 2020 6465 6620 666f 6f74 7072  ..    def footpr
-00016740: 696e 7428 0d0a 2020 2020 2020 2020 7365  int(..        se
-00016750: 6c66 2c0d 0a20 2020 2020 2020 2062 616e  lf,..        ban
-00016760: 643a 2069 6e74 203d 2030 2c0d 0a20 2020  d: int = 0,..   
-00016770: 2020 2020 2065 7863 6c75 6465 5f76 616c       exclude_val
-00016780: 7565 733a 204f 7074 696f 6e61 6c5b 4c69  ues: Optional[Li
-00016790: 7374 5b41 6e79 5d5d 203d 204e 6f6e 652c  st[Any]] = None,
-000167a0: 0d0a 2020 2020 2920 2d3e 2055 6e69 6f6e  ..    ) -> Union
-000167b0: 5b47 656f 4461 7461 4672 616d 652c 204e  [GeoDataFrame, N
-000167c0: 6f6e 655d 3a0d 0a20 2020 2020 2020 2022  one]:..        "
-000167d0: 2222 666f 6f74 7072 696e 742e 0d0a 0d0a  ""footprint.....
-000167e0: 2020 2020 2020 2020 2020 2020 6578 7472              extr
-000167f0: 6163 745f 6578 7465 6e74 2074 616b 6573  act_extent takes
-00016800: 2061 2067 6461 6c20 7261 7374 6572 206f   a gdal raster o
-00016810: 626a 6563 7420 616e 6420 7265 7475 726e  bject and return
-00016820: 730d 0a0d 0a20 2020 2020 2020 2050 6172  s....        Par
-00016830: 616d 6574 6572 730d 0a20 2020 2020 2020  ameters..       
-00016840: 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020   ----------..   
-00016850: 2020 2020 2062 616e 643a 205b 696e 745d       band: [int]
-00016860: 0d0a 2020 2020 2020 2020 2020 2020 6261  ..            ba
-00016870: 6e64 2069 6e64 6578 2e20 4465 6661 756c  nd index. Defaul
-00016880: 7420 6973 2030 2e0d 0a20 2020 2020 2020  t is 0...       
-00016890: 2065 7863 6c75 6465 5f76 616c 7565 733a   exclude_values:
-000168a0: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
-000168b0: 2079 6f75 2077 616e 7420 746f 2065 7863   you want to exc
-000168c0: 6c75 6465 5f76 616c 7565 7320 6120 6365  lude_values a ce
-000168d0: 7274 6169 6e20 7661 6c75 6520 696e 2074  rtain value in t
-000168e0: 6865 2072 6173 7465 7220 7769 7468 2061  he raster with a
-000168f0: 6e6f 7468 6572 2076 616c 7565 2069 6e74  nother value int
-00016900: 6572 2074 6865 2074 776f 2076 616c 7565  er the two value
-00016910: 7320 6173 2061 206c 6973 7420 6f66 2074  s as a list of t
-00016920: 7570 6c65 7320 610d 0a20 2020 2020 2020  uples a..       
-00016930: 2020 2020 205b 2876 616c 7565 5f74 6f5f       [(value_to_
-00016940: 6265 5f65 7863 6c75 6465 5f76 616c 7565  be_exclude_value
-00016950: 7364 2c20 6e65 775f 7661 6c75 6529 5d0d  sd, new_value)].
-00016960: 0a20 2020 2020 2020 2020 2020 203e 3e3e  .            >>>
-00016970: 2065 7863 6c75 6465 5f76 616c 7565 7320   exclude_values 
-00016980: 3d20 5b30 5d0d 0a20 2020 2020 2020 2020  = [0]..         
-00016990: 2020 202d 2054 6869 7320 7061 7261 6d65     - This parame
-000169a0: 7465 7220 6973 2069 6e74 726f 6475 6365  ter is introduce
-000169b0: 6420 7061 7274 6963 756c 6172 6c79 2066  d particularly f
-000169c0: 6f72 2074 6865 2063 6173 6520 6f66 2072  or the case of r
-000169d0: 6173 7465 7273 2074 6861 7420 6861 7320  asters that has 
-000169e0: 7468 6520 6e6f 6461 7461 7661 6c75 6520  the nodatavalue 
-000169f0: 7374 6f72 6564 2069 6e20 7468 650d 0a20  stored in the.. 
-00016a00: 2020 2020 2020 2020 2020 2061 7272 6179             array
-00016a10: 2064 6f65 7320 6e6f 7420 6d61 7463 6820   does not match 
-00016a20: 7468 6520 7661 6c75 6520 7374 6f72 6564  the value stored
-00016a30: 2069 6e20 6172 7261 792c 2073 6f20 7468   in array, so th
-00016a40: 6973 206f 7074 696f 6e20 6361 6e20 636f  is option can co
-00016a50: 7272 6563 7420 7468 6973 2062 6568 6176  rrect this behav
-00016a60: 696f 722e 0d0a 0d0a 2020 2020 2020 2020  ior.....        
-00016a70: 5265 7475 726e 730d 0a20 2020 2020 2020  Returns..       
-00016a80: 202d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020   -------..      
-00016a90: 2020 4765 6f44 6174 6146 7261 6d65 3a0d    GeoDataFrame:.
-00016aa0: 0a20 2020 2020 2020 2020 2020 202d 2067  .            - g
-00016ab0: 656f 6461 7461 6672 616d 6520 636f 6e74  eodataframe cont
-00016ac0: 6169 6e69 6e67 2074 6865 2070 6f6c 7967  aining the polyg
-00016ad0: 6f6e 2072 6570 7265 7365 6e74 696e 6720  on representing 
-00016ae0: 7468 6520 6578 7465 6e74 206f 6620 7468  the extent of th
-00016af0: 6520 7261 7374 6572 2e20 7468 6520 6578  e raster. the ex
-00016b00: 7465 6e74 2063 6f6c 756d 6e20 7368 6f75  tent column shou
-00016b10: 6c64 0d0a 2020 2020 2020 2020 2020 2020  ld..            
-00016b20: 636f 6e74 6169 6e73 2061 2076 616c 7565  contains a value
-00016b30: 206f 6620 2032 206f 6e6c 792e 0d0a 2020   of  2 only...  
-00016b40: 2020 2020 2020 2020 2020 2d20 6966 2074            - if t
-00016b50: 6865 2064 6174 6173 6574 2068 6164 2073  he dataset had s
-00016b60: 6570 6172 6174 6520 706f 6c79 676f 6e73  eparate polygons
-00016b70: 2065 6163 6820 706f 6c79 676f 6e20 7769   each polygon wi
-00016b80: 6c6c 2062 6520 696e 2061 2073 6570 6172  ll be in a separ
-00016b90: 6174 6520 726f 772e 0d0a 2020 2020 2020  ate row...      
-00016ba0: 2020 2222 220d 0a20 2020 2020 2020 2061    """..        a
-00016bb0: 7272 203d 2073 656c 662e 7265 6164 5f61  rr = self.read_a
-00016bc0: 7272 6179 2862 616e 643d 6261 6e64 290d  rray(band=band).
-00016bd0: 0a20 2020 2020 2020 206e 6f5f 6461 7461  .        no_data
-00016be0: 5f76 616c 203d 2073 656c 662e 6e6f 5f64  _val = self.no_d
-00016bf0: 6174 615f 7661 6c75 655b 6261 6e64 5d0d  ata_value[band].
-00016c00: 0a0d 0a20 2020 2020 2020 2069 6620 6e6f  ...        if no
-00016c10: 5f64 6174 615f 7661 6c20 6973 204e 6f6e  _data_val is Non
-00016c20: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
-00016c30: 6966 206e 6f74 2028 6e70 2e69 736e 616e  if not (np.isnan
-00016c40: 2861 7272 2929 2e61 6e79 2829 3a0d 0a20  (arr)).any():.. 
-00016c50: 2020 2020 2020 2020 2020 2020 2020 206c                 l
-00016c60: 6f67 6765 722e 7761 726e 696e 6728 0d0a  ogger.warning(..
-00016c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016c80: 2020 2020 2274 6865 206e 6f64 6174 6120      "the nodata 
-00016c90: 7661 6c75 6573 2073 746f 7265 6420 696e  values stored in
-00016ca0: 2074 6865 2072 6173 7465 7220 646f 6573   the raster does
-00016cb0: 206e 6f74 2065 7869 7374 2069 6e20 7468   not exist in th
-00016cc0: 6520 7261 7374 6572 2022 0d0a 2020 2020  e raster "..    
-00016cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016ce0: 2273 6f20 6569 7468 6572 2074 6865 2072  "so either the r
-00016cf0: 6173 7465 7220 6578 7465 6e74 2069 7320  aster extent is 
-00016d00: 616c 6c20 6675 6c6c 2077 6974 6820 6461  all full with da
-00016d10: 7461 206f 7220 7468 6520 6e6f 6461 7461  ta or the nodata
-00016d20: 7661 6c75 6520 7374 6f72 6564 2069 6e20  value stored in 
-00016d30: 7468 6520 7261 7374 6572 2069 7322 0d0a  the raster is"..
-00016d40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016d50: 2020 2020 2220 6e6f 7420 636f 7272 6563      " not correc
-00016d60: 7422 0d0a 2020 2020 2020 2020 2020 2020  t"..            
-00016d70: 2020 2020 290d 0a20 2020 2020 2020 2065      )..        e
-00016d80: 6c73 653a 0d0a 2020 2020 2020 2020 2020  lse:..          
-00016d90: 2020 6966 206e 6f74 2028 6e70 2e69 7363    if not (np.isc
-00016da0: 6c6f 7365 2861 7272 2c20 6e6f 5f64 6174  lose(arr, no_dat
-00016db0: 615f 7661 6c2c 2072 746f 6c3d 302e 3030  a_val, rtol=0.00
-00016dc0: 3030 3129 292e 616e 7928 293a 0d0a 2020  001)).any():..  
-00016dd0: 2020 2020 2020 2020 2020 2020 2020 6c6f                lo
-00016de0: 6767 6572 2e77 6172 6e69 6e67 280d 0a20  gger.warning(.. 
-00016df0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016e00: 2020 2022 7468 6520 6e6f 6461 7461 2076     "the nodata v
-00016e10: 616c 7565 7320 7374 6f72 6564 2069 6e20  alues stored in 
-00016e20: 7468 6520 7261 7374 6572 2064 6f65 7320  the raster does 
-00016e30: 6e6f 7420 6578 6973 7420 696e 2074 6865  not exist in the
-00016e40: 2072 6173 7465 7220 220d 0a20 2020 2020   raster "..     
-00016e50: 2020 2020 2020 2020 2020 2020 2020 2022                 "
-00016e60: 736f 2065 6974 6865 7220 7468 6520 7261  so either the ra
-00016e70: 7374 6572 2065 7874 656e 7420 6973 2061  ster extent is a
-00016e80: 6c6c 2066 756c 6c20 7769 7468 2064 6174  ll full with dat
-00016e90: 6120 6f72 2074 6865 206e 6f64 6174 6176  a or the nodatav
-00016ea0: 616c 7565 2073 746f 7265 6420 696e 2074  alue stored in t
-00016eb0: 6865 2072 6173 7465 7220 6973 220d 0a20  he raster is".. 
-00016ec0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00016ed0: 2020 2022 206e 6f74 2063 6f72 7265 6374     " not correct
-00016ee0: 220d 0a20 2020 2020 2020 2020 2020 2020  "..             
-00016ef0: 2020 2029 0d0a 2020 2020 2020 2020 2320     )..        # 
-00016f00: 6966 2079 6f75 2077 616e 7420 746f 2065  if you want to e
-00016f10: 7863 6c75 6465 5f76 616c 7565 7320 616e  xclude_values an
-00016f20: 7920 7661 6c75 6520 696e 2074 6865 2072  y value in the r
-00016f30: 6173 7465 720d 0a20 2020 2020 2020 2069  aster..        i
-00016f40: 6620 6578 636c 7564 655f 7661 6c75 6573  f exclude_values
-00016f50: 3a0d 0a20 2020 2020 2020 2020 2020 2066  :..            f
-00016f60: 6f72 2076 616c 2069 6e20 6578 636c 7564  or val in exclud
-00016f70: 655f 7661 6c75 6573 3a0d 0a20 2020 2020  e_values:..     
-00016f80: 2020 2020 2020 2020 2020 2074 7279 3a0d             try:.
-00016f90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00016fa0: 2020 2020 2023 2069 6e20 6361 7365 2074       # in case t
-00016fb0: 6865 2076 616c 3220 6973 204e 6f6e 6520  he val2 is None 
-00016fc0: 616e 6420 7468 6520 6172 7261 7920 6973  and the array is
-00016fd0: 2069 6e74 2074 7970 6520 7468 6520 666f   int type the fo
-00016fe0: 6c6c 6f77 696e 6720 6c69 6e65 2077 696c  llowing line wil
-00016ff0: 6c20 6769 7665 2065 7272 6f72 2061 7320  l give error as 
-00017000: 4e6f 6e65 0d0a 2020 2020 2020 2020 2020  None..          
-00017010: 2020 2020 2020 2020 2020 2320 6973 2063            # is c
-00017020: 6f6e 7369 6465 7265 6420 6173 2066 6c6f  onsidered as flo
-00017030: 6174 0d0a 2020 2020 2020 2020 2020 2020  at..            
-00017040: 2020 2020 2020 2020 6172 725b 6e70 2e69          arr[np.i
-00017050: 7363 6c6f 7365 2861 7272 2c20 7661 6c29  sclose(arr, val)
-00017060: 5d20 3d20 6e6f 5f64 6174 615f 7661 6c0d  ] = no_data_val.
-00017070: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00017080: 2065 7863 6570 7420 5479 7065 4572 726f   except TypeErro
-00017090: 723a 0d0a 2020 2020 2020 2020 2020 2020  r:..            
-000170a0: 2020 2020 2020 2020 6172 7220 3d20 6172          arr = ar
-000170b0: 722e 6173 7479 7065 286e 702e 666c 6f61  r.astype(np.floa
-000170c0: 7433 3229 0d0a 2020 2020 2020 2020 2020  t32)..          
-000170d0: 2020 2020 2020 2020 2020 6172 725b 6e70            arr[np
-000170e0: 2e69 7363 6c6f 7365 2861 7272 2c20 7661  .isclose(arr, va
-000170f0: 6c29 5d20 3d20 6e6f 5f64 6174 615f 7661  l)] = no_data_va
-00017100: 6c0d 0a0d 0a20 2020 2020 2020 2023 2072  l....        # r
-00017110: 6570 6c61 6365 2061 6c6c 2074 6865 2076  eplace all the v
-00017120: 616c 7565 7320 7769 7468 2032 0d0a 2020  alues with 2..  
-00017130: 2020 2020 2020 6966 206e 6f5f 6461 7461        if no_data
-00017140: 5f76 616c 2069 7320 4e6f 6e65 3a0d 0a20  _val is None:.. 
-00017150: 2020 2020 2020 2020 2020 2023 2063 6865             # che
-00017160: 636b 2069 6620 7468 6520 7768 6f6c 6520  ck if the whole 
-00017170: 7261 7374 6572 2069 7320 6675 6c6c 206f  raster is full o
-00017180: 6620 6e6f 5f64 6174 615f 7661 6c75 650d  f no_data_value.
-00017190: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
-000171a0: 286e 702e 6973 6e61 6e28 6172 7229 292e  (np.isnan(arr)).
-000171b0: 616c 6c28 293a 0d0a 2020 2020 2020 2020  all():..        
-000171c0: 2020 2020 2020 2020 6c6f 6767 6572 2e77          logger.w
-000171d0: 6172 6e69 6e67 2822 7468 6520 7261 7374  arning("the rast
-000171e0: 6572 2069 7320 6675 6c6c 206f 6620 6e6f  er is full of no
-000171f0: 5f64 6174 615f 7661 6c75 6522 290d 0a20  _data_value").. 
-00017200: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-00017210: 6574 7572 6e20 4e6f 6e65 0d0a 0d0a 2020  eturn None....  
-00017220: 2020 2020 2020 2020 2020 6172 725b 7e6e            arr[~n
-00017230: 702e 6973 6e61 6e28 6172 7229 5d20 3d20  p.isnan(arr)] = 
-00017240: 320d 0a20 2020 2020 2020 2065 6c73 653a  2..        else:
-00017250: 0d0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
-00017260: 6368 6563 6b20 6966 2074 6865 2077 686f  check if the who
-00017270: 6c65 2072 6173 7465 7220 6973 2066 756c  le raster is ful
-00017280: 6c20 6f66 206e 6f64 6174 6176 616c 7565  l of nodatavalue
-00017290: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
-000172a0: 2028 6e70 2e69 7363 6c6f 7365 2861 7272   (np.isclose(arr
-000172b0: 2c20 6e6f 5f64 6174 615f 7661 6c2c 2072  , no_data_val, r
-000172c0: 746f 6c3d 302e 3030 3030 3129 292e 616c  tol=0.00001)).al
-000172d0: 6c28 293a 0d0a 2020 2020 2020 2020 2020  l():..          
-000172e0: 2020 2020 2020 6c6f 6767 6572 2e77 6172        logger.war
-000172f0: 6e69 6e67 2822 7468 6520 7261 7374 6572  ning("the raster
-00017300: 2069 7320 6675 6c6c 206f 6620 6e6f 5f64   is full of no_d
-00017310: 6174 615f 7661 6c75 6522 290d 0a20 2020  ata_value")..   
-00017320: 2020 2020 2020 2020 2020 2020 2072 6574               ret
-00017330: 7572 6e20 4e6f 6e65 0d0a 0d0a 2020 2020  urn None....    
-00017340: 2020 2020 2020 2020 6172 725b 7e6e 702e          arr[~np.
-00017350: 6973 636c 6f73 6528 6172 722c 206e 6f5f  isclose(arr, no_
-00017360: 6461 7461 5f76 616c 2c20 7274 6f6c 3d30  data_val, rtol=0
-00017370: 2e30 3030 3031 295d 203d 2032 0d0a 2020  .00001)] = 2..  
-00017380: 2020 2020 2020 6e65 775f 6461 7461 7365        new_datase
-00017390: 7420 3d20 7365 6c66 2e63 7265 6174 655f  t = self.create_
-000173a0: 6672 6f6d 5f61 7272 6179 280d 0a20 2020  from_array(..   
-000173b0: 2020 2020 2020 2020 2061 7272 2c20 7365           arr, se
-000173c0: 6c66 2e67 656f 7472 616e 7366 6f72 6d2c  lf.geotransform,
-000173d0: 2073 656c 662e 6570 7367 2c20 7365 6c66   self.epsg, self
-000173e0: 2e6e 6f5f 6461 7461 5f76 616c 7565 0d0a  .no_data_value..
-000173f0: 2020 2020 2020 2020 290d 0a20 2020 2020          )..     
-00017400: 2020 2023 2074 6865 6e20 636f 6e76 6572     # then conver
-00017410: 7420 7468 6520 7261 7361 7465 7220 696e  t the rasater in
-00017420: 746f 2070 6f6c 7967 6f6e 0d0a 2020 2020  to polygon..    
-00017430: 2020 2020 6764 6620 3d20 6e65 775f 6461      gdf = new_da
-00017440: 7461 7365 742e 746f 5f70 6f6c 7967 6f6e  taset.to_polygon
-00017450: 2862 616e 643d 6261 6e64 290d 0a0d 0a20  (band=band).... 
-00017460: 2020 2020 2020 2072 6574 7572 6e20 6764         return gd
-00017470: 660d 0a0d 0a20 2020 2040 7374 6174 6963  f....    @static
-00017480: 6d65 7468 6f64 0d0a 2020 2020 6465 6620  method..    def 
-00017490: 6e6f 726d 616c 697a 6528 6172 7261 793a  normalize(array:
-000174a0: 206e 702e 6e64 6172 7261 7929 3a0d 0a20   np.ndarray):.. 
-000174b0: 2020 2020 2020 2022 2222 0d0a 2020 2020         """..    
-000174c0: 2020 2020 4e6f 726d 616c 697a 6573 206e      Normalizes n
-000174d0: 756d 7079 2061 7272 6179 7320 696e 746f  umpy arrays into
-000174e0: 2073 6361 6c65 2030 2e30 202d 2031 2e30   scale 0.0 - 1.0
-000174f0: 0d0a 0d0a 2020 2020 2020 2020 5061 7261  ....        Para
-00017500: 6d65 7465 7273 0d0a 2020 2020 2020 2020  meters..        
-00017510: 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020  ----------..    
-00017520: 2020 2020 6172 7261 7920 3a20 5b61 7272      array : [arr
-00017530: 6179 5d0d 0a20 2020 2020 2020 2020 2020  ay]..           
-00017540: 206e 756d 7079 2061 7272 6179 0d0a 0d0a   numpy array....
-00017550: 2020 2020 2020 2020 5265 7475 726e 730d          Returns.
-00017560: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-00017570: 0d0a 2020 2020 2020 2020 6172 7261 790d  ..        array.
-00017580: 0a20 2020 2020 2020 2020 2020 2044 4553  .            DES
-00017590: 4352 4950 5449 4f4e 2e0d 0a20 2020 2020  CRIPTION...     
-000175a0: 2020 2022 2222 0d0a 2020 2020 2020 2020     """..        
-000175b0: 6172 7261 795f 6d69 6e20 3d20 6172 7261  array_min = arra
-000175c0: 792e 6d69 6e28 290d 0a20 2020 2020 2020  y.min()..       
-000175d0: 2061 7272 6179 5f6d 6178 203d 2061 7272   array_max = arr
-000175e0: 6179 2e6d 6178 2829 0d0a 2020 2020 2020  ay.max()..      
-000175f0: 2020 7661 6c20 3d20 2861 7272 6179 202d    val = (array -
-00017600: 2061 7272 6179 5f6d 696e 2920 2f20 2861   array_min) / (a
-00017610: 7272 6179 5f6d 6178 202d 2061 7272 6179  rray_max - array
-00017620: 5f6d 696e 290d 0a20 2020 2020 2020 2072  _min)..        r
-00017630: 6574 7572 6e20 7661 6c0d 0a0d 0a20 2020  eturn val....   
-00017640: 2040 7374 6174 6963 6d65 7468 6f64 0d0a   @staticmethod..
-00017650: 2020 2020 6465 6620 5f77 696e 646f 7728      def _window(
-00017660: 7372 633a 2067 6461 6c2e 4461 7461 7365  src: gdal.Datase
-00017670: 742c 2073 697a 653a 2069 6e74 203d 2032  t, size: int = 2
-00017680: 3536 293a 0d0a 2020 2020 2020 2020 2222  56):..        ""
-00017690: 2244 6174 6173 6574 2073 7175 6172 6520  "Dataset square 
-000176a0: 7769 6e64 6f77 2073 697a 652f 6f66 6673  window size/offs
-000176b0: 6574 732e 0d0a 0d0a 2020 2020 2020 2020  ets.....        
-000176c0: 5061 7261 6d65 7465 7273 0d0a 2020 2020  Parameters..    
-000176d0: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a      ----------..
-000176e0: 2020 2020 2020 2020 7372 6320 3a20 5b67          src : [g
-000176f0: 6461 6c2e 4461 7461 6375 6265 5d0d 0a20  dal.Datacube].. 
-00017700: 2020 2020 2020 2020 2020 2067 6461 6c20             gdal 
-00017710: 4461 7461 6375 6265 206f 626a 6563 742e  Datacube object.
-00017720: 0d0a 2020 2020 2020 2020 7369 7a65 203a  ..        size :
-00017730: 205b 696e 745d 0d0a 2020 2020 2020 2020   [int]..        
-00017740: 2020 2020 5369 7a65 206f 6620 7769 6e64      Size of wind
-00017750: 6f77 2069 6e20 7069 7865 6c73 2e20 4f6e  ow in pixels. On
-00017760: 6520 7661 6c75 6520 7265 7175 6972 6564  e value required
-00017770: 2077 6869 6368 2069 7320 7573 6564 2066   which is used f
-00017780: 6f72 2062 6f74 6820 7468 650d 0a20 2020  or both the..   
-00017790: 2020 2020 2020 2020 2078 2061 6e64 2079           x and y
-000177a0: 2073 697a 652e 2045 2e67 2032 3536 206d   size. E.g 256 m
-000177b0: 6561 6e73 2061 2032 3536 7832 3536 2077  eans a 256x256 w
-000177c0: 696e 646f 772e 0d0a 0d0a 2020 2020 2020  indow.....      
-000177d0: 2020 5969 656c 6473 0d0a 2020 2020 2020    Yields..      
-000177e0: 2020 2d2d 2d2d 2d2d 0d0a 2020 2020 2020    ------..      
-000177f0: 2020 7475 706c 655b 696e 745d 0d0a 2020    tuple[int]..  
-00017800: 2020 2020 2020 2020 2020 3420 656c 656d            4 elem
-00017810: 656e 7420 7475 706c 6520 636f 6e74 6169  ent tuple contai
-00017820: 6e69 6e67 2074 6865 2078 2073 697a 652c  ning the x size,
-00017830: 2079 2073 697a 652c 2078 206f 6666 7365   y size, x offse
-00017840: 7420 616e 6420 7920 6f66 6673 6574 0d0a  t and y offset..
-00017850: 2020 2020 2020 2020 2020 2020 6f66 2074              of t
-00017860: 6865 2077 696e 646f 772e 0d0a 2020 2020  he window...    
-00017870: 2020 2020 2222 220d 0a20 2020 2020 2020      """..       
-00017880: 2063 6f6c 7320 3d20 7372 632e 5261 7374   cols = src.Rast
-00017890: 6572 5853 697a 650d 0a20 2020 2020 2020  erXSize..       
-000178a0: 2072 6f77 7320 3d20 7372 632e 5261 7374   rows = src.Rast
-000178b0: 6572 5953 697a 650d 0a20 2020 2020 2020  erYSize..       
-000178c0: 2066 6f72 2078 6f66 6620 696e 2072 616e   for xoff in ran
-000178d0: 6765 2830 2c20 636f 6c73 2c20 7369 7a65  ge(0, cols, size
-000178e0: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
-000178f0: 7873 697a 6520 3d20 7369 7a65 2069 6620  xsize = size if 
-00017900: 7369 7a65 202b 2078 6f66 6620 3c3d 2063  size + xoff <= c
-00017910: 6f6c 7320 656c 7365 2063 6f6c 7320 2d20  ols else cols - 
-00017920: 786f 6666 0d0a 2020 2020 2020 2020 2020  xoff..          
-00017930: 2020 666f 7220 796f 6666 2069 6e20 7261    for yoff in ra
-00017940: 6e67 6528 302c 2072 6f77 732c 2073 697a  nge(0, rows, siz
-00017950: 6529 3a0d 0a20 2020 2020 2020 2020 2020  e):..           
-00017960: 2020 2020 2079 7369 7a65 203d 2073 697a       ysize = siz
-00017970: 6520 6966 2073 697a 6520 2b20 796f 6666  e if size + yoff
-00017980: 203c 3d20 726f 7773 2065 6c73 6520 726f   <= rows else ro
-00017990: 7773 202d 2079 6f66 660d 0a20 2020 2020  ws - yoff..     
-000179a0: 2020 2020 2020 2020 2020 2079 6965 6c64             yield
-000179b0: 2078 7369 7a65 2c20 7973 697a 652c 2078   xsize, ysize, x
-000179c0: 6f66 662c 2079 6f66 660d 0a0d 0a20 2020  off, yoff....   
-000179d0: 2064 6566 2067 6574 5f74 696c 6528 7365   def get_tile(se
-000179e0: 6c66 2c20 7369 7a65 3d32 3536 293a 0d0a  lf, size=256):..
-000179f0: 2020 2020 2020 2020 2222 2267 6574 7320          """gets 
-00017a00: 6120 7261 7374 6572 2061 7272 6179 2069  a raster array i
-00017a10: 6e20 7469 6c65 732e 0d0a 0d0a 2020 2020  n tiles.....    
-00017a20: 2020 2020 5061 7261 6d65 7465 7273 0d0a      Parameters..
-00017a30: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-00017a40: 2d2d 0d0a 2020 2020 2020 2020 7369 7a65  --..        size
-00017a50: 203a 2069 6e74 0d0a 2020 2020 2020 2020   : int..        
-00017a60: 2020 2020 5369 7a65 206f 6620 7769 6e64      Size of wind
-00017a70: 6f77 2069 6e20 7069 7865 6c73 2e20 4f6e  ow in pixels. On
-00017a80: 6520 7661 6c75 6520 7265 7175 6972 6564  e value required
-00017a90: 2077 6869 6368 2069 7320 7573 6564 2066   which is used f
-00017aa0: 6f72 2062 6f74 6820 7468 650d 0a20 2020  or both the..   
-00017ab0: 2020 2020 2020 2020 2078 2061 6e64 2079           x and y
-00017ac0: 2073 697a 652e 2045 2e67 2032 3536 206d   size. E.g 256 m
-00017ad0: 6561 6e73 2061 2032 3536 7832 3536 2077  eans a 256x256 w
-00017ae0: 696e 646f 772e 0d0a 0d0a 2020 2020 2020  indow.....      
-00017af0: 2020 5969 656c 6473 0d0a 2020 2020 2020    Yields..      
-00017b00: 2020 2d2d 2d2d 2d2d 0d0a 2020 2020 2020    ------..      
-00017b10: 2020 6e70 2e6e 6461 7272 6179 0d0a 2020    np.ndarray..  
-00017b20: 2020 2020 2020 2020 2020 4461 7461 7365            Datase
-00017b30: 7420 6172 7261 7920 696e 2066 6f72 6d20  t array in form 
-00017b40: 5b62 616e 645d 5b79 5d5b 785d 2e0d 0a20  [band][y][x]... 
-00017b50: 2020 2020 2020 2022 2222 0d0a 2020 2020         """..    
-00017b60: 2020 2020 666f 7220 7873 697a 652c 2079      for xsize, y
-00017b70: 7369 7a65 2c20 786f 6666 2c20 796f 6666  size, xoff, yoff
-00017b80: 2069 6e20 7365 6c66 2e5f 7769 6e64 6f77   in self._window
-00017b90: 2873 656c 662e 7261 7374 6572 2c20 7369  (self.raster, si
-00017ba0: 7a65 3d73 697a 6529 3a0d 0a20 2020 2020  ze=size):..     
-00017bb0: 2020 2020 2020 2023 2072 6561 6420 7468         # read th
-00017bc0: 6520 6172 7261 7920 6174 2061 2063 6572  e array at a cer
-00017bd0: 7461 696e 2069 6e64 6563 6573 0d0a 2020  tain indeces..  
-00017be0: 2020 2020 2020 2020 2020 7969 656c 6420            yield 
-00017bf0: 7365 6c66 2e72 6173 7465 722e 5265 6164  self.raster.Read
-00017c00: 4173 4172 7261 7928 0d0a 2020 2020 2020  AsArray(..      
-00017c10: 2020 2020 2020 2020 2020 786f 6666 3d78            xoff=x
-00017c20: 6f66 662c 2079 6f66 663d 796f 6666 2c20  off, yoff=yoff, 
-00017c30: 7873 697a 653d 7873 697a 652c 2079 7369  xsize=xsize, ysi
-00017c40: 7a65 3d79 7369 7a65 0d0a 2020 2020 2020  ze=ysize..      
-00017c50: 2020 2020 2020 290d 0a0d 0a20 2020 2040        )....    @
-00017c60: 7374 6174 6963 6d65 7468 6f64 0d0a 2020  staticmethod..  
-00017c70: 2020 6465 6620 5f67 726f 7570 4e65 6967    def _groupNeig
-00017c80: 6862 6f75 7273 280d 0a20 2020 2020 2020  hbours(..       
-00017c90: 2061 7272 6179 2c20 692c 206a 2c20 6c6f   array, i, j, lo
-00017ca0: 7765 7276 616c 7565 2c20 7570 7065 7276  wervalue, upperv
-00017cb0: 616c 7565 2c20 706f 7369 7469 6f6e 2c20  alue, position, 
-00017cc0: 7661 6c75 6573 2c20 636f 756e 742c 2063  values, count, c
-00017cd0: 6c75 7374 6572 0d0a 2020 2020 293a 0d0a  luster..    ):..
-00017ce0: 2020 2020 2020 2020 2222 2267 726f 7570          """group
-00017cf0: 206e 6569 6269 7572 696e 6720 6365 6c6c   neibiuring cell
-00017d00: 7320 7769 7468 2074 6865 2073 616d 6520  s with the same 
-00017d10: 7661 6c75 6573 2222 220d 0a0d 0a20 2020  values"""....   
-00017d20: 2020 2020 2023 2062 6f74 746f 6d20 6365       # bottom ce
-00017d30: 6c6c 0d0a 2020 2020 2020 2020 6966 2028  ll..        if (
-00017d40: 0d0a 2020 2020 2020 2020 2020 2020 6c6f  ..            lo
-00017d50: 7765 7276 616c 7565 203c 3d20 6172 7261  wervalue <= arra
-00017d60: 795b 6920 2b20 312c 206a 5d20 3c3d 2075  y[i + 1, j] <= u
-00017d70: 7070 6572 7661 6c75 650d 0a20 2020 2020  ppervalue..     
-00017d80: 2020 2020 2020 2061 6e64 2063 6c75 7374         and clust
-00017d90: 6572 5b69 202b 2031 2c20 6a5d 203d 3d20  er[i + 1, j] == 
-00017da0: 300d 0a20 2020 2020 2020 2020 2020 2061  0..            a
-00017db0: 6e64 2069 202b 2031 203c 2061 7272 6179  nd i + 1 < array
-00017dc0: 2e73 6861 7065 5b30 5d0d 0a20 2020 2020  .shape[0]..     
-00017dd0: 2020 2029 3a0d 0a20 2020 2020 2020 2020     ):..         
-00017de0: 2020 2070 6f73 6974 696f 6e2e 6170 7065     position.appe
-00017df0: 6e64 285b 6920 2b20 312c 206a 5d29 0d0a  nd([i + 1, j])..
-00017e00: 2020 2020 2020 2020 2020 2020 7661 6c75              valu
-00017e10: 6573 2e61 7070 656e 6428 6172 7261 795b  es.append(array[
-00017e20: 6920 2b20 312c 206a 5d29 0d0a 2020 2020  i + 1, j])..    
-00017e30: 2020 2020 2020 2020 636c 7573 7465 725b          cluster[
-00017e40: 6920 2b20 312c 206a 5d20 3d20 636f 756e  i + 1, j] = coun
-00017e50: 740d 0a20 2020 2020 2020 2020 2020 2044  t..            D
-00017e60: 6174 6173 6574 2e5f 6772 6f75 704e 6569  ataset._groupNei
-00017e70: 6768 626f 7572 7328 0d0a 2020 2020 2020  ghbours(..      
-00017e80: 2020 2020 2020 2020 2020 6172 7261 792c            array,
-00017e90: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00017ea0: 2020 6920 2b20 312c 0d0a 2020 2020 2020    i + 1,..      
-00017eb0: 2020 2020 2020 2020 2020 6a2c 0d0a 2020            j,..  
-00017ec0: 2020 2020 2020 2020 2020 2020 2020 6c6f                lo
-00017ed0: 7765 7276 616c 7565 2c0d 0a20 2020 2020  wervalue,..     
-00017ee0: 2020 2020 2020 2020 2020 2075 7070 6572             upper
-00017ef0: 7661 6c75 652c 0d0a 2020 2020 2020 2020  value,..        
-00017f00: 2020 2020 2020 2020 706f 7369 7469 6f6e          position
-00017f10: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-00017f20: 2020 2076 616c 7565 732c 0d0a 2020 2020     values,..    
-00017f30: 2020 2020 2020 2020 2020 2020 636f 756e              coun
-00017f40: 742c 0d0a 2020 2020 2020 2020 2020 2020  t,..            
-00017f50: 2020 2020 636c 7573 7465 722c 0d0a 2020      cluster,..  
-00017f60: 2020 2020 2020 2020 2020 290d 0a20 2020            )..   
-00017f70: 2020 2020 2023 2062 6f74 746f 6d20 7269       # bottom ri
-00017f80: 6768 740d 0a20 2020 2020 2020 2069 6620  ght..        if 
-00017f90: 280d 0a20 2020 2020 2020 2020 2020 206a  (..            j
-00017fa0: 202b 2031 203c 2061 7272 6179 2e73 6861   + 1 < array.sha
-00017fb0: 7065 5b31 5d0d 0a20 2020 2020 2020 2020  pe[1]..         
-00017fc0: 2020 2061 6e64 2069 202b 2031 203c 2061     and i + 1 < a
-00017fd0: 7272 6179 2e73 6861 7065 5b30 5d0d 0a20  rray.shape[0].. 
-00017fe0: 2020 2020 2020 2020 2020 2061 6e64 206c             and l
-00017ff0: 6f77 6572 7661 6c75 6520 3c3d 2061 7272  owervalue <= arr
-00018000: 6179 5b69 202b 2031 2c20 6a20 2b20 315d  ay[i + 1, j + 1]
-00018010: 203c 3d20 7570 7065 7276 616c 7565 0d0a   <= uppervalue..
-00018020: 2020 2020 2020 2020 2020 2020 616e 6420              and 
-00018030: 636c 7573 7465 725b 6920 2b20 312c 206a  cluster[i + 1, j
-00018040: 202b 2031 5d20 3d3d 2030 0d0a 2020 2020   + 1] == 0..    
-00018050: 2020 2020 293a 0d0a 2020 2020 2020 2020      ):..        
-00018060: 2020 2020 706f 7369 7469 6f6e 2e61 7070      position.app
-00018070: 656e 6428 5b69 202b 2031 2c20 6a20 2b20  end([i + 1, j + 
-00018080: 315d 290d 0a20 2020 2020 2020 2020 2020  1])..           
-00018090: 2076 616c 7565 732e 6170 7065 6e64 2861   values.append(a
-000180a0: 7272 6179 5b69 202b 2031 2c20 6a20 2b20  rray[i + 1, j + 
-000180b0: 315d 290d 0a20 2020 2020 2020 2020 2020  1])..           
-000180c0: 2063 6c75 7374 6572 5b69 202b 2031 2c20   cluster[i + 1, 
-000180d0: 6a20 2b20 315d 203d 2063 6f75 6e74 0d0a  j + 1] = count..
-000180e0: 2020 2020 2020 2020 2020 2020 4461 7461              Data
-000180f0: 7365 742e 5f67 726f 7570 4e65 6967 6862  set._groupNeighb
-00018100: 6f75 7273 280d 0a20 2020 2020 2020 2020  ours(..         
-00018110: 2020 2020 2020 2061 7272 6179 2c0d 0a20         array,.. 
-00018120: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00018130: 202b 2031 2c0d 0a20 2020 2020 2020 2020   + 1,..         
-00018140: 2020 2020 2020 206a 202b 2031 2c0d 0a20         j + 1,.. 
-00018150: 2020 2020 2020 2020 2020 2020 2020 206c                 l
-00018160: 6f77 6572 7661 6c75 652c 0d0a 2020 2020  owervalue,..    
-00018170: 2020 2020 2020 2020 2020 2020 7570 7065              uppe
-00018180: 7276 616c 7565 2c0d 0a20 2020 2020 2020  rvalue,..       
-00018190: 2020 2020 2020 2020 2070 6f73 6974 696f           positio
-000181a0: 6e2c 0d0a 2020 2020 2020 2020 2020 2020  n,..            
-000181b0: 2020 2020 7661 6c75 6573 2c0d 0a20 2020      values,..   
-000181c0: 2020 2020 2020 2020 2020 2020 2063 6f75               cou
-000181d0: 6e74 2c0d 0a20 2020 2020 2020 2020 2020  nt,..           
-000181e0: 2020 2020 2063 6c75 7374 6572 2c0d 0a20       cluster,.. 
-000181f0: 2020 2020 2020 2020 2020 2029 0d0a 2020             )..  
-00018200: 2020 2020 2020 2320 7269 6768 740d 0a20        # right.. 
-00018210: 2020 2020 2020 2069 6620 280d 0a20 2020         if (..   
-00018220: 2020 2020 2020 2020 206a 202b 2031 203c           j + 1 <
-00018230: 2061 7272 6179 2e73 6861 7065 5b31 5d0d   array.shape[1].
-00018240: 0a20 2020 2020 2020 2020 2020 2061 6e64  .            and
-00018250: 206c 6f77 6572 7661 6c75 6520 3c3d 2061   lowervalue <= a
-00018260: 7272 6179 5b69 2c20 6a20 2b20 315d 203c  rray[i, j + 1] <
-00018270: 3d20 7570 7065 7276 616c 7565 0d0a 2020  = uppervalue..  
-00018280: 2020 2020 2020 2020 2020 616e 6420 636c            and cl
-00018290: 7573 7465 725b 692c 206a 202b 2031 5d20  uster[i, j + 1] 
-000182a0: 3d3d 2030 0d0a 2020 2020 2020 2020 293a  == 0..        ):
-000182b0: 0d0a 2020 2020 2020 2020 2020 2020 706f  ..            po
-000182c0: 7369 7469 6f6e 2e61 7070 656e 6428 5b69  sition.append([i
-000182d0: 2c20 6a20 2b20 315d 290d 0a20 2020 2020  , j + 1])..     
-000182e0: 2020 2020 2020 2076 616c 7565 732e 6170         values.ap
-000182f0: 7065 6e64 2861 7272 6179 5b69 2c20 6a20  pend(array[i, j 
-00018300: 2b20 315d 290d 0a20 2020 2020 2020 2020  + 1])..         
-00018310: 2020 2063 6c75 7374 6572 5b69 2c20 6a20     cluster[i, j 
-00018320: 2b20 315d 203d 2063 6f75 6e74 0d0a 2020  + 1] = count..  
-00018330: 2020 2020 2020 2020 2020 4461 7461 7365            Datase
-00018340: 742e 5f67 726f 7570 4e65 6967 6862 6f75  t._groupNeighbou
-00018350: 7273 280d 0a20 2020 2020 2020 2020 2020  rs(..           
-00018360: 2020 2020 2061 7272 6179 2c0d 0a20 2020       array,..   
-00018370: 2020 2020 2020 2020 2020 2020 2069 2c0d               i,.
-00018380: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00018390: 206a 202b 2031 2c0d 0a20 2020 2020 2020   j + 1,..       
-000183a0: 2020 2020 2020 2020 206c 6f77 6572 7661           lowerva
-000183b0: 6c75 652c 0d0a 2020 2020 2020 2020 2020  lue,..          
-000183c0: 2020 2020 2020 7570 7065 7276 616c 7565        uppervalue
-000183d0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-000183e0: 2020 2070 6f73 6974 696f 6e2c 0d0a 2020     position,..  
-000183f0: 2020 2020 2020 2020 2020 2020 2020 7661                va
-00018400: 6c75 6573 2c0d 0a20 2020 2020 2020 2020  lues,..         
-00018410: 2020 2020 2020 2063 6f75 6e74 2c0d 0a20         count,.. 
-00018420: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-00018430: 6c75 7374 6572 2c0d 0a20 2020 2020 2020  luster,..       
-00018440: 2020 2020 2029 0d0a 2020 2020 2020 2020       )..        
-00018450: 2320 7570 7065 7220 7269 6768 740d 0a20  # upper right.. 
-00018460: 2020 2020 2020 2069 6620 280d 0a20 2020         if (..   
-00018470: 2020 2020 2020 2020 206a 202b 2031 203c           j + 1 <
-00018480: 2061 7272 6179 2e73 6861 7065 5b31 5d0d   array.shape[1].
-00018490: 0a20 2020 2020 2020 2020 2020 2061 6e64  .            and
-000184a0: 2069 202d 2031 203e 3d20 300d 0a20 2020   i - 1 >= 0..   
-000184b0: 2020 2020 2020 2020 2061 6e64 206c 6f77           and low
-000184c0: 6572 7661 6c75 6520 3c3d 2061 7272 6179  ervalue <= array
-000184d0: 5b69 202d 2031 2c20 6a20 2b20 315d 203c  [i - 1, j + 1] <
-000184e0: 3d20 7570 7065 7276 616c 7565 0d0a 2020  = uppervalue..  
-000184f0: 2020 2020 2020 2020 2020 616e 6420 636c            and cl
-00018500: 7573 7465 725b 6920 2d20 312c 206a 202b  uster[i - 1, j +
-00018510: 2031 5d20 3d3d 2030 0d0a 2020 2020 2020   1] == 0..      
-00018520: 2020 293a 0d0a 2020 2020 2020 2020 2020    ):..          
-00018530: 2020 706f 7369 7469 6f6e 2e61 7070 656e    position.appen
-00018540: 6428 5b69 202d 2031 2c20 6a20 2b20 315d  d([i - 1, j + 1]
-00018550: 290d 0a20 2020 2020 2020 2020 2020 2076  )..            v
-00018560: 616c 7565 732e 6170 7065 6e64 2861 7272  alues.append(arr
-00018570: 6179 5b69 202d 2031 2c20 6a20 2b20 315d  ay[i - 1, j + 1]
-00018580: 290d 0a20 2020 2020 2020 2020 2020 2063  )..            c
-00018590: 6c75 7374 6572 5b69 202d 2031 2c20 6a20  luster[i - 1, j 
-000185a0: 2b20 315d 203d 2063 6f75 6e74 0d0a 2020  + 1] = count..  
-000185b0: 2020 2020 2020 2020 2020 4461 7461 7365            Datase
-000185c0: 742e 5f67 726f 7570 4e65 6967 6862 6f75  t._groupNeighbou
-000185d0: 7273 280d 0a20 2020 2020 2020 2020 2020  rs(..           
-000185e0: 2020 2020 2061 7272 6179 2c0d 0a20 2020       array,..   
-000185f0: 2020 2020 2020 2020 2020 2020 2069 202d               i -
-00018600: 2031 2c0d 0a20 2020 2020 2020 2020 2020   1,..           
-00018610: 2020 2020 206a 202b 2031 2c0d 0a20 2020       j + 1,..   
-00018620: 2020 2020 2020 2020 2020 2020 206c 6f77               low
-00018630: 6572 7661 6c75 652c 0d0a 2020 2020 2020  ervalue,..      
-00018640: 2020 2020 2020 2020 2020 7570 7065 7276            upperv
-00018650: 616c 7565 2c0d 0a20 2020 2020 2020 2020  alue,..         
-00018660: 2020 2020 2020 2070 6f73 6974 696f 6e2c         position,
-00018670: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00018680: 2020 7661 6c75 6573 2c0d 0a20 2020 2020    values,..     
-00018690: 2020 2020 2020 2020 2020 2063 6f75 6e74             count
-000186a0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-000186b0: 2020 2063 6c75 7374 6572 2c0d 0a20 2020     cluster,..   
-000186c0: 2020 2020 2020 2020 2029 0d0a 2020 2020           )..    
-000186d0: 2020 2020 2320 746f 700d 0a20 2020 2020      # top..     
-000186e0: 2020 2069 6620 280d 0a20 2020 2020 2020     if (..       
-000186f0: 2020 2020 2069 202d 2031 203e 3d20 300d       i - 1 >= 0.
-00018700: 0a20 2020 2020 2020 2020 2020 2061 6e64  .            and
-00018710: 206c 6f77 6572 7661 6c75 6520 3c3d 2061   lowervalue <= a
-00018720: 7272 6179 5b69 202d 2031 2c20 6a5d 203c  rray[i - 1, j] <
-00018730: 3d20 7570 7065 7276 616c 7565 0d0a 2020  = uppervalue..  
-00018740: 2020 2020 2020 2020 2020 616e 6420 636c            and cl
-00018750: 7573 7465 725b 6920 2d20 312c 206a 5d20  uster[i - 1, j] 
-00018760: 3d3d 2030 0d0a 2020 2020 2020 2020 293a  == 0..        ):
-00018770: 0d0a 2020 2020 2020 2020 2020 2020 706f  ..            po
-00018780: 7369 7469 6f6e 2e61 7070 656e 6428 5b69  sition.append([i
-00018790: 202d 2031 2c20 6a5d 290d 0a20 2020 2020   - 1, j])..     
-000187a0: 2020 2020 2020 2076 616c 7565 732e 6170         values.ap
-000187b0: 7065 6e64 2861 7272 6179 5b69 202d 2031  pend(array[i - 1
-000187c0: 2c20 6a5d 290d 0a20 2020 2020 2020 2020  , j])..         
-000187d0: 2020 2063 6c75 7374 6572 5b69 202d 2031     cluster[i - 1
-000187e0: 2c20 6a5d 203d 2063 6f75 6e74 0d0a 2020  , j] = count..  
-000187f0: 2020 2020 2020 2020 2020 4461 7461 7365            Datase
-00018800: 742e 5f67 726f 7570 4e65 6967 6862 6f75  t._groupNeighbou
-00018810: 7273 280d 0a20 2020 2020 2020 2020 2020  rs(..           
-00018820: 2020 2020 2061 7272 6179 2c0d 0a20 2020       array,..   
-00018830: 2020 2020 2020 2020 2020 2020 2069 202d               i -
-00018840: 2031 2c0d 0a20 2020 2020 2020 2020 2020   1,..           
-00018850: 2020 2020 206a 2c0d 0a20 2020 2020 2020       j,..       
-00018860: 2020 2020 2020 2020 206c 6f77 6572 7661           lowerva
-00018870: 6c75 652c 0d0a 2020 2020 2020 2020 2020  lue,..          
-00018880: 2020 2020 2020 7570 7065 7276 616c 7565        uppervalue
-00018890: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-000188a0: 2020 2070 6f73 6974 696f 6e2c 0d0a 2020     position,..  
-000188b0: 2020 2020 2020 2020 2020 2020 2020 7661                va
-000188c0: 6c75 6573 2c0d 0a20 2020 2020 2020 2020  lues,..         
-000188d0: 2020 2020 2020 2063 6f75 6e74 2c0d 0a20         count,.. 
-000188e0: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-000188f0: 6c75 7374 6572 2c0d 0a20 2020 2020 2020  luster,..       
-00018900: 2020 2020 2029 0d0a 2020 2020 2020 2020       )..        
-00018910: 2320 746f 7020 6c65 6674 0d0a 2020 2020  # top left..    
-00018920: 2020 2020 6966 2028 0d0a 2020 2020 2020      if (..      
-00018930: 2020 2020 2020 6920 2d20 3120 3e3d 2030        i - 1 >= 0
-00018940: 0d0a 2020 2020 2020 2020 2020 2020 616e  ..            an
-00018950: 6420 6a20 2d20 3120 3e3d 2030 0d0a 2020  d j - 1 >= 0..  
-00018960: 2020 2020 2020 2020 2020 616e 6420 6c6f            and lo
-00018970: 7765 7276 616c 7565 203c 3d20 6172 7261  wervalue <= arra
-00018980: 795b 6920 2d20 312c 206a 202d 2031 5d20  y[i - 1, j - 1] 
-00018990: 3c3d 2075 7070 6572 7661 6c75 650d 0a20  <= uppervalue.. 
-000189a0: 2020 2020 2020 2020 2020 2061 6e64 2063             and c
-000189b0: 6c75 7374 6572 5b69 202d 2031 2c20 6a20  luster[i - 1, j 
-000189c0: 2d20 315d 203d 3d20 300d 0a20 2020 2020  - 1] == 0..     
-000189d0: 2020 2029 3a0d 0a20 2020 2020 2020 2020     ):..         
-000189e0: 2020 2070 6f73 6974 696f 6e2e 6170 7065     position.appe
-000189f0: 6e64 285b 6920 2d20 312c 206a 202d 2031  nd([i - 1, j - 1
-00018a00: 5d29 0d0a 2020 2020 2020 2020 2020 2020  ])..            
-00018a10: 7661 6c75 6573 2e61 7070 656e 6428 6172  values.append(ar
-00018a20: 7261 795b 6920 2d20 312c 206a 202d 2031  ray[i - 1, j - 1
-00018a30: 5d29 0d0a 2020 2020 2020 2020 2020 2020  ])..            
-00018a40: 636c 7573 7465 725b 6920 2d20 312c 206a  cluster[i - 1, j
-00018a50: 202d 2031 5d20 3d20 636f 756e 740d 0a20   - 1] = count.. 
-00018a60: 2020 2020 2020 2020 2020 2044 6174 6173             Datas
-00018a70: 6574 2e5f 6772 6f75 704e 6569 6768 626f  et._groupNeighbo
-00018a80: 7572 7328 0d0a 2020 2020 2020 2020 2020  urs(..          
-00018a90: 2020 2020 2020 6172 7261 792c 0d0a 2020        array,..  
-00018aa0: 2020 2020 2020 2020 2020 2020 2020 6920                i 
-00018ab0: 2d20 312c 0d0a 2020 2020 2020 2020 2020  - 1,..          
-00018ac0: 2020 2020 2020 6a20 2d20 312c 0d0a 2020        j - 1,..  
-00018ad0: 2020 2020 2020 2020 2020 2020 2020 6c6f                lo
-00018ae0: 7765 7276 616c 7565 2c0d 0a20 2020 2020  wervalue,..     
-00018af0: 2020 2020 2020 2020 2020 2075 7070 6572             upper
-00018b00: 7661 6c75 652c 0d0a 2020 2020 2020 2020  value,..        
-00018b10: 2020 2020 2020 2020 706f 7369 7469 6f6e          position
-00018b20: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-00018b30: 2020 2076 616c 7565 732c 0d0a 2020 2020     values,..    
-00018b40: 2020 2020 2020 2020 2020 2020 636f 756e              coun
-00018b50: 742c 0d0a 2020 2020 2020 2020 2020 2020  t,..            
-00018b60: 2020 2020 636c 7573 7465 722c 0d0a 2020      cluster,..  
-00018b70: 2020 2020 2020 2020 2020 290d 0a20 2020            )..   
-00018b80: 2020 2020 2023 206c 6566 740d 0a20 2020       # left..   
-00018b90: 2020 2020 2069 6620 280d 0a20 2020 2020       if (..     
-00018ba0: 2020 2020 2020 206a 202d 2031 203e 3d20         j - 1 >= 
-00018bb0: 300d 0a20 2020 2020 2020 2020 2020 2061  0..            a
-00018bc0: 6e64 206c 6f77 6572 7661 6c75 6520 3c3d  nd lowervalue <=
-00018bd0: 2061 7272 6179 5b69 2c20 6a20 2d20 315d   array[i, j - 1]
-00018be0: 203c 3d20 7570 7065 7276 616c 7565 0d0a   <= uppervalue..
-00018bf0: 2020 2020 2020 2020 2020 2020 616e 6420              and 
-00018c00: 636c 7573 7465 725b 692c 206a 202d 2031  cluster[i, j - 1
-00018c10: 5d20 3d3d 2030 0d0a 2020 2020 2020 2020  ] == 0..        
-00018c20: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
-00018c30: 706f 7369 7469 6f6e 2e61 7070 656e 6428  position.append(
-00018c40: 5b69 2c20 6a20 2d20 315d 290d 0a20 2020  [i, j - 1])..   
-00018c50: 2020 2020 2020 2020 2076 616c 7565 732e           values.
-00018c60: 6170 7065 6e64 2861 7272 6179 5b69 2c20  append(array[i, 
-00018c70: 6a20 2d20 315d 290d 0a20 2020 2020 2020  j - 1])..       
-00018c80: 2020 2020 2063 6c75 7374 6572 5b69 2c20       cluster[i, 
-00018c90: 6a20 2d20 315d 203d 2063 6f75 6e74 0d0a  j - 1] = count..
-00018ca0: 2020 2020 2020 2020 2020 2020 4461 7461              Data
-00018cb0: 7365 742e 5f67 726f 7570 4e65 6967 6862  set._groupNeighb
-00018cc0: 6f75 7273 280d 0a20 2020 2020 2020 2020  ours(..         
-00018cd0: 2020 2020 2020 2061 7272 6179 2c0d 0a20         array,.. 
-00018ce0: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00018cf0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-00018d00: 2020 206a 202d 2031 2c0d 0a20 2020 2020     j - 1,..     
-00018d10: 2020 2020 2020 2020 2020 206c 6f77 6572             lower
-00018d20: 7661 6c75 652c 0d0a 2020 2020 2020 2020  value,..        
-00018d30: 2020 2020 2020 2020 7570 7065 7276 616c          upperval
-00018d40: 7565 2c0d 0a20 2020 2020 2020 2020 2020  ue,..           
-00018d50: 2020 2020 2070 6f73 6974 696f 6e2c 0d0a       position,..
-00018d60: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00018d70: 7661 6c75 6573 2c0d 0a20 2020 2020 2020  values,..       
-00018d80: 2020 2020 2020 2020 2063 6f75 6e74 2c0d           count,.
-00018d90: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00018da0: 2063 6c75 7374 6572 2c0d 0a20 2020 2020   cluster,..     
-00018db0: 2020 2020 2020 2029 0d0a 2020 2020 2020         )..      
-00018dc0: 2020 2320 626f 7474 6f6d 206c 6566 740d    # bottom left.
-00018dd0: 0a20 2020 2020 2020 2069 6620 280d 0a20  .        if (.. 
-00018de0: 2020 2020 2020 2020 2020 206a 202d 2031             j - 1
-00018df0: 203e 3d20 300d 0a20 2020 2020 2020 2020   >= 0..         
-00018e00: 2020 2061 6e64 2069 202b 2031 203c 2061     and i + 1 < a
-00018e10: 7272 6179 2e73 6861 7065 5b30 5d0d 0a20  rray.shape[0].. 
-00018e20: 2020 2020 2020 2020 2020 2061 6e64 206c             and l
-00018e30: 6f77 6572 7661 6c75 6520 3c3d 2061 7272  owervalue <= arr
-00018e40: 6179 5b69 202b 2031 2c20 6a20 2d20 315d  ay[i + 1, j - 1]
-00018e50: 203c 3d20 7570 7065 7276 616c 7565 0d0a   <= uppervalue..
-00018e60: 2020 2020 2020 2020 2020 2020 616e 6420              and 
-00018e70: 636c 7573 7465 725b 6920 2b20 312c 206a  cluster[i + 1, j
-00018e80: 202d 2031 5d20 3d3d 2030 0d0a 2020 2020   - 1] == 0..    
-00018e90: 2020 2020 293a 0d0a 2020 2020 2020 2020      ):..        
-00018ea0: 2020 2020 706f 7369 7469 6f6e 2e61 7070      position.app
-00018eb0: 656e 6428 5b69 202b 2031 2c20 6a20 2d20  end([i + 1, j - 
-00018ec0: 315d 290d 0a20 2020 2020 2020 2020 2020  1])..           
-00018ed0: 2076 616c 7565 732e 6170 7065 6e64 2861   values.append(a
-00018ee0: 7272 6179 5b69 202b 2031 2c20 6a20 2d20  rray[i + 1, j - 
-00018ef0: 315d 290d 0a20 2020 2020 2020 2020 2020  1])..           
-00018f00: 2063 6c75 7374 6572 5b69 202b 2031 2c20   cluster[i + 1, 
-00018f10: 6a20 2d20 315d 203d 2063 6f75 6e74 0d0a  j - 1] = count..
-00018f20: 2020 2020 2020 2020 2020 2020 4461 7461              Data
-00018f30: 7365 742e 5f67 726f 7570 4e65 6967 6862  set._groupNeighb
-00018f40: 6f75 7273 280d 0a20 2020 2020 2020 2020  ours(..         
-00018f50: 2020 2020 2020 2061 7272 6179 2c0d 0a20         array,.. 
-00018f60: 2020 2020 2020 2020 2020 2020 2020 2069                 i
-00018f70: 202b 2031 2c0d 0a20 2020 2020 2020 2020   + 1,..         
-00018f80: 2020 2020 2020 206a 202d 2031 2c0d 0a20         j - 1,.. 
-00018f90: 2020 2020 2020 2020 2020 2020 2020 206c                 l
-00018fa0: 6f77 6572 7661 6c75 652c 0d0a 2020 2020  owervalue,..    
-00018fb0: 2020 2020 2020 2020 2020 2020 7570 7065              uppe
-00018fc0: 7276 616c 7565 2c0d 0a20 2020 2020 2020  rvalue,..       
-00018fd0: 2020 2020 2020 2020 2070 6f73 6974 696f           positio
-00018fe0: 6e2c 0d0a 2020 2020 2020 2020 2020 2020  n,..            
-00018ff0: 2020 2020 7661 6c75 6573 2c0d 0a20 2020      values,..   
-00019000: 2020 2020 2020 2020 2020 2020 2063 6f75               cou
-00019010: 6e74 2c0d 0a20 2020 2020 2020 2020 2020  nt,..           
-00019020: 2020 2020 2063 6c75 7374 6572 2c0d 0a20       cluster,.. 
-00019030: 2020 2020 2020 2020 2020 2029 0d0a 0d0a             )....
-00019040: 2020 2020 6465 6620 636c 7573 7465 7228      def cluster(
-00019050: 0d0a 2020 2020 2020 2020 7365 6c66 2c20  ..        self, 
-00019060: 6c6f 7765 725f 626f 756e 643a 2041 6e79  lower_bound: Any
-00019070: 2c20 7570 7065 725f 626f 756e 643a 2041  , upper_bound: A
-00019080: 6e79 0d0a 2020 2020 2920 2d3e 2054 7570  ny..    ) -> Tup
-00019090: 6c65 5b6e 702e 6e64 6172 7261 792c 2069  le[np.ndarray, i
-000190a0: 6e74 2c20 6c69 7374 2c20 6c69 7374 5d3a  nt, list, list]:
-000190b0: 0d0a 2020 2020 2020 2020 2222 2243 6c75  ..        """Clu
-000190c0: 7374 6572 0d0a 0d0a 2020 2020 2020 2020  ster....        
-000190d0: 2020 2020 2d20 6772 6f75 7020 616c 6c20      - group all 
-000190e0: 7468 6520 636f 6e6e 6563 7465 6420 7661  the connected va
-000190f0: 6c75 6573 2062 6574 7765 656e 2074 776f  lues between two
-00019100: 206e 756d 6265 7273 2069 6e20 6120 7261   numbers in a ra
-00019110: 7374 6572 2069 6e20 636c 7573 7465 7273  ster in clusters
-00019120: 2e0d 0a0d 0a20 2020 2020 2020 2050 6172  .....        Par
-00019130: 616d 6574 6572 730d 0a20 2020 2020 2020  ameters..       
-00019140: 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020   ----------..   
-00019150: 2020 2020 206c 6f77 6572 5f62 6f75 6e64       lower_bound
-00019160: 203a 205b 6e75 6d65 7269 635d 0d0a 2020   : [numeric]..  
-00019170: 2020 2020 2020 2020 2020 6c6f 7765 7220            lower 
-00019180: 626f 756e 6420 6f66 2074 6865 2063 6c75  bound of the clu
-00019190: 7374 6572 2e0d 0a20 2020 2020 2020 2075  ster...        u
-000191a0: 7070 6572 5f62 6f75 6e64 203a 205b 6e75  pper_bound : [nu
-000191b0: 6d65 7269 635d 0d0a 2020 2020 2020 2020  meric]..        
-000191c0: 2020 2020 7570 7065 7220 626f 756e 6420      upper bound 
-000191d0: 6f66 2074 6865 2063 6c75 7374 6572 2e0d  of the cluster..
-000191e0: 0a0d 0a20 2020 2020 2020 2052 6574 7572  ...        Retur
-000191f0: 6e73 0d0a 2020 2020 2020 2020 2d2d 2d2d  ns..        ----
-00019200: 2d2d 2d0d 0a20 2020 2020 2020 2063 6c75  ---..        clu
-00019210: 7374 6572 203a 205b 6172 7261 795d 0d0a  ster : [array]..
-00019220: 2020 2020 2020 2020 2020 2020 6172 7261              arra
-00019230: 7920 636f 6e74 6169 6e73 2069 6e74 6567  y contains integ
-00019240: 6572 206e 756d 6265 7273 2072 6570 7265  er numbers repre
-00019250: 7365 6e74 696e 6720 7468 6520 6e75 6d62  senting the numb
-00019260: 6572 206f 6620 7468 6520 636c 7573 7465  er of the cluste
-00019270: 722e 0d0a 2020 2020 2020 2020 636f 756e  r...        coun
-00019280: 7420 3a20 5b69 6e74 6567 6572 5d0d 0a20  t : [integer].. 
-00019290: 2020 2020 2020 2020 2020 206e 756d 6265             numbe
-000192a0: 7220 6f66 2074 6865 2063 6c75 7374 6572  r of the cluster
-000192b0: 7320 696e 2074 6865 2061 7272 6179 2e0d  s in the array..
-000192c0: 0a20 2020 2020 2020 2070 6f73 6974 696f  .        positio
-000192d0: 6e20 3a20 5b6c 6973 745d 0d0a 2020 2020  n : [list]..    
-000192e0: 2020 2020 2020 2020 6c69 7374 2063 6f6e          list con
-000192f0: 7461 696e 7320 7477 6f20 696e 6465 6365  tains two indece
-00019300: 7320 5b78 2c79 5d20 666f 7220 7468 6520  s [x,y] for the 
-00019310: 706f 7369 7469 6f6e 206f 6620 6561 6368  position of each
-00019320: 2076 616c 7565 202e 0d0a 2020 2020 2020   value ...      
-00019330: 2020 7661 6c75 6573 203a 205b 6e75 6d65    values : [nume
-00019340: 7269 635d 0d0a 2020 2020 2020 2020 2020  ric]..          
-00019350: 2020 7468 6520 7661 6c75 6573 2073 746f    the values sto
-00019360: 7265 6420 696e 2065 6163 6820 6365 6c6c  red in each cell
-00019370: 2069 6e20 7468 6520 636c 7573 7465 7220   in the cluster 
-00019380: 2e0d 0a20 2020 2020 2020 2022 2222 0d0a  ...        """..
-00019390: 2020 2020 2020 2020 6461 7461 203d 2073          data = s
-000193a0: 656c 662e 7265 6164 5f61 7272 6179 2829  elf.read_array()
-000193b0: 0d0a 2020 2020 2020 2020 706f 7369 7469  ..        positi
-000193c0: 6f6e 203d 205b 5d0d 0a20 2020 2020 2020  on = []..       
-000193d0: 2076 616c 7565 7320 3d20 5b5d 0d0a 2020   values = []..  
-000193e0: 2020 2020 2020 636f 756e 7420 3d20 310d        count = 1.
-000193f0: 0a20 2020 2020 2020 2063 6c75 7374 6572  .        cluster
-00019400: 203d 206e 702e 7a65 726f 7328 7368 6170   = np.zeros(shap
-00019410: 653d 2864 6174 612e 7368 6170 655b 305d  e=(data.shape[0]
-00019420: 2c20 6461 7461 2e73 6861 7065 5b31 5d29  , data.shape[1])
-00019430: 290d 0a0d 0a20 2020 2020 2020 2066 6f72  )....        for
-00019440: 2069 2069 6e20 7261 6e67 6528 6461 7461   i in range(data
-00019450: 2e73 6861 7065 5b30 5d29 3a0d 0a20 2020  .shape[0]):..   
-00019460: 2020 2020 2020 2020 2066 6f72 206a 2069           for j i
-00019470: 6e20 7261 6e67 6528 6461 7461 2e73 6861  n range(data.sha
-00019480: 7065 5b31 5d29 3a0d 0a0d 0a20 2020 2020  pe[1]):....     
-00019490: 2020 2020 2020 2020 2020 2069 6620 6c6f             if lo
-000194a0: 7765 725f 626f 756e 6420 3c3d 2064 6174  wer_bound <= dat
-000194b0: 615b 692c 206a 5d20 3c3d 2075 7070 6572  a[i, j] <= upper
-000194c0: 5f62 6f75 6e64 2061 6e64 2063 6c75 7374  _bound and clust
-000194d0: 6572 5b69 2c20 6a5d 203d 3d20 303a 0d0a  er[i, j] == 0:..
-000194e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000194f0: 2020 2020 7365 6c66 2e5f 6772 6f75 704e      self._groupN
-00019500: 6569 6768 626f 7572 7328 0d0a 2020 2020  eighbours(..    
-00019510: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019520: 2020 2020 6461 7461 2c0d 0a20 2020 2020      data,..     
-00019530: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019540: 2020 2069 2c0d 0a20 2020 2020 2020 2020     i,..         
-00019550: 2020 2020 2020 2020 2020 2020 2020 206a                 j
-00019560: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-00019570: 2020 2020 2020 2020 2020 206c 6f77 6572             lower
-00019580: 5f62 6f75 6e64 2c0d 0a20 2020 2020 2020  _bound,..       
-00019590: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000195a0: 2075 7070 6572 5f62 6f75 6e64 2c0d 0a20   upper_bound,.. 
-000195b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000195c0: 2020 2020 2020 2070 6f73 6974 696f 6e2c         position,
-000195d0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000195e0: 2020 2020 2020 2020 2020 7661 6c75 6573            values
-000195f0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-00019600: 2020 2020 2020 2020 2020 2063 6f75 6e74             count
-00019610: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
-00019620: 2020 2020 2020 2020 2020 2063 6c75 7374             clust
-00019630: 6572 2c0d 0a20 2020 2020 2020 2020 2020  er,..           
-00019640: 2020 2020 2020 2020 2029 0d0a 2020 2020           )..    
-00019650: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019660: 6966 2063 6c75 7374 6572 5b69 2c20 6a5d  if cluster[i, j]
-00019670: 203d 3d20 303a 0d0a 2020 2020 2020 2020   == 0:..        
-00019680: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00019690: 706f 7369 7469 6f6e 2e61 7070 656e 6428  position.append(
-000196a0: 5b69 2c20 6a5d 290d 0a20 2020 2020 2020  [i, j])..       
-000196b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000196c0: 2076 616c 7565 732e 6170 7065 6e64 2864   values.append(d
-000196d0: 6174 615b 692c 206a 5d29 0d0a 2020 2020  ata[i, j])..    
-000196e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000196f0: 2020 2020 636c 7573 7465 725b 692c 206a      cluster[i, j
-00019700: 5d20 3d20 636f 756e 740d 0a20 2020 2020  ] = count..     
-00019710: 2020 2020 2020 2020 2020 2020 2020 2063                 c
-00019720: 6f75 6e74 203d 2063 6f75 6e74 202b 2031  ount = count + 1
-00019730: 0d0a 0d0a 2020 2020 2020 2020 7265 7475  ....        retu
-00019740: 726e 2063 6c75 7374 6572 2c20 636f 756e  rn cluster, coun
-00019750: 742c 2070 6f73 6974 696f 6e2c 2076 616c  t, position, val
-00019760: 7565 730d 0a0d 0a20 2020 2064 6566 206c  ues....    def l
-00019770: 6973 7441 7474 7269 6275 7465 7328 7365  istAttributes(se
-00019780: 6c66 293a 0d0a 2020 2020 2020 2020 2222  lf):..        ""
-00019790: 2250 7269 6e74 2041 7474 7269 6275 7465  "Print Attribute
-000197a0: 7320 4c69 7374 2e22 2222 0d0a 0d0a 2020  s List."""....  
-000197b0: 2020 2020 2020 7072 696e 7428 225c 6e22        print("\n"
-000197c0: 290d 0a20 2020 2020 2020 2070 7269 6e74  )..        print
-000197d0: 280d 0a20 2020 2020 2020 2020 2020 2066  (..            f
-000197e0: 2241 7474 7269 6275 7465 7320 4c69 7374  "Attributes List
-000197f0: 206f 663a 207b 2072 6570 7228 7365 6c66   of: { repr(self
-00019800: 2e5f 5f64 6963 745f 5f5b 276e 616d 6527  .__dict__['name'
-00019810: 5d29 7d20 2d20 7b73 656c 662e 5f5f 636c  ])} - {self.__cl
-00019820: 6173 735f 5f2e 5f5f 6e61 6d65 5f5f 7d20  ass__.__name__} 
-00019830: 2049 6e73 7461 6e63 655c 6e22 0d0a 2020   Instance\n"..  
-00019840: 2020 2020 2020 290d 0a20 2020 2020 2020        )..       
-00019850: 2073 656c 665f 6b65 7973 203d 206c 6973   self_keys = lis
-00019860: 7428 7365 6c66 2e5f 5f64 6963 745f 5f2e  t(self.__dict__.
-00019870: 6b65 7973 2829 290d 0a20 2020 2020 2020  keys())..       
-00019880: 2073 656c 665f 6b65 7973 2e73 6f72 7428   self_keys.sort(
-00019890: 290d 0a20 2020 2020 2020 2066 6f72 206b  )..        for k
-000198a0: 6579 2069 6e20 7365 6c66 5f6b 6579 733a  ey in self_keys:
-000198b0: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
-000198c0: 206b 6579 2021 3d20 226e 616d 6522 3a0d   key != "name":.
-000198d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000198e0: 2070 7269 6e74 2873 7472 286b 6579 2920   print(str(key) 
-000198f0: 2b20 2220 3a20 2220 2b20 7265 7072 2873  + " : " + repr(s
-00019900: 656c 662e 5f5f 6469 6374 5f5f 5b6b 6579  elf.__dict__[key
-00019910: 5d29 290d 0a0d 0a20 2020 2020 2020 2070  ]))....        p
-00019920: 7269 6e74 2822 5c6e 2229 0d0a 0d0a 0d0a  rint("\n")......
-00019930: 636c 6173 7320 4461 7461 6375 6265 3a0d  class Datacube:.
-00019940: 0a20 2020 2022 2222 4461 7461 4375 6265  .    """DataCube
-00019950: 2e22 2222 0d0a 0d0a 2020 2020 6669 6c65  ."""....    file
-00019960: 733a 204c 6973 745b 7374 725d 0d0a 2020  s: List[str]..  
-00019970: 2020 6461 7461 3a20 6e70 2e6e 6461 7272    data: np.ndarr
-00019980: 6179 0d0a 0d0a 2020 2020 2222 220d 0a20  ay....    """.. 
-00019990: 2020 2066 696c 6573 3a0d 0a20 2020 2020     files:..     
-000199a0: 2020 206c 6973 7420 6f66 2067 656f 7469     list of geoti
-000199b0: 6666 2066 696c 6573 2720 6e61 6d65 730d  ff files' names.
-000199c0: 0a20 2020 2022 2222 0d0a 0d0a 2020 2020  .    """....    
-000199d0: 6465 6620 5f5f 696e 6974 5f5f 280d 0a20  def __init__(.. 
-000199e0: 2020 2020 2020 2073 656c 662c 0d0a 2020         self,..  
-000199f0: 2020 2020 2020 7372 633a 2044 6174 6173        src: Datas
-00019a00: 6574 2c0d 0a20 2020 2020 2020 2074 696d  et,..        tim
-00019a10: 655f 6c65 6e67 7468 3a20 696e 742c 0d0a  e_length: int,..
-00019a20: 2020 2020 2020 2020 6669 6c65 733a 204c          files: L
-00019a30: 6973 745b 7374 725d 203d 204e 6f6e 652c  ist[str] = None,
-00019a40: 0d0a 2020 2020 293a 0d0a 2020 2020 2020  ..    ):..      
-00019a50: 2020 7365 6c66 2e5f 6261 7365 203d 2073    self._base = s
-00019a60: 7263 0d0a 2020 2020 2020 2020 7365 6c66  rc..        self
-00019a70: 2e66 696c 6573 203d 2066 696c 6573 0d0a  .files = files..
-00019a80: 2020 2020 2020 2020 7365 6c66 2e5f 7469          self._ti
-00019a90: 6d65 5f6c 656e 6774 6820 3d20 7469 6d65  me_length = time
-00019aa0: 5f6c 656e 6774 680d 0a0d 0a20 2020 2020  _length....     
-00019ab0: 2020 2070 6173 730d 0a0d 0a20 2020 2064     pass....    d
-00019ac0: 6566 205f 5f73 7472 5f5f 2873 656c 6629  ef __str__(self)
-00019ad0: 3a0d 0a20 2020 2020 2020 206d 6573 7361  :..        messa
-00019ae0: 6765 203d 2066 2222 220d 0a20 2020 2020  ge = f"""..     
-00019af0: 2020 2020 2020 2046 696c 6573 3a20 7b6c         Files: {l
-00019b00: 656e 2873 656c 662e 6669 6c65 7329 7d0d  en(self.files)}.
-00019b10: 0a20 2020 2020 2020 2020 2020 2043 656c  .            Cel
-00019b20: 6c20 7369 7a65 3a20 7b73 656c 662e 5f62  l size: {self._b
-00019b30: 6173 652e 6365 6c6c 5f73 697a 657d 0d0a  ase.cell_size}..
-00019b40: 2020 2020 2020 2020 2020 2020 4550 5347              EPSG
-00019b50: 3a20 7b73 656c 662e 5f62 6173 652e 6570  : {self._base.ep
-00019b60: 7367 7d0d 0a20 2020 2020 2020 2020 2020  sg}..           
-00019b70: 2056 6172 6961 626c 6573 3a20 7b73 656c   Variables: {sel
-00019b80: 662e 5f62 6173 652e 7661 7269 6162 6c65  f._base.variable
-00019b90: 737d 0d0a 2020 2020 2020 2020 2020 2020  s}..            
-00019ba0: 4469 6d65 6e73 696f 6e3a 207b 7365 6c66  Dimension: {self
-00019bb0: 2e72 6f77 7320 2a20 7365 6c66 2e63 6f6c  .rows * self.col
-00019bc0: 756d 6e73 7d0d 0a20 2020 2020 2020 2020  umns}..         
-00019bd0: 2020 204d 6173 6b3a 207b 7365 6c66 2e5f     Mask: {self._
-00019be0: 6261 7365 2e6e 6f5f 6461 7461 5f76 616c  base.no_data_val
-00019bf0: 7565 5b30 5d7d 0d0a 2020 2020 2020 2020  ue[0]}..        
-00019c00: 2222 220d 0a20 2020 2020 2020 2072 6574  """..        ret
-00019c10: 7572 6e20 6d65 7373 6167 650d 0a0d 0a20  urn message.... 
-00019c20: 2020 2040 7072 6f70 6572 7479 0d0a 2020     @property..  
-00019c30: 2020 6465 6620 6261 7365 2873 656c 6629    def base(self)
-00019c40: 202d 3e20 4461 7461 7365 743a 0d0a 2020   -> Dataset:..  
-00019c50: 2020 2020 2020 2222 2262 6173 652e 0d0a        """base...
-00019c60: 0d0a 2020 2020 2020 2020 4261 7365 2044  ..        Base D
-00019c70: 6174 6173 6574 0d0a 2020 2020 2020 2020  ataset..        
-00019c80: 2222 220d 0a20 2020 2020 2020 2072 6574  """..        ret
-00019c90: 7572 6e20 7365 6c66 2e5f 6261 7365 0d0a  urn self._base..
-00019ca0: 0d0a 2020 2020 4070 726f 7065 7274 790d  ..    @property.
-00019cb0: 0a20 2020 2064 6566 2074 696d 655f 6c65  .    def time_le
-00019cc0: 6e67 7468 2873 656c 6629 202d 3e20 696e  ngth(self) -> in
-00019cd0: 743a 0d0a 2020 2020 2020 2020 2222 226c  t:..        """l
-00019ce0: 656e 6774 6820 6f66 2074 6865 2064 6174  ength of the dat
-00019cf0: 6173 6574 2e22 2222 0d0a 2020 2020 2020  aset."""..      
-00019d00: 2020 7265 7475 726e 2073 656c 662e 5f74    return self._t
-00019d10: 696d 655f 6c65 6e67 7468 0d0a 0d0a 2020  ime_length....  
-00019d20: 2020 4070 726f 7065 7274 790d 0a20 2020    @property..   
-00019d30: 2064 6566 2072 6f77 7328 7365 6c66 293a   def rows(self):
-00019d40: 0d0a 2020 2020 2020 2020 2222 224e 756d  ..        """Num
-00019d50: 6265 7220 6f66 2072 6f77 7322 2222 0d0a  ber of rows"""..
-00019d60: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-00019d70: 656c 662e 5f62 6173 652e 726f 7773 0d0a  elf._base.rows..
-00019d80: 0d0a 2020 2020 4070 726f 7065 7274 790d  ..    @property.
-00019d90: 0a20 2020 2064 6566 2073 6861 7065 2873  .    def shape(s
-00019da0: 656c 6629 3a0d 0a20 2020 2020 2020 2022  elf):..        "
-00019db0: 2222 4e75 6d62 6572 206f 6620 726f 7773  ""Number of rows
-00019dc0: 2222 220d 0a20 2020 2020 2020 2072 6574  """..        ret
-00019dd0: 7572 6e20 7365 6c66 2e74 696d 655f 6c65  urn self.time_le
-00019de0: 6e67 7468 2c20 7365 6c66 2e72 6f77 732c  ngth, self.rows,
-00019df0: 2073 656c 662e 636f 6c75 6d6e 730d 0a0d   self.columns...
-00019e00: 0a20 2020 2040 7072 6f70 6572 7479 0d0a  .    @property..
-00019e10: 2020 2020 6465 6620 636f 6c75 6d6e 7328      def columns(
-00019e20: 7365 6c66 293a 0d0a 2020 2020 2020 2020  self):..        
-00019e30: 2222 224e 756d 6265 7220 6f66 2063 6f6c  """Number of col
-00019e40: 756d 6e73 2222 220d 0a20 2020 2020 2020  umns"""..       
-00019e50: 2072 6574 7572 6e20 7365 6c66 2e5f 6261   return self._ba
-00019e60: 7365 2e63 6f6c 756d 6e73 0d0a 0d0a 2020  se.columns....  
-00019e70: 2020 4063 6c61 7373 6d65 7468 6f64 0d0a    @classmethod..
-00019e80: 2020 2020 6465 6620 6372 6561 7465 5f63      def create_c
-00019e90: 7562 6528 636c 732c 2073 7263 3a20 4461  ube(cls, src: Da
-00019ea0: 7461 7365 742c 2064 6174 6173 6574 5f6c  taset, dataset_l
-00019eb0: 656e 6774 683a 2069 6e74 293a 0d0a 2020  ength: int):..  
-00019ec0: 2020 2020 2020 2222 2243 7265 6174 6520        """Create 
-00019ed0: 4461 7461 6375 6265 2e0d 0a0d 0a20 2020  Datacube.....   
-00019ee0: 2020 2020 2020 2020 202d 2043 7265 6174           - Creat
-00019ef0: 6520 4461 7461 6375 6265 2066 726f 6d20  e Datacube from 
-00019f00: 6120 7361 6d70 6c65 2072 6173 7465 7220  a sample raster 
-00019f10: 616e 640d 0a0d 0a20 2020 2020 2020 2050  and....        P
-00019f20: 6172 616d 6574 6572 730d 0a20 2020 2020  arameters..     
-00019f30: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20     ----------.. 
-00019f40: 2020 2020 2020 2073 7263 3a20 5b44 6174         src: [Dat
-00019f50: 6173 6574 5d0d 0a20 2020 2020 2020 2020  aset]..         
-00019f60: 2020 2052 4173 7465 7220 4f62 6a65 6374     RAster Object
-00019f70: 0d0a 2020 2020 2020 2020 6461 7461 7365  ..        datase
-00019f80: 745f 6c65 6e67 7468 3a20 5b69 6e74 5d0d  t_length: [int].
-00019f90: 0a20 2020 2020 2020 2020 2020 206c 656e  .            len
-00019fa0: 6774 6820 6f66 2074 6865 2064 6174 6173  gth of the datas
-00019fb0: 6574 2e0d 0a0d 0a20 2020 2020 2020 2052  et.....        R
-00019fc0: 6574 7572 6e73 0d0a 2020 2020 2020 2020  eturns..        
-00019fd0: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
-00019fe0: 2044 6174 6163 7562 6520 6f62 6a65 6374   Datacube object
-00019ff0: 2e0d 0a20 2020 2020 2020 2022 2222 0d0a  ...        """..
-0001a000: 2020 2020 2020 2020 7265 7475 726e 2063          return c
-0001a010: 6c73 2873 7263 2c20 6461 7461 7365 745f  ls(src, dataset_
-0001a020: 6c65 6e67 7468 290d 0a0d 0a20 2020 2064  length)....    d
-0001a030: 6566 2075 7064 6174 655f 6375 6265 2873  ef update_cube(s
-0001a040: 656c 662c 2061 7272 6179 3a20 6e70 2e6e  elf, array: np.n
-0001a050: 6461 7272 6179 293a 0d0a 2020 2020 2020  darray):..      
-0001a060: 2020 2222 2255 7064 6174 6520 6461 7461    """Update data
-0001a070: 7365 7420 6461 7461 2e0d 0a0d 0a20 2020  set data.....   
-0001a080: 2020 2020 2020 2020 202d 2054 6869 7320           - This 
-0001a090: 6675 6e63 7469 6f6e 2063 7265 6174 6573  function creates
-0001a0a0: 2061 2047 656f 7469 6666 2072 6173 7465   a Geotiff raste
-0001a0b0: 7220 6c69 6b65 2061 6e6f 7468 6572 2069  r like another i
-0001a0c0: 6e70 7574 2072 6173 7465 722c 206e 6577  nput raster, new
-0001a0d0: 2072 6173 7465 7220 7769 6c6c 2068 6176   raster will hav
-0001a0e0: 6520 7468 6520 7361 6d65 0d0a 2020 2020  e the same..    
-0001a0f0: 2020 2020 2020 2020 7072 6f6a 6563 7469          projecti
-0001a100: 6f6e 2c20 636f 6f72 6469 6e61 7465 7320  on, coordinates 
-0001a110: 6f72 2074 6865 2074 6f70 206c 6566 7420  or the top left 
-0001a120: 636f 726e 6572 206f 6620 7468 6520 6f72  corner of the or
-0001a130: 6967 696e 616c 2072 6173 7465 722c 2063  iginal raster, c
-0001a140: 656c 6c20 7369 7a65 2c20 6e6f 6461 7461  ell size, nodata
-0001a150: 2076 656c 7565 2c20 616e 6420 6e75 6d62   velue, and numb
-0001a160: 6572 0d0a 2020 2020 2020 2020 2020 2020  er..            
-0001a170: 6f66 2072 6f77 7320 616e 6420 636f 6c75  of rows and colu
-0001a180: 6d6e 730d 0a20 2020 2020 2020 2020 2020  mns..           
-0001a190: 202d 2074 6865 2072 6173 7465 7220 616e   - the raster an
-0001a1a0: 6420 7468 6520 6769 7665 6e20 6172 7261  d the given arra
-0001a1b0: 7920 7368 6f75 6c64 2068 6176 6520 7468  y should have th
-0001a1c0: 6520 7361 6d65 206e 756d 6265 7220 6f66  e same number of
-0001a1d0: 2063 6f6c 756d 6e73 2061 6e64 2072 6f77   columns and row
-0001a1e0: 732e 0d0a 0d0a 2020 2020 2020 2020 5061  s.....        Pa
-0001a1f0: 7261 6d65 7465 7273 0d0a 2020 2020 2020  rameters..      
-0001a200: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020    ----------..  
-0001a210: 2020 2020 2020 6172 7261 793a 205b 6e75        array: [nu
-0001a220: 6d70 7920 6172 7261 795d 0d0a 2020 2020  mpy array]..    
-0001a230: 2020 2020 2020 2020 3344 2061 7272 6179          3D array
-0001a240: 2074 6f20 6265 2073 746f 7265 7320 6173   to be stores as
-0001a250: 2061 2072 6173 7465 7273 2c20 7468 6520   a rasters, the 
-0001a260: 6469 6d65 6e73 696f 6e73 2073 686f 756c  dimensions shoul
-0001a270: 6420 6265 0d0a 2020 2020 2020 2020 2020  d be..          
-0001a280: 2020 5b72 6f77 732c 2063 6f6c 756d 6e73    [rows, columns
-0001a290: 2c20 7469 6d65 7365 7269 6573 206c 656e  , timeseries len
-0001a2a0: 6774 685d 0d0a 0d0a 2020 2020 2020 2020  gth]....        
-0001a2b0: 5265 7475 726e 730d 0a20 2020 2020 2020  Returns..       
-0001a2c0: 202d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020   -------..      
-0001a2d0: 2020 7361 7665 2074 6865 206e 6577 2072    save the new r
-0001a2e0: 6173 7465 7220 746f 2074 6865 2067 6976  aster to the giv
-0001a2f0: 656e 2070 6174 680d 0a0d 0a20 2020 2020  en path....     
-0001a300: 2020 2045 7861 6d70 6c65 730d 0a20 2020     Examples..   
-0001a310: 2020 2020 202d 2d2d 2d2d 2d2d 2d0d 0a20       --------.. 
-0001a320: 2020 2020 2020 203e 3e3e 2073 7263 5f72         >>> src_r
-0001a330: 6173 7465 7220 3d20 6764 616c 2e4f 7065  aster = gdal.Ope
-0001a340: 6e28 2244 454d 2e74 6966 2229 0d0a 2020  n("DEM.tif")..  
-0001a350: 2020 2020 2020 3e3e 3e20 6e61 6d65 203d        >>> name =
-0001a360: 205b 2251 5f32 3031 325f 3031 5f30 315f   ["Q_2012_01_01_
-0001a370: 3031 2e74 6966 222c 2251 5f32 3031 325f  01.tif","Q_2012_
-0001a380: 3031 5f30 315f 3032 2e74 6966 222c 2251  01_01_02.tif","Q
-0001a390: 5f32 3031 325f 3031 5f30 315f 3033 2e74  _2012_01_01_03.t
-0001a3a0: 6966 222c 2251 5f32 3031 325f 3031 5f30  if","Q_2012_01_0
-0001a3b0: 315f 3034 2e74 6966 225d 0d0a 2020 2020  1_04.tif"]..    
-0001a3c0: 2020 2020 3e3e 3e20 4461 7461 6375 6265      >>> Datacube
-0001a3d0: 2e72 6173 7465 7273 4c69 6b65 2873 7263  .rastersLike(src
-0001a3e0: 5f72 6173 7465 722c 2064 6174 612c 206e  _raster, data, n
-0001a3f0: 616d 6529 0d0a 2020 2020 2020 2020 2222  ame)..        ""
-0001a400: 220d 0a20 2020 2020 2020 2073 656c 662e  "..        self.
-0001a410: 6461 7461 203d 2061 7272 6179 0d0a 0d0a  data = array....
-0001a420: 2020 2020 4063 6c61 7373 6d65 7468 6f64      @classmethod
-0001a430: 0d0a 2020 2020 6465 6620 7265 6164 5f73  ..    def read_s
-0001a440: 6570 6172 6174 655f 6669 6c65 7328 0d0a  eparate_files(..
-0001a450: 2020 2020 2020 2020 636c 732c 0d0a 2020          cls,..  
-0001a460: 2020 2020 2020 7061 7468 3a20 556e 696f        path: Unio
-0001a470: 6e5b 7374 722c 204c 6973 745b 7374 725d  n[str, List[str]
-0001a480: 5d2c 0d0a 2020 2020 2020 2020 7769 7468  ],..        with
-0001a490: 5f6f 7264 6572 3a20 626f 6f6c 203d 2046  _order: bool = F
-0001a4a0: 616c 7365 2c0d 0a20 2020 2020 2020 2073  alse,..        s
-0001a4b0: 7461 7274 3a20 7374 7220 3d20 4e6f 6e65  tart: str = None
-0001a4c0: 2c0d 0a20 2020 2020 2020 2065 6e64 3a20  ,..        end: 
-0001a4d0: 7374 7220 3d20 4e6f 6e65 2c0d 0a20 2020  str = None,..   
-0001a4e0: 2020 2020 2066 6d74 3a20 7374 7220 3d20       fmt: str = 
-0001a4f0: 2225 592d 256d 2d25 6422 2c0d 0a20 2020  "%Y-%m-%d",..   
-0001a500: 2020 2020 2066 7265 713a 2073 7472 203d       freq: str =
-0001a510: 2022 6461 696c 7922 2c0d 0a20 2020 2020   "daily",..     
-0001a520: 2020 2073 6570 6172 6174 6f72 3a20 7374     separator: st
-0001a530: 7220 3d20 225f 222c 0d0a 2020 2020 2020  r = "_",..      
-0001a540: 2020 6578 7465 6e73 696f 6e3a 2073 7472    extension: str
-0001a550: 203d 2022 2e74 6966 222c 0d0a 2020 2020   = ".tif",..    
-0001a560: 293a 0d0a 2020 2020 2020 2020 2222 2272  ):..        """r
-0001a570: 6561 645f 7365 7061 7261 7465 5f66 696c  ead_separate_fil
-0001a580: 6573 2e0d 0a0d 0a20 2020 2020 2020 2020  es.....         
-0001a590: 2020 202d 2072 6561 6473 2072 6173 7465     - reads raste
-0001a5a0: 7273 2066 726f 6d20 6120 666f 6c64 6572  rs from a folder
-0001a5b0: 2061 6e64 2063 7265 6174 6573 2061 2033   and creates a 3
-0001a5c0: 6420 6172 7261 7920 7769 7468 2074 6865  d array with the
-0001a5d0: 2073 616d 6520 3264 2064 696d 656e 7369   same 2d dimensi
-0001a5e0: 6f6e 7320 6f66 2074 6865 2066 6972 7374  ons of the first
-0001a5f0: 2072 6173 7465 7220 696e 0d0a 2020 2020   raster in..    
-0001a600: 2020 2020 2020 2020 7468 6520 666f 6c64          the fold
-0001a610: 6572 2061 6e64 206c 656e 2061 7320 7468  er and len as th
-0001a620: 6520 6e75 6d62 6572 206f 6620 6669 6c65  e number of file
-0001a630: 730d 0a0d 0a20 2020 2020 2020 2069 6e73  s....        ins
-0001a640: 6964 6520 7468 6520 666f 6c64 6572 2e0d  ide the folder..
-0001a650: 0a20 2020 2020 2020 2020 2020 202d 2041  .            - A
-0001a660: 6c6c 2072 6173 7465 7273 2073 686f 756c  ll rasters shoul
-0001a670: 6420 6861 7665 2074 6865 2073 616d 6520  d have the same 
-0001a680: 6469 6d65 6e73 696f 6e73 0d0a 2020 2020  dimensions..    
-0001a690: 2020 2020 2020 2020 2d20 466f 6c64 6572          - Folder
-0001a6a0: 2073 686f 756c 6420 6f6e 6c79 2063 6f6e   should only con
-0001a6b0: 7461 696e 2072 6173 7465 7220 6669 6c65  tain raster file
-0001a6c0: 730d 0a20 2020 2020 2020 2020 2020 202d  s..            -
-0001a6d0: 2072 6173 7465 7220 6669 6c65 206e 616d   raster file nam
-0001a6e0: 6520 7368 6f75 6c64 2068 6176 6520 7468  e should have th
-0001a6f0: 6520 6461 7465 2061 7420 7468 6520 656e  e date at the en
-0001a700: 6420 6f66 2074 6865 2066 696c 6520 6e61  d of the file na
-0001a710: 6d65 2062 6566 6f72 6520 7468 6520 6578  me before the ex
-0001a720: 7465 6e73 696f 6e20 6469 7265 6374 6c79  tension directly
-0001a730: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0001a740: 7769 7468 2074 6865 2059 5959 592e 4d4d  with the YYYY.MM
-0001a750: 2e44 4420 2f20 5959 5959 2d4d 4d2d 4444  .DD / YYYY-MM-DD
-0001a760: 206f 7220 5959 5959 5f4d 4d5f 4444 0d0a   or YYYY_MM_DD..
-0001a770: 2020 2020 2020 2020 2020 2020 2020 3e3e                >>
-0001a780: 3e20 2235 305f 4d53 5745 505f 3139 3739  > "50_MSWEP_1979
-0001a790: 2e30 312e 3031 2e74 6966 220d 0a0d 0a20  .01.01.tif".... 
-0001a7a0: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
-0001a7b0: 730d 0a20 2020 2020 2020 202d 2d2d 2d2d  s..        -----
-0001a7c0: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 2070  -----..        p
-0001a7d0: 6174 683a 5b53 7472 696e 672f 6c69 7374  ath:[String/list
-0001a7e0: 5d0d 0a20 2020 2020 2020 2020 2020 2070  ]..            p
-0001a7f0: 6174 6820 6f66 2074 6865 2066 6f6c 6465  ath of the folde
-0001a800: 7220 7468 6174 2063 6f6e 7461 696e 7320  r that contains 
-0001a810: 616c 6c20 7468 6520 7261 7374 6572 7320  all the rasters 
-0001a820: 6f72 0d0a 2020 2020 2020 2020 2020 2020  or..            
-0001a830: 6120 6c69 7374 2063 6f6e 7461 696e 7320  a list contains 
-0001a840: 7468 6520 7061 7468 7320 6f66 2074 6865  the paths of the
-0001a850: 2072 6173 7465 7273 2074 6f20 7265 6164   rasters to read
-0001a860: 2e0d 0a20 2020 2020 2020 2077 6974 685f  ...        with_
-0001a870: 6f72 6465 723a 205b 626f 6f6c 5d0d 0a20  order: [bool].. 
-0001a880: 2020 2020 2020 2020 2020 2054 7275 6520             True 
-0001a890: 6966 2074 6865 2072 6173 7465 7273 2066  if the rasters f
-0001a8a0: 6f6c 6c6f 7773 2061 2063 6572 7461 696e  ollows a certain
-0001a8b0: 206f 7264 6572 2c20 7468 656e 2074 6865   order, then the
-0001a8c0: 2072 6173 7465 7273 206e 616d 6573 2073   rasters names s
-0001a8d0: 686f 756c 6420 6861 7665 2061 0d0a 2020  hould have a..  
-0001a8e0: 2020 2020 2020 2020 2020 6e75 6d62 6572            number
-0001a8f0: 2061 7420 7468 6520 6265 6769 6e6e 696e   at the beginnin
-0001a900: 6720 6f66 2074 6865 2066 696c 6520 6e61  g of the file na
-0001a910: 6d65 2069 6e64 6963 6174 696e 6720 7468  me indicating th
-0001a920: 6520 6f72 6465 722e 0d0a 2020 2020 2020  e order...      
-0001a930: 2020 2020 2020 3e3e 3e20 2230 315f 4d53        >>> "01_MS
-0001a940: 5745 505f 3139 3739 2e30 312e 3031 2e74  WEP_1979.01.01.t
-0001a950: 6966 220d 0a20 2020 2020 2020 2020 2020  if"..           
-0001a960: 203e 3e3e 2022 3032 5f4d 5357 4550 5f31   >>> "02_MSWEP_1
-0001a970: 3937 392e 3031 2e30 322e 7469 6622 0d0a  979.01.02.tif"..
-0001a980: 2020 2020 2020 2020 2020 2020 3e3e 3e20              >>> 
-0001a990: 2e2e 2e0d 0a20 2020 2020 2020 2020 2020  .....           
-0001a9a0: 203e 3e3e 2022 3230 5f4d 5357 4550 5f31   >>> "20_MSWEP_1
-0001a9b0: 3937 392e 3031 2e32 302e 7469 6622 0d0a  979.01.20.tif"..
-0001a9c0: 2020 2020 2020 2020 2020 2020 2d20 6375              - cu
-0001a9d0: 7272 656e 746c 7920 7468 6520 6675 6e63  rrently the func
-0001a9e0: 7469 6f6e 2064 6570 656e 6473 206d 6169  tion depends mai
-0001a9f0: 6e6c 7920 6f6e 2074 6865 2073 6570 6172  nly on the separ
-0001aa00: 6174 6f72 2022 5f22 2074 6861 7420 7365  ator "_" that se
-0001aa10: 7061 7261 7465 2074 6865 206f 7264 6572  parate the order
-0001aa20: 206e 756d 6265 7220 6672 6f6d 2074 6865   number from the
-0001aa30: 2072 6573 7420 6f66 0d0a 2020 2020 2020   rest of..      
-0001aa40: 2020 2020 2020 6669 6c65 206e 616d 652e        file name.
-0001aa50: 0d0a 2020 2020 2020 2020 2020 2020 2d20  ..            - 
-0001aa60: 7468 6520 7365 7061 7261 746f 7220 6265  the separator be
-0001aa70: 7477 6565 6e20 7468 6520 6461 7465 2070  tween the date p
-0001aa80: 6172 7473 2059 5959 592e 4d4d 2e44 4420  arts YYYY.MM.DD 
-0001aa90: 6972 2059 5959 595f 4d4d 5f44 4420 6f72  ir YYYY_MM_DD or
-0001aaa0: 2061 6e79 206f 7468 6572 2073 6570 6172   any other separ
-0001aab0: 6174 6f72 2064 6f65 7320 6e6f 7420 6d61  ator does not ma
-0001aac0: 7474 6572 2c0d 0a20 2020 2020 2020 2020  tter,..         
-0001aad0: 2020 2068 6f77 6576 6572 2074 6865 2073     however the s
-0001aae0: 6570 6172 6174 6f72 2068 6173 2074 6f20  eparator has to 
-0001aaf0: 6265 206f 6e6c 7920 6f6e 6520 6c65 7474  be only one lett
-0001ab00: 6572 2e0d 0a20 2020 2020 2020 2066 6d74  er...        fmt
-0001ab10: 3a20 5b73 7472 5d0d 0a20 2020 2020 2020  : [str]..       
-0001ab20: 2020 2020 2066 6f72 6d61 7420 6f66 2074       format of t
-0001ab30: 6865 2067 6976 656e 2064 6174 650d 0a20  he given date.. 
-0001ab40: 2020 2020 2020 2073 7461 7274 3a20 5b73         start: [s
-0001ab50: 7472 5d0d 0a20 2020 2020 2020 2020 2020  tr]..           
-0001ab60: 2073 7461 7274 2064 6174 6520 6966 2079   start date if y
-0001ab70: 6f75 2077 616e 7420 746f 2072 6561 6420  ou want to read 
-0001ab80: 7468 6520 696e 7075 7420 7261 7374 6572  the input raster
-0001ab90: 2066 6f72 2061 2073 7065 6369 6669 6320   for a specific 
-0001aba0: 7065 7269 6f64 206f 6e6c 7920 616e 6420  period only and 
-0001abb0: 6e6f 7420 616c 6c20 7261 7374 6572 732c  not all rasters,
-0001abc0: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
-0001abd0: 206e 6f74 2067 6976 656e 2061 6c6c 2072   not given all r
-0001abe0: 6173 7465 7273 2069 6e20 7468 6520 6769  asters in the gi
-0001abf0: 7665 6e20 7061 7468 2077 696c 6c20 6265  ven path will be
-0001ac00: 2072 6561 642e 0d0a 2020 2020 2020 2020   read...        
-0001ac10: 2020 2020 4869 6e74 3a0d 0a20 2020 2020      Hint:..     
-0001ac20: 2020 2020 2020 2020 2020 2054 6865 2064             The d
-0001ac30: 6174 6520 696e 2074 6865 2072 6173 7465  ate in the raste
-0001ac40: 7220 6669 6c65 206e 616d 6520 7368 6f75  r file name shou
-0001ac50: 6c64 2062 6520 7468 6520 6c61 7374 2073  ld be the last s
-0001ac60: 7472 696e 6720 6265 666f 7220 7468 6520  tring befor the 
-0001ac70: 6669 6c65 2065 7874 656e 7369 6f6e 0d0a  file extension..
-0001ac80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ac90: 3e3e 3e20 2232 305f 4d53 5745 505f 5959  >>> "20_MSWEP_YY
-0001aca0: 5959 2e4d 4d2e 4444 2e74 6966 220d 0a20  YY.MM.DD.tif".. 
-0001acb0: 2020 2020 2020 2065 6e64 3a20 5b73 7472         end: [str
-0001acc0: 5d0d 0a20 2020 2020 2020 2020 2020 2065  ]..            e
-0001acd0: 6e64 2064 6174 6520 6966 2079 6f75 2077  nd date if you w
-0001ace0: 616e 7420 746f 2072 6561 6420 7468 6520  ant to read the 
-0001acf0: 696e 7075 7420 7465 6d70 6572 6174 7572  input temperatur
-0001ad00: 6520 666f 7220 6120 7370 6563 6966 6963  e for a specific
-0001ad10: 2070 6572 696f 6420 6f6e 6c79 2c0d 0a20   period only,.. 
-0001ad20: 2020 2020 2020 2020 2020 2069 6620 6e6f             if no
-0001ad30: 7420 6769 7665 6e20 616c 6c20 7261 7374  t given all rast
-0001ad40: 6572 7320 696e 2074 6865 2067 6976 656e  ers in the given
-0001ad50: 2070 6174 6820 7769 6c6c 2062 6520 7265   path will be re
-0001ad60: 6164 2e0d 0a20 2020 2020 2020 2020 2020  ad...           
-0001ad70: 2048 696e 743a 0d0a 2020 2020 2020 2020   Hint:..        
-0001ad80: 2020 2020 2020 2020 5468 6520 6461 7465          The date
-0001ad90: 2069 6e20 7468 6520 7261 7374 6572 2066   in the raster f
-0001ada0: 696c 6520 6e61 6d65 2073 686f 756c 6420  ile name should 
-0001adb0: 6265 2074 6865 206c 6173 7420 7374 7269  be the last stri
-0001adc0: 6e67 2062 6566 6f72 2074 6865 2066 696c  ng befor the fil
-0001add0: 6520 6578 7465 6e73 696f 6e0d 0a20 2020  e extension..   
-0001ade0: 2020 2020 2020 2020 2020 2020 203e 3e3e               >>>
-0001adf0: 2022 3230 5f4d 5357 4550 5f59 5959 592e   "20_MSWEP_YYYY.
-0001ae00: 4d4d 2e44 442e 7469 6622 0d0a 2020 2020  MM.DD.tif"..    
-0001ae10: 2020 2020 6672 6571 3a20 5b73 7472 5d0d      freq: [str].
-0001ae20: 0a20 2020 2020 2020 2020 2020 2066 7265  .            fre
-0001ae30: 7175 656e 6379 206f 6620 7468 6520 7261  quency of the ra
-0001ae40: 7374 6572 7320 2264 6169 6c79 222c 2048  sters "daily", H
-0001ae50: 6f75 726c 792c 206d 6f6e 7468 6c79 0d0a  ourly, monthly..
-0001ae60: 2020 2020 2020 2020 7365 7061 7261 746f          separato
-0001ae70: 723a 205b 7374 725d 0d0a 2020 2020 2020  r: [str]..      
-0001ae80: 2020 2020 2020 7365 7061 7261 746f 7220        separator 
-0001ae90: 6265 7477 6565 6e20 7468 6520 6f72 6465  between the orde
-0001aea0: 7220 696e 2074 6865 2062 6567 696e 6e69  r in the beginni
-0001aeb0: 6e67 206f 6620 7468 6520 7261 7374 6572  ng of the raster
-0001aec0: 2066 696c 6520 6e61 6d65 2061 6e64 2074   file name and t
-0001aed0: 6865 2072 6573 7420 6f66 2074 6865 2066  he rest of the f
-0001aee0: 696c 650d 0a20 2020 2020 2020 2020 2020  ile..           
-0001aef0: 206e 616d 652e 2044 6566 6175 6c74 2069   name. Default i
-0001af00: 7320 225f 222e 0d0a 2020 2020 2020 2020  s "_"...        
-0001af10: 6578 7465 6e73 696f 6e3a 205b 7374 725d  extension: [str]
-0001af20: 0d0a 2020 2020 2020 2020 2020 2020 7468  ..            th
-0001af30: 6520 6578 7465 6e73 696f 6e20 6f66 2074  e extension of t
-0001af40: 6865 2066 696c 6573 2079 6f75 2077 616e  he files you wan
-0001af50: 7420 746f 2072 6561 6420 6672 6f6d 2074  t to read from t
-0001af60: 6865 2067 6976 656e 2070 6174 682e 2044  he given path. D
-0001af70: 6566 6175 6c74 2069 7320 222e 7469 6622  efault is ".tif"
-0001af80: 2e0d 0a0d 0a20 2020 2020 2020 2052 6574  .....        Ret
-0001af90: 7572 6e73 0d0a 2020 2020 2020 2020 2d2d  urns..        --
-0001afa0: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 2061  -----..        a
-0001afb0: 7272 5f33 643a 205b 6e75 6d70 792e 6e64  rr_3d: [numpy.nd
-0001afc0: 6172 7261 795d 0d0a 2020 2020 2020 2020  array]..        
-0001afd0: 2020 2020 3364 2061 7272 6179 2063 6f6e      3d array con
-0001afe0: 7461 696e 7320 6172 7261 7973 2072 6561  tains arrays rea
-0001aff0: 6420 6672 6f6d 2061 6c6c 2072 6173 7465  d from all raste
-0001b000: 7273 2069 6e20 7468 6520 666f 6c64 6572  rs in the folder
-0001b010: 2e0d 0a0d 0a20 2020 2020 2020 2045 7861  .....        Exa
-0001b020: 6d70 6c65 0d0a 2020 2020 2020 2020 2d2d  mple..        --
-0001b030: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 203e  -----..        >
-0001b040: 3e3e 2066 726f 6d20 7079 7261 6d69 6473  >> from pyramids
-0001b050: 2e64 6174 6173 6574 2069 6d70 6f72 7420  .dataset import 
-0001b060: 4461 7461 6375 6265 0d0a 2020 2020 2020  Datacube..      
-0001b070: 2020 3e3e 3e20 7261 7374 6572 5f66 6f6c    >>> raster_fol
-0001b080: 6465 7220 3d20 2265 7861 6d70 6c65 732f  der = "examples/
-0001b090: 4749 532f 6461 7461 2f72 6173 7465 722d  GIS/data/raster-
-0001b0a0: 666f 6c64 6572 220d 0a20 2020 2020 2020  folder"..       
-0001b0b0: 203e 3e3e 2070 7265 6320 3d20 4461 7461   >>> prec = Data
-0001b0c0: 6375 6265 2e72 6561 645f 7365 7061 7261  cube.read_separa
-0001b0d0: 7465 5f66 696c 6573 2872 6173 7465 725f  te_files(raster_
-0001b0e0: 666f 6c64 6572 290d 0a0d 0a20 2020 2020  folder)....     
-0001b0f0: 2020 203e 3e3e 2069 6d70 6f72 7420 676c     >>> import gl
-0001b100: 6f62 0d0a 2020 2020 2020 2020 3e3e 3e20  ob..        >>> 
-0001b110: 7365 6172 6368 5f63 7269 7465 7269 6120  search_criteria 
-0001b120: 3d20 222a 2e74 6966 220d 0a20 2020 2020  = "*.tif"..     
-0001b130: 2020 203e 3e3e 2066 696c 655f 6c69 7374     >>> file_list
-0001b140: 203d 2067 6c6f 622e 676c 6f62 286f 732e   = glob.glob(os.
-0001b150: 7061 7468 2e6a 6f69 6e28 7261 7374 6572  path.join(raster
-0001b160: 5f66 6f6c 6465 722c 2073 6561 7263 685f  _folder, search_
-0001b170: 6372 6974 6572 6961 2929 0d0a 2020 2020  criteria))..    
-0001b180: 2020 2020 3e3e 3e20 7072 6563 203d 2044      >>> prec = D
-0001b190: 6174 6163 7562 652e 7265 6164 5f73 6570  atacube.read_sep
-0001b1a0: 6172 6174 655f 6669 6c65 7328 6669 6c65  arate_files(file
-0001b1b0: 5f6c 6973 742c 2077 6974 685f 6f72 6465  _list, with_orde
-0001b1c0: 723d 4661 6c73 6529 0d0a 2020 2020 2020  r=False)..      
-0001b1d0: 2020 2222 220d 0a20 2020 2020 2020 2069    """..        i
-0001b1e0: 6620 6e6f 7420 6973 696e 7374 616e 6365  f not isinstance
-0001b1f0: 2870 6174 682c 2073 7472 2920 616e 6420  (path, str) and 
-0001b200: 6e6f 7420 6973 696e 7374 616e 6365 2870  not isinstance(p
-0001b210: 6174 682c 206c 6973 7429 3a0d 0a20 2020  ath, list):..   
-0001b220: 2020 2020 2020 2020 2072 6169 7365 2054           raise T
-0001b230: 7970 6545 7272 6f72 2866 2270 6174 6820  ypeError(f"path 
-0001b240: 696e 7075 7420 7368 6f75 6c64 2062 6520  input should be 
-0001b250: 7374 7269 6e67 2f6c 6973 7420 7479 7065  string/list type
-0001b260: 2c20 6769 7665 6e7b 7479 7065 2870 6174  , given{type(pat
-0001b270: 6829 7d22 290d 0a0d 0a20 2020 2020 2020  h)}")....       
-0001b280: 2069 6620 6973 696e 7374 616e 6365 2870   if isinstance(p
-0001b290: 6174 682c 2073 7472 293a 0d0a 2020 2020  ath, str):..    
-0001b2a0: 2020 2020 2020 2020 2320 6368 6563 6b20          # check 
-0001b2b0: 7765 7468 6572 2074 6865 2070 6174 6820  wether the path 
-0001b2c0: 6578 6973 7420 6f72 206e 6f74 0d0a 2020  exist or not..  
-0001b2d0: 2020 2020 2020 2020 2020 6966 206e 6f74            if not
-0001b2e0: 206f 732e 7061 7468 2e65 7869 7374 7328   os.path.exists(
-0001b2f0: 7061 7468 293a 0d0a 2020 2020 2020 2020  path):..        
-0001b300: 2020 2020 2020 2020 7261 6973 6520 4669          raise Fi
-0001b310: 6c65 4e6f 7446 6f75 6e64 4572 726f 7228  leNotFoundError(
-0001b320: 2254 6865 2070 6174 6820 796f 7520 6861  "The path you ha
-0001b330: 7665 2070 726f 7669 6465 6420 646f 6573  ve provided does
-0001b340: 206e 6f74 2065 7869 7374 2229 0d0a 2020   not exist")..  
-0001b350: 2020 2020 2020 2020 2020 2320 6765 7420            # get 
-0001b360: 6c69 7374 206f 6620 616c 6c20 6669 6c65  list of all file
-0001b370: 730d 0a20 2020 2020 2020 2020 2020 2066  s..            f
-0001b380: 696c 6573 203d 206f 732e 6c69 7374 6469  iles = os.listdi
-0001b390: 7228 7061 7468 290d 0a20 2020 2020 2020  r(path)..       
-0001b3a0: 2020 2020 2066 696c 6573 203d 205b 6920       files = [i 
-0001b3b0: 666f 7220 6920 696e 2066 696c 6573 2069  for i in files i
-0001b3c0: 6620 692e 656e 6473 7769 7468 2865 7874  f i.endswith(ext
-0001b3d0: 656e 7369 6f6e 295d 0d0a 2020 2020 2020  ension)]..      
-0001b3e0: 2020 2020 2020 2320 6669 6c65 7320 3d20        # files = 
-0001b3f0: 676c 6f62 2e67 6c6f 6228 6f73 2e70 6174  glob.glob(os.pat
-0001b400: 682e 6a6f 696e 2870 6174 682c 2022 2a2e  h.join(path, "*.
-0001b410: 7469 6622 2929 0d0a 2020 2020 2020 2020  tif"))..        
-0001b420: 2020 2020 2320 6368 6563 6b20 7768 6574      # check whet
-0001b430: 6865 7220 7468 6572 6520 6172 6520 6669  her there are fi
-0001b440: 6c65 7320 6f72 206e 6f74 2069 6e73 6964  les or not insid
-0001b450: 6520 7468 6520 666f 6c64 6572 0d0a 2020  e the folder..  
-0001b460: 2020 2020 2020 2020 2020 6966 206c 656e            if len
-0001b470: 2866 696c 6573 2920 3c20 313a 0d0a 2020  (files) < 1:..  
-0001b480: 2020 2020 2020 2020 2020 2020 2020 7261                ra
-0001b490: 6973 6520 4669 6c65 4e6f 7446 6f75 6e64  ise FileNotFound
-0001b4a0: 4572 726f 7228 2254 6865 2070 6174 6820  Error("The path 
-0001b4b0: 796f 7520 6861 7665 2070 726f 7669 6465  you have provide
-0001b4c0: 6420 6973 2065 6d70 7479 2229 0d0a 2020  d is empty")..  
-0001b4d0: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
-0001b4e0: 2020 2020 2020 2020 2066 696c 6573 203d           files =
-0001b4f0: 2070 6174 685b 3a5d 0d0a 2020 2020 2020   path[:]..      
-0001b500: 2020 2320 746f 2073 6f72 7420 7468 6520    # to sort the 
-0001b510: 6669 6c65 7320 696e 2074 6865 2073 616d  files in the sam
-0001b520: 6520 6f72 6465 7220 6173 2074 6865 2066  e order as the f
-0001b530: 6972 7374 206e 756d 6265 7220 696e 2074  irst number in t
-0001b540: 6865 206e 616d 650d 0a20 2020 2020 2020  he name..       
-0001b550: 2069 6620 7769 7468 5f6f 7264 6572 3a0d   if with_order:.
-0001b560: 0a20 2020 2020 2020 2020 2020 2074 7279  .            try
-0001b570: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-0001b580: 2020 2066 696c 6573 4e6f 203d 205b 696e     filesNo = [in
-0001b590: 7428 692e 7370 6c69 7428 7365 7061 7261  t(i.split(separa
-0001b5a0: 746f 7229 5b30 5d29 2066 6f72 2069 2069  tor)[0]) for i i
-0001b5b0: 6e20 6669 6c65 735d 0d0a 2020 2020 2020  n files]..      
-0001b5c0: 2020 2020 2020 6578 6365 7074 2056 616c        except Val
-0001b5d0: 7565 4572 726f 723a 0d0a 2020 2020 2020  ueError:..      
-0001b5e0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-0001b5f0: 5661 6c75 6545 7272 6f72 280d 0a20 2020  ValueError(..   
-0001b600: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b610: 2022 706c 6561 7365 2069 6e63 6c75 6465   "please include
-0001b620: 2061 206e 756d 6265 7220 6174 2074 6865   a number at the
-0001b630: 2062 6567 696e 6e69 6e67 206f 6620 7468   beginning of th
-0001b640: 6522 0d0a 2020 2020 2020 2020 2020 2020  e"..            
-0001b650: 2020 2020 2020 2020 2272 6173 7465 7273          "rasters
-0001b660: 206e 616d 6520 746f 2069 6e64 6963 6174   name to indicat
-0001b670: 6520 7468 6520 6f72 6465 7220 6f66 2074  e the order of t
-0001b680: 6865 2072 6173 7465 7273 2e20 746f 2064  he rasters. to d
-0001b690: 6f20 736f 2070 6c65 6173 6522 0d0a 2020  o so please"..  
-0001b6a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b6b0: 2020 2275 7365 2074 6865 2049 6e70 7574    "use the Input
-0001b6c0: 732e 5265 6e61 6d65 4669 6c65 7320 6d65  s.RenameFiles me
-0001b6d0: 7468 6f64 2074 6f20 736f 6c76 6520 7468  thod to solve th
-0001b6e0: 6973 2069 7373 7565 2061 6e64 2064 6f6e  is issue and don
-0001b6f0: 2774 2022 0d0a 2020 2020 2020 2020 2020  't "..          
-0001b700: 2020 2020 2020 2020 2020 2269 6e63 6c75            "inclu
-0001b710: 6465 2061 6e79 206f 7468 6572 2066 696c  de any other fil
-0001b720: 6573 2069 6e20 7468 6520 666f 6c64 6572  es in the folder
-0001b730: 2077 6974 6820 7468 6520 7261 7374 6572   with the raster
-0001b740: 7322 0d0a 2020 2020 2020 2020 2020 2020  s"..            
-0001b750: 2020 2020 290d 0a0d 0a20 2020 2020 2020      )....       
-0001b760: 2020 2020 2066 696c 655f 7475 706c 6520       file_tuple 
-0001b770: 3d20 736f 7274 6564 287a 6970 2866 696c  = sorted(zip(fil
-0001b780: 6573 4e6f 2c20 6669 6c65 7329 290d 0a20  esNo, files)).. 
-0001b790: 2020 2020 2020 2020 2020 2066 696c 6573             files
-0001b7a0: 203d 205b 7820 666f 7220 5f2c 2078 2069   = [x for _, x i
-0001b7b0: 6e20 6669 6c65 5f74 7570 6c65 5d0d 0a0d  n file_tuple]...
-0001b7c0: 0a20 2020 2020 2020 2069 6620 7374 6172  .        if star
-0001b7d0: 7420 6973 206e 6f74 204e 6f6e 6520 6f72  t is not None or
-0001b7e0: 2065 6e64 2069 7320 6e6f 7420 4e6f 6e65   end is not None
-0001b7f0: 3a0d 0a20 2020 2020 2020 2020 2020 2073  :..            s
-0001b800: 7461 7274 203d 2064 742e 6461 7465 7469  tart = dt.dateti
-0001b810: 6d65 2e73 7472 7074 696d 6528 7374 6172  me.strptime(star
-0001b820: 742c 2066 6d74 290d 0a20 2020 2020 2020  t, fmt)..       
-0001b830: 2020 2020 2065 6e64 203d 2064 742e 6461       end = dt.da
-0001b840: 7465 7469 6d65 2e73 7472 7074 696d 6528  tetime.strptime(
-0001b850: 656e 642c 2066 6d74 290d 0a0d 0a20 2020  end, fmt)....   
-0001b860: 2020 2020 2020 2020 2023 2067 6574 2074           # get t
-0001b870: 6865 2064 6174 6573 2066 6f72 2065 6163  he dates for eac
-0001b880: 6820 6669 6c65 0d0a 2020 2020 2020 2020  h file..        
-0001b890: 2020 2020 6461 7465 7320 3d20 6c69 7374      dates = list
-0001b8a0: 2829 0d0a 2020 2020 2020 2020 2020 2020  ()..            
-0001b8b0: 666f 7220 692c 2066 696c 655f 6920 696e  for i, file_i in
-0001b8c0: 2065 6e75 6d65 7261 7465 2866 696c 6573   enumerate(files
-0001b8d0: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
-0001b8e0: 2020 2020 6966 2066 7265 7120 3d3d 2022      if freq == "
-0001b8f0: 6461 696c 7922 3a0d 0a20 2020 2020 2020  daily":..       
-0001b900: 2020 2020 2020 2020 2020 2020 206c 203d               l =
-0001b910: 206c 656e 2866 696c 655f 6929 202d 2034   len(file_i) - 4
-0001b920: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0001b930: 2020 2020 2020 6461 7920 3d20 696e 7428        day = int(
-0001b940: 6669 6c65 5f69 5b6c 202d 2032 203a 206c  file_i[l - 2 : l
-0001b950: 5d29 0d0a 2020 2020 2020 2020 2020 2020  ])..            
-0001b960: 2020 2020 2020 2020 6d6f 6e74 6820 3d20          month = 
-0001b970: 696e 7428 6669 6c65 5f69 5b6c 202d 2035  int(file_i[l - 5
-0001b980: 203a 206c 202d 2033 5d29 0d0a 2020 2020   : l - 3])..    
-0001b990: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001b9a0: 7965 6172 203d 2069 6e74 2866 696c 655f  year = int(file_
-0001b9b0: 695b 6c20 2d20 3130 203a 206c 202d 2036  i[l - 10 : l - 6
-0001b9c0: 5d29 0d0a 2020 2020 2020 2020 2020 2020  ])..            
-0001b9d0: 2020 2020 2020 2020 6461 7465 732e 6170          dates.ap
-0001b9e0: 7065 6e64 2864 742e 6461 7465 7469 6d65  pend(dt.datetime
-0001b9f0: 2879 6561 722c 206d 6f6e 7468 2c20 6461  (year, month, da
-0001ba00: 7929 290d 0a20 2020 2020 2020 2020 2020  y))..           
-0001ba10: 2020 2020 2065 6c69 6620 6672 6571 203d       elif freq =
-0001ba20: 3d20 2268 6f75 726c 7922 3a0d 0a20 2020  = "hourly":..   
-0001ba30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ba40: 2079 6561 7220 3d20 696e 7428 6669 6c65   year = int(file
-0001ba50: 5f69 2e73 706c 6974 2822 5f22 295b 2d34  _i.split("_")[-4
-0001ba60: 5d29 0d0a 2020 2020 2020 2020 2020 2020  ])..            
-0001ba70: 2020 2020 2020 2020 6d6f 6e74 6820 3d20          month = 
-0001ba80: 696e 7428 6669 6c65 5f69 2e73 706c 6974  int(file_i.split
-0001ba90: 2822 5f22 295b 2d33 5d29 0d0a 2020 2020  ("_")[-3])..    
-0001baa0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001bab0: 6461 7920 3d20 696e 7428 6669 6c65 5f69  day = int(file_i
-0001bac0: 2e73 706c 6974 2822 5f22 295b 2d32 5d29  .split("_")[-2])
-0001bad0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0001bae0: 2020 2020 2020 686f 7572 203d 2069 6e74        hour = int
-0001baf0: 2866 696c 655f 692e 7370 6c69 7428 225f  (file_i.split("_
-0001bb00: 2229 5b2d 315d 2e73 706c 6974 2822 2e22  ")[-1].split("."
-0001bb10: 295b 305d 290d 0a20 2020 2020 2020 2020  )[0])..         
-0001bb20: 2020 2020 2020 2020 2020 2064 6174 6573             dates
-0001bb30: 2e61 7070 656e 6428 6474 2e64 6174 6574  .append(dt.datet
-0001bb40: 696d 6528 7965 6172 2c20 6d6f 6e74 682c  ime(year, month,
-0001bb50: 2064 6179 2c20 686f 7572 2929 0d0a 0d0a   day, hour))....
-0001bb60: 2020 2020 2020 2020 2020 2020 7374 6172              star
-0001bb70: 7469 203d 2064 6174 6573 2e69 6e64 6578  ti = dates.index
-0001bb80: 2873 7461 7274 290d 0a20 2020 2020 2020  (start)..       
-0001bb90: 2020 2020 2065 6e64 6920 3d20 6461 7465       endi = date
-0001bba0: 732e 696e 6465 7828 656e 6429 202b 2031  s.index(end) + 1
-0001bbb0: 0d0a 2020 2020 2020 2020 2020 2020 6173  ..            as
-0001bbc0: 7365 7274 2061 6c6c 280d 0a20 2020 2020  sert all(..     
-0001bbd0: 2020 2020 2020 2020 2020 2066 696c 655f             file_
-0001bbe0: 692e 656e 6473 7769 7468 2822 2e74 6966  i.endswith(".tif
-0001bbf0: 2229 2066 6f72 2066 696c 655f 6920 696e  ") for file_i in
-0001bc00: 2066 696c 6573 5b73 7461 7274 693a 656e   files[starti:en
-0001bc10: 6469 5d0d 0a20 2020 2020 2020 2020 2020  di]..           
-0001bc20: 2029 2c20 2261 6c6c 2066 696c 6573 2069   ), "all files i
-0001bc30: 6e20 7468 6520 6769 7665 6e20 666f 6c64  n the given fold
-0001bc40: 6572 2073 686f 756c 6420 6861 7665 202e  er should have .
-0001bc50: 7469 6620 6578 7465 6e73 696f 6e22 0d0a  tif extension"..
-0001bc60: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
-0001bc70: 2020 2020 2020 2020 2020 2073 7461 7274             start
-0001bc80: 6920 3d20 300d 0a20 2020 2020 2020 2020  i = 0..         
-0001bc90: 2020 2065 6e64 6920 3d20 6c65 6e28 6669     endi = len(fi
-0001bca0: 6c65 7329 0d0a 2020 2020 2020 2020 2020  les)..          
-0001bcb0: 2020 2320 6368 6563 6b20 7468 6174 2066    # check that f
-0001bcc0: 6f6c 6465 7220 6f6e 6c79 2063 6f6e 7461  older only conta
-0001bcd0: 696e 7320 7261 7374 6572 730d 0a20 2020  ins rasters..   
-0001bce0: 2020 2020 2020 2020 2061 7373 6572 7420           assert 
-0001bcf0: 616c 6c28 0d0a 2020 2020 2020 2020 2020  all(..          
-0001bd00: 2020 2020 2020 6669 6c65 5f69 2e65 6e64        file_i.end
-0001bd10: 7377 6974 6828 6578 7465 6e73 696f 6e29  swith(extension)
-0001bd20: 2066 6f72 2066 696c 655f 6920 696e 2066   for file_i in f
-0001bd30: 696c 6573 0d0a 2020 2020 2020 2020 2020  iles..          
-0001bd40: 2020 292c 2022 616c 6c20 6669 6c65 7320    ), "all files 
-0001bd50: 696e 2074 6865 2067 6976 656e 2066 6f6c  in the given fol
-0001bd60: 6465 7220 7368 6f75 6c64 2068 6176 6520  der should have 
-0001bd70: 2e74 6966 2065 7874 656e 7369 6f6e 220d  .tif extension".
-0001bd80: 0a0d 0a20 2020 2020 2020 2023 2066 696c  ...        # fil
-0001bd90: 6573 2074 6f20 6265 2072 6561 640d 0a20  es to be read.. 
-0001bda0: 2020 2020 2020 2066 696c 6573 203d 2066         files = f
-0001bdb0: 696c 6573 5b73 7461 7274 693a 656e 6469  iles[starti:endi
-0001bdc0: 5d0d 0a20 2020 2020 2020 2069 6620 6e6f  ]..        if no
-0001bdd0: 7420 6973 696e 7374 616e 6365 2870 6174  t isinstance(pat
-0001bde0: 682c 206c 6973 7429 3a0d 0a20 2020 2020  h, list):..     
-0001bdf0: 2020 2020 2020 2023 2061 6464 2074 6865         # add the
-0001be00: 2070 6174 6820 746f 2061 6c6c 2074 6865   path to all the
-0001be10: 2066 696c 6573 0d0a 2020 2020 2020 2020   files..        
-0001be20: 2020 2020 6669 6c65 7320 3d20 5b66 227b      files = [f"{
-0001be30: 7061 7468 7d2f 7b69 7d22 2066 6f72 2069  path}/{i}" for i
-0001be40: 2069 6e20 6669 6c65 735d 0d0a 2020 2020   in files]..    
-0001be50: 2020 2020 2320 6372 6561 7465 2061 2033      # create a 3
-0001be60: 6420 6172 7261 7920 7769 7468 2074 6865  d array with the
-0001be70: 2032 6420 6469 6d65 6e73 696f 6e20 6f66   2d dimension of
-0001be80: 2074 6865 2066 6972 7374 2072 6173 7465   the first raste
-0001be90: 7220 616e 6420 7468 6520 6c65 6e0d 0a20  r and the len.. 
-0001bea0: 2020 2020 2020 2023 206f 6620 7468 6520         # of the 
-0001beb0: 6e75 6d62 6572 206f 6620 7261 7374 6572  number of raster
-0001bec0: 7320 696e 2074 6865 2066 6f6c 6465 720d  s in the folder.
-0001bed0: 0a20 2020 2020 2020 2073 616d 706c 6520  .        sample 
-0001bee0: 3d20 4461 7461 7365 742e 7265 6164 5f66  = Dataset.read_f
-0001bef0: 696c 6528 6669 6c65 735b 305d 290d 0a0d  ile(files[0])...
-0001bf00: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0001bf10: 636c 7328 7361 6d70 6c65 2c20 6c65 6e28  cls(sample, len(
-0001bf20: 6669 6c65 7329 2c20 6669 6c65 7329 0d0a  files), files)..
-0001bf30: 0d0a 2020 2020 6465 6620 7265 6164 5f64  ..    def read_d
-0001bf40: 6174 6173 6574 2873 656c 662c 2062 616e  ataset(self, ban
-0001bf50: 643a 2069 6e74 203d 2030 293a 0d0a 2020  d: int = 0):..  
-0001bf60: 2020 2020 2020 2222 2252 6561 6420 6172        """Read ar
-0001bf70: 7261 792e 0d0a 0d0a 2020 2020 2020 2020  ray.....        
-0001bf80: 2020 2020 5265 6164 2076 616c 7565 7320      Read values 
-0001bf90: 666f 726d 2074 6865 2067 6976 656e 2062  form the given b
-0001bfa0: 616e 6473 2061 7320 4172 7261 7973 2066  ands as Arrays f
-0001bfb0: 6f72 2061 6c6c 2066 696c 6573 0d0a 0d0a  or all files....
-0001bfc0: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
-0001bfd0: 7273 0d0a 2020 2020 2020 2020 2d2d 2d2d  rs..        ----
-0001bfe0: 2d2d 2d2d 2d2d 0d0a 2020 2020 2020 2020  ------..        
-0001bff0: 6261 6e64 3a20 5b69 6e74 5d0d 0a20 2020  band: [int]..   
-0001c000: 2020 2020 2020 2020 2069 6e64 6578 206f           index o
-0001c010: 6620 7468 6520 6261 6e64 2079 6f75 2077  f the band you w
-0001c020: 616e 7420 746f 2072 6561 6420 6465 6661  ant to read defa
-0001c030: 756c 7420 6973 2030 2e0d 0a0d 0a20 2020  ult is 0.....   
-0001c040: 2020 2020 2052 6574 7572 6e73 0d0a 2020       Returns..  
-0001c050: 2020 2020 2020 2d2d 2d2d 2d2d 2d0d 0a20        -------.. 
-0001c060: 2020 2020 2020 2041 7272 6179 0d0a 2020         Array..  
-0001c070: 2020 2020 2020 2222 220d 0a20 2020 2020        """..     
-0001c080: 2020 2023 2063 6865 636b 2074 6865 2067     # check the g
-0001c090: 6976 656e 2062 616e 6420 6e75 6d62 6572  iven band number
-0001c0a0: 0d0a 2020 2020 2020 2020 6966 206e 6f74  ..        if not
-0001c0b0: 2068 6173 6174 7472 2873 656c 662c 2022   hasattr(self, "
-0001c0c0: 6261 7365 2229 3a0d 0a20 2020 2020 2020  base"):..       
-0001c0d0: 2020 2020 2072 6169 7365 2056 616c 7565       raise Value
-0001c0e0: 4572 726f 7228 0d0a 2020 2020 2020 2020  Error(..        
-0001c0f0: 2020 2020 2020 2020 2270 6c65 6173 6520          "please 
-0001c100: 7573 6520 7468 6520 7265 6164 5f73 6570  use the read_sep
-0001c110: 6172 6174 655f 6669 6c65 7320 6d65 7468  arate_files meth
-0001c120: 6f64 2074 6f20 6765 7420 7468 6520 6669  od to get the fi
-0001c130: 6c65 7320 2874 6966 662f 6173 6369 6929  les (tiff/ascii)
-0001c140: 2069 6e20 7468 6522 0d0a 2020 2020 2020   in the"..      
-0001c150: 2020 2020 2020 2020 2020 2264 6174 6173            "datas
-0001c160: 6574 2064 6972 6563 746f 7279 220d 0a20  et directory".. 
-0001c170: 2020 2020 2020 2020 2020 2029 0d0a 2020             )..  
-0001c180: 2020 2020 2020 6966 2062 616e 6420 3e20        if band > 
-0001c190: 7365 6c66 2e62 6173 652e 6261 6e64 5f63  self.base.band_c
-0001c1a0: 6f75 6e74 202d 2031 3a0d 0a20 2020 2020  ount - 1:..     
-0001c1b0: 2020 2020 2020 2072 6169 7365 2056 616c         raise Val
-0001c1c0: 7565 4572 726f 7228 0d0a 2020 2020 2020  ueError(..      
-0001c1d0: 2020 2020 2020 2020 2020 6622 7468 6520            f"the 
-0001c1e0: 7261 7374 6572 2068 6173 206f 6e6c 7920  raster has only 
-0001c1f0: 7b73 656c 662e 6261 7365 2e62 616e 645f  {self.base.band_
-0001c200: 636f 756e 747d 2063 6865 636b 2074 6865  count} check the
-0001c210: 2067 6976 656e 2062 616e 6420 6e75 6d62   given band numb
-0001c220: 6572 220d 0a20 2020 2020 2020 2020 2020  er"..           
-0001c230: 2029 0d0a 2020 2020 2020 2020 2320 6669   )..        # fi
-0001c240: 6c6c 2074 6865 2061 7272 6179 2077 6974  ll the array wit
-0001c250: 6820 6e6f 5f64 6174 615f 7661 6c75 6520  h no_data_value 
-0001c260: 6461 7461 0d0a 2020 2020 2020 2020 7365  data..        se
-0001c270: 6c66 2e5f 6461 7461 203d 206e 702e 6f6e  lf._data = np.on
-0001c280: 6573 280d 0a20 2020 2020 2020 2020 2020  es(..           
-0001c290: 2028 0d0a 2020 2020 2020 2020 2020 2020   (..            
-0001c2a0: 2020 2020 7365 6c66 2e74 696d 655f 6c65      self.time_le
-0001c2b0: 6e67 7468 2c0d 0a20 2020 2020 2020 2020  ngth,..         
-0001c2c0: 2020 2020 2020 2073 656c 662e 6261 7365         self.base
-0001c2d0: 2e72 6f77 732c 0d0a 2020 2020 2020 2020  .rows,..        
-0001c2e0: 2020 2020 2020 2020 7365 6c66 2e62 6173          self.bas
-0001c2f0: 652e 636f 6c75 6d6e 732c 0d0a 2020 2020  e.columns,..    
-0001c300: 2020 2020 2020 2020 290d 0a20 2020 2020          )..     
-0001c310: 2020 2029 0d0a 2020 2020 2020 2020 7365     )..        se
-0001c320: 6c66 2e5f 6461 7461 5b3a 2c20 3a2c 203a  lf._data[:, :, :
-0001c330: 5d20 3d20 6e70 2e6e 616e 0d0a 0d0a 2020  ] = np.nan....  
-0001c340: 2020 2020 2020 666f 7220 692c 2066 696c        for i, fil
-0001c350: 655f 6920 696e 2065 6e75 6d65 7261 7465  e_i in enumerate
-0001c360: 2873 656c 662e 6669 6c65 7329 3a0d 0a20  (self.files):.. 
-0001c370: 2020 2020 2020 2020 2020 2023 2072 6561             # rea
-0001c380: 6420 7468 6520 7469 6620 6669 6c65 0d0a  d the tif file..
-0001c390: 2020 2020 2020 2020 2020 2020 7261 7374              rast
-0001c3a0: 6572 5f69 203d 2067 6461 6c2e 4f70 656e  er_i = gdal.Open
-0001c3b0: 2866 227b 6669 6c65 5f69 7d22 290d 0a20  (f"{file_i}").. 
-0001c3c0: 2020 2020 2020 2020 2020 2073 656c 662e             self.
-0001c3d0: 5f64 6174 615b 692c 203a 2c20 3a5d 203d  _data[i, :, :] =
-0001c3e0: 2072 6173 7465 725f 692e 4765 7452 6173   raster_i.GetRas
-0001c3f0: 7465 7242 616e 6428 6261 6e64 202b 2031  terBand(band + 1
-0001c400: 292e 5265 6164 4173 4172 7261 7928 290d  ).ReadAsArray().
-0001c410: 0a0d 0a20 2020 2040 7072 6f70 6572 7479  ...    @property
-0001c420: 0d0a 2020 2020 6465 6620 6461 7461 2873  ..    def data(s
-0001c430: 656c 6629 202d 3e20 6e70 2e6e 6461 7272  elf) -> np.ndarr
-0001c440: 6179 3a0d 0a20 2020 2020 2020 2022 2222  ay:..        """
-0001c450: 6461 7461 2061 7474 7269 6275 7465 2e0d  data attribute..
-0001c460: 0a0d 0a20 2020 2020 2020 202d 2054 6865  ...        - The
-0001c470: 2061 7474 7269 6275 7465 2077 6865 7265   attribute where
-0001c480: 2074 6865 2064 6174 6173 6574 2061 7272   the dataset arr
-0001c490: 6179 2069 7320 7374 6f72 6564 2e0d 0a20  ay is stored... 
-0001c4a0: 2020 2020 2020 202d 2074 6865 2033 4420         - the 3D 
-0001c4b0: 6e75 6d70 7920 6172 7261 792c 205b 6461  numpy array, [da
-0001c4c0: 7461 7365 7420 6c65 6e67 7468 2c20 726f  taset length, ro
-0001c4d0: 7773 2c20 636f 6c73 5d2c 205b 6461 7461  ws, cols], [data
-0001c4e0: 7365 7420 6c65 6e67 7468 2c20 6c6f 6e73  set length, lons
-0001c4f0: 2c20 6c61 7473 5d0d 0a20 2020 2020 2020  , lats]..       
-0001c500: 2022 2222 0d0a 2020 2020 2020 2020 6966   """..        if
-0001c510: 206e 6f74 2068 6173 6174 7472 2873 656c   not hasattr(sel
-0001c520: 662c 2022 5f64 6174 6122 293a 0d0a 2020  f, "_data"):..  
-0001c530: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
-0001c540: 5661 6c75 6545 7272 6f72 2822 706c 6561  ValueError("plea
-0001c550: 7365 2075 7365 2074 6865 2072 6561 645f  se use the read_
-0001c560: 6461 7461 7365 7420 746f 2072 6561 6420  dataset to read 
-0001c570: 7468 6520 6461 7461 2066 6972 7374 2e22  the data first."
-0001c580: 290d 0a0d 0a20 2020 2020 2020 2072 6574  )....        ret
-0001c590: 7572 6e20 7365 6c66 2e5f 6461 7461 0d0a  urn self._data..
-0001c5a0: 0d0a 2020 2020 4064 6174 612e 7365 7474  ..    @data.sett
-0001c5b0: 6572 0d0a 2020 2020 6465 6620 6461 7461  er..    def data
-0001c5c0: 2873 656c 662c 2076 616c 293a 0d0a 2020  (self, val):..  
-0001c5d0: 2020 2020 2020 2222 2244 6174 6120 6174        """Data at
-0001c5e0: 7472 6962 7574 652e 0d0a 0d0a 2020 2020  tribute.....    
-0001c5f0: 2020 2020 2d20 7365 7474 696e 6720 7468      - setting th
-0001c600: 6520 6461 7461 2028 6172 7261 7929 2064  e data (array) d
-0001c610: 6f65 7320 6e6f 7420 616c 6c6f 7720 6469  oes not allow di
-0001c620: 6666 6572 656e 7420 6469 6d65 6e73 696f  fferent dimensio
-0001c630: 6e20 6672 6f6d 2074 6865 2064 696d 656e  n from the dimen
-0001c640: 7369 6f6e 2074 6861 7420 6861 7665 2062  sion that have b
-0001c650: 6565 6e0d 0a20 2020 2020 2020 2064 6566  een..        def
-0001c660: 696e 6564 2069 6e63 7265 6174 696e 6720  ined increating 
-0001c670: 7468 6520 6461 7461 7365 742e 0d0a 2020  the dataset...  
-0001c680: 2020 2020 2020 2222 220d 0a20 2020 2020        """..     
-0001c690: 2020 2023 2069 6620 7468 6520 6174 7472     # if the attr
-0001c6a0: 6962 7574 6520 6973 2064 6566 696e 6564  ibute is defined
-0001c6b0: 2062 6566 6f72 6520 6368 6563 6b20 7468   before check th
-0001c6c0: 6520 6469 6d65 6e73 696f 6e0d 0a20 2020  e dimension..   
-0001c6d0: 2020 2020 2069 6620 6861 7361 7474 7228       if hasattr(
-0001c6e0: 7365 6c66 2c20 2264 6174 6122 293a 0d0a  self, "data"):..
-0001c6f0: 2020 2020 2020 2020 2020 2020 6966 2073              if s
-0001c700: 656c 662e 5f64 6174 612e 7368 6170 6520  elf._data.shape 
-0001c710: 213d 2076 616c 2e73 6861 7065 3a0d 0a20  != val.shape:.. 
-0001c720: 2020 2020 2020 2020 2020 2020 2020 2072                 r
-0001c730: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
-0001c740: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0001c750: 2020 2020 2020 6622 5468 6520 6469 6d65        f"The dime
-0001c760: 6e73 696f 6e20 6f66 2074 6865 206e 6577  nsion of the new
-0001c770: 2064 6174 613a 207b 7661 6c2e 7368 6170   data: {val.shap
-0001c780: 657d 2c20 6469 6666 6572 7320 6672 6f6d  e}, differs from
-0001c790: 2074 6865 2064 696d 656e 7369 6f6e 206f   the dimension o
-0001c7a0: 6620 7468 6520 220d 0a20 2020 2020 2020  f the "..       
-0001c7b0: 2020 2020 2020 2020 2020 2020 2066 226f               f"o
-0001c7c0: 7269 6769 6e61 6c20 6461 7461 7365 743a  riginal dataset:
-0001c7d0: 207b 7365 6c66 2e5f 6461 7461 2e73 6861   {self._data.sha
-0001c7e0: 7065 7d2c 2070 6c65 6173 6520 7265 6465  pe}, please rede
-0001c7f0: 6669 6e65 2074 6865 2062 6173 6520 4461  fine the base Da
-0001c800: 7461 7365 7420 616e 6420 220d 0a20 2020  taset and "..   
-0001c810: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001c820: 2066 2264 6174 6173 6574 5f6c 656e 6774   f"dataset_lengt
-0001c830: 6820 6669 7273 7422 0d0a 2020 2020 2020  h first"..      
-0001c840: 2020 2020 2020 2020 2020 290d 0a0d 0a20            ).... 
-0001c850: 2020 2020 2020 2073 656c 662e 5f64 6174         self._dat
-0001c860: 6120 3d20 7661 6c0d 0a0d 0a20 2020 2040  a = val....    @
-0001c870: 6461 7461 2e64 656c 6574 6572 0d0a 2020  data.deleter..  
-0001c880: 2020 6465 6620 6461 7461 2873 656c 6629    def data(self)
-0001c890: 3a0d 0a20 2020 2020 2020 2073 656c 662e  :..        self.
-0001c8a0: 5f64 6174 6120 3d20 4e6f 6e65 0d0a 0d0a  _data = None....
-0001c8b0: 2020 2020 6465 6620 5f5f 6765 7469 7465      def __getite
-0001c8c0: 6d5f 5f28 7365 6c66 2c20 6b65 7929 3a0d  m__(self, key):.
-0001c8d0: 0a20 2020 2020 2020 2069 6620 6e6f 7420  .        if not 
-0001c8e0: 6861 7361 7474 7228 7365 6c66 2c20 2264  hasattr(self, "d
-0001c8f0: 6174 6122 293a 0d0a 2020 2020 2020 2020  ata"):..        
-0001c900: 2020 2020 7261 6973 6520 4174 7472 6962      raise Attrib
-0001c910: 7574 6545 7272 6f72 2822 506c 6561 7365  uteError("Please
-0001c920: 2075 7365 2074 6865 2072 6561 645f 6461   use the read_da
-0001c930: 7461 7365 7420 6d65 7468 6f64 2074 2072  taset method t r
-0001c940: 6561 6420 7468 6520 6461 7461 2229 0d0a  ead the data")..
-0001c950: 2020 2020 2020 2020 7265 7475 726e 2073          return s
-0001c960: 656c 662e 5f64 6174 615b 6b65 792c 203a  elf._data[key, :
-0001c970: 2c20 3a5d 0d0a 0d0a 2020 2020 6465 6620  , :]....    def 
-0001c980: 5f5f 7365 7469 7465 6d5f 5f28 7365 6c66  __setitem__(self
-0001c990: 2c20 6b65 792c 2076 616c 7565 3a20 6e70  , key, value: np
-0001c9a0: 2e6e 6461 7272 6179 293a 0d0a 2020 2020  .ndarray):..    
-0001c9b0: 2020 2020 6966 206e 6f74 2068 6173 6174      if not hasat
-0001c9c0: 7472 2873 656c 662c 2022 6461 7461 2229  tr(self, "data")
-0001c9d0: 3a0d 0a20 2020 2020 2020 2020 2020 2072  :..            r
-0001c9e0: 6169 7365 2041 7474 7269 6275 7465 4572  aise AttributeEr
-0001c9f0: 726f 7228 2250 6c65 6173 6520 7573 6520  ror("Please use 
-0001ca00: 7468 6520 7265 6164 5f64 6174 6173 6574  the read_dataset
-0001ca10: 206d 6574 686f 6420 7420 7265 6164 2074   method t read t
-0001ca20: 6865 2064 6174 6122 290d 0a20 2020 2020  he data")..     
-0001ca30: 2020 2073 656c 662e 5f64 6174 615b 6b65     self._data[ke
-0001ca40: 792c 203a 2c20 3a5d 203d 2076 616c 7565  y, :, :] = value
-0001ca50: 0d0a 0d0a 2020 2020 6465 6620 5f5f 6c65  ....    def __le
-0001ca60: 6e5f 5f28 7365 6c66 293a 0d0a 2020 2020  n__(self):..    
-0001ca70: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-0001ca80: 5f64 6174 612e 7368 6170 655b 305d 0d0a  _data.shape[0]..
-0001ca90: 0d0a 2020 2020 6465 6620 5f5f 6974 6572  ..    def __iter
-0001caa0: 5f5f 2873 656c 6629 3a0d 0a20 2020 2020  __(self):..     
-0001cab0: 2020 2072 6574 7572 6e20 6974 6572 2873     return iter(s
-0001cac0: 656c 662e 5f64 6174 615b 3a5d 290d 0a0d  elf._data[:])...
-0001cad0: 0a20 2020 2064 6566 2068 6561 6428 7365  .    def head(se
-0001cae0: 6c66 2c20 6e3a 2069 6e74 203d 2035 293a  lf, n: int = 5):
-0001caf0: 0d0a 2020 2020 2020 2020 2222 2246 6972  ..        """Fir
-0001cb00: 7374 2035 2044 6174 6173 6574 732e 2222  st 5 Datasets.""
-0001cb10: 220d 0a20 2020 2020 2020 2072 6574 7572  "..        retur
-0001cb20: 6e20 7365 6c66 2e5f 6461 7461 5b3a 6e2c  n self._data[:n,
-0001cb30: 203a 2c20 3a5d 0d0a 0d0a 2020 2020 6465   :, :]....    de
-0001cb40: 6620 7461 696c 2873 656c 662c 206e 3a20  f tail(self, n: 
-0001cb50: 696e 7420 3d20 2d35 293a 0d0a 2020 2020  int = -5):..    
-0001cb60: 2020 2020 2222 224c 6173 7420 3520 4461      """Last 5 Da
-0001cb70: 7461 7365 7473 2e22 2222 0d0a 2020 2020  tasets."""..    
-0001cb80: 2020 2020 7265 7475 726e 2073 656c 662e      return self.
-0001cb90: 5f64 6174 615b 6e3a 2c20 3a2c 203a 5d0d  _data[n:, :, :].
-0001cba0: 0a0d 0a20 2020 2064 6566 2066 6972 7374  ...    def first
-0001cbb0: 2873 656c 6629 3a0d 0a20 2020 2020 2020  (self):..       
-0001cbc0: 2022 2222 4669 7273 7420 4461 7461 7365   """First Datase
-0001cbd0: 742e 2222 220d 0a20 2020 2020 2020 2072  t."""..        r
-0001cbe0: 6574 7572 6e20 7365 6c66 2e5f 6461 7461  eturn self._data
-0001cbf0: 5b30 2c20 3a2c 203a 5d0d 0a0d 0a20 2020  [0, :, :]....   
-0001cc00: 2064 6566 206c 6173 7428 7365 6c66 293a   def last(self):
-0001cc10: 0d0a 2020 2020 2020 2020 2222 224c 6173  ..        """Las
-0001cc20: 7420 4461 7461 7365 742e 2222 220d 0a20  t Dataset.""".. 
-0001cc30: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
-0001cc40: 6c66 2e5f 6461 7461 5b2d 312c 203a 2c20  lf._data[-1, :, 
-0001cc50: 3a5d 0d0a 0d0a 2020 2020 6465 6620 696c  :]....    def il
-0001cc60: 6f63 2873 656c 662c 2069 293a 0d0a 2020  oc(self, i):..  
-0001cc70: 2020 2020 2020 2222 2269 6c6f 632e 0d0a        """iloc...
-0001cc80: 0d0a 2020 2020 2020 2020 2020 2020 2d20  ..            - 
-0001cc90: 4163 6365 7373 2064 6174 6173 6574 2061  Access dataset a
-0001cca0: 7272 6179 2075 7369 6e67 2069 6e64 6578  rray using index
-0001ccb0: 2e0d 0a0d 0a20 2020 2020 2020 2050 6172  .....        Par
-0001ccc0: 616d 6574 6572 730d 0a20 2020 2020 2020  ameters..       
-0001ccd0: 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020   ----------..   
-0001cce0: 2020 2020 2069 3a20 5b69 6e74 5d0d 0a20       i: [int].. 
-0001ccf0: 2020 2020 2020 2020 2020 2069 6e64 6578             index
-0001cd00: 0d0a 0d0a 2020 2020 2020 2020 5265 7475  ....        Retu
-0001cd10: 726e 730d 0a20 2020 2020 2020 202d 2d2d  rns..        ---
-0001cd20: 2d2d 2d2d 0d0a 2020 2020 2020 2020 4461  ----..        Da
-0001cd30: 7461 7365 743a 0d0a 2020 2020 2020 2020  taset:..        
-0001cd40: 2020 2020 4461 7461 7365 7420 6f62 6a65      Dataset obje
-0001cd50: 6374 2e0d 0a20 2020 2020 2020 2022 2222  ct...        """
-0001cd60: 0d0a 2020 2020 2020 2020 6966 206e 6f74  ..        if not
-0001cd70: 2068 6173 6174 7472 2873 656c 662c 2022   hasattr(self, "
-0001cd80: 6461 7461 2229 3a0d 0a20 2020 2020 2020  data"):..       
-0001cd90: 2020 2020 2072 6169 7365 2044 6174 6173       raise Datas
-0001cda0: 6574 4e6f 466f 756e 6445 7272 6f72 2822  etNoFoundError("
-0001cdb0: 706c 6561 7365 2072 6561 6420 7468 6520  please read the 
-0001cdc0: 6461 7461 7365 7420 6669 7273 7422 290d  dataset first").
-0001cdd0: 0a20 2020 2020 2020 2061 7272 203d 2073  .        arr = s
-0001cde0: 656c 662e 5f64 6174 615b 692c 203a 2c20  elf._data[i, :, 
-0001cdf0: 3a5d 0d0a 2020 2020 2020 2020 6473 7420  :]..        dst 
-0001ce00: 3d20 6764 616c 2e47 6574 4472 6976 6572  = gdal.GetDriver
-0001ce10: 4279 4e61 6d65 2822 4d45 4d22 292e 4372  ByName("MEM").Cr
-0001ce20: 6561 7465 436f 7079 2822 222c 2073 656c  eateCopy("", sel
-0001ce30: 662e 6261 7365 2e72 6173 7465 722c 2030  f.base.raster, 0
-0001ce40: 290d 0a20 2020 2020 2020 2064 7374 2e47  )..        dst.G
-0001ce50: 6574 5261 7374 6572 4261 6e64 2831 292e  etRasterBand(1).
-0001ce60: 5772 6974 6541 7272 6179 2861 7272 290d  WriteArray(arr).
-0001ce70: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0001ce80: 4461 7461 7365 7428 6473 7429 0d0a 0d0a  Dataset(dst)....
-0001ce90: 2020 2020 6465 6620 706c 6f74 2873 656c      def plot(sel
-0001cea0: 662c 2062 616e 643a 2069 6e74 203d 2030  f, band: int = 0
-0001ceb0: 2c20 6578 636c 7564 655f 7661 6c75 653a  , exclude_value:
-0001cec0: 2041 6e79 203d 204e 6f6e 652c 202a 2a6b   Any = None, **k
-0001ced0: 7761 7267 7329 3a0d 0a20 2020 2020 2020  wargs):..       
-0001cee0: 2022 2222 5265 6164 2041 7272 6179 0d0a   """Read Array..
-0001cef0: 0d0a 2020 2020 2020 2020 2020 2020 2d20  ..            - 
-0001cf00: 7265 6164 2074 6865 2076 616c 7565 7320  read the values 
-0001cf10: 7374 6f72 6564 2069 6e20 6120 6769 7665  stored in a give
-0001cf20: 6e20 6261 6e64 2e0d 0a0d 0a20 2020 2020  n band.....     
-0001cf30: 2020 2050 6172 616d 6574 6572 730d 0a20     Parameters.. 
-0001cf40: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
-0001cf50: 2d0d 0a20 2020 2020 2020 2062 616e 6420  -..        band 
-0001cf60: 3a20 5b69 6e74 6567 6572 5d0d 0a20 2020  : [integer]..   
-0001cf70: 2020 2020 2020 2020 2074 6865 2062 616e           the ban
-0001cf80: 6420 796f 7520 7761 6e74 2074 6f20 6765  d you want to ge
-0001cf90: 7420 6974 7320 6461 7461 2e20 4465 6661  t its data. Defa
-0001cfa0: 756c 7420 6973 2030 0d0a 2020 2020 2020  ult is 0..      
-0001cfb0: 2020 6578 636c 7564 655f 7661 6c75 653a    exclude_value:
-0001cfc0: 205b 416e 795d 0d0a 2020 2020 2020 2020   [Any]..        
-0001cfd0: 2020 2020 7661 6c75 6520 746f 2065 7865      value to exe
-0001cfe0: 636c 7564 6520 6672 6f6d 2074 6865 2070  clude from the p
-0001cff0: 6c6f 742e 2044 6566 6175 6c74 2069 7320  lot. Default is 
-0001d000: 4e6f 6e65 2e0d 0a20 2020 2020 2020 202a  None...        *
-0001d010: 2a6b 7761 7267 730d 0a20 2020 2020 2020  *kwargs..       
-0001d020: 2020 2020 2070 6f69 6e74 7320 3a20 5b61       points : [a
-0001d030: 7272 6179 5d0d 0a20 2020 2020 2020 2020  rray]..         
-0001d040: 2020 2020 2020 2033 2063 6f6c 756d 6e20         3 column 
-0001d050: 6172 7261 7920 7769 7468 2074 6865 2066  array with the f
-0001d060: 6972 7374 2063 6f6c 756d 6e20 6173 2074  irst column as t
-0001d070: 6865 2076 616c 7565 2079 6f75 2077 616e  he value you wan
-0001d080: 7420 746f 2064 6973 706c 6179 2066 6f72  t to display for
-0001d090: 2074 6865 2070 6f69 6e74 2c20 7468 6520   the point, the 
-0001d0a0: 7365 636f 6e64 2069 7320 7468 6520 726f  second is the ro
-0001d0b0: 7773 0d0a 2020 2020 2020 2020 2020 2020  ws..            
-0001d0c0: 2020 2020 696e 6465 7820 6f66 2074 6865      index of the
-0001d0d0: 2070 6f69 6e74 2069 6e20 7468 6520 6172   point in the ar
-0001d0e0: 7261 792c 2061 6e64 2074 6865 2074 6869  ray, and the thi
-0001d0f0: 7264 2063 6f6c 756d 6e20 6173 2074 6865  rd column as the
-0001d100: 2063 6f6c 756d 6e20 696e 6465 7820 696e   column index in
-0001d110: 2074 6865 2061 7272 6179 2e0d 0a20 2020   the array...   
-0001d120: 2020 2020 2020 2020 2020 2020 202d 2074               - t
-0001d130: 6865 2073 6563 6f6e 6420 616e 6420 7468  he second and th
-0001d140: 6972 6420 636f 6c75 6d6e 2074 656c 6c73  ird column tells
-0001d150: 2074 6865 206c 6f63 6174 696f 6e20 6f66   the location of
-0001d160: 2074 6865 2070 6f69 6e74 2069 6e20 7468   the point in th
-0001d170: 6520 6172 7261 792e 0d0a 2020 2020 2020  e array...      
-0001d180: 2020 2020 2020 706f 696e 745f 636f 6c6f        point_colo
-0001d190: 723a 205b 7374 725d 0d0a 2020 2020 2020  r: [str]..      
-0001d1a0: 2020 2020 2020 2020 2020 636f 6c6f 722e            color.
-0001d1b0: 0d0a 2020 2020 2020 2020 2020 2020 706f  ..            po
-0001d1c0: 696e 745f 7369 7a65 3a20 5b41 6e79 5d0d  int_size: [Any].
-0001d1d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001d1e0: 2073 697a 6520 6f66 2074 6865 2070 6f69   size of the poi
-0001d1f0: 6e74 2e0d 0a20 2020 2020 2020 2020 2020  nt...           
-0001d200: 2070 6964 5f63 6f6c 6f72 3a20 5b73 7472   pid_color: [str
-0001d210: 5d0d 0a20 2020 2020 2020 2020 2020 2020  ]..             
-0001d220: 2020 2074 6865 2063 6f6c 6f72 206f 6620     the color of 
-0001d230: 7468 6520 616e 6f74 6174 696f 6e20 6f66  the anotation of
-0001d240: 2074 6865 2070 6f69 6e74 2e20 4465 6661   the point. Defa
-0001d250: 756c 7420 6973 2062 6c75 652e 0d0a 2020  ult is blue...  
-0001d260: 2020 2020 2020 2020 2020 7069 645f 7369            pid_si
-0001d270: 7a65 3a20 5b41 6e79 5d0d 0a20 2020 2020  ze: [Any]..     
-0001d280: 2020 2020 2020 2020 2020 2073 697a 6520             size 
-0001d290: 6f66 2074 6865 2070 6f69 6e74 2061 6e6e  of the point ann
-0001d2a0: 6f74 6174 696f 6e2e 0d0a 2020 2020 2020  otation...      
-0001d2b0: 2020 2020 2020 6669 6773 697a 6520 3a20        figsize : 
-0001d2c0: 5b74 7570 6c65 5d2c 206f 7074 696f 6e61  [tuple], optiona
-0001d2d0: 6c0d 0a20 2020 2020 2020 2020 2020 2020  l..             
-0001d2e0: 2020 2066 6967 7572 6520 7369 7a65 2e20     figure size. 
-0001d2f0: 5468 6520 6465 6661 756c 7420 6973 2028  The default is (
-0001d300: 382c 3829 2e0d 0a20 2020 2020 2020 2020  8,8)...         
-0001d310: 2020 2074 6974 6c65 203a 205b 7374 725d     title : [str]
-0001d320: 2c20 6f70 7469 6f6e 616c 0d0a 2020 2020  , optional..    
-0001d330: 2020 2020 2020 2020 2020 2020 7469 746c              titl
-0001d340: 6520 6f66 2074 6865 2070 6c6f 742e 2054  e of the plot. T
-0001d350: 6865 2064 6566 6175 6c74 2069 7320 2754  he default is 'T
-0001d360: 6f74 616c 2044 6973 6368 6172 6765 272e  otal Discharge'.
-0001d370: 0d0a 2020 2020 2020 2020 2020 2020 7469  ..            ti
-0001d380: 746c 655f 7369 7a65 203a 205b 696e 7465  tle_size : [inte
-0001d390: 6765 725d 2c20 6f70 7469 6f6e 616c 0d0a  ger], optional..
-0001d3a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d3b0: 7469 746c 6520 7369 7a65 2e20 5468 6520  title size. The 
-0001d3c0: 6465 6661 756c 7420 6973 2031 352e 0d0a  default is 15...
-0001d3d0: 2020 2020 2020 2020 2020 2020 6f72 6965              orie
-0001d3e0: 6e74 6174 696f 6e20 3a20 5b73 7472 696e  ntation : [strin
-0001d3f0: 675d 2c20 6f70 7469 6f6e 616c 0d0a 2020  g], optional..  
-0001d400: 2020 2020 2020 2020 2020 2020 2020 6f72                or
-0001d410: 696e 7461 7469 6f6e 206f 6620 7468 6520  intation of the 
-0001d420: 636f 6c6f 7262 6172 2068 6f72 697a 6f6e  colorbar horizon
-0001d430: 7461 6c2f 7665 7274 6963 616c 2e20 5468  tal/vertical. Th
-0001d440: 6520 6465 6661 756c 7420 6973 2027 7665  e default is 've
-0001d450: 7274 6963 616c 272e 0d0a 2020 2020 2020  rtical'...      
-0001d460: 2020 2020 2020 726f 7461 7469 6f6e 203a        rotation :
-0001d470: 205b 6e75 6d62 6572 5d2c 206f 7074 696f   [number], optio
-0001d480: 6e61 6c0d 0a20 2020 2020 2020 2020 2020  nal..           
-0001d490: 2020 2020 2072 6f74 6174 696f 6e20 6f66       rotation of
-0001d4a0: 2074 6865 2063 6f6c 6f72 6261 7220 6c61   the colorbar la
-0001d4b0: 6265 6c2e 2054 6865 2064 6566 6175 6c74  bel. The default
-0001d4c0: 2069 7320 2d39 302e 0d0a 2020 2020 2020   is -90...      
-0001d4d0: 2020 2020 2020 6f72 6965 6e74 6174 696f        orientatio
-0001d4e0: 6e20 3a20 5b73 7472 696e 675d 2c20 6f70  n : [string], op
-0001d4f0: 7469 6f6e 616c 0d0a 2020 2020 2020 2020  tional..        
-0001d500: 2020 2020 2020 2020 6f72 696e 7461 7469          orintati
-0001d510: 6f6e 206f 6620 7468 6520 636f 6c6f 7262  on of the colorb
-0001d520: 6172 2068 6f72 697a 6f6e 7461 6c2f 7665  ar horizontal/ve
-0001d530: 7274 6963 616c 2e20 5468 6520 6465 6661  rtical. The defa
-0001d540: 756c 7420 6973 2027 7665 7274 6963 616c  ult is 'vertical
-0001d550: 272e 0d0a 2020 2020 2020 2020 2020 2020  '...            
-0001d560: 6362 6172 5f6c 656e 6774 6820 3a20 5b66  cbar_length : [f
-0001d570: 6c6f 6174 5d2c 206f 7074 696f 6e61 6c0d  loat], optional.
-0001d580: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001d590: 2072 6174 696f 2074 6f20 636f 6e74 726f   ratio to contro
-0001d5a0: 6c20 7468 6520 6865 6967 6874 206f 6620  l the height of 
-0001d5b0: 7468 6520 636f 6c6f 7262 6172 2e20 5468  the colorbar. Th
-0001d5c0: 6520 6465 6661 756c 7420 6973 2030 2e37  e default is 0.7
-0001d5d0: 352e 0d0a 2020 2020 2020 2020 2020 2020  5...            
-0001d5e0: 7469 636b 735f 7370 6163 696e 6720 3a20  ticks_spacing : 
-0001d5f0: 5b69 6e74 6567 6572 5d2c 206f 7074 696f  [integer], optio
-0001d600: 6e61 6c0d 0a20 2020 2020 2020 2020 2020  nal..           
-0001d610: 2020 2020 2053 7061 6369 6e67 2069 6e20       Spacing in 
-0001d620: 7468 6520 636f 6c6f 7262 6172 2074 6963  the colorbar tic
-0001d630: 6b73 2e20 5468 6520 6465 6661 756c 7420  ks. The default 
-0001d640: 6973 2032 2e0d 0a20 2020 2020 2020 2020  is 2...         
-0001d650: 2020 2063 6261 725f 6c61 6265 6c5f 7369     cbar_label_si
-0001d660: 7a65 203a 2069 6e74 6567 6572 2c20 6f70  ze : integer, op
-0001d670: 7469 6f6e 616c 0d0a 2020 2020 2020 2020  tional..        
-0001d680: 2020 2020 2020 2020 7369 7a65 206f 6620          size of 
-0001d690: 7468 6520 636f 6c6f 7220 6261 7220 6c61  the color bar la
-0001d6a0: 6265 6c2e 2054 6865 2064 6566 6175 6c74  bel. The default
-0001d6b0: 2069 7320 3132 2e0d 0a20 2020 2020 2020   is 12...       
-0001d6c0: 2020 2020 2063 6261 725f 6c61 6265 6c20       cbar_label 
-0001d6d0: 3a20 7374 722c 206f 7074 696f 6e61 6c0d  : str, optional.
-0001d6e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-0001d6f0: 206c 6162 656c 206f 6620 7468 6520 636f   label of the co
-0001d700: 6c6f 7220 6261 722e 2054 6865 2064 6566  lor bar. The def
-0001d710: 6175 6c74 2069 7320 2744 6973 6368 6172  ault is 'Dischar
-0001d720: 6765 206d 332f 7327 2e0d 0a20 2020 2020  ge m3/s'...     
-0001d730: 2020 2020 2020 2063 6f6c 6f72 5f73 6361         color_sca
-0001d740: 6c65 203a 2069 6e74 6567 6572 2c20 6f70  le : integer, op
-0001d750: 7469 6f6e 616c 0d0a 2020 2020 2020 2020  tional..        
-0001d760: 2020 2020 2020 2020 7468 6572 6520 6172          there ar
-0001d770: 6520 3520 6f70 7469 6f6e 7320 746f 2063  e 5 options to c
-0001d780: 6861 6e67 6520 7468 6520 7363 616c 6520  hange the scale 
-0001d790: 6f66 2074 6865 2063 6f6c 6f72 732e 2054  of the colors. T
-0001d7a0: 6865 2064 6566 6175 6c74 2069 7320 312e  he default is 1.
-0001d7b0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0001d7c0: 2020 312d 2063 6f6c 6f72 5f73 6361 6c65    1- color_scale
-0001d7d0: 2031 2069 7320 7468 6520 6e6f 726d 616c   1 is the normal
-0001d7e0: 2073 6361 6c65 0d0a 2020 2020 2020 2020   scale..        
-0001d7f0: 2020 2020 2020 2020 322d 2063 6f6c 6f72          2- color
-0001d800: 5f73 6361 6c65 2032 2069 7320 7468 6520  _scale 2 is the 
-0001d810: 706f 7765 7220 7363 616c 650d 0a20 2020  power scale..   
-0001d820: 2020 2020 2020 2020 2020 2020 2033 2d20               3- 
-0001d830: 636f 6c6f 725f 7363 616c 6520 3320 6973  color_scale 3 is
-0001d840: 2074 6865 2053 796d 4c6f 674e 6f72 6d20   the SymLogNorm 
-0001d850: 7363 616c 650d 0a20 2020 2020 2020 2020  scale..         
-0001d860: 2020 2020 2020 2034 2d20 636f 6c6f 725f         4- color_
-0001d870: 7363 616c 6520 3420 6973 2074 6865 2050  scale 4 is the P
-0001d880: 6f77 6572 4e6f 726d 2073 6361 6c65 0d0a  owerNorm scale..
-0001d890: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d8a0: 352d 2063 6f6c 6f72 5f73 6361 6c65 2035  5- color_scale 5
-0001d8b0: 2069 7320 7468 6520 426f 756e 6461 7279   is the Boundary
-0001d8c0: 4e6f 726d 2073 6361 6c65 0d0a 2020 2020  Norm scale..    
-0001d8d0: 2020 2020 2020 2020 2020 2020 2d2d 2d2d              ----
-0001d8e0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0001d8f0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0001d900: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0001d910: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a  --------------..
-0001d920: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001d930: 6761 6d6d 6120 3a20 5b66 6c6f 6174 5d2c  gamma : [float],
-0001d940: 206f 7074 696f 6e61 6c0d 0a20 2020 2020   optional..     
-0001d950: 2020 2020 2020 2020 2020 2020 2020 2076                 v
-0001d960: 616c 7565 206e 6565 6465 6420 666f 7220  alue needed for 
-0001d970: 6f70 7469 6f6e 2032 202e 2054 6865 2064  option 2 . The d
-0001d980: 6566 6175 6c74 2069 7320 312e 2f32 2e2e  efault is 1./2..
-0001d990: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0001d9a0: 2020 6c69 6e65 5f74 6872 6573 686f 6c64    line_threshold
-0001d9b0: 203a 205b 666c 6f61 745d 2c20 6f70 7469   : [float], opti
+000062c0: 696e 7428 6172 722e 7368 6170 655b 315d  int(arr.shape[1]
+000062d0: 290d 0a20 2020 2020 2020 2065 6c73 653a  )..        else:
+000062e0: 0d0a 2020 2020 2020 2020 2020 2020 6261  ..            ba
+000062f0: 6e64 7320 3d20 6172 722e 7368 6170 655b  nds = arr.shape[
+00006300: 305d 0d0a 2020 2020 2020 2020 2020 2020  0]..            
+00006310: 726f 7773 203d 2069 6e74 2861 7272 2e73  rows = int(arr.s
+00006320: 6861 7065 5b31 5d29 0d0a 2020 2020 2020  hape[1])..      
+00006330: 2020 2020 2020 636f 6c73 203d 2069 6e74        cols = int
+00006340: 2861 7272 2e73 6861 7065 5b32 5d29 0d0a  (arr.shape[2])..
+00006350: 0d0a 2020 2020 2020 2020 6474 7970 6520  ..        dtype 
+00006360: 3d20 6e75 6d70 795f 746f 5f67 6461 6c5f  = numpy_to_gdal_
+00006370: 6474 7970 6528 6172 7229 0d0a 2020 2020  dtype(arr)..    
+00006380: 2020 2020 6473 745f 6473 203d 2044 6174      dst_ds = Dat
+00006390: 6173 6574 2e5f 6372 6561 7465 5f67 6461  aset._create_gda
+000063a0: 6c5f 6461 7461 7365 7428 0d0a 2020 2020  l_dataset(..    
+000063b0: 2020 2020 2020 2020 636f 6c73 2c20 726f          cols, ro
+000063c0: 7773 2c20 6261 6e64 732c 2064 7479 7065  ws, bands, dtype
+000063d0: 2c20 6472 6976 6572 3d22 4d45 4d22 2c20  , driver="MEM", 
+000063e0: 7061 7468 3d4e 6f6e 650d 0a20 2020 2020  path=None..     
+000063f0: 2020 2029 0d0a 0d0a 2020 2020 2020 2020     )....        
+00006400: 7372 7365 203d 2044 6174 6173 6574 2e5f  srse = Dataset._
+00006410: 6372 6561 7465 5f73 725f 6672 6f6d 5f65  create_sr_from_e
+00006420: 7073 6728 6570 7367 3d65 7073 6729 0d0a  psg(epsg=epsg)..
+00006430: 2020 2020 2020 2020 6473 745f 6473 2e53          dst_ds.S
+00006440: 6574 5072 6f6a 6563 7469 6f6e 2873 7273  etProjection(srs
+00006450: 652e 4578 706f 7274 546f 576b 7428 2929  e.ExportToWkt())
+00006460: 0d0a 2020 2020 2020 2020 6473 745f 6f62  ..        dst_ob
+00006470: 6a20 3d20 636c 7328 6473 745f 6473 290d  j = cls(dst_ds).
+00006480: 0a20 2020 2020 2020 2064 7374 5f6f 626a  .        dst_obj
+00006490: 2e5f 7365 745f 6e6f 5f64 6174 615f 7661  ._set_no_data_va
+000064a0: 6c75 6528 6e6f 5f64 6174 615f 7661 6c75  lue(no_data_valu
+000064b0: 653d 6e6f 5f64 6174 615f 7661 6c75 6529  e=no_data_value)
+000064c0: 0d0a 0d0a 2020 2020 2020 2020 6473 745f  ....        dst_
+000064d0: 6f62 6a2e 7261 7374 6572 2e53 6574 4765  obj.raster.SetGe
+000064e0: 6f54 7261 6e73 666f 726d 2867 656f 290d  oTransform(geo).
+000064f0: 0a20 2020 2020 2020 2069 6620 6261 6e64  .        if band
+00006500: 7320 3d3d 2031 3a0d 0a20 2020 2020 2020  s == 1:..       
+00006510: 2020 2020 2064 7374 5f6f 626a 2e72 6173       dst_obj.ras
+00006520: 7465 722e 4765 7452 6173 7465 7242 616e  ter.GetRasterBan
+00006530: 6428 3129 2e57 7269 7465 4172 7261 7928  d(1).WriteArray(
+00006540: 6172 7229 0d0a 2020 2020 2020 2020 656c  arr)..        el
+00006550: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
+00006560: 2066 6f72 2069 2069 6e20 7261 6e67 6528   for i in range(
+00006570: 6261 6e64 7329 3a0d 0a20 2020 2020 2020  bands):..       
+00006580: 2020 2020 2020 2020 2064 7374 5f6f 626a           dst_obj
+00006590: 2e72 6173 7465 722e 4765 7452 6173 7465  .raster.GetRaste
+000065a0: 7242 616e 6428 6920 2b20 3129 2e57 7269  rBand(i + 1).Wri
+000065b0: 7465 4172 7261 7928 6172 725b 692c 203a  teArray(arr[i, :
+000065c0: 2c20 3a5d 290d 0a0d 0a20 2020 2020 2020  , :])....       
+000065d0: 2072 6574 7572 6e20 6473 745f 6f62 6a0d   return dst_obj.
+000065e0: 0a0d 0a20 2020 2040 636c 6173 736d 6574  ...    @classmet
+000065f0: 686f 640d 0a20 2020 2064 6566 2064 6174  hod..    def dat
+00006600: 6173 6574 5f6c 696b 6528 0d0a 2020 2020  aset_like(..    
+00006610: 2020 2020 636c 732c 0d0a 2020 2020 2020      cls,..      
+00006620: 2020 7372 632c 0d0a 2020 2020 2020 2020    src,..        
+00006630: 6172 7261 793a 206e 702e 6e64 6172 7261  array: np.ndarra
+00006640: 792c 0d0a 2020 2020 2020 2020 6472 6976  y,..        driv
+00006650: 6572 3a20 7374 7220 3d20 224d 454d 222c  er: str = "MEM",
+00006660: 0d0a 2020 2020 2020 2020 7061 7468 3a20  ..        path: 
+00006670: 7374 7220 3d20 4e6f 6e65 2c0d 0a20 2020  str = None,..   
+00006680: 2029 202d 3e20 556e 696f 6e5b 6764 616c   ) -> Union[gdal
+00006690: 2e44 6174 6173 6574 2c20 4e6f 6e65 5d3a  .Dataset, None]:
+000066a0: 0d0a 2020 2020 2020 2020 2222 2272 6173  ..        """ras
+000066b0: 7465 724c 696b 652e 0d0a 0d0a 2020 2020  terLike.....    
+000066c0: 2020 2020 7261 7374 6572 4c69 6b65 206d      rasterLike m
+000066d0: 6574 686f 6420 6372 6561 7465 7320 6120  ethod creates a 
+000066e0: 4765 6f74 6966 6620 7261 7374 6572 206c  Geotiff raster l
+000066f0: 696b 6520 616e 6f74 6865 7220 696e 7075  ike another inpu
+00006700: 7420 7261 7374 6572 2c20 6e65 7720 7261  t raster, new ra
+00006710: 7374 6572 0d0a 2020 2020 2020 2020 7769  ster..        wi
+00006720: 6c6c 2068 6176 6520 7468 6520 7361 6d65  ll have the same
+00006730: 2070 726f 6a65 6374 696f 6e2c 2063 6f6f   projection, coo
+00006740: 7264 696e 6174 6573 206f 7220 7468 6520  rdinates or the 
+00006750: 746f 7020 6c65 6674 2063 6f72 6e65 7220  top left corner 
+00006760: 6f66 2074 6865 206f 7269 6769 6e61 6c0d  of the original.
+00006770: 0a20 2020 2020 2020 2072 6173 7465 722c  .        raster,
+00006780: 2063 656c 6c20 7369 7a65 2c20 6e6f 6461   cell size, noda
+00006790: 7461 2076 656c 7565 2c20 616e 6420 6e75  ta velue, and nu
+000067a0: 6d62 6572 206f 6620 726f 7773 2061 6e64  mber of rows and
+000067b0: 2063 6f6c 756d 6e73 0d0a 2020 2020 2020   columns..      
+000067c0: 2020 7468 6520 7261 7374 6572 2061 6e64    the raster and
+000067d0: 2074 6865 2064 656d 2073 686f 756c 6420   the dem should 
+000067e0: 6861 7665 2074 6865 2073 616d 6520 6e75  have the same nu
+000067f0: 6d62 6572 206f 6620 636f 6c75 6d6e 7320  mber of columns 
+00006800: 616e 6420 726f 7773 0d0a 0d0a 2020 2020  and rows....    
+00006810: 2020 2020 5061 7261 6d65 7465 7273 0d0a      Parameters..
+00006820: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+00006830: 2d2d 0d0a 2020 2020 2020 2020 7372 6320  --..        src 
+00006840: 3a20 5b67 6461 6c2e 6461 7461 7365 745d  : [gdal.dataset]
+00006850: 0d0a 2020 2020 2020 2020 2020 2020 736f  ..            so
+00006860: 7572 6365 2072 6173 7465 7220 746f 2067  urce raster to g
+00006870: 6574 2074 6865 2073 7061 7469 616c 2069  et the spatial i
+00006880: 6e66 6f72 6d61 7469 6f6e 0d0a 2020 2020  nformation..    
+00006890: 2020 2020 6172 7261 7920 3a20 5b6e 756d      array : [num
+000068a0: 7079 2061 7272 6179 5d0d 0a20 2020 2020  py array]..     
+000068b0: 2020 2020 2020 2074 6f20 7374 6f72 6520         to store 
+000068c0: 696e 2074 6865 206e 6577 2072 6173 7465  in the new raste
+000068d0: 720d 0a20 2020 2020 2020 2064 7269 7665  r..        drive
+000068e0: 723a 5b73 7472 5d0d 0a20 2020 2020 2020  r:[str]..       
+000068f0: 2020 2020 2067 6461 6c20 6472 6976 6572       gdal driver
+00006900: 2074 7970 652e 2044 6566 6175 6c74 2069   type. Default i
+00006910: 7320 2247 5469 6666 220d 0a20 2020 2020  s "GTiff"..     
+00006920: 2020 2070 6174 6820 3a20 5b53 7472 696e     path : [Strin
+00006930: 675d 0d0a 2020 2020 2020 2020 2020 2020  g]..            
+00006940: 7061 7468 2074 6f20 7361 7665 2074 6865  path to save the
+00006950: 206e 6577 2072 6173 7465 7220 696e 636c   new raster incl
+00006960: 7564 696e 6720 6e65 7720 7261 7374 6572  uding new raster
+00006970: 206e 616d 6520 616e 6420 6578 7465 6e73   name and extens
+00006980: 696f 6e20 282e 7469 6629 0d0a 0d0a 2020  ion (.tif)....  
+00006990: 2020 2020 2020 5265 7475 726e 730d 0a20        Returns.. 
+000069a0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 0d0a         -------..
+000069b0: 2020 2020 2020 2020 4e6f 6e65 3a0d 0a20          None:.. 
+000069c0: 2020 2020 2020 2020 2020 2069 6620 7468             if th
+000069d0: 6520 6472 6976 6572 2069 7320 2247 5469  e driver is "GTi
+000069e0: 6666 2220 7468 6520 6675 6e63 7469 6f6e  ff" the function
+000069f0: 2077 696c 6c20 7361 7665 2074 6865 206e   will save the n
+00006a00: 6577 2072 6173 7465 7220 746f 2074 6865  ew raster to the
+00006a10: 2067 6976 656e 2070 6174 682e 0d0a 2020   given path...  
+00006a20: 2020 2020 2020 4461 7461 6375 6265 3a0d        Datacube:.
+00006a30: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+00006a40: 7468 6520 6472 6976 6572 2069 7320 224d  the driver is "M
+00006a50: 454d 2220 7468 6520 6675 6e63 7469 6f6e  EM" the function
+00006a60: 2077 696c 6c20 7265 7475 726e 2074 6865   will return the
+00006a70: 2063 7265 6174 6564 2072 6173 7465 7220   created raster 
+00006a80: 696e 206d 656d 6f72 792e 0d0a 0d0a 2020  in memory.....  
+00006a90: 2020 2020 2020 4578 616d 706c 650d 0a20        Example.. 
+00006aa0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 0d0a         -------..
+00006ab0: 2020 2020 2020 2020 3e3e 3e20 6172 7261          >>> arra
+00006ac0: 7920 3d20 6e70 2e6c 6f61 6428 2252 4149  y = np.load("RAI
+00006ad0: 4e5f 356b 2e6e 7079 2229 0d0a 2020 2020  N_5k.npy")..    
+00006ae0: 2020 2020 3e3e 3e20 7372 6320 3d20 6764      >>> src = gd
+00006af0: 616c 2e4f 7065 6e28 2244 454d 2e74 6966  al.Open("DEM.tif
+00006b00: 2229 0d0a 2020 2020 2020 2020 3e3e 3e20  ")..        >>> 
+00006b10: 6e61 6d65 203d 2022 7261 696e 2e74 6966  name = "rain.tif
+00006b20: 220d 0a20 2020 2020 2020 203e 3e3e 2044  "..        >>> D
+00006b30: 6174 6173 6574 2e64 6174 6173 6574 5f6c  ataset.dataset_l
+00006b40: 696b 6528 7372 632c 2061 7272 6179 2c20  ike(src, array, 
+00006b50: 6472 6976 6572 3d22 4754 6966 6622 2c20  driver="GTiff", 
+00006b60: 7061 7468 3d6e 616d 6529 0d0a 2020 2020  path=name)..    
+00006b70: 2020 2020 2d20 6f72 2063 7265 6174 6520      - or create 
+00006b80: 6120 7261 7374 6572 2069 6e20 6d65 6d6f  a raster in memo
+00006b90: 7279 0d0a 2020 2020 2020 2020 3e3e 3e20  ry..        >>> 
+00006ba0: 6172 7261 7920 3d20 6e70 2e6c 6f61 6428  array = np.load(
+00006bb0: 2252 4149 4e5f 356b 2e6e 7079 2229 0d0a  "RAIN_5k.npy")..
+00006bc0: 2020 2020 2020 2020 3e3e 3e20 7372 6320          >>> src 
+00006bd0: 3d20 6764 616c 2e4f 7065 6e28 2244 454d  = gdal.Open("DEM
+00006be0: 2e74 6966 2229 0d0a 2020 2020 2020 2020  .tif")..        
+00006bf0: 3e3e 3e20 6473 7420 3d20 4461 7461 7365  >>> dst = Datase
+00006c00: 742e 6461 7461 7365 745f 6c69 6b65 2873  t.dataset_like(s
+00006c10: 7263 2c20 6172 7261 792c 2064 7269 7665  rc, array, drive
+00006c20: 723d 224d 454d 2229 0d0a 2020 2020 2020  r="MEM")..      
+00006c30: 2020 2222 220d 0a20 2020 2020 2020 2069    """..        i
+00006c40: 6620 6e6f 7420 6973 696e 7374 616e 6365  f not isinstance
+00006c50: 2861 7272 6179 2c20 6e70 2e6e 6461 7272  (array, np.ndarr
+00006c60: 6179 293a 0d0a 2020 2020 2020 2020 2020  ay):..          
+00006c70: 2020 7261 6973 6520 5479 7065 4572 726f    raise TypeErro
+00006c80: 7228 2261 7272 6179 2073 686f 756c 6420  r("array should 
+00006c90: 6265 206f 6620 7479 7065 206e 756d 7079  be of type numpy
+00006ca0: 2061 7272 6179 2229 0d0a 0d0a 2020 2020   array")....    
+00006cb0: 2020 2020 6966 206c 656e 2861 7272 6179      if len(array
+00006cc0: 2e73 6861 7065 2920 3d3d 2032 3a0d 0a20  .shape) == 2:.. 
+00006cd0: 2020 2020 2020 2020 2020 2062 616e 6473             bands
+00006ce0: 203d 2031 0d0a 2020 2020 2020 2020 656c   = 1..        el
+00006cf0: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
+00006d00: 2062 616e 6473 203d 2061 7272 6179 2e73   bands = array.s
+00006d10: 6861 7065 5b30 5d0d 0a0d 0a20 2020 2020  hape[0]....     
+00006d20: 2020 2064 7479 7065 203d 206e 756d 7079     dtype = numpy
+00006d30: 5f74 6f5f 6764 616c 5f64 7479 7065 2861  _to_gdal_dtype(a
+00006d40: 7272 6179 290d 0a0d 0a20 2020 2020 2020  rray)....       
+00006d50: 2064 7374 203d 2044 6174 6173 6574 2e5f   dst = Dataset._
+00006d60: 6372 6561 7465 5f67 6461 6c5f 6461 7461  create_gdal_data
+00006d70: 7365 7428 0d0a 2020 2020 2020 2020 2020  set(..          
+00006d80: 2020 7372 632e 636f 6c75 6d6e 732c 2073    src.columns, s
+00006d90: 7263 2e72 6f77 732c 2062 616e 6473 2c20  rc.rows, bands, 
+00006da0: 6474 7970 652c 2064 7269 7665 723d 6472  dtype, driver=dr
+00006db0: 6976 6572 2c20 7061 7468 3d70 6174 680d  iver, path=path.
+00006dc0: 0a20 2020 2020 2020 2029 0d0a 0d0a 2020  .        )....  
+00006dd0: 2020 2020 2020 6473 742e 5365 7447 656f        dst.SetGeo
+00006de0: 5472 616e 7366 6f72 6d28 7372 632e 6765  Transform(src.ge
+00006df0: 6f74 7261 6e73 666f 726d 290d 0a20 2020  otransform)..   
+00006e00: 2020 2020 2064 7374 2e53 6574 5072 6f6a       dst.SetProj
+00006e10: 6563 7469 6f6e 2873 7263 2e63 7273 290d  ection(src.crs).
+00006e20: 0a20 2020 2020 2020 2023 2073 6574 7469  .        # setti
+00006e30: 6e67 2074 6865 204e 6f44 6174 6156 616c  ng the NoDataVal
+00006e40: 7565 2064 6f65 7320 6e6f 7420 6163 6365  ue does not acce
+00006e50: 7074 2064 6f75 626c 6520 7072 6563 6973  pt double precis
+00006e60: 696f 6e20 6e75 6d62 6572 730d 0a20 2020  ion numbers..   
+00006e70: 2020 2020 2064 7374 5f6f 626a 203d 2063       dst_obj = c
+00006e80: 6c73 2864 7374 290d 0a20 2020 2020 2020  ls(dst)..       
+00006e90: 2064 7374 5f6f 626a 2e5f 7365 745f 6e6f   dst_obj._set_no
+00006ea0: 5f64 6174 615f 7661 6c75 6528 6e6f 5f64  _data_value(no_d
+00006eb0: 6174 615f 7661 6c75 653d 7372 632e 6e6f  ata_value=src.no
+00006ec0: 5f64 6174 615f 7661 6c75 655b 305d 290d  _data_value[0]).
+00006ed0: 0a0d 0a20 2020 2020 2020 2064 7374 5f6f  ...        dst_o
+00006ee0: 626a 2e72 6173 7465 722e 4765 7452 6173  bj.raster.GetRas
+00006ef0: 7465 7242 616e 6428 3129 2e57 7269 7465  terBand(1).Write
+00006f00: 4172 7261 7928 6172 7261 7929 0d0a 2020  Array(array)..  
+00006f10: 2020 2020 2020 6966 2070 6174 6820 6973        if path is
+00006f20: 206e 6f74 204e 6f6e 653a 0d0a 2020 2020   not None:..    
+00006f30: 2020 2020 2020 2020 6473 745f 6f62 6a2e          dst_obj.
+00006f40: 7261 7374 6572 2e46 6c75 7368 4361 6368  raster.FlushCach
+00006f50: 6528 290d 0a20 2020 2020 2020 2020 2020  e()..           
+00006f60: 2064 7374 5f6f 626a 203d 204e 6f6e 650d   dst_obj = None.
+00006f70: 0a0d 0a20 2020 2020 2020 2072 6574 7572  ...        retur
+00006f80: 6e20 6473 745f 6f62 6a0d 0a0d 0a20 2020  n dst_obj....   
+00006f90: 2064 6566 205f 6765 745f 6372 7328 7365   def _get_crs(se
+00006fa0: 6c66 2920 2d3e 2073 7472 3a0d 0a20 2020  lf) -> str:..   
+00006fb0: 2020 2020 2022 2222 4765 7420 636f 6f72       """Get coor
+00006fc0: 6469 6e61 7465 2072 6566 6572 656e 6365  dinate reference
+00006fd0: 2073 7973 7465 6d2e 2222 220d 0a20 2020   system."""..   
+00006fe0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+00006ff0: 2e72 6173 7465 722e 4765 7450 726f 6a65  .raster.GetProje
+00007000: 6374 696f 6e28 290d 0a0d 0a20 2020 2064  ction()....    d
+00007010: 6566 2073 6574 5f63 7273 2873 656c 662c  ef set_crs(self,
+00007020: 2063 7273 3a20 4f70 7469 6f6e 616c 203d   crs: Optional =
+00007030: 204e 6f6e 652c 2065 7073 673a 2069 6e74   None, epsg: int
+00007040: 203d 204e 6f6e 6529 3a0d 0a20 2020 2020   = None):..     
+00007050: 2020 2022 2222 7365 745f 6372 732e 0d0a     """set_crs...
+00007060: 0d0a 2020 2020 2020 2020 2020 2020 5365  ..            Se
+00007070: 7420 7468 6520 436f 6f72 6469 6e61 7465  t the Coordinate
+00007080: 2052 6566 6572 656e 6365 2053 7973 7465   Reference Syste
+00007090: 6d20 2843 5253 2920 6f66 2061 0d0a 0d0a  m (CRS) of a....
+000070a0: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
+000070b0: 7273 0d0a 2020 2020 2020 2020 2d2d 2d2d  rs..        ----
+000070c0: 2d2d 2d2d 2d2d 0d0a 2020 2020 2020 2020  ------..        
+000070d0: 6372 733a 205b 7374 725d 0d0a 2020 2020  crs: [str]..    
+000070e0: 2020 2020 2020 2020 6f70 7469 6f6e 616c          optional
+000070f0: 2069 6620 6570 7367 2069 7320 7370 6563   if epsg is spec
+00007100: 6966 6965 640d 0a20 2020 2020 2020 2020  ified..         
+00007110: 2020 2057 4b54 2073 7472 696e 672e 0d0a     WKT string...
+00007120: 2020 2020 2020 2020 2020 2020 692e 652e              i.e.
+00007130: 2027 4745 4f47 4353 5b22 5747 5320 3834   'GEOGCS["WGS 84
+00007140: 222c 4441 5455 4d5b 2257 4753 5f31 3938  ",DATUM["WGS_198
+00007150: 3422 2c53 5048 4552 4f49 445b 2257 4753  4",SPHEROID["WGS
+00007160: 2038 3422 2c36 3337 3831 3337 2c32 3938   84",6378137,298
+00007170: 2e32 3537 3232 3335 3633 2c41 5554 484f  .257223563,AUTHO
+00007180: 5249 5459 5b22 4550 5347 222c 2237 3033  RITY["EPSG","703
+00007190: 3022 5d5d 2c0d 0a20 2020 2020 2020 2020  0"]],..         
+000071a0: 2020 2041 5554 484f 5249 5459 5b22 4550     AUTHORITY["EP
+000071b0: 5347 222c 2236 3332 3622 5d5d 2c50 5249  SG","6326"]],PRI
+000071c0: 4d45 4d5b 2247 7265 656e 7769 6368 222c  MEM["Greenwich",
+000071d0: 302c 4155 5448 4f52 4954 595b 2245 5053  0,AUTHORITY["EPS
+000071e0: 4722 2c22 3839 3031 225d 5d2c 554e 4954  G","8901"]],UNIT
+000071f0: 5b22 6465 6772 6565 222c 0d0a 2020 2020  ["degree",..    
+00007200: 2020 2020 2020 2020 302e 3031 3734 3533          0.017453
+00007210: 3239 3235 3139 3934 3333 2c41 5554 484f  2925199433,AUTHO
+00007220: 5249 5459 5b22 4550 5347 222c 2239 3132  RITY["EPSG","912
+00007230: 3222 5d5d 2c41 5849 535b 224c 6174 6974  2"]],AXIS["Latit
+00007240: 7564 6522 2c4e 4f52 5448 5d2c 4158 4953  ude",NORTH],AXIS
+00007250: 5b22 4c6f 6e67 6974 7564 6522 2c45 4153  ["Longitude",EAS
+00007260: 545d 2c41 5554 484f 5249 5459 5b22 4550  T],AUTHORITY["EP
+00007270: 5347 222c 2234 3332 3622 5d5d 270d 0a20  SG","4326"]]'.. 
+00007280: 2020 2020 2020 2065 7073 673a 205b 696e         epsg: [in
+00007290: 745d 0d0a 2020 2020 2020 2020 2020 2020  t]..            
+000072a0: 6f70 7469 6f6e 616c 2069 6620 6372 7320  optional if crs 
+000072b0: 6973 2073 7065 6369 6669 6564 0d0a 2020  is specified..  
+000072c0: 2020 2020 2020 2020 2020 4550 5347 2063            EPSG c
+000072d0: 6f64 6520 7370 6563 6966 7969 6e67 2074  ode specifying t
+000072e0: 6865 2070 726f 6a65 6374 696f 6e2e 0d0a  he projection...
+000072f0: 2020 2020 2020 2020 2222 220d 0a20 2020          """..   
+00007300: 2020 2020 2023 2066 6972 7374 2063 6861       # first cha
+00007310: 6e67 6520 7468 6520 7072 6f6a 6563 7469  nge the projecti
+00007320: 6f6e 206f 6620 7468 6520 6764 616c 2064  on of the gdal d
+00007330: 6174 6173 6574 206f 626a 6563 740d 0a20  ataset object.. 
+00007340: 2020 2020 2020 2023 2073 6563 6f6e 6420         # second 
+00007350: 6368 616e 6765 2074 6865 2065 7073 6720  change the epsg 
+00007360: 6174 7472 6962 7574 6520 6f66 2074 6865  attribute of the
+00007370: 2044 6174 6173 6574 206f 626a 6563 740d   Dataset object.
+00007380: 0a20 2020 2020 2020 2069 6620 7365 6c66  .        if self
+00007390: 2e64 7269 7665 725f 7479 7065 203d 3d20  .driver_type == 
+000073a0: 2261 7363 6969 223a 0d0a 2020 2020 2020  "ascii":..      
+000073b0: 2020 2020 2020 7261 6973 6520 5479 7065        raise Type
+000073c0: 4572 726f 7228 0d0a 2020 2020 2020 2020  Error(..        
+000073d0: 2020 2020 2020 2020 2253 6574 7469 6e67          "Setting
+000073e0: 2043 5253 2066 6f72 2041 5343 4949 2066   CRS for ASCII f
+000073f0: 696c 6520 6973 206e 6f74 2070 6f73 7369  ile is not possi
+00007400: 626c 652c 2079 6f75 2063 616e 2073 6176  ble, you can sav
+00007410: 6520 7468 6520 6669 6c65 7320 746f 2061  e the files to a
+00007420: 2067 656f 7469 6666 2061 6e64 2074 6865   geotiff and the
+00007430: 6e20 7265 7365 7420 7468 6520 6372 7322  n reset the crs"
+00007440: 0d0a 2020 2020 2020 2020 2020 2020 290d  ..            ).
+00007450: 0a20 2020 2020 2020 2065 6c73 653a 0d0a  .        else:..
+00007460: 2020 2020 2020 2020 2020 2020 6966 2063              if c
+00007470: 7273 2069 7320 6e6f 7420 4e6f 6e65 3a0d  rs is not None:.
+00007480: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00007490: 2073 656c 662e 7261 7374 6572 2e53 6574   self.raster.Set
+000074a0: 5072 6f6a 6563 7469 6f6e 2863 7273 290d  Projection(crs).
+000074b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000074c0: 2073 656c 662e 5f65 7073 6720 3d20 4665   self._epsg = Fe
+000074d0: 6174 7572 6543 6f6c 6c65 6374 696f 6e2e  atureCollection.
+000074e0: 6765 745f 6570 7367 5f66 726f 6d5f 5072  get_epsg_from_Pr
+000074f0: 6a28 6372 7329 0d0a 2020 2020 2020 2020  j(crs)..        
+00007500: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
+00007510: 2020 2020 2020 2020 2020 2073 7220 3d20             sr = 
+00007520: 4461 7461 7365 742e 5f63 7265 6174 655f  Dataset._create_
+00007530: 7372 5f66 726f 6d5f 6570 7367 2865 7073  sr_from_epsg(eps
+00007540: 6729 0d0a 2020 2020 2020 2020 2020 2020  g)..            
+00007550: 2020 2020 7365 6c66 2e72 6173 7465 722e      self.raster.
+00007560: 5365 7450 726f 6a65 6374 696f 6e28 7372  SetProjection(sr
+00007570: 2e45 7870 6f72 7454 6f57 6b74 2829 290d  .ExportToWkt()).
+00007580: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00007590: 2073 656c 662e 5f65 7073 6720 3d20 6570   self._epsg = ep
+000075a0: 7367 0d0a 0d0a 2020 2020 6465 6620 5f67  sg....    def _g
+000075b0: 6574 5f65 7073 6728 7365 6c66 2920 2d3e  et_epsg(self) ->
+000075c0: 2069 6e74 3a0d 0a20 2020 2020 2020 2022   int:..        "
+000075d0: 2222 4765 7445 5053 472e 0d0a 0d0a 2020  ""GetEPSG.....  
+000075e0: 2020 2020 2020 2020 2020 5468 6973 2066            This f
+000075f0: 756e 6374 696f 6e20 7265 6164 7320 7468  unction reads th
+00007600: 6520 7072 6f6a 6563 7469 6f6e 206f 6620  e projection of 
+00007610: 6120 4745 4f47 4353 2066 696c 6520 6f72  a GEOGCS file or
+00007620: 2074 6966 6620 6669 6c65 0d0a 0d0a 2020   tiff file....  
+00007630: 2020 2020 2020 5265 7475 726e 730d 0a20        Returns.. 
+00007640: 2020 2020 2020 202d 2d2d 2d2d 2d2d 0d0a         -------..
+00007650: 2020 2020 2020 2020 6570 7367 203a 205b          epsg : [
+00007660: 696e 7465 6765 725d 0d0a 2020 2020 2020  integer]..      
+00007670: 2020 2020 2020 6570 7367 206e 756d 6265        epsg numbe
+00007680: 720d 0a20 2020 2020 2020 2022 2222 0d0a  r..        """..
+00007690: 2020 2020 2020 2020 7072 6a20 3d20 7365          prj = se
+000076a0: 6c66 2e5f 6765 745f 6372 7328 290d 0a20  lf._get_crs().. 
+000076b0: 2020 2020 2020 2065 7073 6720 3d20 4665         epsg = Fe
+000076c0: 6174 7572 6543 6f6c 6c65 6374 696f 6e2e  atureCollection.
+000076d0: 6765 745f 6570 7367 5f66 726f 6d5f 5072  get_epsg_from_Pr
+000076e0: 6a28 7072 6a29 0d0a 0d0a 2020 2020 2020  j(prj)....      
+000076f0: 2020 7265 7475 726e 2065 7073 670d 0a0d    return epsg...
+00007700: 0a20 2020 2064 6566 2067 6574 5f76 6172  .    def get_var
+00007710: 6961 626c 6573 2873 656c 6629 3a0d 0a20  iables(self):.. 
+00007720: 2020 2020 2020 2022 2222 0d0a 0d0a 2020         """....  
+00007730: 2020 2020 2020 5265 7475 726e 730d 0a20        Returns.. 
+00007740: 2020 2020 2020 202d 2d2d 2d2d 2d2d 0d0a         -------..
+00007750: 0d0a 2020 2020 2020 2020 2222 220d 0a20  ..        """.. 
+00007760: 2020 2020 2020 2076 6172 6961 626c 6573         variables
+00007770: 203d 207b 7d0d 0a20 2020 2020 2020 2066   = {}..        f
+00007780: 6f72 2069 2c20 7661 7220 696e 2065 6e75  or i, var in enu
+00007790: 6d65 7261 7465 2873 656c 662e 7375 6273  merate(self.subs
+000077a0: 6574 7329 3a0d 0a20 2020 2020 2020 2020  ets):..         
+000077b0: 2020 206e 616d 6520 3d20 7661 725b 315d     name = var[1]
+000077c0: 2e73 706c 6974 2822 2022 295b 315d 0d0a  .split(" ")[1]..
+000077d0: 2020 2020 2020 2020 2020 2020 7372 6320              src 
+000077e0: 3d20 6764 616c 2e4f 7065 6e28 7365 6c66  = gdal.Open(self
+000077f0: 2e73 7562 7365 7473 5b69 5d5b 305d 290d  .subsets[i][0]).
+00007800: 0a20 2020 2020 2020 2020 2020 2076 6172  .            var
+00007810: 6961 626c 6573 5b6e 616d 655d 203d 2044  iables[name] = D
+00007820: 6174 6173 6574 2873 7263 290d 0a0d 0a20  ataset(src).... 
+00007830: 2020 2020 2020 2072 6574 7572 6e20 7661         return va
+00007840: 7269 6162 6c65 730d 0a0d 0a20 2020 2064  riables....    d
+00007850: 6566 2063 6f75 6e74 5f64 6f6d 6169 6e5f  ef count_domain_
+00007860: 6365 6c6c 7328 7365 6c66 293a 0d0a 2020  cells(self):..  
+00007870: 2020 2020 2020 2222 2243 6f75 6e74 2063        """Count c
+00007880: 656c 6c73 2069 6e73 6964 6520 7468 6520  ells inside the 
+00007890: 646f 6d61 696e 0d0a 0d0a 2020 2020 2020  domain....      
+000078a0: 2020 5265 7475 726e 730d 0a20 2020 2020    Returns..     
+000078b0: 2020 202d 2d2d 2d2d 2d2d 0d0a 2020 2020     -------..    
+000078c0: 2020 2020 696e 743a 0d0a 2020 2020 2020      int:..      
+000078d0: 2020 2020 2020 4e75 6d62 6572 206f 6620        Number of 
+000078e0: 6365 6c6c 730d 0a20 2020 2020 2020 2022  cells..        "
+000078f0: 2222 0d0a 2020 2020 2020 2020 2320 636f  ""..        # co
+00007900: 756e 7420 6365 6c6c 7320 696e 7369 6465  unt cells inside
+00007910: 2074 6865 2064 6f6d 6169 6e0d 0a20 2020   the domain..   
+00007920: 2020 2020 2061 7272 203d 2073 656c 662e       arr = self.
+00007930: 7261 7374 6572 2e52 6561 6441 7341 7272  raster.ReadAsArr
+00007940: 6179 2829 0d0a 2020 2020 2020 2020 646f  ay()..        do
+00007950: 6d61 696e 5f63 6f75 6e74 203d 206e 702e  main_count = np.
+00007960: 7369 7a65 2861 7272 5b3a 2c20 3a5d 2920  size(arr[:, :]) 
+00007970: 2d20 6e70 2e63 6f75 6e74 5f6e 6f6e 7a65  - np.count_nonze
+00007980: 726f 280d 0a20 2020 2020 2020 2020 2020  ro(..           
+00007990: 2028 6172 725b 6e70 2e69 7363 6c6f 7365   (arr[np.isclose
+000079a0: 2861 7272 2c20 7365 6c66 2e6e 6f5f 6461  (arr, self.no_da
+000079b0: 7461 5f76 616c 7565 5b30 5d2c 2072 746f  ta_value[0], rto
+000079c0: 6c3d 302e 3030 3129 5d29 0d0a 2020 2020  l=0.001)])..    
+000079d0: 2020 2020 290d 0a20 2020 2020 2020 2072      )..        r
+000079e0: 6574 7572 6e20 646f 6d61 696e 5f63 6f75  eturn domain_cou
+000079f0: 6e74 0d0a 0d0a 2020 2020 4073 7461 7469  nt....    @stati
+00007a00: 636d 6574 686f 640d 0a20 2020 2064 6566  cmethod..    def
+00007a10: 205f 6372 6561 7465 5f73 725f 6672 6f6d   _create_sr_from
+00007a20: 5f65 7073 6728 6570 7367 3a20 696e 7420  _epsg(epsg: int 
+00007a30: 3d20 4e6f 6e65 2920 2d3e 2053 7061 7469  = None) -> Spati
+00007a40: 616c 5265 6665 7265 6e63 653a 0d0a 2020  alReference:..  
+00007a50: 2020 2020 2020 2222 2243 7265 6174 6520        """Create 
+00007a60: 6120 7370 6174 6961 6c20 7265 6665 7265  a spatial refere
+00007a70: 6e63 6520 6f62 6a65 6374 2066 726f 6d20  nce object from 
+00007a80: 6570 7367 206e 756d 6265 722e 0d0a 0d0a  epsg number.....
+00007a90: 2020 2020 2020 2020 6874 7470 733a 2f2f          https://
+00007aa0: 6764 616c 2e6f 7267 2f74 7574 6f72 6961  gdal.org/tutoria
+00007ab0: 6c73 2f6f 7372 5f61 7069 5f74 7574 2e68  ls/osr_api_tut.h
+00007ac0: 746d 6c0d 0a0d 0a20 2020 2020 2020 2050  tml....        P
+00007ad0: 6172 616d 6574 6572 730d 0a20 2020 2020  arameters..     
+00007ae0: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20     ----------.. 
+00007af0: 2020 2020 2020 2065 7073 673a 205b 696e         epsg: [in
+00007b00: 745d 0d0a 2020 2020 2020 2020 2020 2020  t]..            
+00007b10: 6570 7367 206e 756d 6265 722e 0d0a 0d0a  epsg number.....
+00007b20: 2020 2020 2020 2020 5265 7475 726e 730d          Returns.
+00007b30: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+00007b40: 0d0a 2020 2020 2020 2020 5370 6174 6961  ..        Spatia
+00007b50: 6c52 6566 6572 656e 6365 206f 626a 6563  lReference objec
+00007b60: 740d 0a20 2020 2020 2020 2022 2222 0d0a  t..        """..
+00007b70: 2020 2020 2020 2020 7372 203d 206f 7372          sr = osr
+00007b80: 2e53 7061 7469 616c 5265 6665 7265 6e63  .SpatialReferenc
+00007b90: 6528 290d 0a20 2020 2020 2020 2073 722e  e()..        sr.
+00007ba0: 496d 706f 7274 4672 6f6d 4550 5347 2869  ImportFromEPSG(i
+00007bb0: 6e74 2865 7073 6729 290d 0a0d 0a20 2020  nt(epsg))....   
+00007bc0: 2020 2020 2023 2069 6620 6570 7367 2069       # if epsg i
+00007bd0: 7320 4e6f 6e65 3a0d 0a20 2020 2020 2020  s None:..       
+00007be0: 2023 2020 2020 2073 722e 5365 7457 656c   #     sr.SetWel
+00007bf0: 6c4b 6e6f 776e 4765 6f67 4353 2822 5747  lKnownGeogCS("WG
+00007c00: 5338 3422 290d 0a20 2020 2020 2020 2023  S84")..        #
+00007c10: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
+00007c20: 2320 2020 2020 7472 793a 0d0a 2020 2020  #     try:..    
+00007c30: 2020 2020 2320 2020 2020 2020 2020 6966      #         if
+00007c40: 206e 6f74 2073 722e 5365 7457 656c 6c4b   not sr.SetWellK
+00007c50: 6e6f 776e 4765 6f67 4353 2865 7073 6729  nownGeogCS(epsg)
+00007c60: 203d 3d20 363a 0d0a 2020 2020 2020 2020   == 6:..        
+00007c70: 2320 2020 2020 2020 2020 2020 2020 7372  #             sr
+00007c80: 2e53 6574 5765 6c6c 4b6e 6f77 6e47 656f  .SetWellKnownGeo
+00007c90: 6743 5328 6570 7367 290d 0a20 2020 2020  gCS(epsg)..     
+00007ca0: 2020 2023 2020 2020 2020 2020 2065 6c73     #         els
+00007cb0: 653a 0d0a 2020 2020 2020 2020 2320 2020  e:..        #   
+00007cc0: 2020 2020 2020 2020 2020 7472 793a 0d0a            try:..
+00007cd0: 2020 2020 2020 2020 2320 2020 2020 2020          #       
+00007ce0: 2020 2020 2020 2020 2020 7372 2e49 6d70            sr.Imp
+00007cf0: 6f72 7446 726f 6d45 5053 4728 696e 7428  ortFromEPSG(int(
+00007d00: 6570 7367 2929 0d0a 2020 2020 2020 2020  epsg))..        
+00007d10: 2320 2020 2020 2020 2020 2020 2020 6578  #             ex
+00007d20: 6365 7074 3a0d 0a20 2020 2020 2020 2023  cept:..        #
+00007d30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00007d40: 2073 722e 496d 706f 7274 4672 6f6d 576b   sr.ImportFromWk
+00007d50: 7428 6570 7367 290d 0a20 2020 2020 2020  t(epsg)..       
+00007d60: 2023 2020 2020 2065 7863 6570 743a 0d0a   #     except:..
+00007d70: 2020 2020 2020 2020 2320 2020 2020 2020          #       
+00007d80: 2020 7472 793a 0d0a 2020 2020 2020 2020    try:..        
+00007d90: 2320 2020 2020 2020 2020 2020 2020 7372  #             sr
+00007da0: 2e49 6d70 6f72 7446 726f 6d45 5053 4728  .ImportFromEPSG(
+00007db0: 696e 7428 6570 7367 2929 0d0a 2020 2020  int(epsg))..    
+00007dc0: 2020 2020 2320 2020 2020 2020 2020 6578      #         ex
+00007dd0: 6365 7074 3a0d 0a20 2020 2020 2020 2023  cept:..        #
+00007de0: 2020 2020 2020 2020 2020 2020 2073 722e               sr.
+00007df0: 496d 706f 7274 4672 6f6d 576b 7428 6570  ImportFromWkt(ep
+00007e00: 7367 290d 0a20 2020 2020 2020 2072 6574  sg)..        ret
+00007e10: 7572 6e20 7372 0d0a 0d0a 2020 2020 6465  urn sr....    de
+00007e20: 6620 6765 745f 6261 6e64 5f6e 616d 6573  f get_band_names
+00007e30: 2873 656c 6629 202d 3e20 4c69 7374 5b73  (self) -> List[s
+00007e40: 7472 5d3a 0d0a 2020 2020 2020 2020 2222  tr]:..        ""
+00007e50: 2247 6574 2062 616e 6420 6e61 6d65 7320  "Get band names 
+00007e60: 6672 6f6d 2062 616e 6420 6d65 7461 2064  from band meta d
+00007e70: 6174 6120 6966 2065 7869 7374 7320 6f74  ata if exists ot
+00007e80: 6865 7277 6973 6520 7769 6c6c 2072 6574  herwise will ret
+00007e90: 7572 6e20 6964 6578 205b 312c 322c 202e  urn idex [1,2, .
+00007ea0: 2e2e 5d0d 0a0d 0a20 2020 2020 2020 2050  ..]....        P
+00007eb0: 6172 616d 6574 6572 730d 0a20 2020 2020  arameters..     
+00007ec0: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a0d     ----------...
+00007ed0: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
+00007ee0: 0d0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ..        ------
+00007ef0: 2d0d 0a20 2020 2020 2020 206c 6973 745b  -..        list[
+00007f00: 7374 725d 0d0a 2020 2020 2020 2020 2222  str]..        ""
+00007f10: 220d 0a20 2020 2020 2020 206e 616d 6573  "..        names
+00007f20: 203d 205b 5d0d 0a20 2020 2020 2020 2066   = []..        f
+00007f30: 6f72 2069 2069 6e20 7261 6e67 6528 312c  or i in range(1,
+00007f40: 2073 656c 662e 7261 7374 6572 2e52 6173   self.raster.Ras
+00007f50: 7465 7243 6f75 6e74 202b 2031 293a 0d0a  terCount + 1):..
+00007f60: 2020 2020 2020 2020 2020 2020 6261 6e64              band
+00007f70: 5f69 203d 2073 656c 662e 7261 7374 6572  _i = self.raster
+00007f80: 2e47 6574 5261 7374 6572 4261 6e64 2869  .GetRasterBand(i
+00007f90: 290d 0a0d 0a20 2020 2020 2020 2020 2020  )....           
+00007fa0: 2069 6620 6261 6e64 5f69 2e47 6574 4465   if band_i.GetDe
+00007fb0: 7363 7269 7074 696f 6e28 293a 0d0a 2020  scription():..  
+00007fc0: 2020 2020 2020 2020 2020 2020 2020 2320                # 
+00007fd0: 5573 6520 7468 6520 6261 6e64 5f69 2064  Use the band_i d
+00007fe0: 6573 6372 6970 7469 6f6e 2e0d 0a20 2020  escription...   
+00007ff0: 2020 2020 2020 2020 2020 2020 206e 616d               nam
+00008000: 6573 2e61 7070 656e 6428 6261 6e64 5f69  es.append(band_i
+00008010: 2e47 6574 4465 7363 7269 7074 696f 6e28  .GetDescription(
+00008020: 2929 0d0a 2020 2020 2020 2020 2020 2020  ))..            
+00008030: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
+00008040: 2020 2020 2020 2023 2043 6865 636b 2066         # Check f
+00008050: 6f72 206d 6574 6564 6174 612e 0d0a 2020  or metedata...  
+00008060: 2020 2020 2020 2020 2020 2020 2020 6261                ba
+00008070: 6e64 5f69 5f6e 616d 6520 3d20 2242 616e  nd_i_name = "Ban
+00008080: 645f 7b7d 222e 666f 726d 6174 2862 616e  d_{}".format(ban
+00008090: 645f 692e 4765 7442 616e 6428 2929 0d0a  d_i.GetBand())..
+000080a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000080b0: 6d65 7461 6461 7461 203d 2062 616e 645f  metadata = band_
+000080c0: 692e 4765 7444 6174 6173 6574 2829 2e47  i.GetDataset().G
+000080d0: 6574 4d65 7461 6461 7461 5f44 6963 7428  etMetadata_Dict(
+000080e0: 290d 0a0d 0a20 2020 2020 2020 2020 2020  )....           
+000080f0: 2020 2020 2023 2049 6620 696e 206d 6574       # If in met
+00008100: 6164 6174 612c 2072 6574 7572 6e20 7468  adata, return th
+00008110: 6520 6d65 7461 6461 7461 2065 6e74 7279  e metadata entry
+00008120: 2c20 656c 7365 2042 616e 645f 4e2e 0d0a  , else Band_N...
+00008130: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008140: 6966 2062 616e 645f 695f 6e61 6d65 2069  if band_i_name i
+00008150: 6e20 6d65 7461 6461 7461 2061 6e64 206d  n metadata and m
+00008160: 6574 6164 6174 615b 6261 6e64 5f69 5f6e  etadata[band_i_n
+00008170: 616d 655d 3a0d 0a20 2020 2020 2020 2020  ame]:..         
+00008180: 2020 2020 2020 2020 2020 206e 616d 6573             names
+00008190: 2e61 7070 656e 6428 6d65 7461 6461 7461  .append(metadata
+000081a0: 5b62 616e 645f 695f 6e61 6d65 5d29 0d0a  [band_i_name])..
+000081b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000081c0: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
+000081d0: 2020 2020 2020 2020 2020 206e 616d 6573             names
+000081e0: 2e61 7070 656e 6428 6261 6e64 5f69 5f6e  .append(band_i_n
+000081f0: 616d 6529 0d0a 0d0a 2020 2020 2020 2020  ame)....        
+00008200: 7265 7475 726e 206e 616d 6573 0d0a 0d0a  return names....
+00008210: 2020 2020 6465 6620 5f63 6865 636b 5f6e      def _check_n
+00008220: 6f5f 6461 7461 5f76 616c 7565 2873 656c  o_data_value(sel
+00008230: 662c 206e 6f5f 6461 7461 5f76 616c 7565  f, no_data_value
+00008240: 3a20 4c69 7374 293a 0d0a 2020 2020 2020  : List):..      
+00008250: 2020 2222 2256 616c 6964 6174 6520 5468    """Validate Th
+00008260: 6520 6e6f 5f64 6174 615f 7661 6c75 6520  e no_data_value 
+00008270: 7769 7468 2074 6865 2064 7479 7065 206f  with the dtype o
+00008280: 6620 7468 6520 6f62 6a65 6374 2e0d 0a0d  f the object....
+00008290: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
+000082a0: 6572 730d 0a20 2020 2020 2020 202d 2d2d  ers..        ---
+000082b0: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
+000082c0: 206e 6f5f 6461 7461 5f76 616c 7565 0d0a   no_data_value..
+000082d0: 0d0a 2020 2020 2020 2020 5265 7475 726e  ..        Return
+000082e0: 730d 0a20 2020 2020 2020 202d 2d2d 2d2d  s..        -----
+000082f0: 2d2d 0d0a 2020 2020 2020 2020 6e6f 5f64  --..        no_d
+00008300: 6174 615f 7661 6c75 653a 0d0a 2020 2020  ata_value:..    
+00008310: 2020 2020 2020 2020 636f 6e76 6572 7420          convert 
+00008320: 7468 6520 6e6f 5f64 6174 615f 7661 6c75  the no_data_valu
+00008330: 6520 746f 2063 6f6d 6c79 2077 6974 6820  e to comly with 
+00008340: 7468 6520 6474 7970 650d 0a20 2020 2020  the dtype..     
+00008350: 2020 2022 2222 0d0a 2020 2020 2020 2020     """..        
+00008360: 666f 7220 692c 2076 616c 2069 6e20 656e  for i, val in en
+00008370: 756d 6572 6174 6528 7365 6c66 2e64 7479  umerate(self.dty
+00008380: 7065 293a 0d0a 2020 2020 2020 2020 2020  pe):..          
+00008390: 2020 6966 2067 6461 6c5f 746f 5f6e 756d    if gdal_to_num
+000083a0: 7079 5f64 7479 7065 2876 616c 292e 5f5f  py_dtype(val).__
+000083b0: 636f 6e74 6169 6e73 5f5f 2822 666c 6f61  contains__("floa
+000083c0: 7422 293a 0d0a 2020 2020 2020 2020 2020  t"):..          
+000083d0: 2020 2020 2020 6e6f 5f64 6174 615f 7661        no_data_va
+000083e0: 6c75 655b 695d 203d 2028 0d0a 2020 2020  lue[i] = (..    
+000083f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008400: 666c 6f61 7428 6e6f 5f64 6174 615f 7661  float(no_data_va
+00008410: 6c75 655b 695d 290d 0a20 2020 2020 2020  lue[i])..       
+00008420: 2020 2020 2020 2020 2020 2020 2069 6620               if 
+00008430: 286e 6f5f 6461 7461 5f76 616c 7565 5b69  (no_data_value[i
+00008440: 5d20 6973 206e 6f74 204e 6f6e 6520 616e  ] is not None an
+00008450: 6420 6e6f 7420 6e70 2e69 736e 616e 286e  d not np.isnan(n
+00008460: 6f5f 6461 7461 5f76 616c 7565 5b69 5d29  o_data_value[i])
+00008470: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+00008480: 2020 2020 2020 2065 6c73 6520 4e6f 6e65         else None
+00008490: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000084a0: 2020 290d 0a20 2020 2020 2020 2020 2020    )..           
+000084b0: 2065 6c69 6620 6764 616c 5f74 6f5f 6e75   elif gdal_to_nu
+000084c0: 6d70 795f 6474 7970 6528 7661 6c29 2e5f  mpy_dtype(val)._
+000084d0: 5f63 6f6e 7461 696e 735f 5f28 2269 6e74  _contains__("int
+000084e0: 2229 3a0d 0a20 2020 2020 2020 2020 2020  "):..           
+000084f0: 2020 2020 206e 6f5f 6461 7461 5f76 616c       no_data_val
+00008500: 7565 5b69 5d20 3d20 280d 0a20 2020 2020  ue[i] = (..     
+00008510: 2020 2020 2020 2020 2020 2020 2020 2069                 i
+00008520: 6e74 286e 6f5f 6461 7461 5f76 616c 7565  nt(no_data_value
+00008530: 5b69 5d29 0d0a 2020 2020 2020 2020 2020  [i])..          
+00008540: 2020 2020 2020 2020 2020 6966 2028 6e6f            if (no
+00008550: 5f64 6174 615f 7661 6c75 655b 695d 2069  _data_value[i] i
+00008560: 7320 6e6f 7420 4e6f 6e65 2061 6e64 206e  s not None and n
+00008570: 6f74 206e 702e 6973 6e61 6e28 6e6f 5f64  ot np.isnan(no_d
+00008580: 6174 615f 7661 6c75 655b 695d 2929 0d0a  ata_value[i]))..
+00008590: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000085a0: 2020 2020 656c 7365 204e 6f6e 650d 0a20      else None.. 
+000085b0: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+000085c0: 0d0a 2020 2020 2020 2020 2020 2020 656c  ..            el
+000085d0: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
+000085e0: 2020 2020 2072 6169 7365 2054 7970 6545       raise TypeE
+000085f0: 7272 6f72 2822 4e6f 4461 7461 5661 6c75  rror("NoDataValu
+00008600: 6520 6861 7320 6120 636f 6d70 6c65 7820  e has a complex 
+00008610: 6461 7461 2074 7970 6522 290d 0a0d 0a20  data type").... 
+00008620: 2020 2020 2020 2072 6574 7572 6e20 6e6f         return no
+00008630: 5f64 6174 615f 7661 6c75 650d 0a0d 0a20  _data_value.... 
+00008640: 2020 2064 6566 205f 7365 745f 6e6f 5f64     def _set_no_d
+00008650: 6174 615f 7661 6c75 6528 0d0a 2020 2020  ata_value(..    
+00008660: 2020 2020 7365 6c66 2c20 6e6f 5f64 6174      self, no_dat
+00008670: 615f 7661 6c75 653a 2055 6e69 6f6e 5b41  a_value: Union[A
+00008680: 6e79 2c20 6c69 7374 5d20 3d20 4445 4641  ny, list] = DEFA
+00008690: 554c 545f 4e4f 5f44 4154 415f 5641 4c55  ULT_NO_DATA_VALU
+000086a0: 450d 0a20 2020 2029 3a0d 0a20 2020 2020  E..    ):..     
+000086b0: 2020 2022 2222 7365 744e 6f44 6174 6156     """setNoDataV
+000086c0: 616c 7565 2e0d 0a0d 0a20 2020 2020 2020  alue.....       
+000086d0: 2020 2020 202d 2053 6574 2074 6865 206e       - Set the n
+000086e0: 6f20 6461 7461 2076 616c 7565 2069 6e20  o data value in 
+000086f0: 6120 616c 6c20 7261 7374 6572 2062 616e  a all raster ban
+00008700: 6473 2e0d 0a20 2020 2020 2020 2020 2020  ds...           
+00008710: 202d 2046 696c 6c73 2074 6865 2077 686f   - Fills the who
+00008720: 6c65 2072 6173 7465 7220 7769 7468 2074  le raster with t
+00008730: 6865 206e 6f5f 6461 7461 5f76 616c 7565  he no_data_value
+00008740: 2e0d 0a20 2020 2020 2020 2020 2020 202d  ...            -
+00008750: 2075 7365 6420 6f6e 6c79 2077 6865 6e20   used only when 
+00008760: 6372 6561 7469 6e67 2061 6e20 656d 7074  creating an empt
+00008770: 7920 6472 6976 6572 2e0d 0a0d 0a20 2020  y driver.....   
+00008780: 2020 2020 2050 6172 616d 6574 6572 730d       Parameters.
+00008790: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+000087a0: 2d2d 2d0d 0a20 2020 2020 2020 206e 6f5f  ---..        no_
+000087b0: 6461 7461 5f76 616c 7565 3a20 5b6e 756d  data_value: [num
+000087c0: 6572 6963 5d0d 0a20 2020 2020 2020 2020  eric]..         
+000087d0: 2020 206e 6f20 6461 7461 2076 616c 7565     no data value
+000087e0: 2074 6f20 6669 6c6c 2074 6865 206d 6173   to fill the mas
+000087f0: 6b65 6420 7061 7274 206f 6620 7468 6520  ked part of the 
+00008800: 6172 7261 790d 0a20 2020 2020 2020 2022  array..        "
+00008810: 2222 0d0a 2020 2020 2020 2020 6966 206e  ""..        if n
+00008820: 6f74 2069 7369 6e73 7461 6e63 6528 6e6f  ot isinstance(no
+00008830: 5f64 6174 615f 7661 6c75 652c 206c 6973  _data_value, lis
+00008840: 7429 3a0d 0a20 2020 2020 2020 2020 2020  t):..           
+00008850: 206e 6f5f 6461 7461 5f76 616c 7565 203d   no_data_value =
+00008860: 205b 6e6f 5f64 6174 615f 7661 6c75 655d   [no_data_value]
+00008870: 202a 2073 656c 662e 6261 6e64 5f63 6f75   * self.band_cou
+00008880: 6e74 0d0a 0d0a 2020 2020 2020 2020 7365  nt....        se
+00008890: 6c66 2e5f 6368 6563 6b5f 6e6f 5f64 6174  lf._check_no_dat
+000088a0: 615f 7661 6c75 6528 6e6f 5f64 6174 615f  a_value(no_data_
+000088b0: 7661 6c75 6529 0d0a 0d0a 2020 2020 2020  value)....      
+000088c0: 2020 666f 7220 6261 6e64 2069 6e20 7261    for band in ra
+000088d0: 6e67 6528 7365 6c66 2e62 616e 645f 636f  nge(self.band_co
+000088e0: 756e 7429 3a0d 0a20 2020 2020 2020 2020  unt):..         
+000088f0: 2020 2074 7279 3a0d 0a20 2020 2020 2020     try:..       
+00008900: 2020 2020 2020 2020 2073 656c 662e 5f73           self._s
+00008910: 6574 5f6e 6f5f 6461 7461 5f76 616c 7565  et_no_data_value
+00008920: 5f62 6163 6b65 6e64 2862 616e 642c 206e  _backend(band, n
+00008930: 6f5f 6461 7461 5f76 616c 7565 5b62 616e  o_data_value[ban
+00008940: 645d 290d 0a20 2020 2020 2020 2020 2020  d])..           
+00008950: 2065 7863 6570 7420 4578 6365 7074 696f   except Exceptio
+00008960: 6e20 6173 2065 3a0d 0a20 2020 2020 2020  n as e:..       
+00008970: 2020 2020 2020 2020 2069 6620 7374 7228           if str(
+00008980: 6529 2e5f 5f63 6f6e 7461 696e 735f 5f28  e).__contains__(
+00008990: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000089a0: 2020 2020 2020 2241 7474 656d 7074 2074        "Attempt t
+000089b0: 6f20 7772 6974 6520 746f 2072 6561 6420  o write to read 
+000089c0: 6f6e 6c79 2064 6174 6173 6574 2069 6e20  only dataset in 
+000089d0: 4744 414c 5261 7374 6572 4261 6e64 3a3a  GDALRasterBand::
+000089e0: 4669 6c6c 2829 2e22 0d0a 2020 2020 2020  Fill()."..      
+000089f0: 2020 2020 2020 2020 2020 293a 0d0a 2020            ):..  
+00008a00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008a10: 2020 7261 6973 6520 5265 6164 4f6e 6c79    raise ReadOnly
+00008a20: 4572 726f 7228 0d0a 2020 2020 2020 2020  Error(..        
+00008a30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008a40: 2254 6865 2044 6174 6173 6574 2069 7320  "The Dataset is 
+00008a50: 6f70 656e 2077 6974 6820 6120 7265 6164  open with a read
+00008a60: 206f 6e6c 792c 2070 6c65 6173 6520 7265   only, please re
+00008a70: 6164 2074 6865 2072 6173 7465 7220 7573  ad the raster us
+00008a80: 696e 6720 7570 6461 7465 2022 0d0a 2020  ing update "..  
+00008a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008aa0: 2020 2020 2020 2261 6363 6573 7320 6d6f        "access mo
+00008ab0: 6465 220d 0a20 2020 2020 2020 2020 2020  de"..           
+00008ac0: 2020 2020 2020 2020 2029 0d0a 2020 2020           )..    
+00008ad0: 2020 2020 2020 2020 2020 2020 656c 6966              elif
+00008ae0: 2073 7472 2865 292e 5f5f 636f 6e74 6169   str(e).__contai
+00008af0: 6e73 5f5f 280d 0a20 2020 2020 2020 2020  ns__(..         
+00008b00: 2020 2020 2020 2020 2020 2022 696e 206d             "in m
+00008b10: 6574 686f 6420 2742 616e 645f 5365 744e  ethod 'Band_SetN
+00008b20: 6f44 6174 6156 616c 7565 272c 2061 7267  oDataValue', arg
+00008b30: 756d 656e 7420 3220 6f66 2074 7970 6520  ument 2 of type 
+00008b40: 2764 6f75 626c 6527 220d 0a20 2020 2020  'double'"..     
+00008b50: 2020 2020 2020 2020 2020 2029 3a0d 0a20             ):.. 
+00008b60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008b70: 2020 2073 656c 662e 5f73 6574 5f6e 6f5f     self._set_no_
+00008b80: 6461 7461 5f76 616c 7565 5f62 6163 6b65  data_value_backe
+00008b90: 6e64 280d 0a20 2020 2020 2020 2020 2020  nd(..           
+00008ba0: 2020 2020 2020 2020 2020 2020 2062 616e               ban
+00008bb0: 642c 206e 702e 666c 6f61 7436 3428 6e6f  d, np.float64(no
+00008bc0: 5f64 6174 615f 7661 6c75 655b 6261 6e64  _data_value[band
+00008bd0: 5d29 0d0a 2020 2020 2020 2020 2020 2020  ])..            
+00008be0: 2020 2020 2020 2020 290d 0a20 2020 2020          )..     
+00008bf0: 2020 2020 2020 2020 2020 2065 6c73 653a             else:
+00008c00: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00008c10: 2020 2020 2020 7365 6c66 2e5f 7365 745f        self._set_
+00008c20: 6e6f 5f64 6174 615f 7661 6c75 655f 6261  no_data_value_ba
+00008c30: 636b 656e 6428 6261 6e64 2c20 4445 4641  ckend(band, DEFA
+00008c40: 554c 545f 4e4f 5f44 4154 415f 5641 4c55  ULT_NO_DATA_VALU
+00008c50: 4529 0d0a 2020 2020 2020 2020 2020 2020  E)..            
+00008c60: 2020 2020 2020 2020 6c6f 6767 6572 2e77          logger.w
+00008c70: 6172 6e69 6e67 280d 0a20 2020 2020 2020  arning(..       
+00008c80: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008c90: 2022 7468 6520 7479 7065 206f 6620 7468   "the type of th
+00008ca0: 6520 6769 7665 6e20 6e6f 5f64 6174 615f  e given no_data_
+00008cb0: 7661 6c75 6520 6469 6666 6572 7320 6672  value differs fr
+00008cc0: 6f6d 2074 6865 2064 7479 7065 206f 6620  om the dtype of 
+00008cd0: 7468 6520 7261 7374 6572 220d 0a20 2020  the raster"..   
+00008ce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00008cf0: 2020 2020 2066 226e 6f5f 6461 7461 5f76       f"no_data_v
+00008d00: 616c 7565 206e 6f77 2069 7320 7365 7420  alue now is set 
+00008d10: 746f 207b 4445 4641 554c 545f 4e4f 5f44  to {DEFAULT_NO_D
+00008d20: 4154 415f 5641 4c55 457d 2069 6e20 7468  ATA_VALUE} in th
+00008d30: 6520 7261 7374 6572 220d 0a20 2020 2020  e raster"..     
+00008d40: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+00008d50: 0d0a 0d0a 2020 2020 6465 6620 5f63 616c  ....    def _cal
+00008d60: 6375 6c61 7465 5f62 626f 7828 7365 6c66  culate_bbox(self
+00008d70: 2920 2d3e 204c 6973 743a 0d0a 2020 2020  ) -> List:..    
+00008d80: 2020 2020 2222 2263 616c 6375 6c61 7465      """calculate
+00008d90: 2062 6f75 6e64 696e 6720 626f 7822 2222   bounding box"""
+00008da0: 0d0a 2020 2020 2020 2020 786d 696e 2c20  ..        xmin, 
+00008db0: 796d 6178 203d 2073 656c 662e 7069 766f  ymax = self.pivo
+00008dc0: 745f 706f 696e 740d 0a20 2020 2020 2020  t_point..       
+00008dd0: 2079 6d69 6e20 3d20 796d 6178 202d 2073   ymin = ymax - s
+00008de0: 656c 662e 726f 7773 202a 2073 656c 662e  elf.rows * self.
+00008df0: 6365 6c6c 5f73 697a 650d 0a20 2020 2020  cell_size..     
+00008e00: 2020 2078 6d61 7820 3d20 786d 696e 202b     xmax = xmin +
+00008e10: 2073 656c 662e 636f 6c75 6d6e 7320 2a20   self.columns * 
+00008e20: 7365 6c66 2e63 656c 6c5f 7369 7a65 0d0a  self.cell_size..
+00008e30: 2020 2020 2020 2020 7265 7475 726e 205b          return [
+00008e40: 786d 696e 2c20 796d 696e 2c20 786d 6178  xmin, ymin, xmax
+00008e50: 2c20 796d 6178 5d0d 0a0d 0a20 2020 2064  , ymax]....    d
+00008e60: 6566 205f 6361 6c63 756c 6174 655f 626f  ef _calculate_bo
+00008e70: 756e 6473 2873 656c 6629 202d 3e20 4765  unds(self) -> Ge
+00008e80: 6f44 6174 6146 7261 6d65 3a0d 0a20 2020  oDataFrame:..   
+00008e90: 2020 2020 2022 2222 6765 7420 7468 6520       """get the 
+00008ea0: 6262 6f78 2061 7320 6120 6765 6f64 6174  bbox as a geodat
+00008eb0: 6166 7261 6d65 2077 6974 6820 6120 706f  aframe with a po
+00008ec0: 6c79 676f 6e20 6765 6f6d 6574 7279 2222  lygon geometry""
+00008ed0: 220d 0a20 2020 2020 2020 2078 6d69 6e2c  "..        xmin,
+00008ee0: 2079 6d69 6e2c 2078 6d61 782c 2079 6d61   ymin, xmax, yma
+00008ef0: 7820 3d20 7365 6c66 2e5f 6361 6c63 756c  x = self._calcul
+00008f00: 6174 655f 6262 6f78 2829 0d0a 2020 2020  ate_bbox()..    
+00008f10: 2020 2020 636f 6f72 6473 203d 205b 2878      coords = [(x
+00008f20: 6d69 6e2c 2079 6d61 7829 2c20 2878 6d69  min, ymax), (xmi
+00008f30: 6e2c 2079 6d69 6e29 2c20 2878 6d61 782c  n, ymin), (xmax,
+00008f40: 2079 6d69 6e29 2c20 2878 6d61 782c 2079   ymin), (xmax, y
+00008f50: 6d61 7829 5d0d 0a20 2020 2020 2020 2070  max)]..        p
+00008f60: 6f6c 7920 3d20 4665 6174 7572 6543 6f6c  oly = FeatureCol
+00008f70: 6c65 6374 696f 6e2e 6372 6561 7465 5f70  lection.create_p
+00008f80: 6f6c 7967 6f6e 2863 6f6f 7264 7329 0d0a  olygon(coords)..
+00008f90: 2020 2020 2020 2020 6764 6620 3d20 6770          gdf = gp
+00008fa0: 642e 4765 6f44 6174 6146 7261 6d65 2867  d.GeoDataFrame(g
+00008fb0: 656f 6d65 7472 793d 5b70 6f6c 795d 290d  eometry=[poly]).
+00008fc0: 0a20 2020 2020 2020 2067 6466 2e73 6574  .        gdf.set
+00008fd0: 5f63 7273 2865 7073 673d 7365 6c66 2e65  _crs(epsg=self.e
+00008fe0: 7073 672c 2069 6e70 6c61 6365 3d54 7275  psg, inplace=Tru
+00008ff0: 6529 0d0a 2020 2020 2020 2020 7265 7475  e)..        retu
+00009000: 726e 2067 6466 0d0a 0d0a 2020 2020 6465  rn gdf....    de
+00009010: 6620 5f73 6574 5f6e 6f5f 6461 7461 5f76  f _set_no_data_v
+00009020: 616c 7565 5f62 6163 6b65 6e64 2873 656c  alue_backend(sel
+00009030: 662c 2062 616e 645f 693a 2069 6e74 2c20  f, band_i: int, 
+00009040: 6e6f 5f64 6174 615f 7661 6c75 653a 2041  no_data_value: A
+00009050: 6e79 293a 0d0a 2020 2020 2020 2020 2222  ny):..        ""
+00009060: 220d 0a20 2020 2020 2020 2020 2020 202d  "..            -
+00009070: 2062 616e 645f 6920 7374 6172 7473 2066   band_i starts f
+00009080: 726f 6d20 3020 746f 2074 6865 206e 756d  rom 0 to the num
+00009090: 6265 7220 6f66 2062 616e 6473 2d31 2e0d  ber of bands-1..
+000090a0: 0a0d 0a20 2020 2020 2020 2050 6172 616d  ...        Param
+000090b0: 6574 6572 730d 0a20 2020 2020 2020 202d  eters..        -
+000090c0: 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020  ---------..     
+000090d0: 2020 2062 616e 645f 693a 0d0a 2020 2020     band_i:..    
+000090e0: 2020 2020 2020 2020 6261 6e64 2069 6e64          band ind
+000090f0: 6578 2c20 7374 6172 7473 2066 726f 6d20  ex, starts from 
+00009100: 302e 0d0a 2020 2020 2020 2020 6e6f 5f64  0...        no_d
+00009110: 6174 615f 7661 6c75 653a 0d0a 2020 2020  ata_value:..    
+00009120: 2020 2020 2020 2020 4e75 6d65 7269 6361          Numerica
+00009130: 6c20 7661 6c75 652e 0d0a 2020 2020 2020  l value...      
+00009140: 2020 2222 220d 0a20 2020 2020 2020 2023    """..        #
+00009150: 2063 6865 636b 2069 6620 7468 6520 6474   check if the dt
+00009160: 7970 6520 6f66 2074 6865 206e 6f5f 6461  ype of the no_da
+00009170: 7461 5f76 616c 7565 2063 6f6d 706c 7920  ta_value comply 
+00009180: 7769 7468 2074 6865 2064 7479 7065 206f  with the dtype o
+00009190: 6620 7468 6520 7261 7374 6572 2069 7473  f the raster its
+000091a0: 656c 662e 0d0a 2020 2020 2020 2020 6e6f  elf...        no
+000091b0: 5f64 7479 7065 203d 2073 7472 2874 7970  _dtype = str(typ
+000091c0: 6528 6e6f 5f64 6174 615f 7661 6c75 6529  e(no_data_value)
+000091d0: 292e 7370 6c69 7428 2227 2229 5b31 5d0d  ).split("'")[1].
+000091e0: 0a20 2020 2020 2020 2070 6f74 656e 7469  .        potenti
+000091f0: 616c 5f64 7479 7065 7320 3d20 5b0d 0a20  al_dtypes = [.. 
+00009200: 2020 2020 2020 2020 2020 2069 2066 6f72             i for
+00009210: 2069 2069 6e20 6c69 7374 284e 554d 5059   i in list(NUMPY
+00009220: 5f47 4441 4c5f 4441 5441 5f54 5950 4553  _GDAL_DATA_TYPES
+00009230: 2e6b 6579 7328 2929 2069 6620 692e 5f5f  .keys()) if i.__
+00009240: 636f 6e74 6169 6e73 5f5f 286e 6f5f 6474  contains__(no_dt
+00009250: 7970 6529 0d0a 2020 2020 2020 2020 5d0d  ype)..        ].
+00009260: 0a20 2020 2020 2020 2070 6f74 656e 7469  .        potenti
+00009270: 616c 5f64 7479 7065 7320 3d20 5b4e 554d  al_dtypes = [NUM
+00009280: 5059 5f47 4441 4c5f 4441 5441 5f54 5950  PY_GDAL_DATA_TYP
+00009290: 4553 2e67 6574 2869 2920 666f 7220 6920  ES.get(i) for i 
+000092a0: 696e 2070 6f74 656e 7469 616c 5f64 7479  in potential_dty
+000092b0: 7065 735d 0d0a 0d0a 2020 2020 2020 2020  pes]....        
+000092c0: 6966 206e 6f5f 6461 7461 5f76 616c 7565  if no_data_value
+000092d0: 2069 7320 6e6f 7420 4e6f 6e65 3a0d 0a20   is not None:.. 
+000092e0: 2020 2020 2020 2020 2020 2069 6620 6e6f             if no
+000092f0: 7420 7365 6c66 2e64 7479 7065 5b62 616e  t self.dtype[ban
+00009300: 645f 695d 2069 6e20 706f 7465 6e74 6961  d_i] in potentia
+00009310: 6c5f 6474 7970 6573 3a0d 0a20 2020 2020  l_dtypes:..     
+00009320: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+00009330: 204e 6f44 6174 6156 616c 7565 4572 726f   NoDataValueErro
+00009340: 7228 0d0a 2020 2020 2020 2020 2020 2020  r(..            
+00009350: 2020 2020 2020 2020 6622 5468 6520 6474          f"The dt
+00009360: 7970 6520 6f66 2074 6865 2067 6976 656e  ype of the given
+00009370: 206e 6f5f 6461 7461 5f76 616c 7565 7b6e   no_data_value{n
+00009380: 6f5f 6461 7461 5f76 616c 7565 7d3a 207b  o_data_value}: {
+00009390: 6e6f 5f64 7479 7065 7d20 6469 6666 6572  no_dtype} differ
+000093a0: 7320 6672 6f6d 2074 6865 2064 7479 7065  s from the dtype
+000093b0: 206f 6620 7468 6520 220d 0a20 2020 2020   of the "..     
+000093c0: 2020 2020 2020 2020 2020 2020 2020 2066                 f
+000093d0: 2262 616e 643a 207b 6764 616c 5f74 6f5f  "band: {gdal_to_
+000093e0: 6e75 6d70 795f 6474 7970 6528 7365 6c66  numpy_dtype(self
+000093f0: 2e64 7479 7065 5b62 616e 645f 695d 297d  .dtype[band_i])}
+00009400: 220d 0a20 2020 2020 2020 2020 2020 2020  "..             
+00009410: 2020 2029 0d0a 0d0a 2020 2020 2020 2020     )....        
+00009420: 7365 6c66 2e5f 6368 616e 6765 5f6e 6f5f  self._change_no_
+00009430: 6461 7461 5f76 616c 7565 5f61 7474 7228  data_value_attr(
+00009440: 6261 6e64 5f69 2c20 6e6f 5f64 6174 615f  band_i, no_data_
+00009450: 7661 6c75 6529 0d0a 2020 2020 2020 2020  value)..        
+00009460: 2320 696e 6974 6961 6c69 7a65 2074 6865  # initialize the
+00009470: 2062 616e 6420 7769 7468 2074 6865 206e   band with the n
+00009480: 6f64 6174 6120 7661 6c75 6520 696e 7374  odata value inst
+00009490: 6561 6420 6f66 2030 0d0a 2020 2020 2020  ead of 0..      
+000094a0: 2020 7472 793a 0d0a 2020 2020 2020 2020    try:..        
+000094b0: 2020 2020 7365 6c66 2e72 6173 7465 722e      self.raster.
+000094c0: 4765 7452 6173 7465 7242 616e 6428 6261  GetRasterBand(ba
+000094d0: 6e64 5f69 202b 2031 292e 4669 6c6c 286e  nd_i + 1).Fill(n
+000094e0: 6f5f 6461 7461 5f76 616c 7565 290d 0a20  o_data_value).. 
+000094f0: 2020 2020 2020 2065 7863 6570 7420 4578         except Ex
+00009500: 6365 7074 696f 6e20 6173 2065 3a0d 0a20  ception as e:.. 
+00009510: 2020 2020 2020 2020 2020 2069 6620 7374             if st
+00009520: 7228 6529 2e5f 5f63 6f6e 7461 696e 735f  r(e).__contains_
+00009530: 5f28 2220 6172 6775 6d65 6e74 2032 206f  _(" argument 2 o
+00009540: 6620 7479 7065 2027 646f 7562 6c65 2722  f type 'double'"
+00009550: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
+00009560: 2020 2020 7365 6c66 2e72 6173 7465 722e      self.raster.
+00009570: 4765 7452 6173 7465 7242 616e 6428 6261  GetRasterBand(ba
+00009580: 6e64 5f69 202b 2031 292e 4669 6c6c 286e  nd_i + 1).Fill(n
+00009590: 702e 666c 6f61 7436 3428 6e6f 5f64 6174  p.float64(no_dat
+000095a0: 615f 7661 6c75 6529 290d 0a20 2020 2020  a_value))..     
+000095b0: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
+000095c0: 2020 2020 2020 2020 2020 2020 2020 7261                ra
+000095d0: 6973 6520 5661 6c75 6545 7272 6f72 280d  ise ValueError(.
+000095e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000095f0: 2020 2020 2066 2246 6169 6c65 6420 746f       f"Failed to
+00009600: 2066 696c 6c20 7468 6520 6261 6e64 207b   fill the band {
+00009610: 6261 6e64 5f69 7d20 7769 7468 2076 616c  band_i} with val
+00009620: 7565 3a20 7b6e 6f5f 6461 7461 5f76 616c  ue: {no_data_val
+00009630: 7565 7d2c 2062 6563 6175 7365 206f 6620  ue}, because of 
+00009640: 7b65 7d22 0d0a 2020 2020 2020 2020 2020  {e}"..          
+00009650: 2020 2020 2020 290d 0a20 2020 2020 2020        )..       
+00009660: 2023 2075 7064 6174 6520 7468 6520 6e6f   # update the no
+00009670: 5f64 6174 615f 7661 6c75 6520 696e 2074  _data_value in t
+00009680: 6865 2044 6174 6173 6574 206f 626a 6563  he Dataset objec
+00009690: 740d 0a20 2020 2020 2020 2073 656c 662e  t..        self.
+000096a0: 6e6f 5f64 6174 615f 7661 6c75 655b 6261  no_data_value[ba
+000096b0: 6e64 5f69 5d20 3d20 6e6f 5f64 6174 615f  nd_i] = no_data_
+000096c0: 7661 6c75 650d 0a0d 0a20 2020 2064 6566  value....    def
+000096d0: 205f 6368 616e 6765 5f6e 6f5f 6461 7461   _change_no_data
+000096e0: 5f76 616c 7565 5f61 7474 7228 7365 6c66  _value_attr(self
+000096f0: 2c20 6261 6e64 3a20 696e 742c 206e 6f5f  , band: int, no_
+00009700: 6461 7461 5f76 616c 7565 293a 0d0a 2020  data_value):..  
+00009710: 2020 2020 2020 2222 2243 6861 6e67 6520        """Change 
+00009720: 7468 6520 6e6f 5f64 6174 615f 7661 6c75  the no_data_valu
+00009730: 6520 6174 7472 6962 7574 652e 0d0a 0d0a  e attribute.....
+00009740: 2020 2020 2020 2020 2020 2020 2d20 4368              - Ch
+00009750: 616e 6765 206f 6e6c 7920 7468 6520 6e6f  ange only the no
+00009760: 5f64 6174 615f 7661 6c75 6520 6174 7472  _data_value attr
+00009770: 6962 7574 6520 696e 2074 6865 2067 6461  ibute in the gda
+00009780: 6c20 4461 7461 6375 6265 206f 626a 6563  l Datacube objec
+00009790: 742e 0d0a 2020 2020 2020 2020 2020 2020  t...            
+000097a0: 2d20 4368 616e 6765 2074 6865 206e 6f5f  - Change the no_
+000097b0: 6461 7461 5f76 616c 7565 2069 6e20 7468  data_value in th
+000097c0: 6520 4461 7461 7365 7420 6f62 6a65 6374  e Dataset object
+000097d0: 2066 6f72 2074 6865 2067 6976 656e 2062   for the given b
+000097e0: 616e 6420 696e 6465 782e 0d0a 2020 2020  and index...    
+000097f0: 2020 2020 2020 2020 2d20 5468 6520 636f          - The co
+00009800: 7272 6573 706f 6e64 696e 6720 7661 6c75  rresponding valu
+00009810: 6520 696e 2074 6865 2061 7272 6179 2077  e in the array w
+00009820: 696c 6c20 6e6f 7420 6265 2063 6861 6e67  ill not be chang
+00009830: 6564 2e0d 0a20 2020 2020 2020 2020 2020  ed...           
+00009840: 202d 2042 616e 6420 696e 6465 7820 7374   - Band index st
+00009850: 6172 7473 2066 726f 6d20 300d 0a0d 0a20  arts from 0.... 
+00009860: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
+00009870: 730d 0a20 2020 2020 2020 202d 2d2d 2d2d  s..        -----
+00009880: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 2062  -----..        b
+00009890: 616e 643a 205b 696e 745d 0d0a 2020 2020  and: [int]..    
+000098a0: 2020 2020 2020 2020 6261 6e64 2069 6e64          band ind
+000098b0: 6578 2073 7461 7274 7320 6672 6f6d 2030  ex starts from 0
+000098c0: 2e0d 0a20 2020 2020 2020 206e 6f5f 6461  ...        no_da
+000098d0: 7461 5f76 616c 7565 3a20 5b41 6e79 5d0d  ta_value: [Any].
+000098e0: 0a20 2020 2020 2020 2020 2020 206e 6f20  .            no 
+000098f0: 6461 7461 2076 616c 7565 2e0d 0a20 2020  data value...   
+00009900: 2020 2020 2022 2222 0d0a 2020 2020 2020       """..      
+00009910: 2020 7472 793a 0d0a 2020 2020 2020 2020    try:..        
+00009920: 2020 2020 7365 6c66 2e72 6173 7465 722e      self.raster.
+00009930: 4765 7452 6173 7465 7242 616e 6428 6261  GetRasterBand(ba
+00009940: 6e64 202b 2031 292e 5365 744e 6f44 6174  nd + 1).SetNoDat
+00009950: 6156 616c 7565 286e 6f5f 6461 7461 5f76  aValue(no_data_v
+00009960: 616c 7565 290d 0a20 2020 2020 2020 2065  alue)..        e
+00009970: 7863 6570 7420 4578 6365 7074 696f 6e20  xcept Exception 
+00009980: 6173 2065 3a0d 0a20 2020 2020 2020 2020  as e:..         
+00009990: 2020 2069 6620 7374 7228 6529 2e5f 5f63     if str(e).__c
+000099a0: 6f6e 7461 696e 735f 5f28 0d0a 2020 2020  ontains__(..    
+000099b0: 2020 2020 2020 2020 2020 2020 2241 7474              "Att
+000099c0: 656d 7074 2074 6f20 7772 6974 6520 746f  empt to write to
+000099d0: 2072 6561 6420 6f6e 6c79 2064 6174 6173   read only datas
+000099e0: 6574 2069 6e20 4744 414c 5261 7374 6572  et in GDALRaster
+000099f0: 4261 6e64 3a3a 4669 6c6c 2829 2e22 0d0a  Band::Fill()."..
+00009a00: 2020 2020 2020 2020 2020 2020 293a 0d0a              ):..
+00009a10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00009a20: 7261 6973 6520 5265 6164 4f6e 6c79 4572  raise ReadOnlyEr
+00009a30: 726f 7228 0d0a 2020 2020 2020 2020 2020  ror(..          
+00009a40: 2020 2020 2020 2020 2020 2254 6865 2044            "The D
+00009a50: 6174 6173 6574 2069 7320 6f70 656e 2077  ataset is open w
+00009a60: 6974 6820 6120 7265 6164 206f 6e6c 792c  ith a read only,
+00009a70: 2070 6c65 6173 6520 7265 6164 2074 6865   please read the
+00009a80: 2072 6173 7465 7220 7573 696e 6720 7570   raster using up
+00009a90: 6461 7465 2022 0d0a 2020 2020 2020 2020  date "..        
+00009aa0: 2020 2020 2020 2020 2020 2020 2261 6363              "acc
+00009ab0: 6573 7320 6d6f 6465 220d 0a20 2020 2020  ess mode"..     
+00009ac0: 2020 2020 2020 2020 2020 2029 0d0a 2020             )..  
+00009ad0: 2020 2020 2020 2020 2020 656c 6966 2073            elif s
+00009ae0: 7472 2865 292e 5f5f 636f 6e74 6169 6e73  tr(e).__contains
+00009af0: 5f5f 280d 0a20 2020 2020 2020 2020 2020  __(..           
+00009b00: 2020 2020 2022 696e 206d 6574 686f 6420       "in method 
+00009b10: 2742 616e 645f 5365 744e 6f44 6174 6156  'Band_SetNoDataV
+00009b20: 616c 7565 272c 2061 7267 756d 656e 7420  alue', argument 
+00009b30: 3220 6f66 2074 7970 6520 2764 6f75 626c  2 of type 'doubl
+00009b40: 6527 220d 0a20 2020 2020 2020 2020 2020  e'"..           
+00009b50: 2029 3a0d 0a20 2020 2020 2020 2020 2020   ):..           
+00009b60: 2020 2020 2073 656c 662e 7261 7374 6572       self.raster
+00009b70: 2e47 6574 5261 7374 6572 4261 6e64 2862  .GetRasterBand(b
+00009b80: 616e 6420 2b20 3129 2e53 6574 4e6f 4461  and + 1).SetNoDa
+00009b90: 7461 5661 6c75 6528 0d0a 2020 2020 2020  taValue(..      
+00009ba0: 2020 2020 2020 2020 2020 2020 2020 6e70                np
+00009bb0: 2e66 6c6f 6174 3634 286e 6f5f 6461 7461  .float64(no_data
+00009bc0: 5f76 616c 7565 290d 0a20 2020 2020 2020  _value)..       
+00009bd0: 2020 2020 2020 2020 2029 0d0a 2020 2020           )..    
+00009be0: 2020 2020 7365 6c66 2e5f 6e6f 5f64 6174      self._no_dat
+00009bf0: 615f 7661 6c75 655b 6261 6e64 5d20 3d20  a_value[band] = 
+00009c00: 6e6f 5f64 6174 615f 7661 6c75 650d 0a0d  no_data_value...
+00009c10: 0a20 2020 2064 6566 2063 6861 6e67 655f  .    def change_
+00009c20: 6e6f 5f64 6174 615f 7661 6c75 6528 7365  no_data_value(se
+00009c30: 6c66 2c20 6e65 775f 7661 6c75 653a 2041  lf, new_value: A
+00009c40: 6e79 2c20 6f6c 645f 7661 6c75 653a 2041  ny, old_value: A
+00009c50: 6e79 203d 204e 6f6e 6529 3a0d 0a20 2020  ny = None):..   
+00009c60: 2020 2020 2022 2222 4368 616e 6765 204e       """Change N
+00009c70: 6f20 4461 7461 2056 616c 7565 2e0d 0a0d  o Data Value....
+00009c80: 0a20 2020 2020 2020 2020 2020 202d 2053  .            - S
+00009c90: 6574 2074 6865 206e 6f20 6461 7461 2076  et the no data v
+00009ca0: 616c 7565 2069 6e20 6120 616c 6c20 7261  alue in a all ra
+00009cb0: 7374 6572 2062 616e 6473 2e0d 0a20 2020  ster bands...   
+00009cc0: 2020 2020 2020 2020 202d 2046 696c 6c73           - Fills
+00009cd0: 2074 6865 2077 686f 6c65 2072 6173 7465   the whole raste
+00009ce0: 7220 7769 7468 2074 6865 206e 6f5f 6461  r with the no_da
+00009cf0: 7461 5f76 616c 7565 2e0d 0a20 2020 2020  ta_value...     
+00009d00: 2020 2020 2020 202d 2043 6861 6e67 6520         - Change 
+00009d10: 7468 6520 6e6f 5f64 6174 615f 7661 6c75  the no_data_valu
+00009d20: 6520 696e 2074 6865 2061 7272 6179 2069  e in the array i
+00009d30: 6e20 616c 6c20 6261 6e64 732e 0d0a 0d0a  n all bands.....
+00009d40: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
+00009d50: 7273 0d0a 2020 2020 2020 2020 2d2d 2d2d  rs..        ----
+00009d60: 2d2d 2d2d 2d2d 0d0a 2020 2020 2020 2020  ------..        
+00009d70: 6e65 775f 7661 6c75 653a 205b 6e75 6d65  new_value: [nume
+00009d80: 7269 635d 0d0a 2020 2020 2020 2020 2020  ric]..          
+00009d90: 2020 6e6f 2064 6174 6120 7661 6c75 6520    no data value 
+00009da0: 746f 2073 6574 2069 6e20 7468 6520 7261  to set in the ra
+00009db0: 7374 6572 2062 616e 6473 2e0d 0a0d 0a20  ster bands..... 
+00009dc0: 2020 2020 2020 206f 6c64 5f76 616c 7565         old_value
+00009dd0: 3a20 5b6e 756d 6572 6963 5d0d 0a20 2020  : [numeric]..   
+00009de0: 2020 2020 2020 2020 206f 6c64 206e 6f20           old no 
+00009df0: 6461 7461 2076 616c 7565 2074 6861 7420  data value that 
+00009e00: 6172 6520 616c 7265 6164 7920 696e 2074  are already in t
+00009e10: 6865 2072 6173 7465 7220 6261 6e64 732e  he raster bands.
+00009e20: 0d0a 2020 2020 2020 2020 2222 220d 0a20  ..        """.. 
+00009e30: 2020 2020 2020 2069 6620 6e6f 7420 6973         if not is
+00009e40: 696e 7374 616e 6365 286e 6577 5f76 616c  instance(new_val
+00009e50: 7565 2c20 6c69 7374 293a 0d0a 2020 2020  ue, list):..    
+00009e60: 2020 2020 2020 2020 6e65 775f 7661 6c75          new_valu
+00009e70: 6520 3d20 5b6e 6577 5f76 616c 7565 5d20  e = [new_value] 
+00009e80: 2a20 7365 6c66 2e62 616e 645f 636f 756e  * self.band_coun
+00009e90: 740d 0a0d 0a20 2020 2020 2020 2069 6620  t....        if 
+00009ea0: 6f6c 645f 7661 6c75 6520 6973 206e 6f74  old_value is not
+00009eb0: 204e 6f6e 6520 616e 6420 6e6f 7420 6973   None and not is
+00009ec0: 696e 7374 616e 6365 286f 6c64 5f76 616c  instance(old_val
+00009ed0: 7565 2c20 6c69 7374 293a 0d0a 2020 2020  ue, list):..    
+00009ee0: 2020 2020 2020 2020 6f6c 645f 7661 6c75          old_valu
+00009ef0: 6520 3d20 5b6f 6c64 5f76 616c 7565 5d20  e = [old_value] 
+00009f00: 2a20 7365 6c66 2e62 616e 645f 636f 756e  * self.band_coun
+00009f10: 740d 0a0d 0a20 2020 2020 2020 2064 7374  t....        dst
+00009f20: 203d 2067 6461 6c2e 4765 7444 7269 7665   = gdal.GetDrive
+00009f30: 7242 794e 616d 6528 224d 454d 2229 2e43  rByName("MEM").C
+00009f40: 7265 6174 6543 6f70 7928 2222 2c20 7365  reateCopy("", se
+00009f50: 6c66 2e72 6173 7465 722c 2030 290d 0a20  lf.raster, 0).. 
+00009f60: 2020 2020 2020 2023 2063 7265 6174 6520         # create 
+00009f70: 6120 6e65 7720 6461 7461 7365 740d 0a20  a new dataset.. 
+00009f80: 2020 2020 2020 206e 6577 5f64 6174 6173         new_datas
+00009f90: 6574 203d 2044 6174 6173 6574 2864 7374  et = Dataset(dst
+00009fa0: 290d 0a20 2020 2020 2020 206e 6577 5f64  )..        new_d
+00009fb0: 6174 6173 6574 2e5f 7365 745f 6e6f 5f64  ataset._set_no_d
+00009fc0: 6174 615f 7661 6c75 6528 6e65 775f 7661  ata_value(new_va
+00009fd0: 6c75 6529 0d0a 0d0a 2020 2020 2020 2020  lue)....        
+00009fe0: 666f 7220 6261 6e64 2069 6e20 7261 6e67  for band in rang
+00009ff0: 6528 7365 6c66 2e62 616e 645f 636f 756e  e(self.band_coun
+0000a000: 7429 3a0d 0a20 2020 2020 2020 2020 2020  t):..           
+0000a010: 2061 7272 203d 2073 656c 662e 7265 6164   arr = self.read
+0000a020: 5f61 7272 6179 2862 616e 6429 0d0a 2020  _array(band)..  
+0000a030: 2020 2020 2020 2020 2020 7472 793a 0d0a            try:..
+0000a040: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a050: 6172 725b 6e70 2e69 7363 6c6f 7365 2861  arr[np.isclose(a
+0000a060: 7272 2c20 6f6c 645f 7661 6c75 652c 2072  rr, old_value, r
+0000a070: 746f 6c3d 302e 3030 3129 5d20 3d20 6e65  tol=0.001)] = ne
+0000a080: 775f 7661 6c75 655b 6261 6e64 5d0d 0a20  w_value[band].. 
+0000a090: 2020 2020 2020 2020 2020 2065 7863 6570             excep
+0000a0a0: 7420 5479 7065 4572 726f 723a 0d0a 2020  t TypeError:..  
+0000a0b0: 2020 2020 2020 2020 2020 2020 2020 7261                ra
+0000a0c0: 6973 6520 4e6f 4461 7461 5661 6c75 6545  ise NoDataValueE
+0000a0d0: 7272 6f72 280d 0a20 2020 2020 2020 2020  rror(..         
+0000a0e0: 2020 2020 2020 2020 2020 2066 2254 6865             f"The
+0000a0f0: 2064 7479 7065 206f 6620 7468 6520 6769   dtype of the gi
+0000a100: 7665 6e20 6e6f 5f64 6174 615f 7661 6c75  ven no_data_valu
+0000a110: 653a 207b 6e65 775f 7661 6c75 655b 6261  e: {new_value[ba
+0000a120: 6e64 5d7d 2064 6966 6665 7273 2066 726f  nd]} differs fro
+0000a130: 6d20 7468 6520 6474 7970 6520 6f66 2074  m the dtype of t
+0000a140: 6865 2022 0d0a 2020 2020 2020 2020 2020  he "..          
+0000a150: 2020 2020 2020 2020 2020 6622 6261 6e64            f"band
+0000a160: 3a20 7b67 6461 6c5f 746f 5f6e 756d 7079  : {gdal_to_numpy
+0000a170: 5f64 7479 7065 2873 656c 662e 6474 7970  _dtype(self.dtyp
+0000a180: 655b 6261 6e64 5d29 7d22 0d0a 2020 2020  e[band])}"..    
+0000a190: 2020 2020 2020 2020 2020 2020 290d 0a20              ).. 
+0000a1a0: 2020 2020 2020 2020 2020 206e 6577 5f64             new_d
+0000a1b0: 6174 6173 6574 2e72 6173 7465 722e 4765  ataset.raster.Ge
+0000a1c0: 7452 6173 7465 7242 616e 6428 6261 6e64  tRasterBand(band
+0000a1d0: 202b 2031 292e 5772 6974 6541 7272 6179   + 1).WriteArray
+0000a1e0: 2861 7272 290d 0a0d 0a20 2020 2020 2020  (arr)....       
+0000a1f0: 2073 656c 662e 5f5f 696e 6974 5f5f 286e   self.__init__(n
+0000a200: 6577 5f64 6174 6173 6574 2e72 6173 7465  ew_dataset.raste
+0000a210: 7229 0d0a 0d0a 2020 2020 6465 6620 6765  r)....    def ge
+0000a220: 745f 6365 6c6c 5f63 6f6f 7264 7328 0d0a  t_cell_coords(..
+0000a230: 2020 2020 2020 2020 7365 6c66 2c20 6c6f          self, lo
+0000a240: 6361 7469 6f6e 3a20 7374 7220 3d20 2263  cation: str = "c
+0000a250: 656e 7465 7222 2c20 6d61 736b 3a20 626f  enter", mask: bo
+0000a260: 6f6c 203d 2046 616c 7365 0d0a 2020 2020  ol = False..    
+0000a270: 2920 2d3e 206e 702e 6e64 6172 7261 793a  ) -> np.ndarray:
+0000a280: 0d0a 2020 2020 2020 2020 2222 2247 6574  ..        """Get
+0000a290: 436f 6f72 6473 2e0d 0a0d 0a20 2020 2020  Coords.....     
+0000a2a0: 2020 2052 6574 7572 6e73 2074 6865 2063     Returns the c
+0000a2b0: 6f6f 7264 696e 6174 6573 206f 6620 7468  oordinates of th
+0000a2c0: 6520 6365 6c6c 2063 656e 7472 6573 2069  e cell centres i
+0000a2d0: 6e73 6964 6520 7468 6520 646f 6d61 696e  nside the domain
+0000a2e0: 2028 6f6e 6c79 2074 6865 2063 656c 6c73   (only the cells
+0000a2f0: 2074 6861 740d 0a20 2020 2020 2020 2064   that..        d
+0000a300: 6f65 7320 6e6f 7420 6861 7665 206e 6f64  oes not have nod
+0000a310: 6174 6120 7661 6c75 6529 0d0a 0d0a 2020  ata value)....  
+0000a320: 2020 2020 2020 5061 7261 6d65 7465 7273        Parameters
+0000a330: 0d0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ..        ------
+0000a340: 2d2d 2d2d 0d0a 2020 2020 2020 2020 6c6f  ----..        lo
+0000a350: 6361 7469 6f6e 3a20 5b73 7472 5d0d 0a20  cation: [str].. 
+0000a360: 2020 2020 2020 2020 2020 206c 6f63 6174             locat
+0000a370: 696f 6e20 6f66 2074 6865 2063 6f6f 7264  ion of the coord
+0000a380: 696e 6174 6573 2022 6365 6e74 6572 2220  inates "center" 
+0000a390: 666f 7220 7468 6520 6365 6e74 6572 206f  for the center o
+0000a3a0: 6620 6120 6365 6c6c 2c20 636f 726e 6572  f a cell, corner
+0000a3b0: 2066 6f72 2074 6865 2063 6f72 6e65 7220   for the corner 
+0000a3c0: 6f66 2074 6865 2063 656c 6c2e 0d0a 2020  of the cell...  
+0000a3d0: 2020 2020 2020 2020 2020 7468 6520 636f            the co
+0000a3e0: 726e 6572 2069 7320 7468 6520 746f 7020  rner is the top 
+0000a3f0: 6c65 6674 2063 6f72 6e65 722e 0d0a 2020  left corner...  
+0000a400: 2020 2020 2020 6d61 736b 3a20 5b62 6f6f        mask: [boo
+0000a410: 6c5d 0d0a 2020 2020 2020 2020 2020 2020  l]..            
+0000a420: 5472 7565 2074 6f20 4578 6563 6c75 6465  True to Execlude
+0000a430: 2074 6865 2063 656c 6c73 206f 7574 206f   the cells out o
+0000a440: 6620 7468 6520 646f 6169 6e2e 2044 6566  f the doain. Def
+0000a450: 6175 6c74 2069 7320 4661 6c73 652e 0d0a  ault is False...
+0000a460: 0d0a 2020 2020 2020 2020 5265 7475 726e  ..        Return
+0000a470: 730d 0a20 2020 2020 2020 202d 2d2d 2d2d  s..        -----
+0000a480: 2d2d 0d0a 2020 2020 2020 2020 636f 6f72  --..        coor
+0000a490: 6473 203a 205b 6e70 2e6e 6461 7272 6179  ds : [np.ndarray
+0000a4a0: 5d0d 0a20 2020 2020 2020 2020 2020 2041  ]..            A
+0000a4b0: 7272 6179 2077 6974 6820 6120 6c69 7374  rray with a list
+0000a4c0: 206f 6620 7468 6520 636f 6f72 6469 6e61   of the coordina
+0000a4d0: 7465 7320 746f 2062 6520 696e 7465 7270  tes to be interp
+0000a4e0: 6f6c 6174 6564 2c20 7769 7468 6f75 7420  olated, without 
+0000a4f0: 7468 6520 4e61 6e0d 0a20 2020 2020 2020  the Nan..       
+0000a500: 206d 6174 5f72 616e 6765 203a 205b 6e70   mat_range : [np
+0000a510: 2e6e 6461 7272 6179 5d0d 0a20 2020 2020  .ndarray]..     
+0000a520: 2020 2020 2020 2041 7272 6179 2077 6974         Array wit
+0000a530: 6820 616c 6c20 7468 6520 6365 6e74 7265  h all the centre
+0000a540: 7320 6f66 2063 656c 6c73 2069 6e20 7468  s of cells in th
+0000a550: 6520 646f 6d61 696e 206f 6620 7468 6520  e domain of the 
+0000a560: 4445 4d0d 0a20 2020 2020 2020 2022 2222  DEM..        """
+0000a570: 0d0a 2020 2020 2020 2020 2320 6368 6563  ..        # chec
+0000a580: 6b20 7468 6520 6c6f 6361 7469 6f6e 2070  k the location p
+0000a590: 6172 616d 6574 6572 0d0a 2020 2020 2020  arameter..      
+0000a5a0: 2020 6c6f 6361 7469 6f6e 203d 206c 6f63    location = loc
+0000a5b0: 6174 696f 6e2e 6c6f 7765 7228 290d 0a20  ation.lower().. 
+0000a5c0: 2020 2020 2020 2069 6620 6c6f 6361 7469         if locati
+0000a5d0: 6f6e 206e 6f74 2069 6e20 5b22 6365 6e74  on not in ["cent
+0000a5e0: 6572 222c 2022 636f 726e 6572 225d 3a0d  er", "corner"]:.
+0000a5f0: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
+0000a600: 7365 2056 616c 7565 4572 726f 7228 0d0a  se ValueError(..
+0000a610: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000a620: 2254 6865 206c 6f63 6174 696f 6e20 7061  "The location pa
+0000a630: 7261 6d65 7465 7220 6361 6e20 6861 7665  rameter can have
+0000a640: 206f 6e65 206f 6620 7468 6573 6520 7661   one of these va
+0000a650: 6c75 6573 3a20 2763 656e 7465 7227 2c20  lues: 'center', 
+0000a660: 2763 6f72 6e65 7227 2c20 220d 0a20 2020  'corner', "..   
+0000a670: 2020 2020 2020 2020 2020 2020 2066 2262               f"b
+0000a680: 7574 2074 6865 2076 616c 7565 3a20 7b6c  ut the value: {l
+0000a690: 6f63 6174 696f 6e7d 2069 7320 6769 7665  ocation} is give
+0000a6a0: 6e2e 220d 0a20 2020 2020 2020 2020 2020  n."..           
+0000a6b0: 2029 0d0a 0d0a 2020 2020 2020 2020 6966   )....        if
+0000a6c0: 206c 6f63 6174 696f 6e20 3d3d 2022 6365   location == "ce
+0000a6d0: 6e74 6572 223a 0d0a 2020 2020 2020 2020  nter":..        
+0000a6e0: 2020 2020 2320 4164 6469 6e67 2030 2e35      # Adding 0.5
+0000a6f0: 2a63 656c 6c20 7369 7a65 2074 6f20 6765  *cell size to ge
+0000a700: 7420 7468 6520 6365 6e74 7265 0d0a 2020  t the centre..  
+0000a710: 2020 2020 2020 2020 2020 6164 645f 7661            add_va
+0000a720: 6c75 6520 3d20 302e 350d 0a20 2020 2020  lue = 0.5..     
+0000a730: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
+0000a740: 2020 2020 2020 6164 645f 7661 6c75 6520        add_value 
+0000a750: 3d20 300d 0a20 2020 2020 2020 2023 2047  = 0..        # G
+0000a760: 6574 7469 6e67 2064 6174 6120 666f 7220  etting data for 
+0000a770: 7468 6520 7768 6f6c 6520 6772 6964 0d0a  the whole grid..
+0000a780: 2020 2020 2020 2020 280d 0a20 2020 2020          (..     
+0000a790: 2020 2020 2020 2078 5f69 6e69 742c 0d0a         x_init,..
+0000a7a0: 2020 2020 2020 2020 2020 2020 6365 6c6c              cell
+0000a7b0: 5f73 697a 655f 782c 0d0a 2020 2020 2020  _size_x,..      
+0000a7c0: 2020 2020 2020 7879 5f73 7061 6e2c 0d0a        xy_span,..
+0000a7d0: 2020 2020 2020 2020 2020 2020 795f 696e              y_in
+0000a7e0: 6974 2c0d 0a20 2020 2020 2020 2020 2020  it,..           
+0000a7f0: 2079 795f 7370 616e 2c0d 0a20 2020 2020   yy_span,..     
+0000a800: 2020 2020 2020 2063 656c 6c5f 7369 7a65         cell_size
+0000a810: 5f79 2c0d 0a20 2020 2020 2020 2029 203d  _y,..        ) =
+0000a820: 2073 656c 662e 6765 6f74 7261 6e73 666f   self.geotransfo
+0000a830: 726d 0d0a 2020 2020 2020 2020 6966 2063  rm..        if c
+0000a840: 656c 6c5f 7369 7a65 5f78 2021 3d20 6365  ell_size_x != ce
+0000a850: 6c6c 5f73 697a 655f 793a 0d0a 2020 2020  ll_size_y:..    
+0000a860: 2020 2020 2020 2020 6966 206e 702e 6162          if np.ab
+0000a870: 7328 6365 6c6c 5f73 697a 655f 7829 2021  s(cell_size_x) !
+0000a880: 3d20 6e70 2e61 6273 2863 656c 6c5f 7369  = np.abs(cell_si
+0000a890: 7a65 5f79 293a 0d0a 2020 2020 2020 2020  ze_y):..        
+0000a8a0: 2020 2020 2020 2020 6c6f 6767 6572 2e77          logger.w
+0000a8b0: 6172 6e69 6e67 280d 0a20 2020 2020 2020  arning(..       
+0000a8c0: 2020 2020 2020 2020 2020 2020 2066 2254               f"T
+0000a8d0: 6865 2067 6976 656e 2072 6173 7465 7220  he given raster 
+0000a8e0: 646f 6573 206e 6f74 2068 6176 6520 6120  does not have a 
+0000a8f0: 7371 7561 7265 2063 656c 6c73 2c20 7468  square cells, th
+0000a900: 6520 6365 6c6c 2073 697a 6520 6973 207b  e cell size is {
+0000a910: 6365 6c6c 5f73 697a 655f 787d 2a7b 6365  cell_size_x}*{ce
+0000a920: 6c6c 5f73 697a 655f 797d 2022 0d0a 2020  ll_size_y} "..  
+0000a930: 2020 2020 2020 2020 2020 2020 2020 290d                ).
+0000a940: 0a0d 0a20 2020 2020 2020 2023 2064 6174  ...        # dat
+0000a950: 6120 696e 2074 6865 2061 7272 6179 0d0a  a in the array..
+0000a960: 2020 2020 2020 2020 6e6f 5f76 616c 203d          no_val =
+0000a970: 2073 656c 662e 6e6f 5f64 6174 615f 7661   self.no_data_va
+0000a980: 6c75 655b 305d 0d0a 2020 2020 2020 2020  lue[0]..        
+0000a990: 6172 7220 3d20 7365 6c66 2e72 6561 645f  arr = self.read_
+0000a9a0: 6172 7261 7928 6261 6e64 3d30 290d 0a20  array(band=0).. 
+0000a9b0: 2020 2020 2020 2069 6620 6d61 736b 2069         if mask i
+0000a9c0: 7320 6e6f 7420 4e6f 6e65 2061 6e64 206e  s not None and n
+0000a9d0: 6f5f 7661 6c20 6e6f 7420 696e 2061 7272  o_val not in arr
+0000a9e0: 3a0d 0a20 2020 2020 2020 2020 2020 206c  :..            l
+0000a9f0: 6f67 6765 722e 7761 726e 696e 6728 0d0a  ogger.warning(..
+0000aa00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000aa10: 2254 6865 206e 6f20 6461 7461 2076 616c  "The no data val
+0000aa20: 7565 2064 6f65 7320 6e6f 7420 6578 6973  ue does not exis
+0000aa30: 7420 696e 2074 6865 2062 616e 642c 2073  t in the band, s
+0000aa40: 6f20 616c 6c20 7468 6520 6365 6c6c 7320  o all the cells 
+0000aa50: 7769 6c6c 2062 6520 636f 7369 6465 7265  will be cosidere
+0000aa60: 6420 616e 6420 7468 6520 220d 0a20 2020  d and the "..   
+0000aa70: 2020 2020 2020 2020 2020 2020 2022 6d61               "ma
+0000aa80: 736b 2077 696c 6c20 6e6f 7420 6265 2063  sk will not be c
+0000aa90: 6f73 6964 6572 6564 2e22 0d0a 2020 2020  osidered."..    
+0000aaa0: 2020 2020 2020 2020 290d 0a0d 0a20 2020          )....   
+0000aab0: 2020 2020 2069 6620 6d61 736b 3a0d 0a20       if mask:.. 
+0000aac0: 2020 2020 2020 2020 2020 206d 6173 6b20             mask 
+0000aad0: 3d20 5b6e 6f5f 7661 6c5d 0d0a 2020 2020  = [no_val]..    
+0000aae0: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
+0000aaf0: 2020 2020 2020 206d 6173 6b20 3d20 4e6f         mask = No
+0000ab00: 6e65 0d0a 2020 2020 2020 2020 696e 6469  ne..        indi
+0000ab10: 6365 7320 3d20 6765 745f 696e 6469 6365  ces = get_indice
+0000ab20: 7332 2861 7272 2c20 6d61 736b 3d6d 6173  s2(arr, mask=mas
+0000ab30: 6b29 0d0a 0d0a 2020 2020 2020 2020 2320  k)....        # 
+0000ab40: 6578 6563 6c75 6465 2074 6865 206e 6f5f  execlude the no_
+0000ab50: 6461 7461 5f76 616c 7565 7320 6365 6c6c  data_values cell
+0000ab60: 732e 0d0a 2020 2020 2020 2020 6631 203d  s...        f1 =
+0000ab70: 205b 695b 305d 2066 6f72 2069 2069 6e20   [i[0] for i in 
+0000ab80: 696e 6469 6365 735d 0d0a 2020 2020 2020  indices]..      
+0000ab90: 2020 6632 203d 205b 695b 315d 2066 6f72    f2 = [i[1] for
+0000aba0: 2069 2069 6e20 696e 6469 6365 735d 0d0a   i in indices]..
+0000abb0: 2020 2020 2020 2020 7820 3d20 5b78 5f69          x = [x_i
+0000abc0: 6e69 7420 2b20 6365 6c6c 5f73 697a 655f  nit + cell_size_
+0000abd0: 7820 2a20 2869 202b 2061 6464 5f76 616c  x * (i + add_val
+0000abe0: 7565 2920 666f 7220 6920 696e 2066 325d  ue) for i in f2]
+0000abf0: 0d0a 2020 2020 2020 2020 7920 3d20 5b79  ..        y = [y
+0000ac00: 5f69 6e69 7420 2b20 6365 6c6c 5f73 697a  _init + cell_siz
+0000ac10: 655f 7920 2a20 2869 202b 2061 6464 5f76  e_y * (i + add_v
+0000ac20: 616c 7565 2920 666f 7220 6920 696e 2066  alue) for i in f
+0000ac30: 315d 0d0a 2020 2020 2020 2020 636f 6f72  1]..        coor
+0000ac40: 6473 203d 206e 702e 6172 7261 7928 6c69  ds = np.array(li
+0000ac50: 7374 287a 6970 2878 2c20 7929 2929 0d0a  st(zip(x, y)))..
+0000ac60: 0d0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+0000ac70: 2063 6f6f 7264 730d 0a0d 0a20 2020 2064   coords....    d
+0000ac80: 6566 2067 6574 5f63 656c 6c5f 706f 6c79  ef get_cell_poly
+0000ac90: 676f 6e73 2873 656c 662c 206d 6173 6b3d  gons(self, mask=
+0000aca0: 4661 6c73 6529 202d 3e20 4765 6f44 6174  False) -> GeoDat
+0000acb0: 6146 7261 6d65 3a0d 0a20 2020 2020 2020  aFrame:..       
+0000acc0: 2022 2222 4765 7420 6120 706f 6c79 676f   """Get a polygo
+0000acd0: 6e20 7368 6170 656c 7920 6765 6f6d 6574  n shapely geomet
+0000ace0: 7279 2066 6f72 2074 6865 2072 6173 7465  ry for the raste
+0000acf0: 7220 6365 6c6c 732e 0d0a 0d0a 2020 2020  r cells.....    
+0000ad00: 2020 2020 5061 7261 6d65 7465 7273 0d0a      Parameters..
+0000ad10: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+0000ad20: 2d2d 0d0a 2020 2020 2020 2020 6d61 736b  --..        mask
+0000ad30: 3a20 5b62 6f6f 6c5d 0d0a 2020 2020 2020  : [bool]..      
+0000ad40: 2020 2020 2020 5472 7565 2074 6f20 6765        True to ge
+0000ad50: 7420 7468 6520 706f 6c79 676f 6e73 206f  t the polygons o
+0000ad60: 6620 7468 6520 6365 6c6c 7320 696e 7369  f the cells insi
+0000ad70: 6465 2074 6865 2064 6f6d 6169 6e2e 0d0a  de the domain...
+0000ad80: 0d0a 2020 2020 2020 2020 5265 7475 726e  ..        Return
+0000ad90: 730d 0a20 2020 2020 2020 202d 2d2d 2d2d  s..        -----
+0000ada0: 2d2d 0d0a 2020 2020 2020 2020 4765 6f44  --..        GeoD
+0000adb0: 6174 6146 7261 6d65 3a0d 0a20 2020 2020  ataFrame:..     
+0000adc0: 2020 2020 2020 2077 6974 6820 7477 6f20         with two 
+0000add0: 636f 6c75 6d6e 732c 2067 656f 6d65 7472  columns, geometr
+0000ade0: 792c 2061 6e64 2069 640d 0a20 2020 2020  y, and id..     
+0000adf0: 2020 2022 2222 0d0a 2020 2020 2020 2020     """..        
+0000ae00: 636f 6f72 6473 203d 2073 656c 662e 6765  coords = self.ge
+0000ae10: 745f 6365 6c6c 5f63 6f6f 7264 7328 6c6f  t_cell_coords(lo
+0000ae20: 6361 7469 6f6e 3d22 636f 726e 6572 222c  cation="corner",
+0000ae30: 206d 6173 6b3d 6d61 736b 290d 0a20 2020   mask=mask)..   
+0000ae40: 2020 2020 2063 656c 6c5f 7369 7a65 203d       cell_size =
+0000ae50: 2073 656c 662e 6765 6f74 7261 6e73 666f   self.geotransfo
+0000ae60: 726d 5b31 5d0d 0a20 2020 2020 2020 2065  rm[1]..        e
+0000ae70: 7073 6720 3d20 7365 6c66 2e5f 6765 745f  psg = self._get_
+0000ae80: 6570 7367 2829 0d0a 2020 2020 2020 2020  epsg()..        
+0000ae90: 7820 3d20 6e70 2e7a 6572 6f73 2828 636f  x = np.zeros((co
+0000aea0: 6f72 6473 2e73 6861 7065 5b30 5d2c 2034  ords.shape[0], 4
+0000aeb0: 2929 0d0a 2020 2020 2020 2020 7920 3d20  ))..        y = 
+0000aec0: 6e70 2e7a 6572 6f73 2828 636f 6f72 6473  np.zeros((coords
+0000aed0: 2e73 6861 7065 5b30 5d2c 2034 2929 0d0a  .shape[0], 4))..
+0000aee0: 2020 2020 2020 2020 2320 6669 6c6c 2074          # fill t
+0000aef0: 6865 2074 6f70 206c 6566 7420 636f 726e  he top left corn
+0000af00: 6572 2070 6f69 6e74 0d0a 2020 2020 2020  er point..      
+0000af10: 2020 785b 3a2c 2030 5d20 3d20 636f 6f72    x[:, 0] = coor
+0000af20: 6473 5b3a 2c20 305d 0d0a 2020 2020 2020  ds[:, 0]..      
+0000af30: 2020 795b 3a2c 2030 5d20 3d20 636f 6f72    y[:, 0] = coor
+0000af40: 6473 5b3a 2c20 315d 0d0a 2020 2020 2020  ds[:, 1]..      
+0000af50: 2020 2320 6669 6c6c 2074 6865 2074 6f70    # fill the top
+0000af60: 2072 6967 6874 0d0a 2020 2020 2020 2020   right..        
+0000af70: 785b 3a2c 2031 5d20 3d20 785b 3a2c 2030  x[:, 1] = x[:, 0
+0000af80: 5d20 2b20 6365 6c6c 5f73 697a 650d 0a20  ] + cell_size.. 
+0000af90: 2020 2020 2020 2079 5b3a 2c20 315d 203d         y[:, 1] =
+0000afa0: 2079 5b3a 2c20 305d 0d0a 2020 2020 2020   y[:, 0]..      
+0000afb0: 2020 2320 6669 6c6c 2074 6865 2062 6f74    # fill the bot
+0000afc0: 746f 6d20 7269 6768 740d 0a20 2020 2020  tom right..     
+0000afd0: 2020 2078 5b3a 2c20 325d 203d 2078 5b3a     x[:, 2] = x[:
+0000afe0: 2c20 305d 202b 2063 656c 6c5f 7369 7a65  , 0] + cell_size
+0000aff0: 0d0a 2020 2020 2020 2020 795b 3a2c 2032  ..        y[:, 2
+0000b000: 5d20 3d20 795b 3a2c 2030 5d20 2d20 6365  ] = y[:, 0] - ce
+0000b010: 6c6c 5f73 697a 650d 0a0d 0a20 2020 2020  ll_size....     
+0000b020: 2020 2023 2066 696c 6c20 7468 6520 626f     # fill the bo
+0000b030: 7474 6f6d 206c 6566 740d 0a20 2020 2020  ttom left..     
+0000b040: 2020 2078 5b3a 2c20 335d 203d 2078 5b3a     x[:, 3] = x[:
+0000b050: 2c20 305d 0d0a 2020 2020 2020 2020 795b  , 0]..        y[
+0000b060: 3a2c 2033 5d20 3d20 795b 3a2c 2030 5d20  :, 3] = y[:, 0] 
+0000b070: 2d20 6365 6c6c 5f73 697a 650d 0a0d 0a20  - cell_size.... 
+0000b080: 2020 2020 2020 2063 6f6f 7264 735f 7475         coords_tu
+0000b090: 706c 6573 203d 205b 6c69 7374 287a 6970  ples = [list(zip
+0000b0a0: 2878 5b3a 2c20 695d 2c20 795b 3a2c 2069  (x[:, i], y[:, i
+0000b0b0: 5d29 2920 666f 7220 6920 696e 2072 616e  ])) for i in ran
+0000b0c0: 6765 2834 295d 0d0a 2020 2020 2020 2020  ge(4)]..        
+0000b0d0: 706f 6c79 735f 636f 6f72 6473 203d 205b  polys_coords = [
+0000b0e0: 0d0a 2020 2020 2020 2020 2020 2020 280d  ..            (.
+0000b0f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000b100: 2063 6f6f 7264 735f 7475 706c 6573 5b30   coords_tuples[0
+0000b110: 5d5b 695d 2c0d 0a20 2020 2020 2020 2020  ][i],..         
+0000b120: 2020 2020 2020 2063 6f6f 7264 735f 7475         coords_tu
+0000b130: 706c 6573 5b31 5d5b 695d 2c0d 0a20 2020  ples[1][i],..   
+0000b140: 2020 2020 2020 2020 2020 2020 2063 6f6f               coo
+0000b150: 7264 735f 7475 706c 6573 5b32 5d5b 695d  rds_tuples[2][i]
+0000b160: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+0000b170: 2020 2063 6f6f 7264 735f 7475 706c 6573     coords_tuples
+0000b180: 5b33 5d5b 695d 2c0d 0a20 2020 2020 2020  [3][i],..       
+0000b190: 2020 2020 2029 0d0a 2020 2020 2020 2020       )..        
+0000b1a0: 2020 2020 666f 7220 6920 696e 2072 616e      for i in ran
+0000b1b0: 6765 286c 656e 2878 2929 0d0a 2020 2020  ge(len(x))..    
+0000b1c0: 2020 2020 5d0d 0a20 2020 2020 2020 2070      ]..        p
+0000b1d0: 6f6c 7967 6f6e 7320 3d20 6c69 7374 286d  olygons = list(m
+0000b1e0: 6170 2846 6561 7475 7265 436f 6c6c 6563  ap(FeatureCollec
+0000b1f0: 7469 6f6e 2e63 7265 6174 655f 706f 6c79  tion.create_poly
+0000b200: 676f 6e2c 2070 6f6c 7973 5f63 6f6f 7264  gon, polys_coord
+0000b210: 7329 290d 0a20 2020 2020 2020 2067 6466  s))..        gdf
+0000b220: 203d 2067 7064 2e47 656f 4461 7461 4672   = gpd.GeoDataFr
+0000b230: 616d 6528 6765 6f6d 6574 7279 3d70 6f6c  ame(geometry=pol
+0000b240: 7967 6f6e 7329 0d0a 2020 2020 2020 2020  ygons)..        
+0000b250: 6764 662e 7365 745f 6372 7328 6570 7367  gdf.set_crs(epsg
+0000b260: 3d65 7073 672c 2069 6e70 6c61 6365 3d54  =epsg, inplace=T
+0000b270: 7275 6529 0d0a 2020 2020 2020 2020 6764  rue)..        gd
+0000b280: 665b 2269 6422 5d20 3d20 6764 662e 696e  f["id"] = gdf.in
+0000b290: 6465 780d 0a20 2020 2020 2020 2072 6574  dex..        ret
+0000b2a0: 7572 6e20 6764 660d 0a0d 0a20 2020 2064  urn gdf....    d
+0000b2b0: 6566 2067 6574 5f63 656c 6c5f 706f 696e  ef get_cell_poin
+0000b2c0: 7473 2873 656c 662c 206c 6f63 6174 696f  ts(self, locatio
+0000b2d0: 6e3a 2073 7472 203d 2022 6365 6e74 6572  n: str = "center
+0000b2e0: 222c 206d 6173 6b3d 4661 6c73 6529 202d  ", mask=False) -
+0000b2f0: 3e20 4765 6f44 6174 6146 7261 6d65 3a0d  > GeoDataFrame:.
+0000b300: 0a20 2020 2020 2020 2022 2222 4765 7420  .        """Get 
+0000b310: 6120 706f 696e 7420 7368 6170 656c 7920  a point shapely 
+0000b320: 6765 6f6d 6574 7279 2066 6f72 2074 6865  geometry for the
+0000b330: 2072 6173 7465 7220 6365 6c6c 7320 6365   raster cells ce
+0000b340: 6e74 6572 2070 6f69 6e74 2e0d 0a0d 0a20  nter point..... 
+0000b350: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
+0000b360: 730d 0a20 2020 2020 2020 202d 2d2d 2d2d  s..        -----
+0000b370: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 206c  -----..        l
+0000b380: 6f63 6174 696f 6e3a 205b 7374 725d 0d0a  ocation: [str]..
+0000b390: 2020 2020 2020 2020 2020 2020 6c6f 6361              loca
+0000b3a0: 7469 6f6e 206f 6620 7468 6520 706f 696e  tion of the poin
+0000b3b0: 742c 205b 2263 6f72 6e65 7222 2c20 2263  t, ["corner", "c
+0000b3c0: 656e 7465 7222 5d2e 2044 6566 6175 6c74  enter"]. Default
+0000b3d0: 2069 7320 2263 656e 7465 7222 2e0d 0a20   is "center"... 
+0000b3e0: 2020 2020 2020 206d 6173 6b3a 205b 626f         mask: [bo
+0000b3f0: 6f6c 5d0d 0a20 2020 2020 2020 2020 2020  ol]..           
+0000b400: 2054 7275 6520 746f 2067 6574 2074 6865   True to get the
+0000b410: 2070 6f6c 7967 6f6e 7320 6f66 2074 6865   polygons of the
+0000b420: 2063 656c 6c73 2069 6e73 6964 6520 7468   cells inside th
+0000b430: 6520 646f 6d61 696e 2e0d 0a0d 0a20 2020  e domain.....   
+0000b440: 2020 2020 2052 6574 7572 6e73 0d0a 2020       Returns..  
+0000b450: 2020 2020 2020 2d2d 2d2d 2d2d 2d0d 0a20        -------.. 
+0000b460: 2020 2020 2020 2047 656f 4461 7461 4672         GeoDataFr
+0000b470: 616d 653a 0d0a 2020 2020 2020 2020 2020  ame:..          
+0000b480: 2020 7769 7468 2074 776f 2063 6f6c 756d    with two colum
+0000b490: 6e73 2c20 6765 6f6d 6574 7279 2c20 616e  ns, geometry, an
+0000b4a0: 6420 6964 0d0a 2020 2020 2020 2020 2222  d id..        ""
+0000b4b0: 220d 0a20 2020 2020 2020 2063 6f6f 7264  "..        coord
+0000b4c0: 7320 3d20 7365 6c66 2e67 6574 5f63 656c  s = self.get_cel
+0000b4d0: 6c5f 636f 6f72 6473 286c 6f63 6174 696f  l_coords(locatio
+0000b4e0: 6e3d 6c6f 6361 7469 6f6e 2c20 6d61 736b  n=location, mask
+0000b4f0: 3d6d 6173 6b29 0d0a 2020 2020 2020 2020  =mask)..        
+0000b500: 6570 7367 203d 2073 656c 662e 5f67 6574  epsg = self._get
+0000b510: 5f65 7073 6728 290d 0a0d 0a20 2020 2020  _epsg()....     
+0000b520: 2020 2063 6f6f 7264 735f 7475 706c 6573     coords_tuples
+0000b530: 203d 206c 6973 7428 7a69 7028 636f 6f72   = list(zip(coor
+0000b540: 6473 5b3a 2c20 305d 2c20 636f 6f72 6473  ds[:, 0], coords
+0000b550: 5b3a 2c20 315d 2929 0d0a 2020 2020 2020  [:, 1]))..      
+0000b560: 2020 706f 696e 7473 203d 2046 6561 7475    points = Featu
+0000b570: 7265 436f 6c6c 6563 7469 6f6e 2e63 7265  reCollection.cre
+0000b580: 6174 655f 706f 696e 7428 636f 6f72 6473  ate_point(coords
+0000b590: 5f74 7570 6c65 7329 0d0a 2020 2020 2020  _tuples)..      
+0000b5a0: 2020 6764 6620 3d20 6770 642e 4765 6f44    gdf = gpd.GeoD
+0000b5b0: 6174 6146 7261 6d65 2867 656f 6d65 7472  ataFrame(geometr
+0000b5c0: 793d 706f 696e 7473 290d 0a20 2020 2020  y=points)..     
+0000b5d0: 2020 2067 6466 2e73 6574 5f63 7273 2865     gdf.set_crs(e
+0000b5e0: 7073 673d 6570 7367 2c20 696e 706c 6163  psg=epsg, inplac
+0000b5f0: 653d 5472 7565 290d 0a20 2020 2020 2020  e=True)..       
+0000b600: 2067 6466 5b22 6964 225d 203d 2067 6466   gdf["id"] = gdf
+0000b610: 2e69 6e64 6578 0d0a 2020 2020 2020 2020  .index..        
+0000b620: 7265 7475 726e 2067 6466 0d0a 0d0a 2020  return gdf....  
+0000b630: 2020 6465 6620 746f 5f66 696c 6528 7365    def to_file(se
+0000b640: 6c66 2c20 7061 7468 3a20 7374 722c 2062  lf, path: str, b
+0000b650: 616e 643a 2069 6e74 203d 2030 2920 2d3e  and: int = 0) ->
+0000b660: 204e 6f6e 653a 0d0a 2020 2020 2020 2020   None:..        
+0000b670: 2222 2253 6176 6520 746f 2067 656f 7469  """Save to geoti
+0000b680: 6666 2066 6f72 6d61 742e 0d0a 0d0a 2020  ff format.....  
+0000b690: 2020 2020 2020 2020 2020 7361 7665 2073            save s
+0000b6a0: 6176 6573 2061 2072 6173 7465 7220 746f  aves a raster to
+0000b6b0: 2061 2070 6174 682c 2074 6865 2074 7970   a path, the typ
+0000b6c0: 6520 6f66 2074 6865 2064 7269 7665 7220  e of the driver 
+0000b6d0: 2867 656f 7269 6666 2f6e 6574 6364 662f  (georiff/netcdf/
+0000b6e0: 6173 6369 6929 2077 696c 6c20 6265 2069  ascii) will be i
+0000b6f0: 6d70 6c69 6564 2066 726f 6d20 7468 650d  mplied from the.
+0000b700: 0a20 2020 2020 2020 2020 2020 2065 7874  .            ext
+0000b710: 656e 7369 6f6e 2061 7420 7468 6520 656e  ension at the en
+0000b720: 6420 6f66 2074 6865 2067 6976 656e 2070  d of the given p
+0000b730: 6174 682e 0d0a 0d0a 2020 2020 2020 2020  ath.....        
+0000b740: 5061 7261 6d65 7465 7273 0d0a 2020 2020  Parameters..    
+0000b750: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a      ----------..
+0000b760: 2020 2020 2020 2020 7061 7468 3a20 5b73          path: [s
+0000b770: 7472 696e 675d 0d0a 2020 2020 2020 2020  tring]..        
+0000b780: 2020 2020 6120 7061 7468 2069 6e63 6c75      a path inclu
+0000b790: 646e 6720 7468 6520 6e61 6d65 206f 6620  dng the name of 
+0000b7a0: 7468 6520 7261 7374 6572 2061 6e64 2065  the raster and e
+0000b7b0: 7874 656e 7469 6f6e 2e0d 0a20 2020 2020  xtention...     
+0000b7c0: 2020 2020 2020 203e 3e3e 2070 6174 6820         >>> path 
+0000b7d0: 3d20 2264 6174 612f 6372 6f70 7065 642e  = "data/cropped.
+0000b7e0: 7469 6622 0d0a 2020 2020 2020 2020 6261  tif"..        ba
+0000b7f0: 6e64 3a20 5b69 6e74 5d0d 0a20 2020 2020  nd: [int]..     
+0000b800: 2020 2020 2020 2062 616e 6420 696e 6465         band inde
+0000b810: 782c 206e 6565 6465 6420 6f6e 6c79 2069  x, needed only i
+0000b820: 6e20 6361 7365 206f 6620 6173 6369 6920  n case of ascii 
+0000b830: 6472 6976 6572 732e 2044 6566 6175 6c74  drivers. Default
+0000b840: 2069 7320 302e 0d0a 0d0a 2020 2020 2020   is 0.....      
+0000b850: 2020 4578 616d 706c 6573 0d0a 2020 2020    Examples..    
+0000b860: 2020 2020 2d2d 2d2d 2d2d 2d2d 0d0a 2020      --------..  
+0000b870: 2020 2020 2020 3e3e 3e20 7261 7374 6572        >>> raster
+0000b880: 5f6f 626a 203d 2044 6174 6173 6574 2e72  _obj = Dataset.r
+0000b890: 6561 645f 6669 6c65 2822 7061 7468 2f74  ead_file("path/t
+0000b8a0: 6f2f 6669 6c65 2f2a 2a2a 2e74 6966 2229  o/file/***.tif")
+0000b8b0: 0d0a 2020 2020 2020 2020 3e3e 3e20 6f75  ..        >>> ou
+0000b8c0: 7470 7574 5f70 6174 6820 3d20 2265 7861  tput_path = "exa
+0000b8d0: 6d70 6c65 732f 4749 532f 6461 7461 2f73  mples/GIS/data/s
+0000b8e0: 6176 655f 7261 7374 6572 5f74 6573 742e  ave_raster_test.
+0000b8f0: 7469 6622 0d0a 2020 2020 2020 2020 3e3e  tif"..        >>
+0000b900: 3e20 7261 7374 6572 5f6f 626a 2e74 6f5f  > raster_obj.to_
+0000b910: 6669 6c65 286f 7574 7075 745f 7061 7468  file(output_path
+0000b920: 290d 0a20 2020 2020 2020 2022 2222 0d0a  )..        """..
+0000b930: 2020 2020 2020 2020 6966 206e 6f74 2069          if not i
+0000b940: 7369 6e73 7461 6e63 6528 7061 7468 2c20  sinstance(path, 
+0000b950: 7374 7229 3a0d 0a20 2020 2020 2020 2020  str):..         
+0000b960: 2020 2072 6169 7365 2054 7970 6545 7272     raise TypeErr
+0000b970: 6f72 2822 7061 7468 2069 6e70 7574 2073  or("path input s
+0000b980: 686f 756c 6420 6265 2073 7472 696e 6720  hould be string 
+0000b990: 7479 7065 2229 0d0a 0d0a 2020 2020 2020  type")....      
+0000b9a0: 2020 6578 7465 6e73 696f 6e20 3d20 7061    extension = pa
+0000b9b0: 7468 2e73 706c 6974 2822 2e22 295b 2d31  th.split(".")[-1
+0000b9c0: 5d0d 0a20 2020 2020 2020 2064 7269 7665  ]..        drive
+0000b9d0: 7220 3d20 4341 5441 4c4f 472e 6765 745f  r = CATALOG.get_
+0000b9e0: 6472 6976 6572 5f6e 616d 655f 6279 5f65  driver_name_by_e
+0000b9f0: 7874 656e 7369 6f6e 2865 7874 656e 7369  xtension(extensi
+0000ba00: 6f6e 290d 0a20 2020 2020 2020 2023 2069  on)..        # i
+0000ba10: 6620 6e6f 7420 4341 5441 4c4f 472e 6578  f not CATALOG.ex
+0000ba20: 6973 7473 2864 7269 7665 7229 3a0d 0a20  ists(driver):.. 
+0000ba30: 2020 2020 2020 2023 2020 2020 2072 6169         #     rai
+0000ba40: 7365 2044 7269 7665 724e 6f74 4578 6973  se DriverNotExis
+0000ba50: 7445 7272 6f72 2866 2254 6865 2067 6976  tError(f"The giv
+0000ba60: 656e 2064 7269 7665 723a 207b 6472 6976  en driver: {driv
+0000ba70: 6572 7d20 646f 6573 206e 6f74 2065 7869  er} does not exi
+0000ba80: 7374 2229 0d0a 2020 2020 2020 2020 6472  st")..        dr
+0000ba90: 6976 6572 5f6e 616d 6520 3d20 4341 5441  iver_name = CATA
+0000baa0: 4c4f 472e 6765 745f 6764 616c 5f6e 616d  LOG.get_gdal_nam
+0000bab0: 6528 6472 6976 6572 290d 0a0d 0a20 2020  e(driver)....   
+0000bac0: 2020 2020 2069 6620 6472 6976 6572 203d       if driver =
+0000bad0: 3d20 2261 7363 6969 223a 0d0a 2020 2020  = "ascii":..    
+0000bae0: 2020 2020 2020 2020 6172 7220 3d20 7365          arr = se
+0000baf0: 6c66 2e72 6561 645f 6172 7261 7928 6261  lf.read_array(ba
+0000bb00: 6e64 3d62 616e 6429 0d0a 2020 2020 2020  nd=band)..      
+0000bb10: 2020 2020 2020 6e6f 5f64 6174 615f 7661        no_data_va
+0000bb20: 6c75 6520 3d20 7365 6c66 2e6e 6f5f 6461  lue = self.no_da
+0000bb30: 7461 5f76 616c 7565 5b62 616e 645d 0d0a  ta_value[band]..
+0000bb40: 2020 2020 2020 2020 2020 2020 786d 696e              xmin
+0000bb50: 2c20 796d 696e 2c20 5f2c 205f 203d 2073  , ymin, _, _ = s
+0000bb60: 656c 662e 6262 6f78 0d0a 2020 2020 2020  elf.bbox..      
+0000bb70: 2020 2020 2020 5f69 6f2e 746f 5f61 7363        _io.to_asc
+0000bb80: 6969 2861 7272 2c20 7365 6c66 2e63 656c  ii(arr, self.cel
+0000bb90: 6c5f 7369 7a65 2c20 786d 696e 2c20 796d  l_size, xmin, ym
+0000bba0: 696e 2c20 6e6f 5f64 6174 615f 7661 6c75  in, no_data_valu
+0000bbb0: 652c 2070 6174 6829 0d0a 2020 2020 2020  e, path)..      
+0000bbc0: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
+0000bbd0: 2020 2020 2064 7374 203d 2067 6461 6c2e       dst = gdal.
+0000bbe0: 4765 7444 7269 7665 7242 794e 616d 6528  GetDriverByName(
+0000bbf0: 6472 6976 6572 5f6e 616d 6529 2e43 7265  driver_name).Cre
+0000bc00: 6174 6543 6f70 7928 7061 7468 2c20 7365  ateCopy(path, se
+0000bc10: 6c66 2e72 6173 7465 722c 2030 290d 0a20  lf.raster, 0).. 
+0000bc20: 2020 2020 2020 2020 2020 2064 7374 203d             dst =
+0000bc30: 204e 6f6e 6520 2023 2046 6c75 7368 2074   None  # Flush t
+0000bc40: 6865 2064 6174 6173 6574 2074 6f20 6469  he dataset to di
+0000bc50: 736b 0d0a 2020 2020 2020 2020 2020 2020  sk..            
+0000bc60: 2320 7072 696e 7420 746f 2067 6f20 6172  # print to go ar
+0000bc70: 6f75 6e64 2074 6865 2061 7373 6967 6e65  ound the assigne
+0000bc80: 6420 6275 7420 6e65 7665 7220 7573 6564  d but never used
+0000bc90: 2070 7265 2d63 6f6d 6d69 7420 6973 7375   pre-commit issu
+0000bca0: 650d 0a20 2020 2020 2020 2020 2020 2070  e..            p
+0000bcb0: 7269 6e74 2864 7374 290d 0a0d 0a20 2020  rint(dst)....   
+0000bcc0: 2064 6566 2063 6f6e 7665 7274 5f6c 6f6e   def convert_lon
+0000bcd0: 6769 7475 6465 2873 656c 662c 2069 6e70  gitude(self, inp
+0000bce0: 6c61 6365 3a20 626f 6f6c 203d 2046 616c  lace: bool = Fal
+0000bcf0: 7365 293a 0d0a 2020 2020 2020 2020 2222  se):..        ""
+0000bd00: 2243 6f6e 7665 7274 204c 6f6e 6769 7475  "Convert Longitu
+0000bd10: 6465 2e0d 0a0d 0a20 2020 2020 2020 2020  de.....         
+0000bd20: 2020 202d 2063 6f6e 7665 7274 2074 6865     - convert the
+0000bd30: 206c 6f6e 6769 7475 6465 2066 726f 6d20   longitude from 
+0000bd40: 3020 2d20 3336 3020 746f 202d 3138 3020  0 - 360 to -180 
+0000bd50: 2d20 3138 302e 0d0a 2020 2020 2020 2020  - 180...        
+0000bd60: 2020 2020 2d20 6375 7272 656e 746c 7920      - currently 
+0000bd70: 7468 6520 6675 6e63 7469 6f6e 2077 6f72  the function wor
+0000bd80: 6b73 2063 6f72 7265 6374 6c79 2069 6620  ks correctly if 
+0000bd90: 7468 6520 7261 7374 6572 2063 6f76 6572  the raster cover
+0000bda0: 7320 7468 6520 7768 6f6c 6520 776f 726c  s the whole worl
+0000bdb0: 642c 2069 7420 6d65 616e 7320 7468 6174  d, it means that
+0000bdc0: 2074 6865 2063 6f6c 756d 6e73 0d0a 2020   the columns..  
+0000bdd0: 2020 2020 2020 2020 2020 696e 2074 6865            in the
+0000bde0: 2072 6173 7465 7273 2063 6f76 6572 7320   rasters covers 
+0000bdf0: 6672 6f6d 206c 6f6e 6769 7475 6465 2030  from longitude 0
+0000be00: 2074 6f20 3336 302e 0d0a 0d0a 2020 2020   to 360.....    
+0000be10: 2020 2020 5061 7261 6d65 7465 7273 0d0a      Parameters..
+0000be20: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+0000be30: 2d2d 0d0a 2020 2020 2020 2020 696e 706c  --..        inpl
+0000be40: 6163 653a 205b 626f 6f6c 5d0d 0a20 2020  ace: [bool]..   
+0000be50: 2020 2020 2020 2020 2054 7275 6520 746f           True to
+0000be60: 206d 616b 6520 7468 6520 6368 616e 6765   make the change
+0000be70: 7320 696e 2070 6c61 6365 2e0d 0a0d 0a20  s in place..... 
+0000be80: 2020 2020 2020 2052 6574 7572 6e73 0d0a         Returns..
+0000be90: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d0d          -------.
+0000bea0: 0a20 2020 2020 2020 2044 6174 6173 6574  .        Dataset
+0000beb0: 2e0d 0a20 2020 2020 2020 2022 2222 0d0a  ...        """..
+0000bec0: 2020 2020 2020 2020 6c6f 6e20 3d20 7365          lon = se
+0000bed0: 6c66 2e6c 6f6e 0d0a 2020 2020 2020 2020  lf.lon..        
+0000bee0: 7372 6320 3d20 7365 6c66 2e72 6173 7465  src = self.raste
+0000bef0: 720d 0a20 2020 2020 2020 2023 2063 7265  r..        # cre
+0000bf00: 6174 6520 6120 636f 7079 0d0a 2020 2020  ate a copy..    
+0000bf10: 2020 2020 6472 7620 3d20 6764 616c 2e47      drv = gdal.G
+0000bf20: 6574 4472 6976 6572 4279 4e61 6d65 2822  etDriverByName("
+0000bf30: 4d45 4d22 290d 0a20 2020 2020 2020 2064  MEM")..        d
+0000bf40: 7374 203d 2064 7276 2e43 7265 6174 6543  st = drv.CreateC
+0000bf50: 6f70 7928 2222 2c20 7372 632c 2030 290d  opy("", src, 0).
+0000bf60: 0a20 2020 2020 2020 2023 2063 6f6e 7665  .        # conve
+0000bf70: 7274 2074 6865 2030 2074 6f20 3336 3020  rt the 0 to 360 
+0000bf80: 746f 202d 3138 3020 746f 2031 3830 0d0a  to -180 to 180..
+0000bf90: 2020 2020 2020 2020 6966 206c 6f6e 5b2d          if lon[-
+0000bfa0: 315d 203c 3d20 3138 303a 0d0a 2020 2020  1] <= 180:..    
+0000bfb0: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
+0000bfc0: 6c75 6545 7272 6f72 2822 5468 6520 7261  lueError("The ra
+0000bfd0: 7374 6572 2073 686f 756c 6420 636f 7665  ster should cove
+0000bfe0: 7220 7468 6520 7768 6f6c 6520 676c 6f62  r the whole glob
+0000bff0: 6522 290d 0a0d 0a20 2020 2020 2020 2066  e")....        f
+0000c000: 6972 7374 5f74 6f5f 7472 616e 736c 6174  irst_to_translat
+0000c010: 6564 203d 206e 702e 7768 6572 6528 6c6f  ed = np.where(lo
+0000c020: 6e20 3e20 3138 3029 5b30 5d5b 305d 0d0a  n > 180)[0][0]..
+0000c030: 0d0a 2020 2020 2020 2020 696e 6420 3d20  ..        ind = 
+0000c040: 6c69 7374 2872 616e 6765 2866 6972 7374  list(range(first
+0000c050: 5f74 6f5f 7472 616e 736c 6174 6564 2c20  _to_translated, 
+0000c060: 6c65 6e28 6c6f 6e29 2929 0d0a 2020 2020  len(lon)))..    
+0000c070: 2020 2020 696e 645f 3220 3d20 6c69 7374      ind_2 = list
+0000c080: 2872 616e 6765 2830 2c20 6669 7273 745f  (range(0, first_
+0000c090: 746f 5f74 7261 6e73 6c61 7465 6429 290d  to_translated)).
+0000c0a0: 0a0d 0a20 2020 2020 2020 2066 6f72 2062  ...        for b
+0000c0b0: 616e 6420 696e 2072 616e 6765 2873 656c  and in range(sel
+0000c0c0: 662e 6261 6e64 5f63 6f75 6e74 293a 0d0a  f.band_count):..
+0000c0d0: 2020 2020 2020 2020 2020 2020 6172 7220              arr 
+0000c0e0: 3d20 7365 6c66 2e72 6561 645f 6172 7261  = self.read_arra
+0000c0f0: 7928 6261 6e64 3d62 616e 6429 0d0a 2020  y(band=band)..  
+0000c100: 2020 2020 2020 2020 2020 6172 725f 7265            arr_re
+0000c110: 6172 7261 6e67 6564 203d 2061 7272 5b3a  arranged = arr[:
+0000c120: 2c20 696e 6420 2b20 696e 645f 325d 0d0a  , ind + ind_2]..
+0000c130: 2020 2020 2020 2020 2020 2020 6473 742e              dst.
+0000c140: 4765 7452 6173 7465 7242 616e 6428 6261  GetRasterBand(ba
+0000c150: 6e64 202b 2031 292e 5772 6974 6541 7272  nd + 1).WriteArr
+0000c160: 6179 2861 7272 5f72 6561 7272 616e 6765  ay(arr_rearrange
+0000c170: 6429 0d0a 0d0a 2020 2020 2020 2020 2320  d)....        # 
+0000c180: 636f 7272 6563 7420 7468 6520 6765 6f74  correct the geot
+0000c190: 7261 6e73 666f 726d 0d0a 2020 2020 2020  ransform..      
+0000c1a0: 2020 7069 766f 745f 706f 696e 7420 3d20    pivot_point = 
+0000c1b0: 7365 6c66 2e70 6976 6f74 5f70 6f69 6e74  self.pivot_point
+0000c1c0: 0d0a 2020 2020 2020 2020 6774 203d 206c  ..        gt = l
+0000c1d0: 6973 7428 7365 6c66 2e67 656f 7472 616e  ist(self.geotran
+0000c1e0: 7366 6f72 6d29 0d0a 2020 2020 2020 2020  sform)..        
+0000c1f0: 6966 206c 6f6e 5b2d 315d 203e 2031 3830  if lon[-1] > 180
+0000c200: 3a0d 0a20 2020 2020 2020 2020 2020 206e  :..            n
+0000c210: 6577 5f67 7420 3d20 7069 766f 745f 706f  ew_gt = pivot_po
+0000c220: 696e 745b 305d 202d 2031 3830 0d0a 2020  int[0] - 180..  
+0000c230: 2020 2020 2020 2020 2020 6774 5b30 5d20            gt[0] 
+0000c240: 3d20 6e65 775f 6774 0d0a 0d0a 2020 2020  = new_gt....    
+0000c250: 2020 2020 6473 742e 5365 7447 656f 5472      dst.SetGeoTr
+0000c260: 616e 7366 6f72 6d28 6774 290d 0a0d 0a20  ansform(gt).... 
+0000c270: 2020 2020 2020 2069 6620 6e6f 7420 696e         if not in
+0000c280: 706c 6163 653a 0d0a 2020 2020 2020 2020  place:..        
+0000c290: 2020 2020 7265 7475 726e 2044 6174 6173      return Datas
+0000c2a0: 6574 2864 7374 290d 0a20 2020 2020 2020  et(dst)..       
+0000c2b0: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
+0000c2c0: 2020 2020 7365 6c66 2e5f 5f69 6e69 745f      self.__init_
+0000c2d0: 5f28 6473 7429 0d0a 0d0a 2020 2020 6465  _(dst)....    de
+0000c2e0: 6620 746f 5f70 6f6c 7967 6f6e 280d 0a20  f to_polygon(.. 
+0000c2f0: 2020 2020 2020 2073 656c 662c 0d0a 2020         self,..  
+0000c300: 2020 2020 2020 6261 6e64 3a20 696e 7420        band: int 
+0000c310: 3d20 302c 0d0a 2020 2020 2020 2020 636f  = 0,..        co
+0000c320: 6c5f 6e61 6d65 3a20 416e 7920 3d20 2269  l_name: Any = "i
+0000c330: 6422 2c0d 0a20 2020 2020 2020 2070 6174  d",..        pat
+0000c340: 683a 2073 7472 203d 204e 6f6e 652c 0d0a  h: str = None,..
+0000c350: 2020 2020 2020 2020 6472 6976 6572 3a20          driver: 
+0000c360: 7374 7220 3d20 226d 656d 6f72 7922 2c0d  str = "memory",.
+0000c370: 0a20 2020 2029 202d 3e20 556e 696f 6e5b  .    ) -> Union[
+0000c380: 4765 6f44 6174 6146 7261 6d65 2c20 4e6f  GeoDataFrame, No
+0000c390: 6e65 5d3a 0d0a 2020 2020 2020 2020 2222  ne]:..        ""
+0000c3a0: 2270 6f6c 7967 6f6e 697a 652e 0d0a 0d0a  "polygonize.....
+0000c3b0: 2020 2020 2020 2020 2020 2020 5261 7374              Rast
+0000c3c0: 6572 546f 506f 6c79 676f 6e20 7461 6b65  erToPolygon take
+0000c3d0: 7320 6120 6764 616c 2044 6174 6163 7562  s a gdal Datacub
+0000c3e0: 6520 6f62 6a65 6374 2061 6e64 2067 726f  e object and gro
+0000c3f0: 7570 206e 6569 6768 626f 7269 6e67 2063  up neighboring c
+0000c400: 656c 6c73 2077 6974 6820 7468 6520 7361  ells with the sa
+0000c410: 6d65 2076 616c 7565 2069 6e74 6f20 6f6e  me value into on
+0000c420: 650d 0a20 2020 2020 2020 2020 2020 2070  e..            p
+0000c430: 6f6c 7967 6f6e 2c20 7468 6520 7265 7375  olygon, the resu
+0000c440: 6c74 6564 2076 6563 746f 7220 7769 6c6c  lted vector will
+0000c450: 2062 6520 7361 7665 6420 746f 2064 6973   be saved to dis
+0000c460: 6b20 6173 2061 2067 656f 6a73 6f6e 2066  k as a geojson f
+0000c470: 696c 650d 0a0d 0a20 2020 2020 2020 2050  ile....        P
+0000c480: 6172 616d 6574 6572 730d 0a20 2020 2020  arameters..     
+0000c490: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20     ----------.. 
+0000c4a0: 2020 2020 2020 2062 616e 643a 205b 696e         band: [in
+0000c4b0: 745d 0d0a 2020 2020 2020 2020 2020 2020  t]..            
+0000c4c0: 7261 7374 6572 2062 616e 6420 696e 6465  raster band inde
+0000c4d0: 7820 5b31 2c32 2c33 2c2e 2e5d 0d0a 2020  x [1,2,3,..]..  
+0000c4e0: 2020 2020 2020 7061 7468 3a5b 7374 725d        path:[str]
+0000c4f0: 0d0a 2020 2020 2020 2020 2020 2020 7061  ..            pa
+0000c500: 7468 2077 6865 7265 2079 6f75 2077 616e  th where you wan
+0000c510: 7420 746f 2073 6176 6520 7468 6520 706f  t to save the po
+0000c520: 6c79 676f 6e2c 2074 6865 2070 6174 6820  lygon, the path 
+0000c530: 7368 6f75 6c64 2069 6e63 6c75 6465 2074  should include t
+0000c540: 6865 2065 7874 656e 7369 6f6e 2061 7420  he extension at 
+0000c550: 7468 6520 656e 640d 0a20 2020 2020 2020  the end..       
+0000c560: 2020 2020 2028 692e 652e 2070 6174 682f       (i.e. path/
+0000c570: 7665 6374 6f72 5f6e 616d 652e 6765 6f6a  vector_name.geoj
+0000c580: 736f 6e29 0d0a 2020 2020 2020 2020 636f  son)..        co
+0000c590: 6c5f 6e61 6d65 3a0d 0a20 2020 2020 2020  l_name:..       
+0000c5a0: 2020 2020 206e 616d 6520 6f66 2074 6865       name of the
+0000c5b0: 2063 6f6c 756d 6e20 7768 6572 6520 7468   column where th
+0000c5c0: 6520 7261 7374 6572 2064 6174 6120 7769  e raster data wi
+0000c5d0: 6c6c 2062 6520 7374 6f72 6564 2e0d 0a20  ll be stored... 
+0000c5e0: 2020 2020 2020 2064 7269 7665 723a 205b         driver: [
+0000c5f0: 7374 725d 0d0a 2020 2020 2020 2020 2020  str]..          
+0000c600: 2020 7665 6374 6f72 2064 7269 7665 722c    vector driver,
+0000c610: 2066 6f72 2061 6c6c 2070 6f73 7369 626c   for all possibl
+0000c620: 6520 6472 6976 6572 7320 6368 6563 6b20  e drivers check 
+0000c630: 6874 7470 733a 2f2f 6764 616c 2e6f 7267  https://gdal.org
+0000c640: 2f64 7269 7665 7273 2f76 6563 746f 722f  /drivers/vector/
+0000c650: 696e 6465 782e 6874 6d6c 202e 0d0a 2020  index.html ...  
+0000c660: 2020 2020 2020 2020 2020 4465 6661 756c            Defaul
+0000c670: 7420 6973 2022 4765 6f4a 534f 4e22 2e0d  t is "GeoJSON"..
+0000c680: 0a0d 0a20 2020 2020 2020 2052 6574 7572  ...        Retur
+0000c690: 6e73 0d0a 2020 2020 2020 2020 2d2d 2d2d  ns..        ----
+0000c6a0: 2d2d 2d0d 0a20 2020 2020 2020 204e 6f6e  ---..        Non
+0000c6b0: 650d 0a20 2020 2020 2020 2022 2222 0d0a  e..        """..
+0000c6c0: 2020 2020 2020 2020 6261 6e64 203d 2073          band = s
+0000c6d0: 656c 662e 7261 7374 6572 2e47 6574 5261  elf.raster.GetRa
+0000c6e0: 7374 6572 4261 6e64 2862 616e 6420 2b20  sterBand(band + 
+0000c6f0: 3129 0d0a 2020 2020 2020 2020 7372 7320  1)..        srs 
+0000c700: 3d20 6f73 722e 5370 6174 6961 6c52 6566  = osr.SpatialRef
+0000c710: 6572 656e 6365 2877 6b74 3d73 656c 662e  erence(wkt=self.
+0000c720: 6372 7329 0d0a 2020 2020 2020 2020 6966  crs)..        if
+0000c730: 2070 6174 6820 6973 204e 6f6e 653a 0d0a   path is None:..
+0000c740: 2020 2020 2020 2020 2020 2020 6473 745f              dst_
+0000c750: 6c61 7965 726e 616d 6520 3d20 2269 6422  layername = "id"
+0000c760: 0d0a 2020 2020 2020 2020 656c 7365 3a0d  ..        else:.
+0000c770: 0a20 2020 2020 2020 2020 2020 2064 7374  .            dst
+0000c780: 5f6c 6179 6572 6e61 6d65 203d 2070 6174  _layername = pat
+0000c790: 682e 7370 6c69 7428 222e 2229 5b30 5d2e  h.split(".")[0].
+0000c7a0: 7370 6c69 7428 222f 2229 5b2d 315d 0d0a  split("/")[-1]..
+0000c7b0: 0d0a 2020 2020 2020 2020 6473 745f 6473  ..        dst_ds
+0000c7c0: 203d 2046 6561 7475 7265 436f 6c6c 6563   = FeatureCollec
+0000c7d0: 7469 6f6e 2e63 7265 6174 655f 6473 2864  tion.create_ds(d
+0000c7e0: 7269 7665 722c 2070 6174 6829 0d0a 2020  river, path)..  
+0000c7f0: 2020 2020 2020 6473 745f 6c61 7965 7220        dst_layer 
+0000c800: 3d20 6473 745f 6473 2e43 7265 6174 654c  = dst_ds.CreateL
+0000c810: 6179 6572 2864 7374 5f6c 6179 6572 6e61  ayer(dst_layerna
+0000c820: 6d65 2c20 7372 733d 7372 7329 0d0a 2020  me, srs=srs)..  
+0000c830: 2020 2020 2020 6474 7970 6520 3d20 6764        dtype = gd
+0000c840: 616c 5f74 6f5f 6f67 725f 6474 7970 6528  al_to_ogr_dtype(
+0000c850: 7365 6c66 2e72 6173 7465 7229 0d0a 2020  self.raster)..  
+0000c860: 2020 2020 2020 6e65 7746 6965 6c64 203d        newField =
+0000c870: 206f 6772 2e46 6965 6c64 4465 666e 2863   ogr.FieldDefn(c
+0000c880: 6f6c 5f6e 616d 652c 2064 7479 7065 290d  ol_name, dtype).
+0000c890: 0a20 2020 2020 2020 2064 7374 5f6c 6179  .        dst_lay
+0000c8a0: 6572 2e43 7265 6174 6546 6965 6c64 286e  er.CreateField(n
+0000c8b0: 6577 4669 656c 6429 0d0a 2020 2020 2020  ewField)..      
+0000c8c0: 2020 6764 616c 2e50 6f6c 7967 6f6e 697a    gdal.Polygoniz
+0000c8d0: 6528 6261 6e64 2c20 6261 6e64 2c20 6473  e(band, band, ds
+0000c8e0: 745f 6c61 7965 722c 2030 2c20 5b5d 2c20  t_layer, 0, [], 
+0000c8f0: 6361 6c6c 6261 636b 3d4e 6f6e 6529 0d0a  callback=None)..
+0000c900: 2020 2020 2020 2020 6966 2070 6174 683a          if path:
+0000c910: 0d0a 2020 2020 2020 2020 2020 2020 6473  ..            ds
+0000c920: 745f 6c61 7965 7220 3d20 4e6f 6e65 0d0a  t_layer = None..
+0000c930: 2020 2020 2020 2020 2020 2020 6473 745f              dst_
+0000c940: 6473 203d 204e 6f6e 650d 0a20 2020 2020  ds = None..     
+0000c950: 2020 2065 6c73 653a 0d0a 2020 2020 2020     else:..      
+0000c960: 2020 2020 2020 7665 6374 6f72 203d 2046        vector = F
+0000c970: 6561 7475 7265 436f 6c6c 6563 7469 6f6e  eatureCollection
+0000c980: 2864 7374 5f64 7329 0d0a 2020 2020 2020  (dst_ds)..      
+0000c990: 2020 2020 2020 6764 6620 3d20 7665 6374        gdf = vect
+0000c9a0: 6f72 2e5f 6473 5f74 6f5f 6764 6628 290d  or._ds_to_gdf().
+0000c9b0: 0a20 2020 2020 2020 2020 2020 2072 6574  .            ret
+0000c9c0: 7572 6e20 6764 660d 0a0d 0a20 2020 2064  urn gdf....    d
+0000c9d0: 6566 2074 6f5f 6765 6f64 6174 6166 7261  ef to_geodatafra
+0000c9e0: 6d65 280d 0a20 2020 2020 2020 2073 656c  me(..        sel
+0000c9f0: 662c 0d0a 2020 2020 2020 2020 7665 6374  f,..        vect
+0000ca00: 6f72 5f6d 6173 6b3a 2055 6e69 6f6e 5b73  or_mask: Union[s
+0000ca10: 7472 2c20 4765 6f44 6174 6146 7261 6d65  tr, GeoDataFrame
+0000ca20: 5d20 3d20 4e6f 6e65 2c0d 0a20 2020 2020  ] = None,..     
+0000ca30: 2020 2061 6464 5f67 656f 6d65 7472 793a     add_geometry:
+0000ca40: 2073 7472 203d 204e 6f6e 652c 0d0a 2020   str = None,..  
+0000ca50: 2020 2020 2020 7469 6c65 3a20 626f 6f6c        tile: bool
+0000ca60: 203d 2046 616c 7365 2c0d 0a20 2020 2020   = False,..     
+0000ca70: 2020 2074 696c 655f 7369 7a65 3a20 696e     tile_size: in
+0000ca80: 7420 3d20 3135 3030 2c0d 0a20 2020 2029  t = 1500,..    )
+0000ca90: 202d 3e20 556e 696f 6e5b 4461 7461 4672   -> Union[DataFr
+0000caa0: 616d 652c 2047 656f 4461 7461 4672 616d  ame, GeoDataFram
+0000cab0: 655d 3a0d 0a20 2020 2020 2020 2022 2222  e]:..        """
+0000cac0: 436f 6e76 6572 7420 6120 7261 7374 6572  Convert a raster
+0000cad0: 2074 6f20 6120 4765 6f44 6174 6146 7261   to a GeoDataFra
+0000cae0: 6d65 2e0d 0a0d 0a20 2020 2020 2020 2020  me.....         
+0000caf0: 2020 2054 6865 2066 756e 6374 696f 6e20     The function 
+0000cb00: 646f 2074 6865 2066 6f6c 6c6f 7769 6e67  do the following
+0000cb10: 0d0a 2020 2020 2020 2020 2020 2020 2d20  ..            - 
+0000cb20: 466c 6174 7465 6e20 7468 6520 6172 7261  Flatten the arra
+0000cb30: 7920 696e 2065 6163 6820 6261 6e64 2069  y in each band i
+0000cb40: 6e20 7468 6520 7261 7374 6572 2074 6865  n the raster the
+0000cb50: 6e20 6d61 736b 2074 6865 2076 616c 7565  n mask the value
+0000cb60: 7320 6966 2061 2076 6563 746f 725f 6d61  s if a vector_ma
+0000cb70: 736b 0d0a 2020 2020 2020 2020 2020 2020  sk..            
+0000cb80: 6669 6c65 2069 7320 6769 7665 6e20 6f74  file is given ot
+0000cb90: 6865 7277 6973 6520 6974 2077 696c 6c20  herwise it will 
+0000cba0: 666c 6174 7465 6e20 616c 6c20 7661 6c75  flatten all valu
+0000cbb0: 6573 2e0d 0a20 2020 2020 2020 2020 2020  es...           
+0000cbc0: 202d 2050 7574 2074 6865 2076 616c 7565   - Put the value
+0000cbd0: 7320 666f 7220 6561 6368 2062 616e 6420  s for each band 
+0000cbe0: 696e 2061 2063 6f6c 756d 6e20 696e 2061  in a column in a
+0000cbf0: 2064 6174 6166 7261 6d65 2075 6e64 6572   dataframe under
+0000cc00: 2074 6865 206e 616d 6520 6f66 2074 6865   the name of the
+0000cc10: 2072 6173 7465 7220 6261 6e64 2c20 6275   raster band, bu
+0000cc20: 7420 6966 206e 6f20 6d65 7461 0d0a 2020  t if no meta..  
+0000cc30: 2020 2020 2020 2020 2020 6461 7461 2069            data i
+0000cc40: 6e20 7468 6520 7261 7374 6572 2062 616e  n the raster ban
+0000cc50: 6420 6578 6973 7473 2c20 616e 2069 6e64  d exists, an ind
+0000cc60: 6578 206e 756d 6265 7220 7769 6c6c 2062  ex number will b
+0000cc70: 6520 7573 6564 205b 312c 2032 2c20 332c  e used [1, 2, 3,
+0000cc80: 202e 2e2e 5d0d 0a20 2020 2020 2020 2020   ...]..         
+0000cc90: 2020 202d 2054 6865 2066 756e 6374 696f     - The functio
+0000cca0: 6e20 6861 7320 6120 6164 645f 6765 6f6d  n has a add_geom
+0000ccb0: 6574 7279 2070 6172 616d 6574 6572 2077  etry parameter w
+0000ccc0: 6974 6820 7477 6f20 706f 7373 6962 6c65  ith two possible
+0000ccd0: 2076 616c 7565 7320 5b22 706f 696e 7422   values ["point"
+0000cce0: 2c20 2270 6f6c 7967 6f6e 225d 2c20 7768  , "polygon"], wh
+0000ccf0: 6963 6820 796f 7520 6361 6e0d 0a20 2020  ich you can..   
+0000cd00: 2020 2020 2020 2020 2073 7065 6369 6679           specify
+0000cd10: 2074 6865 2074 7970 6520 6f66 2073 6861   the type of sha
+0000cd20: 7065 6c79 2067 656f 6d65 7472 7920 796f  pely geometry yo
+0000cd30: 7520 7761 6e74 2074 6f20 6372 6561 7465  u want to create
+0000cd40: 2066 726f 6d20 6561 6368 2063 656c 6c2c   from each cell,
+0000cd50: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000cd60: 2020 2d20 4966 2070 6f69 6e74 2069 7320    - If point is 
+0000cd70: 6368 6f73 656e 2c20 7468 6520 6372 6561  chosen, the crea
+0000cd80: 7465 6420 706f 696e 7420 7769 6c6c 2062  ted point will b
+0000cd90: 6520 6174 2074 6865 2063 656e 7465 7220  e at the center 
+0000cda0: 6f66 2065 6163 6820 6365 6c6c 0d0a 2020  of each cell..  
+0000cdb0: 2020 2020 2020 2020 2020 2020 2020 2d20                - 
+0000cdc0: 4966 2061 2070 6f6c 7967 6f6e 2069 7320  If a polygon is 
+0000cdd0: 6368 6f73 656e 2c20 6120 7371 7561 7265  chosen, a square
+0000cde0: 2070 6f6c 7967 6f6e 2077 696c 6c20 6265   polygon will be
+0000cdf0: 2063 7265 6174 6564 2074 6861 7420 636f   created that co
+0000ce00: 7665 7273 2074 6865 2065 6e74 6972 6520  vers the entire 
+0000ce10: 6365 6c6c 2e0d 0a0d 0a20 2020 2020 2020  cell.....       
+0000ce20: 2050 6172 616d 6574 6572 730d 0a20 2020   Parameters..   
+0000ce30: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d       ----------.
+0000ce40: 0a20 2020 2020 2020 2076 6563 746f 725f  .        vector_
+0000ce50: 6d61 736b 203a 204f 7074 696f 6e61 6c5b  mask : Optional[
+0000ce60: 4765 6f44 6174 6146 7261 6d65 2f73 7472  GeoDataFrame/str
+0000ce70: 5d0d 0a20 2020 2020 2020 2020 2020 2047  ]..            G
+0000ce80: 656f 4461 7461 4672 616d 6520 666f 7220  eoDataFrame for 
+0000ce90: 7468 6520 7665 6374 6f72 5f6d 6173 6b20  the vector_mask 
+0000cea0: 6669 6c65 2070 6174 6820 746f 2076 6563  file path to vec
+0000ceb0: 746f 725f 6d61 736b 2066 696c 652e 2049  tor_mask file. I
+0000cec0: 6620 6769 7665 6e2c 2069 7420 7769 6c6c  f given, it will
+0000ced0: 2062 6520 7573 6564 2074 6f20 636c 6970   be used to clip
+0000cee0: 2074 6865 2072 6173 7465 720d 0a20 2020   the raster..   
+0000cef0: 2020 2020 2061 6464 5f67 656f 6d65 7472       add_geometr
+0000cf00: 793a 205b 7374 725d 0d0a 2020 2020 2020  y: [str]..      
+0000cf10: 2020 2020 2020 2250 6f6c 7967 6f6e 222c        "Polygon",
+0000cf20: 206f 7220 2250 6f69 6e74 2220 6966 2079   or "Point" if y
+0000cf30: 6f75 2077 616e 7420 746f 2061 6464 2061  ou want to add a
+0000cf40: 2070 6f6c 7967 6f6e 2067 656f 6d65 7472   polygon geometr
+0000cf50: 7920 6f66 2074 6865 2063 656c 6c73 2061  y of the cells a
+0000cf60: 7320 2063 6f6c 756d 6e20 696e 2064 6174  s  column in dat
+0000cf70: 6166 7261 6d65 2e0d 0a20 2020 2020 2020  aframe...       
+0000cf80: 2020 2020 2044 6566 6175 6c74 2069 7320       Default is 
+0000cf90: 4e6f 6e65 2e0d 0a20 2020 2020 2020 2074  None...        t
+0000cfa0: 696c 653a 205b 626f 6f6c 5d0d 0a20 2020  ile: [bool]..   
+0000cfb0: 2020 2020 2020 2020 2054 7275 6520 746f           True to
+0000cfc0: 2075 7365 2074 696c 6573 2069 6e20 6578   use tiles in ex
+0000cfd0: 7472 6163 7469 6e67 2074 6865 2076 616c  tracting the val
+0000cfe0: 7565 7320 6672 6f6d 2074 6865 2072 6173  ues from the ras
+0000cff0: 7465 722e 2044 6566 6175 6c74 2069 7320  ter. Default is 
+0000d000: 4661 6c73 652e 0d0a 2020 2020 2020 2020  False...        
+0000d010: 7469 6c65 5f73 697a 653a 205b 696e 745d  tile_size: [int]
+0000d020: 0d0a 2020 2020 2020 2020 2020 2020 7469  ..            ti
+0000d030: 6c65 2073 697a 652e 2044 6566 6175 6c74  le size. Default
+0000d040: 2069 7320 3135 3030 2e0d 0a0d 0a20 2020   is 1500.....   
+0000d050: 2020 2020 2052 6574 7572 6e73 0d0a 2020       Returns..  
+0000d060: 2020 2020 2020 2d2d 2d2d 2d2d 2d0d 0a20        -------.. 
+0000d070: 2020 2020 2020 2044 6174 6146 7261 6d65         DataFrame
+0000d080: 2f47 656f 4461 7461 4672 616d 650d 0a20  /GeoDataFrame.. 
+0000d090: 2020 2020 2020 2020 2020 2063 6f6c 756d             colum
+0000d0a0: 6e64 4c3a 0d0a 2020 2020 2020 2020 2020  ndL:..          
+0000d0b0: 2020 2020 2020 3e3e 3e20 7072 696e 7428        >>> print(
+0000d0c0: 6764 662e 636f 6c75 6d6e 7329 0d0a 2020  gdf.columns)..  
+0000d0d0: 2020 2020 2020 2020 2020 2020 2020 3e3e                >>
+0000d0e0: 3e20 496e 6465 7828 5b27 4261 6e64 5f31  > Index(['Band_1
+0000d0f0: 272c 2027 6765 6f6d 6574 7279 275d 2c20  ', 'geometry'], 
+0000d100: 6474 7970 653d 276f 626a 6563 7427 290d  dtype='object').
+0000d110: 0a0d 0a20 2020 2020 2020 2074 6865 2072  ...        the r
+0000d120: 6573 756c 7465 6420 6765 6f64 6174 6166  esulted geodataf
+0000d130: 7261 6d65 2077 696c 6c20 6861 7665 2074  rame will have t
+0000d140: 6865 2062 616e 6420 7661 6c75 6520 756e  he band value un
+0000d150: 6465 7220 7468 6520 6e61 6d65 206f 6620  der the name of 
+0000d160: 7468 6520 6261 6e64 2028 6966 2074 6865  the band (if the
+0000d170: 2072 6173 7465 7220 6669 6c65 2068 6173   raster file has
+0000d180: 2061 206d 6574 6164 6174 612c 0d0a 2020   a metadata,..  
+0000d190: 2020 2020 2020 6966 206e 6f74 2c20 7468        if not, th
+0000d1a0: 6520 6261 6e64 7320 7769 6c6c 2062 6520  e bands will be 
+0000d1b0: 696e 6465 7865 6420 6672 6f6d 2031 2074  indexed from 1 t
+0000d1c0: 6f20 7468 6520 6e75 6d62 6572 206f 6620  o the number of 
+0000d1d0: 6261 6e64 7329 0d0a 2020 2020 2020 2020  bands)..        
+0000d1e0: 2222 220d 0a20 2020 2020 2020 2074 656d  """..        tem
+0000d1f0: 705f 6469 7220 3d20 4e6f 6e65 0d0a 0d0a  p_dir = None....
+0000d200: 2020 2020 2020 2020 2320 4765 7420 7261          # Get ra
+0000d210: 7374 6572 2062 616e 6420 6e61 6d65 732e  ster band names.
+0000d220: 206f 7065 6e20 7468 6520 6461 7461 7365   open the datase
+0000d230: 7420 7573 696e 6720 6764 616c 2e4f 7065  t using gdal.Ope
+0000d240: 6e0d 0a20 2020 2020 2020 2062 616e 645f  n..        band_
+0000d250: 6e61 6d65 7320 3d20 7365 6c66 2e67 6574  names = self.get
+0000d260: 5f62 616e 645f 6e61 6d65 7328 290d 0a0d  _band_names()...
+0000d270: 0a20 2020 2020 2020 2023 2043 7265 6174  .        # Creat
+0000d280: 6520 6120 6d61 736b 2066 726f 6d20 7468  e a mask from th
+0000d290: 6520 7069 7865 6c73 2074 6f75 6368 6564  e pixels touched
+0000d2a0: 2062 7920 7468 6520 7665 6374 6f72 5f6d   by the vector_m
+0000d2b0: 6173 6b2e 0d0a 2020 2020 2020 2020 6966  ask...        if
+0000d2c0: 2076 6563 746f 725f 6d61 736b 2069 7320   vector_mask is 
+0000d2d0: 6e6f 7420 4e6f 6e65 3a0d 0a20 2020 2020  not None:..     
+0000d2e0: 2020 2020 2020 2023 2043 7265 6174 6520         # Create 
+0000d2f0: 6120 7465 6d70 6f72 6172 7920 6469 7265  a temporary dire
+0000d300: 6374 6f72 7920 666f 7220 6669 6c65 732e  ctory for files.
+0000d310: 0d0a 2020 2020 2020 2020 2020 2020 7465  ..            te
+0000d320: 6d70 5f64 6972 203d 2074 656d 7066 696c  mp_dir = tempfil
+0000d330: 652e 6d6b 6474 656d 7028 290d 0a20 2020  e.mkdtemp()..   
+0000d340: 2020 2020 2020 2020 206e 6577 5f76 6563           new_vec
+0000d350: 746f 725f 7061 7468 203d 206f 732e 7061  tor_path = os.pa
+0000d360: 7468 2e6a 6f69 6e28 7465 6d70 5f64 6972  th.join(temp_dir
+0000d370: 2c20 6622 7b75 7569 642e 7575 6964 3128  , f"{uuid.uuid1(
+0000d380: 297d 2229 0d0a 0d0a 2020 2020 2020 2020  )}")....        
+0000d390: 2020 2020 2320 7265 6164 2074 6865 2076      # read the v
+0000d3a0: 6563 746f 7220 7769 7468 2067 656f 7061  ector with geopa
+0000d3b0: 6e64 6173 0d0a 2020 2020 2020 2020 2020  ndas..          
+0000d3c0: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
+0000d3d0: 7665 6374 6f72 5f6d 6173 6b2c 2047 656f  vector_mask, Geo
+0000d3e0: 4461 7461 4672 616d 6529 3a0d 0a20 2020  DataFrame):..   
+0000d3f0: 2020 2020 2020 2020 2020 2020 2076 6563               vec
+0000d400: 746f 7220 3d20 4665 6174 7572 6543 6f6c  tor = FeatureCol
+0000d410: 6c65 6374 696f 6e28 7665 6374 6f72 5f6d  lection(vector_m
+0000d420: 6173 6b29 0d0a 2020 2020 2020 2020 2020  ask)..          
+0000d430: 2020 656c 6966 2069 7369 6e73 7461 6e63    elif isinstanc
+0000d440: 6528 7665 6374 6f72 5f6d 6173 6b2c 2046  e(vector_mask, F
+0000d450: 6561 7475 7265 436f 6c6c 6563 7469 6f6e  eatureCollection
+0000d460: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
+0000d470: 2020 2020 7665 6374 6f72 203d 2076 6563      vector = vec
+0000d480: 746f 725f 6d61 736b 0d0a 2020 2020 2020  tor_mask..      
+0000d490: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
+0000d4a0: 2020 2020 2020 2020 2020 2020 2072 6169               rai
+0000d4b0: 7365 2054 7970 6545 7272 6f72 280d 0a20  se TypeError(.. 
+0000d4c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d4d0: 2020 2066 2254 6865 2076 6563 746f 725f     f"The vector_
+0000d4e0: 6d61 736b 2073 686f 756c 6420 6265 206f  mask should be o
+0000d4f0: 6620 7479 7065 3a20 5b47 656f 4461 7461  f type: [GeoData
+0000d500: 4672 616d 652f 4665 6174 7572 6543 6f6c  Frame/FeatureCol
+0000d510: 6c65 6374 696f 6e5d 2c20 6769 7665 6e3a  lection], given:
+0000d520: 2022 0d0a 2020 2020 2020 2020 2020 2020   "..            
+0000d530: 2020 2020 2020 2020 6622 7b74 7970 6528          f"{type(
+0000d540: 7665 6374 6f72 5f6d 6173 6b29 7d22 0d0a  vector_mask)}"..
+0000d550: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000d560: 290d 0a0d 0a20 2020 2020 2020 2020 2020  )....           
+0000d570: 2023 2061 6464 2061 2075 6e69 7175 6520   # add a unique 
+0000d580: 7661 6c75 6520 666f 7220 6561 6368 2072  value for each r
+0000d590: 6f77 7320 746f 2075 7365 2069 7420 746f  ows to use it to
+0000d5a0: 2072 6173 7465 7269 7a65 2074 6865 2076   rasterize the v
+0000d5b0: 6563 746f 720d 0a20 2020 2020 2020 2020  ector..         
+0000d5c0: 2020 2076 6563 746f 722e 6665 6174 7572     vector.featur
+0000d5d0: 655b 2262 7572 6e5f 7661 6c75 6522 5d20  e["burn_value"] 
+0000d5e0: 3d20 6c69 7374 2872 616e 6765 2831 2c20  = list(range(1, 
+0000d5f0: 6c65 6e28 7665 6374 6f72 2e66 6561 7475  len(vector.featu
+0000d600: 7265 2920 2b20 3129 290d 0a20 2020 2020  re) + 1))..     
+0000d610: 2020 2020 2020 2023 2073 6176 6520 7468         # save th
+0000d620: 6520 6e65 7720 7665 6374 6f72 2074 6f20  e new vector to 
+0000d630: 6469 736b 2074 6f20 7265 6164 2069 7420  disk to read it 
+0000d640: 7769 7468 206f 6772 206c 6174 6572 0d0a  with ogr later..
+0000d650: 2020 2020 2020 2020 2020 2020 7665 6374              vect
+0000d660: 6f72 2e66 6561 7475 7265 2e74 6f5f 6669  or.feature.to_fi
+0000d670: 6c65 286e 6577 5f76 6563 746f 725f 7061  le(new_vector_pa
+0000d680: 7468 2c20 6472 6976 6572 3d22 4765 6f4a  th, driver="GeoJ
+0000d690: 534f 4e22 290d 0a0d 0a20 2020 2020 2020  SON")....       
+0000d6a0: 2020 2020 2023 2072 6173 7465 7269 7a65       # rasterize
+0000d6b0: 2074 6865 2076 6563 746f 7220 6279 2062   the vector by b
+0000d6c0: 7572 6e69 6e67 2074 6865 2075 6e69 7175  urning the uniqu
+0000d6d0: 6520 7661 6c75 6573 2061 7320 6365 6c6c  e values as cell
+0000d6e0: 2076 616c 7565 732e 0d0a 2020 2020 2020   values...      
+0000d6f0: 2020 2020 2020 2320 7261 7374 6572 697a        # rasteriz
+0000d700: 6564 5f76 6563 746f 725f 7061 7468 203d  ed_vector_path =
+0000d710: 206f 732e 7061 7468 2e6a 6f69 6e28 7465   os.path.join(te
+0000d720: 6d70 5f64 6972 2c20 6622 7b75 7569 642e  mp_dir, f"{uuid.
+0000d730: 7575 6964 3128 297d 2e74 6966 2229 0d0a  uuid1()}.tif")..
+0000d740: 2020 2020 2020 2020 2020 2020 7261 7374              rast
+0000d750: 6572 697a 6564 5f76 6563 746f 7220 3d20  erized_vector = 
+0000d760: 7665 6374 6f72 2e74 6f5f 6461 7461 7365  vector.to_datase
+0000d770: 7428 0d0a 2020 2020 2020 2020 2020 2020  t(..            
+0000d780: 2020 2020 6461 7461 7365 743d 7365 6c66      dataset=self
+0000d790: 2c20 636f 6c75 6d6e 5f6e 616d 653d 2262  , column_name="b
+0000d7a0: 7572 6e5f 7661 6c75 6522 0d0a 2020 2020  urn_value"..    
+0000d7b0: 2020 2020 2020 2020 2920 2023 2072 6173          )  # ras
+0000d7c0: 7465 7269 7a65 645f 7665 6374 6f72 5f70  terized_vector_p
+0000d7d0: 6174 682c 0d0a 2020 2020 2020 2020 2020  ath,..          
+0000d7e0: 2020 6966 2061 6464 5f67 656f 6d65 7472    if add_geometr
+0000d7f0: 793a 0d0a 2020 2020 2020 2020 2020 2020  y:..            
+0000d800: 2020 2020 6966 2061 6464 5f67 656f 6d65      if add_geome
+0000d810: 7472 792e 6c6f 7765 7228 2920 3d3d 2022  try.lower() == "
+0000d820: 706f 696e 7422 3a0d 0a20 2020 2020 2020  point":..       
+0000d830: 2020 2020 2020 2020 2020 2020 2063 6f6f               coo
+0000d840: 7264 7320 3d20 7261 7374 6572 697a 6564  rds = rasterized
+0000d850: 5f76 6563 746f 722e 6765 745f 6365 6c6c  _vector.get_cell
+0000d860: 5f70 6f69 6e74 7328 6d61 736b 3d54 7275  _points(mask=Tru
+0000d870: 6529 0d0a 2020 2020 2020 2020 2020 2020  e)..            
+0000d880: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
+0000d890: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+0000d8a0: 6f6f 7264 7320 3d20 7261 7374 6572 697a  oords = rasteriz
+0000d8b0: 6564 5f76 6563 746f 722e 6765 745f 6365  ed_vector.get_ce
+0000d8c0: 6c6c 5f70 6f6c 7967 6f6e 7328 6d61 736b  ll_polygons(mask
+0000d8d0: 3d54 7275 6529 0d0a 0d0a 2020 2020 2020  =True)....      
+0000d8e0: 2020 2020 2020 2320 4c6f 6f70 206f 7665        # Loop ove
+0000d8f0: 7220 6d61 736b 2076 616c 7565 7320 746f  r mask values to
+0000d900: 2065 7874 7261 6374 2070 6978 656c 732e   extract pixels.
+0000d910: 0d0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
+0000d920: 4461 7461 4672 616d 6573 206f 6620 6561  DataFrames of ea
+0000d930: 6368 2074 696c 652e 0d0a 2020 2020 2020  ch tile...      
+0000d940: 2020 2020 2020 6466 5f6c 6973 7420 3d20        df_list = 
+0000d950: 5b5d 0d0a 2020 2020 2020 2020 2020 2020  []..            
+0000d960: 6d61 736b 5f61 7272 203d 2072 6173 7465  mask_arr = raste
+0000d970: 7269 7a65 645f 7665 6374 6f72 2e72 6173  rized_vector.ras
+0000d980: 7465 722e 4765 7452 6173 7465 7242 616e  ter.GetRasterBan
+0000d990: 6428 3129 2e52 6561 6441 7341 7272 6179  d(1).ReadAsArray
+0000d9a0: 2829 0d0a 0d0a 2020 2020 2020 2020 2020  ()....          
+0000d9b0: 2020 666f 7220 6172 7220 696e 2073 656c    for arr in sel
+0000d9c0: 662e 6765 745f 7469 6c65 2874 696c 655f  f.get_tile(tile_
+0000d9d0: 7369 7a65 293a 0d0a 0d0a 2020 2020 2020  size):....      
+0000d9e0: 2020 2020 2020 2020 2020 6d61 736b 5f64            mask_d
+0000d9f0: 6673 203d 205b 5d0d 0a20 2020 2020 2020  fs = []..       
+0000da00: 2020 2020 2020 2020 2066 6f72 206d 6173           for mas
+0000da10: 6b5f 7661 6c20 696e 2076 6563 746f 722e  k_val in vector.
+0000da20: 6665 6174 7572 655b 2262 7572 6e5f 7661  feature["burn_va
+0000da30: 6c75 6522 5d2e 7661 6c75 6573 3a0d 0a20  lue"].values:.. 
+0000da40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000da50: 2020 2023 2045 7874 7261 6374 206f 6e6c     # Extract onl
+0000da60: 7920 6d61 736b 6564 2070 6978 656c 732e  y masked pixels.
+0000da70: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0000da80: 2020 2020 2020 666c 6174 7465 6e5f 6d61        flatten_ma
+0000da90: 736b 6564 5f76 616c 7565 7320 3d20 6765  sked_values = ge
+0000daa0: 745f 7069 7865 6c73 280d 0a20 2020 2020  t_pixels(..     
+0000dab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000dac0: 2020 2061 7272 2c20 6d61 736b 5f61 7272     arr, mask_arr
+0000dad0: 2c20 6d61 736b 5f76 616c 3d6d 6173 6b5f  , mask_val=mask_
+0000dae0: 7661 6c0d 0a20 2020 2020 2020 2020 2020  val..           
+0000daf0: 2020 2020 2020 2020 2029 2e74 7261 6e73           ).trans
+0000db00: 706f 7365 2829 0d0a 2020 2020 2020 2020  pose()..        
+0000db10: 2020 2020 2020 2020 2020 2020 6669 645f              fid_
+0000db20: 7078 203d 206e 702e 6f6e 6573 2866 6c61  px = np.ones(fla
+0000db30: 7474 656e 5f6d 6173 6b65 645f 7661 6c75  tten_masked_valu
+0000db40: 6573 2e73 6861 7065 5b30 5d29 202a 206d  es.shape[0]) * m
+0000db50: 6173 6b5f 7661 6c0d 0a0d 0a20 2020 2020  ask_val....     
+0000db60: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+0000db70: 2043 7265 6174 6520 6120 4461 7461 4672   Create a DataFr
+0000db80: 616d 6520 6f66 206d 6173 6b65 6420 666c  ame of masked fl
+0000db90: 6174 7465 6e5f 6d61 736b 6564 5f76 616c  atten_masked_val
+0000dba0: 7565 7320 616e 6420 7468 6569 7220 4649  ues and their FI
+0000dbb0: 442e 0d0a 2020 2020 2020 2020 2020 2020  D...            
+0000dbc0: 2020 2020 2020 2020 6d61 736b 5f64 6620          mask_df 
+0000dbd0: 3d20 7064 2e44 6174 6146 7261 6d65 2866  = pd.DataFrame(f
+0000dbe0: 6c61 7474 656e 5f6d 6173 6b65 645f 7661  latten_masked_va
+0000dbf0: 6c75 6573 2c20 636f 6c75 6d6e 733d 6261  lues, columns=ba
+0000dc00: 6e64 5f6e 616d 6573 290d 0a20 2020 2020  nd_names)..     
+0000dc10: 2020 2020 2020 2020 2020 2020 2020 206d                 m
+0000dc20: 6173 6b5f 6466 5b22 6275 726e 5f76 616c  ask_df["burn_val
+0000dc30: 7565 225d 203d 2066 6964 5f70 780d 0a20  ue"] = fid_px.. 
+0000dc40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000dc50: 2020 206d 6173 6b5f 6466 732e 6170 7065     mask_dfs.appe
+0000dc60: 6e64 286d 6173 6b5f 6466 290d 0a0d 0a20  nd(mask_df).... 
+0000dc70: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+0000dc80: 2043 6f6e 6361 7420 7468 6520 6d61 736b   Concat the mask
+0000dc90: 2044 6174 6146 7261 6d65 732e 0d0a 2020   DataFrames...  
+0000dca0: 2020 2020 2020 2020 2020 2020 2020 6d61                ma
+0000dcb0: 736b 5f64 6620 3d20 7064 2e63 6f6e 6361  sk_df = pd.conca
+0000dcc0: 7428 6d61 736b 5f64 6673 290d 0a0d 0a20  t(mask_dfs).... 
+0000dcd0: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+0000dce0: 204a 6f69 6e20 7769 7468 2070 6978 656c   Join with pixel
+0000dcf0: 7320 7769 7468 2076 6563 746f 7220 6174  s with vector at
+0000dd00: 7472 6962 7574 6573 2075 7369 6e67 2074  tributes using t
+0000dd10: 6865 2046 4944 2e0d 0a20 2020 2020 2020  he FID...       
+0000dd20: 2020 2020 2020 2020 2064 665f 6c69 7374           df_list
+0000dd30: 2e61 7070 656e 6428 0d0a 2020 2020 2020  .append(..      
+0000dd40: 2020 2020 2020 2020 2020 2020 2020 6d61                ma
+0000dd50: 736b 5f64 662e 6d65 7267 6528 7665 6374  sk_df.merge(vect
+0000dd60: 6f72 2e66 6561 7475 7265 2c20 686f 773d  or.feature, how=
+0000dd70: 226c 6566 7422 2c20 6f6e 3d22 6275 726e  "left", on="burn
+0000dd80: 5f76 616c 7565 2229 0d0a 2020 2020 2020  _value")..      
+0000dd90: 2020 2020 2020 2020 2020 290d 0a0d 0a20            ).... 
+0000dda0: 2020 2020 2020 2020 2020 2023 204d 6572             # Mer
+0000ddb0: 6765 2061 6c6c 2074 6865 2074 696c 6573  ge all the tiles
+0000ddc0: 2e0d 0a20 2020 2020 2020 2020 2020 206f  ...            o
+0000ddd0: 7574 5f64 6620 3d20 7064 2e63 6f6e 6361  ut_df = pd.conca
+0000dde0: 7428 6466 5f6c 6973 7429 0d0a 2020 2020  t(df_list)..    
+0000ddf0: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
+0000de00: 2020 2020 2020 2069 6620 7469 6c65 3a0d         if tile:.
+0000de10: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000de20: 2064 665f 6c69 7374 203d 205b 5d20 2023   df_list = []  #
+0000de30: 2044 6174 6146 7261 6d65 7320 6f66 2065   DataFrames of e
+0000de40: 6163 6820 7469 6c65 2e0d 0a20 2020 2020  ach tile...     
+0000de50: 2020 2020 2020 2020 2020 2066 6f72 2061             for a
+0000de60: 7272 2069 6e20 4461 7461 7365 742e 6765  rr in Dataset.ge
+0000de70: 745f 7469 6c65 2873 656c 662e 7261 7374  t_tile(self.rast
+0000de80: 6572 293a 0d0a 2020 2020 2020 2020 2020  er):..          
+0000de90: 2020 2020 2020 2020 2020 2320 4173 7375            # Assu
+0000dea0: 6d65 206d 756c 7469 6261 6e64 0d0a 2020  me multiband..  
+0000deb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000dec0: 2020 6964 7820 3d20 2831 2c20 3229 0d0a    idx = (1, 2)..
+0000ded0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000dee0: 2020 2020 6966 2061 7272 2e6e 6469 6d20      if arr.ndim 
+0000def0: 3d3d 2032 3a0d 0a20 2020 2020 2020 2020  == 2:..         
+0000df00: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+0000df10: 2048 616e 646c 6520 7369 6e67 6c65 2062   Handle single b
+0000df20: 616e 6420 7261 7374 6572 730d 0a20 2020  and rasters..   
+0000df30: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000df40: 2020 2020 2069 6478 203d 2028 302c 2031       idx = (0, 1
+0000df50: 290d 0a0d 0a20 2020 2020 2020 2020 2020  )....           
+0000df60: 2020 2020 2020 2020 206d 6173 6b5f 6172           mask_ar
+0000df70: 7220 3d20 6e70 2e6f 6e65 7328 2861 7272  r = np.ones((arr
+0000df80: 2e73 6861 7065 5b69 6478 5b30 5d5d 2c20  .shape[idx[0]], 
+0000df90: 6172 722e 7368 6170 655b 6964 785b 315d  arr.shape[idx[1]
+0000dfa0: 5d29 290d 0a20 2020 2020 2020 2020 2020  ]))..           
+0000dfb0: 2020 2020 2020 2020 2070 6978 656c 7320           pixels 
+0000dfc0: 3d20 6765 745f 7069 7865 6c73 2861 7272  = get_pixels(arr
+0000dfd0: 2c20 6d61 736b 5f61 7272 292e 7472 616e  , mask_arr).tran
+0000dfe0: 7370 6f73 6528 290d 0a20 2020 2020 2020  spose()..       
+0000dff0: 2020 2020 2020 2020 2020 2020 2064 665f               df_
+0000e000: 6c69 7374 2e61 7070 656e 6428 7064 2e44  list.append(pd.D
+0000e010: 6174 6146 7261 6d65 2870 6978 656c 732c  ataFrame(pixels,
+0000e020: 2063 6f6c 756d 6e73 3d62 616e 645f 6e61   columns=band_na
+0000e030: 6d65 7329 290d 0a0d 0a20 2020 2020 2020  mes))....       
+0000e040: 2020 2020 2020 2020 2023 204d 6572 6765           # Merge
+0000e050: 2061 6c6c 2074 6865 2074 696c 6573 2e0d   all the tiles..
+0000e060: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000e070: 206f 7574 5f64 6620 3d20 7064 2e63 6f6e   out_df = pd.con
+0000e080: 6361 7428 6466 5f6c 6973 7429 0d0a 2020  cat(df_list)..  
+0000e090: 2020 2020 2020 2020 2020 656c 7365 3a0d            else:.
+0000e0a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000e0b0: 2023 2057 6172 6e69 6e67 3a20 6e6f 7420   # Warning: not 
+0000e0c0: 6368 6563 6b65 6420 7965 7420 666f 7220  checked yet for 
+0000e0d0: 6d75 6c74 6920 6261 6e64 730d 0a20 2020  multi bands..   
+0000e0e0: 2020 2020 2020 2020 2020 2020 2061 7272               arr
+0000e0f0: 203d 2073 656c 662e 7261 7374 6572 2e52   = self.raster.R
+0000e100: 6561 6441 7341 7272 6179 2829 0d0a 2020  eadAsArray()..  
+0000e110: 2020 2020 2020 2020 2020 2020 2020 7069                pi
+0000e120: 7865 6c73 203d 2061 7272 2e66 6c61 7474  xels = arr.flatt
+0000e130: 656e 2829 0d0a 2020 2020 2020 2020 2020  en()..          
+0000e140: 2020 2020 2020 6f75 745f 6466 203d 2070        out_df = p
+0000e150: 642e 4461 7461 4672 616d 6528 7069 7865  d.DataFrame(pixe
+0000e160: 6c73 2c20 636f 6c75 6d6e 733d 6261 6e64  ls, columns=band
+0000e170: 5f6e 616d 6573 290d 0a0d 0a20 2020 2020  _names)....     
+0000e180: 2020 2020 2020 2069 6620 6164 645f 6765         if add_ge
+0000e190: 6f6d 6574 7279 3a0d 0a20 2020 2020 2020  ometry:..       
+0000e1a0: 2020 2020 2020 2020 2069 6620 6164 645f           if add_
+0000e1b0: 6765 6f6d 6574 7279 2e6c 6f77 6572 2829  geometry.lower()
+0000e1c0: 203d 3d20 2270 6f69 6e74 223a 0d0a 2020   == "point":..  
+0000e1d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0000e1e0: 2020 636f 6f72 6473 203d 2073 656c 662e    coords = self.
+0000e1f0: 6765 745f 6365 6c6c 5f70 6f69 6e74 7328  get_cell_points(
+0000e200: 6d61 736b 3d54 7275 6529 0d0a 2020 2020  mask=True)..    
+0000e210: 2020 2020 2020 2020 2020 2020 656c 7365              else
+0000e220: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+0000e230: 2020 2020 2020 2063 6f6f 7264 7320 3d20         coords = 
+0000e240: 7365 6c66 2e67 6574 5f63 656c 6c5f 706f  self.get_cell_po
+0000e250: 6c79 676f 6e73 286d 6173 6b3d 5472 7565  lygons(mask=True
+0000e260: 290d 0a0d 0a20 2020 2020 2020 206f 7574  )....        out
+0000e270: 5f64 6620 3d20 6f75 745f 6466 2e64 726f  _df = out_df.dro
+0000e280: 7028 636f 6c75 6d6e 733d 5b22 6275 726e  p(columns=["burn
+0000e290: 5f76 616c 7565 222c 2022 6765 6f6d 6574  _value", "geomet
+0000e2a0: 7279 225d 2c20 6572 726f 7273 3d22 6967  ry"], errors="ig
+0000e2b0: 6e6f 7265 2229 0d0a 2020 2020 2020 2020  nore")..        
+0000e2c0: 6966 2061 6464 5f67 656f 6d65 7472 793a  if add_geometry:
+0000e2d0: 0d0a 2020 2020 2020 2020 2020 2020 6f75  ..            ou
+0000e2e0: 745f 6466 203d 2067 7064 2e47 656f 4461  t_df = gpd.GeoDa
+0000e2f0: 7461 4672 616d 6528 6f75 745f 6466 2c20  taFrame(out_df, 
+0000e300: 6765 6f6d 6574 7279 3d63 6f6f 7264 735b  geometry=coords[
+0000e310: 2267 656f 6d65 7472 7922 5d29 0d0a 0d0a  "geometry"])....
+0000e320: 2020 2020 2020 2020 2320 544f 444f 206d          # TODO m
+0000e330: 6173 6b20 6e6f 2064 6174 6120 7661 6c75  ask no data valu
+0000e340: 6573 2e0d 0a0d 0a20 2020 2020 2020 2023  es.....        #
+0000e350: 2052 656d 6f76 6520 7465 6d70 6f72 6172   Remove temporar
+0000e360: 7920 6669 6c65 732e 0d0a 2020 2020 2020  y files...      
+0000e370: 2020 6966 2074 656d 705f 6469 7220 6973    if temp_dir is
+0000e380: 206e 6f74 204e 6f6e 653a 0d0a 2020 2020   not None:..    
+0000e390: 2020 2020 2020 2020 7368 7574 696c 2e72          shutil.r
+0000e3a0: 6d74 7265 6528 7465 6d70 5f64 6972 2c20  mtree(temp_dir, 
+0000e3b0: 6967 6e6f 7265 5f65 7272 6f72 733d 5472  ignore_errors=Tr
+0000e3c0: 7565 290d 0a0d 0a20 2020 2020 2020 2023  ue)....        #
+0000e3d0: 2052 6574 7572 6e20 6472 6f70 7069 6e67   Return dropping
+0000e3e0: 2061 6e79 2065 7874 7261 2063 6f6c 732e   any extra cols.
+0000e3f0: 0d0a 2020 2020 2020 2020 7265 7475 726e  ..        return
+0000e400: 206f 7574 5f64 660d 0a0d 0a20 2020 2064   out_df....    d
+0000e410: 6566 2061 7070 6c79 2873 656c 662c 2066  ef apply(self, f
+0000e420: 756e 2c20 6261 6e64 3a20 696e 7420 3d20  un, band: int = 
+0000e430: 3029 3a0d 0a20 2020 2020 2020 2022 2222  0):..        """
+0000e440: 6d61 7041 6c67 6562 7261 2e0d 0a0d 0a20  mapAlgebra..... 
+0000e450: 2020 2020 2020 202d 206d 6170 416c 6765         - mapAlge
+0000e460: 6272 6120 6578 6563 7574 6573 2061 206d  bra executes a m
+0000e470: 6174 6865 6d61 7469 6361 6c20 6f70 6572  athematical oper
+0000e480: 6174 696f 6e20 6f6e 2072 6173 7465 7220  ation on raster 
+0000e490: 6172 7261 7920 616e 6420 7265 7475 726e  array and return
+0000e4a0: 730d 0a20 2020 2020 2020 2074 6865 2072  s..        the r
+0000e4b0: 6573 756c 740d 0a20 2020 2020 2020 202d  esult..        -
+0000e4c0: 2054 6865 206d 6170 416c 6765 6272 6120   The mapAlgebra 
+0000e4d0: 6578 6563 7574 6573 2074 6865 2066 756e  executes the fun
+0000e4e0: 6374 696f 6e20 6f6e 6c79 206f 6e20 6f6e  ction only on on
+0000e4f0: 6520 6365 6c6c 2061 7420 6120 7469 6d65  e cell at a time
+0000e500: 2e0d 0a0d 0a20 2020 2020 2020 2050 6172  .....        Par
+0000e510: 616d 6574 6572 730d 0a20 2020 2020 2020  ameters..       
+0000e520: 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020   ----------..   
+0000e530: 2020 2020 2066 756e 3a20 5b66 756e 6374       fun: [funct
+0000e540: 696f 6e5d 0d0a 2020 2020 2020 2020 2020  ion]..          
+0000e550: 2020 6465 6669 6e65 6420 6675 6e63 7469    defined functi
+0000e560: 6f6e 2074 6861 7420 7461 6b65 7320 6f6e  on that takes on
+0000e570: 6520 696e 7075 7420 7768 6963 6820 6973  e input which is
+0000e580: 2074 6865 2063 656c 6c20 7661 6c75 652e   the cell value.
+0000e590: 0d0a 2020 2020 2020 2020 6261 6e64 3a20  ..        band: 
+0000e5a0: 5b69 6e74 5d0d 0a20 2020 2020 2020 2020  [int]..         
+0000e5b0: 2020 2062 616e 6420 6e75 6d62 6572 2e0d     band number..
+0000e5c0: 0a0d 0a20 2020 2020 2020 2052 6574 7572  ...        Retur
+0000e5d0: 6e73 0d0a 2020 2020 2020 2020 2d2d 2d2d  ns..        ----
+0000e5e0: 2d2d 2d0d 0a20 2020 2020 2020 2044 6174  ---..        Dat
+0000e5f0: 6163 7562 650d 0a20 2020 2020 2020 2020  acube..         
+0000e600: 2020 2067 6461 6c20 6461 7461 7365 7420     gdal dataset 
+0000e610: 6f62 6a65 6374 0d0a 0d0a 2020 2020 2020  object....      
+0000e620: 2020 4578 616d 706c 6573 0d0a 2020 2020    Examples..    
+0000e630: 2020 2020 2d2d 2d2d 2d2d 2d2d 0d0a 2020      --------..  
+0000e640: 2020 2020 2020 3e3e 3e20 7372 635f 7261        >>> src_ra
+0000e650: 7374 6572 203d 2067 6461 6c2e 4f70 656e  ster = gdal.Open
+0000e660: 2822 6576 6170 2e74 6966 2229 0d0a 2020  ("evap.tif")..  
+0000e670: 2020 2020 2020 3e3e 3e20 6675 6e63 203d        >>> func =
+0000e680: 206e 702e 6162 730d 0a20 2020 2020 2020   np.abs..       
+0000e690: 203e 3e3e 206e 6577 5f72 6173 7465 7220   >>> new_raster 
+0000e6a0: 3d20 4461 7461 7365 742e 6170 706c 7928  = Dataset.apply(
+0000e6b0: 7372 635f 7261 7374 6572 2c20 6675 6e63  src_raster, func
+0000e6c0: 290d 0a20 2020 2020 2020 2022 2222 0d0a  )..        """..
+0000e6d0: 2020 2020 2020 2020 6966 206e 6f74 2063          if not c
+0000e6e0: 616c 6c61 626c 6528 6675 6e29 3a0d 0a20  allable(fun):.. 
+0000e6f0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+0000e700: 2054 7970 6545 7272 6f72 2822 7365 636f   TypeError("seco
+0000e710: 6e64 2061 7267 756d 656e 7420 7368 6f75  nd argument shou
+0000e720: 6c64 2062 6520 6120 6675 6e63 7469 6f6e  ld be a function
+0000e730: 2229 0d0a 0d0a 2020 2020 2020 2020 6e6f  ")....        no
+0000e740: 5f64 6174 615f 7661 6c75 6520 3d20 7365  _data_value = se
+0000e750: 6c66 2e6e 6f5f 6461 7461 5f76 616c 7565  lf.no_data_value
+0000e760: 5b62 616e 645d 0d0a 2020 2020 2020 2020  [band]..        
+0000e770: 7372 635f 6172 7261 7920 3d20 7365 6c66  src_array = self
+0000e780: 2e72 6561 645f 6172 7261 7928 6261 6e64  .read_array(band
+0000e790: 290d 0a20 2020 2020 2020 2064 7479 7065  )..        dtype
+0000e7a0: 203d 2073 656c 662e 6474 7970 655b 6261   = self.dtype[ba
+0000e7b0: 6e64 5d0d 0a0d 0a20 2020 2020 2020 2023  nd]....        #
+0000e7c0: 2066 696c 6c20 7468 6520 6e65 7720 6172   fill the new ar
+0000e7d0: 7261 7920 7769 7468 2074 6865 206e 6f64  ray with the nod
+0000e7e0: 6174 6120 7661 6c75 650d 0a20 2020 2020  ata value..     
+0000e7f0: 2020 206e 6577 5f61 7272 6179 203d 206e     new_array = n
+0000e800: 702e 6f6e 6573 2828 7365 6c66 2e72 6f77  p.ones((self.row
+0000e810: 732c 2073 656c 662e 636f 6c75 6d6e 7329  s, self.columns)
+0000e820: 2920 2a20 6e6f 5f64 6174 615f 7661 6c75  ) * no_data_valu
+0000e830: 650d 0a20 2020 2020 2020 2023 2065 7865  e..        # exe
+0000e840: 6375 7465 2074 6865 2066 756e 6374 696f  cute the functio
+0000e850: 6e20 6f6e 2065 6163 6820 6365 6c6c 0d0a  n on each cell..
+0000e860: 2020 2020 2020 2020 2320 544f 444f 3a20          # TODO: 
+0000e870: 6f70 7469 6d69 7a65 2065 7865 6375 7469  optimize executi
+0000e880: 6e67 2061 2066 756e 6374 696f 6e20 6f76  ng a function ov
+0000e890: 6572 2061 2077 686f 6c65 2061 7272 6179  er a whole array
+0000e8a0: 0d0a 2020 2020 2020 2020 666f 7220 6920  ..        for i 
+0000e8b0: 696e 2072 616e 6765 2873 656c 662e 726f  in range(self.ro
+0000e8c0: 7773 293a 0d0a 2020 2020 2020 2020 2020  ws):..          
+0000e8d0: 2020 666f 7220 6a20 696e 2072 616e 6765    for j in range
+0000e8e0: 2873 656c 662e 636f 6c75 6d6e 7329 3a0d  (self.columns):.
+0000e8f0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000e900: 2069 6620 6e6f 7420 6e70 2e69 7363 6c6f   if not np.isclo
+0000e910: 7365 2873 7263 5f61 7272 6179 5b69 2c20  se(src_array[i, 
+0000e920: 6a5d 2c20 6e6f 5f64 6174 615f 7661 6c75  j], no_data_valu
+0000e930: 652c 2072 746f 6c3d 302e 3030 3129 3a0d  e, rtol=0.001):.
+0000e940: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0000e950: 2020 2020 206e 6577 5f61 7272 6179 5b69       new_array[i
+0000e960: 2c20 6a5d 203d 2066 756e 2873 7263 5f61  , j] = fun(src_a
+0000e970: 7272 6179 5b69 2c20 6a5d 290d 0a0d 0a20  rray[i, j]).... 
+0000e980: 2020 2020 2020 2023 2063 7265 6174 6520         # create 
+0000e990: 7468 6520 6f75 7470 7574 2072 6173 7465  the output raste
+0000e9a0: 720d 0a20 2020 2020 2020 2064 7374 203d  r..        dst =
+0000e9b0: 2044 6174 6173 6574 2e5f 6372 6561 7465   Dataset._create
+0000e9c0: 5f67 6461 6c5f 6461 7461 7365 7428 0d0a  _gdal_dataset(..
+0000e9d0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0000e9e0: 2e63 6f6c 756d 6e73 2c20 7365 6c66 2e72  .columns, self.r
+0000e9f0: 6f77 732c 2031 2c20 6474 7970 652c 2064  ows, 1, dtype, d
+0000ea00: 7269 7665 723d 224d 454d 220d 0a20 2020  river="MEM"..   
+0000ea10: 2020 2020 2029 0d0a 2020 2020 2020 2020       )..        
+0000ea20: 2320 7365 7420 7468 6520 6765 6f74 7261  # set the geotra
+0000ea30: 6e73 666f 726d 0d0a 2020 2020 2020 2020  nsform..        
+0000ea40: 6473 742e 5365 7447 656f 5472 616e 7366  dst.SetGeoTransf
+0000ea50: 6f72 6d28 7365 6c66 2e67 656f 7472 616e  orm(self.geotran
+0000ea60: 7366 6f72 6d29 0d0a 2020 2020 2020 2020  sform)..        
+0000ea70: 2320 7365 7420 7468 6520 7072 6f6a 6563  # set the projec
+0000ea80: 7469 6f6e 0d0a 2020 2020 2020 2020 6473  tion..        ds
+0000ea90: 742e 5365 7450 726f 6a65 6374 696f 6e28  t.SetProjection(
+0000eaa0: 7365 6c66 2e63 7273 290d 0a20 2020 2020  self.crs)..     
+0000eab0: 2020 2064 7374 5f6f 626a 203d 2044 6174     dst_obj = Dat
+0000eac0: 6173 6574 2864 7374 290d 0a20 2020 2020  aset(dst)..     
+0000ead0: 2020 2064 7374 5f6f 626a 2e5f 7365 745f     dst_obj._set_
+0000eae0: 6e6f 5f64 6174 615f 7661 6c75 6528 6e6f  no_data_value(no
+0000eaf0: 5f64 6174 615f 7661 6c75 653d 6e6f 5f64  _data_value=no_d
+0000eb00: 6174 615f 7661 6c75 6529 0d0a 2020 2020  ata_value)..    
+0000eb10: 2020 2020 6473 745f 6f62 6a2e 7261 7374      dst_obj.rast
+0000eb20: 6572 2e47 6574 5261 7374 6572 4261 6e64  er.GetRasterBand
+0000eb30: 2862 616e 6420 2b20 3129 2e57 7269 7465  (band + 1).Write
+0000eb40: 4172 7261 7928 6e65 775f 6172 7261 7929  Array(new_array)
+0000eb50: 0d0a 0d0a 2020 2020 2020 2020 7265 7475  ....        retu
+0000eb60: 726e 2064 7374 5f6f 626a 0d0a 0d0a 2020  rn dst_obj....  
+0000eb70: 2020 6465 6620 6669 6c6c 280d 0a20 2020    def fill(..   
+0000eb80: 2020 2020 2073 656c 662c 2076 616c 3a20       self, val: 
+0000eb90: 556e 696f 6e5b 666c 6f61 742c 2069 6e74  Union[float, int
+0000eba0: 5d2c 2064 7269 7665 723a 2073 7472 203d  ], driver: str =
+0000ebb0: 2022 4d45 4d22 2c20 7061 7468 3a20 7374   "MEM", path: st
+0000ebc0: 7220 3d20 4e6f 6e65 0d0a 2020 2020 2920  r = None..    ) 
+0000ebd0: 2d3e 2055 6e69 6f6e 5b4e 6f6e 652c 2067  -> Union[None, g
+0000ebe0: 6461 6c2e 4461 7461 7365 745d 3a0d 0a20  dal.Dataset]:.. 
+0000ebf0: 2020 2020 2020 2022 2222 4669 6c6c 2e0d         """Fill..
+0000ec00: 0a0d 0a20 2020 2020 2020 2020 2020 2046  ...            F
+0000ec10: 696c 6c20 7461 6b65 7320 6120 7261 7374  ill takes a rast
+0000ec20: 6572 2061 6e64 2066 696c 6c20 6974 2077  er and fill it w
+0000ec30: 6974 6820 6f6e 6520 7661 6c75 650d 0a0d  ith one value...
+0000ec40: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
+0000ec50: 6572 730d 0a20 2020 2020 2020 202d 2d2d  ers..        ---
+0000ec60: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
+0000ec70: 2076 616c 3a20 5b6e 756d 6572 6963 5d0d   val: [numeric].
+0000ec80: 0a20 2020 2020 2020 2020 2020 206e 756d  .            num
+0000ec90: 6572 6963 2076 616c 7565 0d0a 2020 2020  eric value..    
+0000eca0: 2020 2020 6472 6976 6572 3a20 5b73 7472      driver: [str
+0000ecb0: 5d0d 0a20 2020 2020 2020 2020 2020 2064  ]..            d
+0000ecc0: 7269 7665 7220 7479 7065 205b 2247 5469  river type ["GTi
+0000ecd0: 6666 222c 2022 4d45 4d22 5d0d 0a20 2020  ff", "MEM"]..   
+0000ece0: 2020 2020 2070 6174 6820 3a20 5b73 7472       path : [str
+0000ecf0: 5d0d 0a20 2020 2020 2020 2020 2020 2070  ]..            p
+0000ed00: 6174 6820 696e 636c 7564 696e 6720 7468  ath including th
+0000ed10: 6520 6578 7465 6e73 696f 6e20 282e 7469  e extension (.ti
+0000ed20: 6629 0d0a 0d0a 2020 2020 2020 2020 5265  f)....        Re
+0000ed30: 7475 726e 730d 0a20 2020 2020 2020 202d  turns..        -
+0000ed40: 2d2d 2d2d 2d2d 0d0a 2020 2020 2020 2020  ------..        
+0000ed50: 7261 7374 6572 203a 205b 4e6f 6e65 2f67  raster : [None/g
+0000ed60: 6461 6c2e 4461 7461 6375 6265 5d0d 0a20  dal.Datacube].. 
+0000ed70: 2020 2020 2020 2020 2020 2069 6620 7468             if th
+0000ed80: 6520 7261 7374 6572 2069 7320 7361 7665  e raster is save
+0000ed90: 6420 6469 7265 6374 6c79 2074 6f20 7468  d directly to th
+0000eda0: 6520 7061 7468 2079 6f75 2070 726f 7669  e path you provi
+0000edb0: 6465 6420 7468 6520 7265 7475 726e 6564  ded the returned
+0000edc0: 2076 616c 7565 2077 696c 6c20 6265 204e   value will be N
+0000edd0: 6f6e 652c 206f 7468 6572 7769 7365 2074  one, otherwise t
+0000ede0: 6865 0d0a 2020 2020 2020 2020 2020 2020  he..            
+0000edf0: 7265 7475 726e 6564 2076 616c 7565 2077  returned value w
+0000ee00: 696c 6c20 6265 2074 6865 2067 6461 6c2e  ill be the gdal.
+0000ee10: 4461 7461 6375 6265 2069 7473 656c 662e  Datacube itself.
+0000ee20: 0d0a 2020 2020 2020 2020 2222 220d 0a20  ..        """.. 
+0000ee30: 2020 2020 2020 206e 6f5f 6461 7461 5f76         no_data_v
+0000ee40: 616c 7565 203d 2073 656c 662e 6e6f 5f64  alue = self.no_d
+0000ee50: 6174 615f 7661 6c75 655b 305d 0d0a 2020  ata_value[0]..  
+0000ee60: 2020 2020 2020 7372 635f 6172 7261 7920        src_array 
+0000ee70: 3d20 7365 6c66 2e72 6173 7465 722e 5265  = self.raster.Re
+0000ee80: 6164 4173 4172 7261 7928 290d 0a0d 0a20  adAsArray().... 
+0000ee90: 2020 2020 2020 2069 6620 6e6f 5f64 6174         if no_dat
+0000eea0: 615f 7661 6c75 6520 6973 204e 6f6e 653a  a_value is None:
+0000eeb0: 0d0a 2020 2020 2020 2020 2020 2020 6e6f  ..            no
+0000eec0: 5f64 6174 615f 7661 6c75 6520 3d20 6e70  _data_value = np
+0000eed0: 2e6e 616e 0d0a 0d0a 2020 2020 2020 2020  .nan....        
+0000eee0: 6966 206e 6f74 206e 702e 6973 6e61 6e28  if not np.isnan(
+0000eef0: 6e6f 5f64 6174 615f 7661 6c75 6529 3a0d  no_data_value):.
+0000ef00: 0a20 2020 2020 2020 2020 2020 2073 7263  .            src
+0000ef10: 5f61 7272 6179 5b7e 6e70 2e69 7363 6c6f  _array[~np.isclo
+0000ef20: 7365 2873 7263 5f61 7272 6179 2c20 6e6f  se(src_array, no
+0000ef30: 5f64 6174 615f 7661 6c75 652c 2072 746f  _data_value, rto
+0000ef40: 6c3d 302e 3030 3030 3031 295d 203d 2076  l=0.000001)] = v
+0000ef50: 616c 0d0a 2020 2020 2020 2020 656c 7365  al..        else
+0000ef60: 3a0d 0a20 2020 2020 2020 2020 2020 2073  :..            s
+0000ef70: 7263 5f61 7272 6179 5b7e 6e70 2e69 736e  rc_array[~np.isn
+0000ef80: 616e 2873 7263 5f61 7272 6179 295d 203d  an(src_array)] =
+0000ef90: 2076 616c 0d0a 2020 2020 2020 2020 6473   val..        ds
+0000efa0: 7420 3d20 4461 7461 7365 742e 6461 7461  t = Dataset.data
+0000efb0: 7365 745f 6c69 6b65 2873 656c 662c 2073  set_like(self, s
+0000efc0: 7263 5f61 7272 6179 2c20 6472 6976 6572  rc_array, driver
+0000efd0: 3d64 7269 7665 722c 2070 6174 683d 7061  =driver, path=pa
+0000efe0: 7468 290d 0a20 2020 2020 2020 2072 6574  th)..        ret
+0000eff0: 7572 6e20 6473 740d 0a0d 0a20 2020 2064  urn dst....    d
+0000f000: 6566 2072 6573 616d 706c 6528 7365 6c66  ef resample(self
+0000f010: 2c20 6365 6c6c 5f73 697a 653a 2055 6e69  , cell_size: Uni
+0000f020: 6f6e 5b69 6e74 2c20 666c 6f61 745d 2c20  on[int, float], 
+0000f030: 6d65 7468 6f64 3a20 7374 7220 3d20 226e  method: str = "n
+0000f040: 6561 7265 7374 206e 6569 626f 7572 2229  earest neibour")
+0000f050: 3a0d 0a20 2020 2020 2020 2022 2222 7265  :..        """re
+0000f060: 7361 6d70 6c65 2e0d 0a0d 0a20 2020 2020  sample.....     
+0000f070: 2020 2072 6573 616d 706c 6520 6d65 7468     resample meth
+0000f080: 6f64 2072 6570 726f 6a65 6374 2061 2072  od reproject a r
+0000f090: 6173 7465 7220 746f 2061 6e79 2070 726f  aster to any pro
+0000f0a0: 6a65 6374 696f 6e0d 0a20 2020 2020 2020  jection..       
+0000f0b0: 2028 6465 6661 756c 7420 7468 6520 5747   (default the WG
+0000f0c0: 5338 3420 7765 6220 6d65 7263 6174 6f72  S84 web mercator
+0000f0d0: 2070 726f 6a65 6374 696f 6e2c 2077 6974   projection, wit
+0000f0e0: 686f 7574 2072 6573 616d 706c 696e 6729  hout resampling)
+0000f0f0: 0d0a 2020 2020 2020 2020 5468 6520 6675  ..        The fu
+0000f100: 6e63 7469 6f6e 2072 6574 7572 6e73 2061  nction returns a
+0000f110: 2047 4441 4c20 696e 2d6d 656d 6f72 7920   GDAL in-memory 
+0000f120: 6669 6c65 206f 626a 6563 742c 2077 6865  file object, whe
+0000f130: 7265 2079 6f75 2063 616e 2052 6561 6441  re you can ReadA
+0000f140: 7341 7272 6179 2065 7463 2e0d 0a0d 0a20  sArray etc..... 
+0000f150: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
+0000f160: 730d 0a20 2020 2020 2020 202d 2d2d 2d2d  s..        -----
+0000f170: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 2063  -----..        c
+0000f180: 656c 6c5f 7369 7a65 203a 205b 696e 7465  ell_size : [inte
+0000f190: 6765 725d 0d0a 2020 2020 2020 2020 2020  ger]..          
+0000f1a0: 2020 206e 6577 2063 656c 6c20 7369 7a65     new cell size
+0000f1b0: 2074 6f20 7265 7361 6d70 6c65 2074 6865   to resample the
+0000f1c0: 2072 6173 7465 722e 0d0a 2020 2020 2020   raster...      
+0000f1d0: 2020 2020 2020 2864 6566 6175 6c74 2065        (default e
+0000f1e0: 6d70 7479 2073 6f20 7261 7374 6572 2077  mpty so raster w
+0000f1f0: 696c 6c20 6e6f 7420 6265 2072 6573 616d  ill not be resam
+0000f200: 706c 6564 290d 0a20 2020 2020 2020 206d  pled)..        m
+0000f210: 6574 686f 6420 3a20 5b53 7472 696e 675d  ethod : [String]
+0000f220: 0d0a 2020 2020 2020 2020 2020 2020 7265  ..            re
+0000f230: 7361 6d70 6c69 6e67 2074 6563 686e 6971  sampling techniq
+0000f240: 7565 2064 6566 6175 6c74 2069 7320 224e  ue default is "N
+0000f250: 6561 7265 7374 220d 0a20 2020 2020 2020  earest"..       
+0000f260: 2020 2020 2068 7474 7073 3a2f 2f67 6973       https://gis
+0000f270: 6765 6f67 7261 7068 792e 636f 6d2f 7261  geography.com/ra
+0000f280: 7374 6572 2d72 6573 616d 706c 696e 672f  ster-resampling/
+0000f290: 0d0a 2020 2020 2020 2020 2020 2020 226e  ..            "n
+0000f2a0: 6561 7265 7374 206e 6569 626f 7572 2220  earest neibour" 
+0000f2b0: 666f 7220 6e65 6172 6573 7420 6e65 6967  for nearest neig
+0000f2c0: 6862 6f75 722c 2263 7562 6963 2220 666f  hbour,"cubic" fo
+0000f2d0: 7220 6375 6269 6320 636f 6e76 6f6c 7574  r cubic convolut
+0000f2e0: 696f 6e2c 0d0a 2020 2020 2020 2020 2020  ion,..          
+0000f2f0: 2020 2262 696c 696e 6561 7222 2066 6f72    "bilinear" for
+0000f300: 2062 696c 696e 6561 720d 0a0d 0a20 2020   bilinear....   
+0000f310: 2020 2020 2052 6574 7572 6e73 0d0a 2020       Returns..  
+0000f320: 2020 2020 2020 2d2d 2d2d 2d2d 2d0d 0a20        -------.. 
+0000f330: 2020 2020 2020 2072 6173 7465 7220 3a20         raster : 
+0000f340: 5b44 6174 6173 6574 5d0d 0a20 2020 2020  [Dataset]..     
+0000f350: 2020 2020 2020 2020 4461 7461 7365 7420          Dataset 
+0000f360: 6f62 6a65 6374 2e0d 0a20 2020 2020 2020  object...       
+0000f370: 2022 2222 0d0a 2020 2020 2020 2020 6966   """..        if
+0000f380: 206e 6f74 2069 7369 6e73 7461 6e63 6528   not isinstance(
+0000f390: 6d65 7468 6f64 2c20 7374 7229 3a0d 0a20  method, str):.. 
+0000f3a0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+0000f3b0: 2054 7970 6545 7272 6f72 280d 0a20 2020   TypeError(..   
+0000f3c0: 2020 2020 2020 2020 2020 2020 2022 2070               " p
+0000f3d0: 6c65 6173 6520 656e 7465 7220 636f 7272  lease enter corr
+0000f3e0: 6563 7420 6d65 7468 6f64 206d 6f72 6520  ect method more 
+0000f3f0: 696e 666f 726d 6174 696f 6e20 7365 6520  information see 
+0000f400: 646f 636d 656e 7461 7469 6f6e 2022 0d0a  docmentation "..
+0000f410: 2020 2020 2020 2020 2020 2020 290d 0a20              ).. 
+0000f420: 2020 2020 2020 2069 6620 6d65 7468 6f64         if method
+0000f430: 206e 6f74 2069 6e20 494e 5445 5250 4f4c   not in INTERPOL
+0000f440: 4154 494f 4e5f 4d45 5448 4f44 532e 6b65  ATION_METHODS.ke
+0000f450: 7973 2829 3a0d 0a20 2020 2020 2020 2020  ys():..         
+0000f460: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
+0000f470: 726f 7228 0d0a 2020 2020 2020 2020 2020  ror(..          
+0000f480: 2020 2020 2020 6622 5468 6520 6769 7665        f"The give
+0000f490: 6e20 696e 7465 7270 6f6c 6174 696f 6e20  n interpolation 
+0000f4a0: 6d65 7468 6f64 2064 6f65 7320 6e6f 7420  method does not 
+0000f4b0: 6578 6973 742c 2065 7869 7374 696e 6720  exist, existing 
+0000f4c0: 6d65 7468 6f64 7320 6172 6520 7b49 4e54  methods are {INT
+0000f4d0: 4552 504f 4c41 5449 4f4e 5f4d 4554 484f  ERPOLATION_METHO
+0000f4e0: 4453 2e6b 6579 7328 297d 220d 0a20 2020  DS.keys()}"..   
+0000f4f0: 2020 2020 2020 2020 2029 0d0a 0d0a 2020           )....  
+0000f500: 2020 2020 2020 6d65 7468 6f64 203d 2049        method = I
+0000f510: 4e54 4552 504f 4c41 5449 4f4e 5f4d 4554  NTERPOLATION_MET
+0000f520: 484f 4453 2e67 6574 286d 6574 686f 6429  HODS.get(method)
+0000f530: 0d0a 0d0a 2020 2020 2020 2020 7372 5f73  ....        sr_s
+0000f540: 7263 203d 206f 7372 2e53 7061 7469 616c  rc = osr.Spatial
+0000f550: 5265 6665 7265 6e63 6528 776b 743d 7365  Reference(wkt=se
+0000f560: 6c66 2e63 7273 290d 0a0d 0a20 2020 2020  lf.crs)....     
+0000f570: 2020 2075 6c78 203d 2073 656c 662e 6765     ulx = self.ge
+0000f580: 6f74 7261 6e73 666f 726d 5b30 5d0d 0a20  otransform[0].. 
+0000f590: 2020 2020 2020 2075 6c79 203d 2073 656c         uly = sel
+0000f5a0: 662e 6765 6f74 7261 6e73 666f 726d 5b33  f.geotransform[3
+0000f5b0: 5d0d 0a20 2020 2020 2020 2023 2074 7261  ]..        # tra
+0000f5c0: 6e73 666f 726d 2074 6865 2072 6967 6874  nsform the right
+0000f5d0: 206c 6f77 6572 2063 6f72 6e65 7220 706f   lower corner po
+0000f5e0: 696e 740d 0a20 2020 2020 2020 206c 7278  int..        lrx
+0000f5f0: 203d 2073 656c 662e 6765 6f74 7261 6e73   = self.geotrans
+0000f600: 666f 726d 5b30 5d20 2b20 7365 6c66 2e67  form[0] + self.g
+0000f610: 656f 7472 616e 7366 6f72 6d5b 315d 202a  eotransform[1] *
+0000f620: 2073 656c 662e 636f 6c75 6d6e 730d 0a20   self.columns.. 
+0000f630: 2020 2020 2020 206c 7279 203d 2073 656c         lry = sel
+0000f640: 662e 6765 6f74 7261 6e73 666f 726d 5b33  f.geotransform[3
+0000f650: 5d20 2b20 7365 6c66 2e67 656f 7472 616e  ] + self.geotran
+0000f660: 7366 6f72 6d5b 355d 202a 2073 656c 662e  sform[5] * self.
+0000f670: 726f 7773 0d0a 0d0a 2020 2020 2020 2020  rows....        
+0000f680: 2320 6e65 7720 6765 6f74 7261 6e73 666f  # new geotransfo
+0000f690: 726d 0d0a 2020 2020 2020 2020 6e65 775f  rm..        new_
+0000f6a0: 6765 6f20 3d20 280d 0a20 2020 2020 2020  geo = (..       
+0000f6b0: 2020 2020 2073 656c 662e 6765 6f74 7261       self.geotra
+0000f6c0: 6e73 666f 726d 5b30 5d2c 0d0a 2020 2020  nsform[0],..    
+0000f6d0: 2020 2020 2020 2020 6365 6c6c 5f73 697a          cell_siz
+0000f6e0: 652c 0d0a 2020 2020 2020 2020 2020 2020  e,..            
+0000f6f0: 7365 6c66 2e67 656f 7472 616e 7366 6f72  self.geotransfor
+0000f700: 6d5b 325d 2c0d 0a20 2020 2020 2020 2020  m[2],..         
+0000f710: 2020 2073 656c 662e 6765 6f74 7261 6e73     self.geotrans
+0000f720: 666f 726d 5b33 5d2c 0d0a 2020 2020 2020  form[3],..      
+0000f730: 2020 2020 2020 7365 6c66 2e67 656f 7472        self.geotr
+0000f740: 616e 7366 6f72 6d5b 345d 2c0d 0a20 2020  ansform[4],..   
+0000f750: 2020 2020 2020 2020 202d 3120 2a20 6365           -1 * ce
+0000f760: 6c6c 5f73 697a 652c 0d0a 2020 2020 2020  ll_size,..      
+0000f770: 2020 290d 0a20 2020 2020 2020 2023 2063    )..        # c
+0000f780: 7265 6174 6520 6120 6e65 7720 7261 7374  reate a new rast
+0000f790: 6572 0d0a 2020 2020 2020 2020 636f 6c73  er..        cols
+0000f7a0: 203d 2069 6e74 286e 702e 726f 756e 6428   = int(np.round(
+0000f7b0: 6162 7328 6c72 7820 2d20 756c 7829 202f  abs(lrx - ulx) /
+0000f7c0: 2063 656c 6c5f 7369 7a65 2929 0d0a 2020   cell_size))..  
+0000f7d0: 2020 2020 2020 726f 7773 203d 2069 6e74        rows = int
+0000f7e0: 286e 702e 726f 756e 6428 6162 7328 756c  (np.round(abs(ul
+0000f7f0: 7920 2d20 6c72 7929 202f 2063 656c 6c5f  y - lry) / cell_
+0000f800: 7369 7a65 2929 0d0a 2020 2020 2020 2020  size))..        
+0000f810: 6474 7970 6520 3d20 7365 6c66 2e64 7479  dtype = self.dty
+0000f820: 7065 5b30 5d0d 0a20 2020 2020 2020 2062  pe[0]..        b
+0000f830: 616e 6473 203d 2073 656c 662e 6261 6e64  ands = self.band
+0000f840: 5f63 6f75 6e74 0d0a 0d0a 2020 2020 2020  _count....      
+0000f850: 2020 6473 7420 3d20 4461 7461 7365 742e    dst = Dataset.
+0000f860: 5f63 7265 6174 655f 6764 616c 5f64 6174  _create_gdal_dat
+0000f870: 6173 6574 2863 6f6c 732c 2072 6f77 732c  aset(cols, rows,
+0000f880: 2062 616e 6473 2c20 6474 7970 6529 0d0a   bands, dtype)..
+0000f890: 2020 2020 2020 2020 2320 7365 7420 7468          # set th
+0000f8a0: 6520 6765 6f74 7261 6e73 666f 726d 0d0a  e geotransform..
+0000f8b0: 2020 2020 2020 2020 6473 742e 5365 7447          dst.SetG
+0000f8c0: 656f 5472 616e 7366 6f72 6d28 6e65 775f  eoTransform(new_
+0000f8d0: 6765 6f29 0d0a 2020 2020 2020 2020 2320  geo)..        # 
+0000f8e0: 7365 7420 7468 6520 7072 6f6a 6563 7469  set the projecti
+0000f8f0: 6f6e 0d0a 2020 2020 2020 2020 6473 742e  on..        dst.
+0000f900: 5365 7450 726f 6a65 6374 696f 6e28 7372  SetProjection(sr
+0000f910: 5f73 7263 2e45 7870 6f72 7454 6f57 6b74  _src.ExportToWkt
+0000f920: 2829 290d 0a20 2020 2020 2020 2064 7374  ())..        dst
+0000f930: 5f6f 626a 203d 2044 6174 6173 6574 2864  _obj = Dataset(d
+0000f940: 7374 290d 0a20 2020 2020 2020 2023 2073  st)..        # s
+0000f950: 6574 2074 6865 206e 6f20 6461 7461 2076  et the no data v
+0000f960: 616c 7565 0d0a 2020 2020 2020 2020 6473  alue..        ds
+0000f970: 745f 6f62 6a2e 5f73 6574 5f6e 6f5f 6461  t_obj._set_no_da
+0000f980: 7461 5f76 616c 7565 2873 656c 662e 6e6f  ta_value(self.no
+0000f990: 5f64 6174 615f 7661 6c75 6529 0d0a 2020  _data_value)..  
+0000f9a0: 2020 2020 2020 2320 7065 7266 6f72 6d20        # perform 
+0000f9b0: 7468 6520 7072 6f6a 6563 7469 6f6e 2026  the projection &
+0000f9c0: 2072 6573 616d 706c 696e 670d 0a20 2020   resampling..   
+0000f9d0: 2020 2020 2067 6461 6c2e 5265 7072 6f6a       gdal.Reproj
+0000f9e0: 6563 7449 6d61 6765 280d 0a20 2020 2020  ectImage(..     
+0000f9f0: 2020 2020 2020 2073 656c 662e 7261 7374         self.rast
+0000fa00: 6572 2c0d 0a20 2020 2020 2020 2020 2020  er,..           
+0000fa10: 2064 7374 5f6f 626a 2e72 6173 7465 722c   dst_obj.raster,
+0000fa20: 0d0a 2020 2020 2020 2020 2020 2020 7372  ..            sr
+0000fa30: 5f73 7263 2e45 7870 6f72 7454 6f57 6b74  _src.ExportToWkt
+0000fa40: 2829 2c0d 0a20 2020 2020 2020 2020 2020  (),..           
+0000fa50: 2073 725f 7372 632e 4578 706f 7274 546f   sr_src.ExportTo
+0000fa60: 576b 7428 292c 0d0a 2020 2020 2020 2020  Wkt(),..        
+0000fa70: 2020 2020 6d65 7468 6f64 2c0d 0a20 2020      method,..   
+0000fa80: 2020 2020 2029 0d0a 0d0a 2020 2020 2020       )....      
+0000fa90: 2020 7265 7475 726e 2064 7374 5f6f 626a    return dst_obj
+0000faa0: 0d0a 0d0a 2020 2020 6465 6620 746f 5f63  ....    def to_c
+0000fab0: 7273 280d 0a20 2020 2020 2020 2073 656c  rs(..        sel
+0000fac0: 662c 0d0a 2020 2020 2020 2020 746f 5f65  f,..        to_e
+0000fad0: 7073 673a 2069 6e74 2c0d 0a20 2020 2020  psg: int,..     
+0000fae0: 2020 206d 6574 686f 643a 2073 7472 203d     method: str =
+0000faf0: 2022 6e65 6172 6573 7420 6e65 6962 6f75   "nearest neibou
+0000fb00: 7222 2c0d 0a20 2020 2020 2020 206d 6169  r",..        mai
+0000fb10: 6e74 6169 6e5f 616c 6967 686d 656e 743a  ntain_alighment:
+0000fb20: 2069 6e74 203d 2046 616c 7365 2c0d 0a20   int = False,.. 
+0000fb30: 2020 2029 3a0d 0a20 2020 2020 2020 2022     ):..        "
+0000fb40: 2222 746f 5f65 7073 672e 0d0a 0d0a 2020  ""to_epsg.....  
+0000fb50: 2020 2020 2020 746f 5f65 7073 6720 7265        to_epsg re
+0000fb60: 7072 6f6a 6563 7473 2061 2072 6173 7465  projects a raste
+0000fb70: 7220 746f 2061 6e79 2070 726f 6a65 6374  r to any project
+0000fb80: 696f 6e0d 0a20 2020 2020 2020 2028 6465  ion..        (de
+0000fb90: 6661 756c 7420 7468 6520 5747 5338 3420  fault the WGS84 
+0000fba0: 7765 6220 6d65 7263 6174 6f72 2070 726f  web mercator pro
+0000fbb0: 6a65 6374 696f 6e2c 2077 6974 686f 7574  jection, without
+0000fbc0: 2072 6573 616d 706c 696e 6729 0d0a 0d0a   resampling)....
+0000fbd0: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
+0000fbe0: 7273 0d0a 2020 2020 2020 2020 2d2d 2d2d  rs..        ----
+0000fbf0: 2d2d 2d2d 2d2d 0d0a 2020 2020 2020 2020  ------..        
+0000fc00: 746f 5f65 7073 673a 205b 696e 7465 6765  to_epsg: [intege
+0000fc10: 725d 0d0a 2020 2020 2020 2020 2020 2020  r]..            
+0000fc20: 7265 6665 7265 6e63 6520 6e75 6d62 6572  reference number
+0000fc30: 2074 6f20 7468 6520 6e65 7720 7072 6f6a   to the new proj
+0000fc40: 6563 7469 6f6e 2028 6874 7470 733a 2f2f  ection (https://
+0000fc50: 6570 7367 2e69 6f2f 290d 0a20 2020 2020  epsg.io/)..     
+0000fc60: 2020 2020 2020 2028 6465 6661 756c 7420         (default 
+0000fc70: 3338 3537 2074 6865 2072 6566 6572 656e  3857 the referen
+0000fc80: 6365 206e 6f20 6f66 2057 4753 3834 2077  ce no of WGS84 w
+0000fc90: 6562 206d 6572 6361 746f 7220 290d 0a20  eb mercator ).. 
+0000fca0: 2020 2020 2020 206d 6574 686f 643a 205b         method: [
+0000fcb0: 5374 7269 6e67 5d0d 0a20 2020 2020 2020  String]..       
+0000fcc0: 2020 2020 2072 6573 616d 706c 696e 6720       resampling 
+0000fcd0: 7465 6368 6e69 7175 6520 6465 6661 756c  technique defaul
+0000fce0: 7420 6973 2022 4e65 6172 6573 7422 0d0a  t is "Nearest"..
+0000fcf0: 2020 2020 2020 2020 2020 2020 6874 7470              http
+0000fd00: 733a 2f2f 6769 7367 656f 6772 6170 6879  s://gisgeography
+0000fd10: 2e63 6f6d 2f72 6173 7465 722d 7265 7361  .com/raster-resa
+0000fd20: 6d70 6c69 6e67 2f0d 0a20 2020 2020 2020  mpling/..       
+0000fd30: 2020 2020 2022 6e65 6172 6573 7420 6e65       "nearest ne
+0000fd40: 6962 6f75 7222 2066 6f72 206e 6561 7265  ibour" for neare
+0000fd50: 7374 206e 6569 6768 626f 7572 2c22 6375  st neighbour,"cu
+0000fd60: 6269 6322 2066 6f72 2063 7562 6963 2063  bic" for cubic c
+0000fd70: 6f6e 766f 6c75 7469 6f6e 2c0d 0a20 2020  onvolution,..   
+0000fd80: 2020 2020 2020 2020 2022 6269 6c69 6e65           "biline
+0000fd90: 6172 2220 666f 7220 6269 6c69 6e65 6172  ar" for bilinear
+0000fda0: 0d0a 2020 2020 2020 2020 6d61 696e 7461  ..        mainta
+0000fdb0: 696e 5f61 6c69 6768 6d65 6e74 203a 205b  in_alighment : [
+0000fdc0: 626f 6f6c 5d0d 0a20 2020 2020 2020 2020  bool]..         
+0000fdd0: 2020 2054 7275 6520 746f 206d 6169 6e74     True to maint
+0000fde0: 6169 6e20 7468 6520 6e75 6d62 6572 206f  ain the number o
+0000fdf0: 6620 726f 7773 2061 6e64 2063 6f6c 756d  f rows and colum
+0000fe00: 6e73 206f 6620 7468 6520 7261 7374 6572  ns of the raster
+0000fe10: 2074 6865 2073 616d 6520 6166 7465 7220   the same after 
+0000fe20: 7265 7072 6f6a 6563 7469 6f6e 2e20 4465  reprojection. De
+0000fe30: 6661 756c 7420 6973 2046 616c 7365 2e0d  fault is False..
+0000fe40: 0a0d 0a20 2020 2020 2020 2052 6574 7572  ...        Retur
+0000fe50: 6e73 0d0a 2020 2020 2020 2020 2d2d 2d2d  ns..        ----
+0000fe60: 2d2d 2d0d 0a20 2020 2020 2020 2072 6173  ---..        ras
+0000fe70: 7465 723a 0d0a 2020 2020 2020 2020 2020  ter:..          
+0000fe80: 2020 6764 616c 2064 6174 6173 6574 2028    gdal dataset (
+0000fe90: 796f 7520 6361 6e20 7265 6164 2069 7420  you can read it 
+0000fea0: 6279 2052 6561 6441 7341 7272 6179 290d  by ReadAsArray).
+0000feb0: 0a0d 0a20 2020 2020 2020 2045 7861 6d70  ...        Examp
+0000fec0: 6c65 730d 0a20 2020 2020 2020 202d 2d2d  les..        ---
+0000fed0: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 203e  -----..        >
+0000fee0: 3e3e 2066 726f 6d20 7079 7261 6d69 6473  >> from pyramids
+0000fef0: 2e64 6174 6173 6574 2069 6d70 6f72 7420  .dataset import 
+0000ff00: 4461 7461 7365 740d 0a20 2020 2020 2020  Dataset..       
+0000ff10: 203e 3e3e 2073 7263 203d 2044 6174 6173   >>> src = Datas
+0000ff20: 6574 2e72 6561 645f 6669 6c65 2822 7061  et.read_file("pa
+0000ff30: 7468 2f72 6173 7465 725f 6e61 6d65 2e74  th/raster_name.t
+0000ff40: 6966 2229 0d0a 2020 2020 2020 2020 3e3e  if")..        >>
+0000ff50: 3e20 7072 6f6a 6563 7465 645f 7261 7374  > projected_rast
+0000ff60: 6572 203d 2073 7263 2e74 6f5f 6372 7328  er = src.to_crs(
+0000ff70: 746f 5f65 7073 673d 3338 3537 290d 0a20  to_epsg=3857).. 
+0000ff80: 2020 2020 2020 2022 2222 0d0a 2020 2020         """..    
+0000ff90: 2020 2020 6966 206e 6f74 2069 7369 6e73      if not isins
+0000ffa0: 7461 6e63 6528 746f 5f65 7073 672c 2069  tance(to_epsg, i
+0000ffb0: 6e74 293a 0d0a 2020 2020 2020 2020 2020  nt):..          
+0000ffc0: 2020 7261 6973 6520 5479 7065 4572 726f    raise TypeErro
+0000ffd0: 7228 0d0a 2020 2020 2020 2020 2020 2020  r(..            
+0000ffe0: 2020 2020 2270 6c65 6173 6520 656e 7465      "please ente
+0000fff0: 7220 636f 7272 6563 7420 696e 7465 6765  r correct intege
+00010000: 7220 6e75 6d62 6572 2066 6f72 2074 6f5f  r number for to_
+00010010: 6570 7367 206d 6f72 6520 696e 666f 726d  epsg more inform
+00010020: 6174 696f 6e20 220d 0a20 2020 2020 2020  ation "..       
+00010030: 2020 2020 2020 2020 2066 2268 7474 7073           f"https
+00010040: 3a2f 2f65 7073 672e 696f 2f2c 2067 6976  ://epsg.io/, giv
+00010050: 656e 207b 7479 7065 2874 6f5f 6570 7367  en {type(to_epsg
+00010060: 297d 220d 0a20 2020 2020 2020 2020 2020  )}"..           
+00010070: 2029 0d0a 2020 2020 2020 2020 6966 206e   )..        if n
+00010080: 6f74 2069 7369 6e73 7461 6e63 6528 6d65  ot isinstance(me
+00010090: 7468 6f64 2c20 7374 7229 3a0d 0a20 2020  thod, str):..   
+000100a0: 2020 2020 2020 2020 2072 6169 7365 2054           raise T
+000100b0: 7970 6545 7272 6f72 280d 0a20 2020 2020  ypeError(..     
+000100c0: 2020 2020 2020 2020 2020 2022 706c 6561             "plea
+000100d0: 7365 2065 6e74 6572 2063 6f72 7265 6374  se enter correct
+000100e0: 206d 6574 686f 6420 6d6f 7265 2069 6e66   method more inf
+000100f0: 6f72 6d61 7469 6f6e 2073 6565 2022 2022  ormation see " "
+00010100: 646f 636d 656e 7461 7469 6f6e 2022 0d0a  docmentation "..
+00010110: 2020 2020 2020 2020 2020 2020 290d 0a20              ).. 
+00010120: 2020 2020 2020 2069 6620 6d65 7468 6f64         if method
+00010130: 206e 6f74 2069 6e20 494e 5445 5250 4f4c   not in INTERPOL
+00010140: 4154 494f 4e5f 4d45 5448 4f44 532e 6b65  ATION_METHODS.ke
+00010150: 7973 2829 3a0d 0a20 2020 2020 2020 2020  ys():..         
+00010160: 2020 2072 6169 7365 2056 616c 7565 4572     raise ValueEr
+00010170: 726f 7228 0d0a 2020 2020 2020 2020 2020  ror(..          
+00010180: 2020 2020 2020 6622 5468 6520 6769 7665        f"The give
+00010190: 6e20 696e 7465 7270 6f6c 6174 696f 6e20  n interpolation 
+000101a0: 6d65 7468 6f64 2064 6f65 7320 6e6f 7420  method does not 
+000101b0: 6578 6973 742c 2065 7869 7374 696e 6720  exist, existing 
+000101c0: 6d65 7468 6f64 7320 6172 6520 7b49 4e54  methods are {INT
+000101d0: 4552 504f 4c41 5449 4f4e 5f4d 4554 484f  ERPOLATION_METHO
+000101e0: 4453 2e6b 6579 7328 297d 220d 0a20 2020  DS.keys()}"..   
+000101f0: 2020 2020 2020 2020 2029 0d0a 0d0a 2020           )....  
+00010200: 2020 2020 2020 6d65 7468 6f64 203d 2049        method = I
+00010210: 4e54 4552 504f 4c41 5449 4f4e 5f4d 4554  NTERPOLATION_MET
+00010220: 484f 4453 2e67 6574 286d 6574 686f 6429  HODS.get(method)
+00010230: 0d0a 0d0a 2020 2020 2020 2020 6966 206d  ....        if m
+00010240: 6169 6e74 6169 6e5f 616c 6967 686d 656e  aintain_alighmen
+00010250: 743a 0d0a 2020 2020 2020 2020 2020 2020  t:..            
+00010260: 6473 745f 6f62 6a20 3d20 7365 6c66 2e5f  dst_obj = self._
+00010270: 7265 7072 6f6a 6563 745f 7769 7468 5f52  reproject_with_R
+00010280: 6570 726f 6a65 6374 496d 6167 6528 746f  eprojectImage(to
+00010290: 5f65 7073 672c 206d 6574 686f 6429 0d0a  _epsg, method)..
+000102a0: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
+000102b0: 2020 2020 2020 2020 2020 2064 7374 203d             dst =
+000102c0: 2067 6461 6c2e 5761 7270 2822 222c 2073   gdal.Warp("", s
+000102d0: 656c 662e 7261 7374 6572 2c20 6473 7453  elf.raster, dstS
+000102e0: 5253 3d66 2245 5053 473a 7b74 6f5f 6570  RS=f"EPSG:{to_ep
+000102f0: 7367 7d22 2c20 666f 726d 6174 3d22 5652  sg}", format="VR
+00010300: 5422 290d 0a20 2020 2020 2020 2020 2020  T")..           
+00010310: 2064 7374 5f6f 626a 203d 2044 6174 6173   dst_obj = Datas
+00010320: 6574 2864 7374 290d 0a0d 0a20 2020 2020  et(dst)....     
+00010330: 2020 2072 6574 7572 6e20 6473 745f 6f62     return dst_ob
+00010340: 6a0d 0a0d 0a20 2020 2064 6566 205f 7265  j....    def _re
+00010350: 7072 6f6a 6563 745f 7769 7468 5f52 6570  project_with_Rep
+00010360: 726f 6a65 6374 496d 6167 6528 0d0a 2020  rojectImage(..  
+00010370: 2020 2020 2020 7365 6c66 2c20 746f 5f65        self, to_e
+00010380: 7073 673a 2069 6e74 2c20 6d65 7468 6f64  psg: int, method
+00010390: 3a20 7374 7220 3d20 226e 6561 7265 7374  : str = "nearest
+000103a0: 206e 6569 626f 7572 220d 0a20 2020 2029   neibour"..    )
+000103b0: 202d 3e20 6f62 6a65 6374 3a0d 0a20 2020   -> object:..   
+000103c0: 2020 2020 2073 7263 5f67 7420 3d20 7365       src_gt = se
+000103d0: 6c66 2e67 656f 7472 616e 7366 6f72 6d0d  lf.geotransform.
+000103e0: 0a20 2020 2020 2020 2073 7263 5f78 203d  .        src_x =
+000103f0: 2073 656c 662e 636f 6c75 6d6e 730d 0a20   self.columns.. 
+00010400: 2020 2020 2020 2073 7263 5f79 203d 2073         src_y = s
+00010410: 656c 662e 726f 7773 0d0a 0d0a 2020 2020  elf.rows....    
+00010420: 2020 2020 7372 635f 7372 203d 206f 7372      src_sr = osr
+00010430: 2e53 7061 7469 616c 5265 6665 7265 6e63  .SpatialReferenc
+00010440: 6528 776b 743d 7365 6c66 2e63 7273 290d  e(wkt=self.crs).
+00010450: 0a20 2020 2020 2020 2073 7263 5f65 7073  .        src_eps
+00010460: 6720 3d20 7365 6c66 2e65 7073 670d 0a0d  g = self.epsg...
+00010470: 0a20 2020 2020 2020 2023 2323 2064 6973  .        ### dis
+00010480: 7469 6e61 7469 6f6e 2072 6173 7465 720d  tination raster.
+00010490: 0a20 2020 2020 2020 2023 2073 7061 7469  .        # spati
+000104a0: 616c 2072 6566 0d0a 2020 2020 2020 2020  al ref..        
+000104b0: 6473 745f 7372 203d 2073 656c 662e 5f63  dst_sr = self._c
+000104c0: 7265 6174 655f 7372 5f66 726f 6d5f 6570  reate_sr_from_ep
+000104d0: 7367 2874 6f5f 6570 7367 290d 0a0d 0a20  sg(to_epsg).... 
+000104e0: 2020 2020 2020 2023 2069 6e20 6361 7365         # in case
+000104f0: 2074 6865 2073 6f75 7263 6520 6372 7320   the source crs 
+00010500: 6973 2047 4353 2061 6e64 206c 6f6e 6769  is GCS and longi
+00010510: 7475 6465 2069 7320 696e 2074 6865 2077  tude is in the w
+00010520: 6573 7420 6865 6d69 7370 6865 7265 2067  est hemisphere g
+00010530: 6461 6c0d 0a20 2020 2020 2020 2023 2072  dal..        # r
+00010540: 6561 6473 206c 6f6e 6769 7475 6465 2066  eads longitude f
+00010550: 726f 6d20 3020 746f 2033 3630 2061 6e64  rom 0 to 360 and
+00010560: 2074 7261 6e73 666f 726d 6174 696f 6e20   transformation 
+00010570: 6661 6374 6f72 2077 6f6e 7420 776f 726b  factor wont work
+00010580: 2077 6974 6820 7661 6c75 6573 0d0a 2020   with values..  
+00010590: 2020 2020 2020 2320 6772 6561 7465 7220        # greater 
+000105a0: 7468 616e 2031 3830 0d0a 2020 2020 2020  than 180..      
+000105b0: 2020 6966 2073 7263 5f65 7073 6720 213d    if src_epsg !=
+000105c0: 2074 6f5f 6570 7367 3a0d 0a20 2020 2020   to_epsg:..     
+000105d0: 2020 2020 2020 2069 6620 7372 635f 6570         if src_ep
+000105e0: 7367 203d 3d20 2234 3332 3622 2061 6e64  sg == "4326" and
+000105f0: 2073 7263 5f67 745b 305d 203e 2031 3830   src_gt[0] > 180
+00010600: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+00010610: 2020 206c 6e67 5f6e 6577 203d 2073 7263     lng_new = src
+00010620: 5f67 745b 305d 202d 2033 3630 0d0a 2020  _gt[0] - 360..  
+00010630: 2020 2020 2020 2020 2020 2020 2020 2320                # 
+00010640: 7472 616e 7366 6f72 6d61 7469 6f6e 2066  transformation f
+00010650: 6163 746f 7273 0d0a 2020 2020 2020 2020  actors..        
+00010660: 2020 2020 2020 2020 7478 203d 206f 7372          tx = osr
+00010670: 2e43 6f6f 7264 696e 6174 6554 7261 6e73  .CoordinateTrans
+00010680: 666f 726d 6174 696f 6e28 7372 635f 7372  formation(src_sr
+00010690: 2c20 6473 745f 7372 290d 0a20 2020 2020  , dst_sr)..     
+000106a0: 2020 2020 2020 2020 2020 2023 2074 7261             # tra
+000106b0: 6e73 666f 726d 2074 6865 2072 6967 6874  nsform the right
+000106c0: 2075 7070 6572 2063 6f72 6e65 7220 706f   upper corner po
+000106d0: 696e 740d 0a20 2020 2020 2020 2020 2020  int..           
+000106e0: 2020 2020 2028 756c 782c 2075 6c79 2c20       (ulx, uly, 
+000106f0: 756c 7a29 203d 2074 782e 5472 616e 7366  ulz) = tx.Transf
+00010700: 6f72 6d50 6f69 6e74 286c 6e67 5f6e 6577  ormPoint(lng_new
+00010710: 2c20 7372 635f 6774 5b33 5d29 0d0a 2020  , src_gt[3])..  
+00010720: 2020 2020 2020 2020 2020 2020 2020 2320                # 
+00010730: 7472 616e 7366 6f72 6d20 7468 6520 7269  transform the ri
+00010740: 6768 7420 6c6f 7765 7220 636f 726e 6572  ght lower corner
+00010750: 2070 6f69 6e74 0d0a 2020 2020 2020 2020   point..        
+00010760: 2020 2020 2020 2020 286c 7278 2c20 6c72          (lrx, lr
+00010770: 792c 206c 727a 2920 3d20 7478 2e54 7261  y, lrz) = tx.Tra
+00010780: 6e73 666f 726d 506f 696e 7428 0d0a 2020  nsformPoint(..  
+00010790: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000107a0: 2020 6c6e 675f 6e65 7720 2b20 7372 635f    lng_new + src_
+000107b0: 6774 5b31 5d20 2a20 7372 635f 782c 2073  gt[1] * src_x, s
+000107c0: 7263 5f67 745b 335d 202b 2073 7263 5f67  rc_gt[3] + src_g
+000107d0: 745b 355d 202a 2073 7263 5f79 0d0a 2020  t[5] * src_y..  
+000107e0: 2020 2020 2020 2020 2020 2020 2020 290d                ).
+000107f0: 0a20 2020 2020 2020 2020 2020 2065 6c73  .            els
+00010800: 653a 0d0a 2020 2020 2020 2020 2020 2020  e:..            
+00010810: 2020 2020 7873 203d 205b 7372 635f 6774      xs = [src_gt
+00010820: 5b30 5d2c 2073 7263 5f67 745b 305d 202b  [0], src_gt[0] +
+00010830: 2073 7263 5f67 745b 315d 202a 2073 7263   src_gt[1] * src
+00010840: 5f78 5d0d 0a20 2020 2020 2020 2020 2020  _x]..           
+00010850: 2020 2020 2079 7320 3d20 5b73 7263 5f67       ys = [src_g
+00010860: 745b 335d 2c20 7372 635f 6774 5b33 5d20  t[3], src_gt[3] 
+00010870: 2b20 7372 635f 6774 5b35 5d20 2a20 7372  + src_gt[5] * sr
+00010880: 635f 795d 0d0a 0d0a 2020 2020 2020 2020  c_y]....        
+00010890: 2020 2020 2020 2020 5b75 6c79 2c20 6c72          [uly, lr
+000108a0: 795d 2c20 5b75 6c78 2c20 6c72 785d 203d  y], [ulx, lrx] =
+000108b0: 2046 6561 7475 7265 436f 6c6c 6563 7469   FeatureCollecti
+000108c0: 6f6e 2e72 6570 726f 6a65 6374 5f70 6f69  on.reproject_poi
+000108d0: 6e74 7328 0d0a 2020 2020 2020 2020 2020  nts(..          
+000108e0: 2020 2020 2020 2020 2020 7973 2c20 7873            ys, xs
+000108f0: 2c20 6672 6f6d 5f65 7073 673d 7372 635f  , from_epsg=src_
+00010900: 6570 7367 2c20 746f 5f65 7073 673d 746f  epsg, to_epsg=to
+00010910: 5f65 7073 670d 0a20 2020 2020 2020 2020  _epsg..         
+00010920: 2020 2020 2020 2029 0d0a 2020 2020 2020         )..      
+00010930: 2020 2020 2020 2020 2020 2320 6f6c 6420            # old 
+00010940: 7472 616e 7366 6f72 6d0d 0a20 2020 2020  transform..     
+00010950: 2020 2020 2020 2020 2020 2023 2023 2074             # # t
+00010960: 7261 6e73 666f 726d 2074 6865 2072 6967  ransform the rig
+00010970: 6874 2075 7070 6572 2063 6f72 6e65 7220  ht upper corner 
+00010980: 706f 696e 740d 0a20 2020 2020 2020 2020  point..         
+00010990: 2020 2020 2020 2023 2028 756c 782c 2075         # (ulx, u
+000109a0: 6c79 2c20 756c 7a29 203d 2074 782e 5472  ly, ulz) = tx.Tr
+000109b0: 616e 7366 6f72 6d50 6f69 6e74 2873 7263  ansformPoint(src
+000109c0: 5f67 745b 305d 2c20 7372 635f 6774 5b33  _gt[0], src_gt[3
+000109d0: 5d29 0d0a 2020 2020 2020 2020 2020 2020  ])..            
+000109e0: 2020 2020 2320 2320 7472 616e 7366 6f72      # # transfor
+000109f0: 6d20 7468 6520 7269 6768 7420 6c6f 7765  m the right lowe
+00010a00: 7220 636f 726e 6572 2070 6f69 6e74 0d0a  r corner point..
+00010a10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00010a20: 2320 286c 7278 2c20 6c72 792c 206c 727a  # (lrx, lry, lrz
+00010a30: 2920 3d20 7478 2e54 7261 6e73 666f 726d  ) = tx.Transform
+00010a40: 506f 696e 7428 0d0a 2020 2020 2020 2020  Point(..        
+00010a50: 2020 2020 2020 2020 2320 2020 2020 7372          #     sr
+00010a60: 635f 6774 5b30 5d20 2b20 7372 635f 6774  c_gt[0] + src_gt
+00010a70: 5b31 5d20 2a20 7372 635f 782c 2073 7263  [1] * src_x, src
+00010a80: 5f67 745b 335d 202b 2073 7263 5f67 745b  _gt[3] + src_gt[
+00010a90: 355d 202a 2073 7263 5f79 0d0a 2020 2020  5] * src_y..    
+00010aa0: 2020 2020 2020 2020 2020 2020 2320 290d              # ).
+00010ab0: 0a0d 0a20 2020 2020 2020 2065 6c73 653a  ...        else:
+00010ac0: 0d0a 2020 2020 2020 2020 2020 2020 756c  ..            ul
+00010ad0: 7820 3d20 7372 635f 6774 5b30 5d0d 0a20  x = src_gt[0].. 
+00010ae0: 2020 2020 2020 2020 2020 2075 6c79 203d             uly =
+00010af0: 2073 7263 5f67 745b 335d 0d0a 2020 2020   src_gt[3]..    
+00010b00: 2020 2020 2020 2020 6c72 7820 3d20 7372          lrx = sr
+00010b10: 635f 6774 5b30 5d20 2b20 7372 635f 6774  c_gt[0] + src_gt
+00010b20: 5b31 5d20 2a20 7372 635f 780d 0a20 2020  [1] * src_x..   
+00010b30: 2020 2020 2020 2020 206c 7279 203d 2073           lry = s
+00010b40: 7263 5f67 745b 335d 202b 2073 7263 5f67  rc_gt[3] + src_g
+00010b50: 745b 355d 202a 2073 7263 5f79 0d0a 0d0a  t[5] * src_y....
+00010b60: 2020 2020 2020 2020 2320 6765 7420 7468          # get th
+00010b70: 6520 6365 6c6c 2073 697a 6520 696e 2074  e cell size in t
+00010b80: 6865 2073 6f75 7263 6520 7261 7374 6572  he source raster
+00010b90: 2061 6e64 2063 6f6e 7665 7274 2069 7420   and convert it 
+00010ba0: 746f 2074 6865 206e 6577 2063 7273 0d0a  to the new crs..
+00010bb0: 2020 2020 2020 2020 2320 7820 636f 6f72          # x coor
+00010bc0: 6469 6e61 7465 7320 6f72 206c 6f6e 6769  dinates or longi
+00010bd0: 7475 6465 730d 0a20 2020 2020 2020 2078  tudes..        x
+00010be0: 7320 3d20 5b73 7263 5f67 745b 305d 2c20  s = [src_gt[0], 
+00010bf0: 7372 635f 6774 5b30 5d20 2b20 7372 635f  src_gt[0] + src_
+00010c00: 6774 5b31 5d5d 0d0a 2020 2020 2020 2020  gt[1]]..        
+00010c10: 2320 7920 636f 6f72 6469 6e61 7465 7320  # y coordinates 
+00010c20: 6f72 206c 6174 6974 7564 6573 0d0a 2020  or latitudes..  
+00010c30: 2020 2020 2020 7973 203d 205b 7372 635f        ys = [src_
+00010c40: 6774 5b33 5d2c 2073 7263 5f67 745b 335d  gt[3], src_gt[3]
+00010c50: 5d0d 0a0d 0a20 2020 2020 2020 2069 6620  ]....        if 
+00010c60: 7372 635f 6570 7367 2021 3d20 746f 5f65  src_epsg != to_e
+00010c70: 7073 673a 0d0a 2020 2020 2020 2020 2020  psg:..          
+00010c80: 2020 2320 7472 616e 7366 6f72 6d20 7468    # transform th
+00010c90: 6520 7477 6f20 706f 696e 7473 2063 6f6f  e two points coo
+00010ca0: 7264 696e 6174 6573 2074 6f20 7468 6520  rdinates to the 
+00010cb0: 6e65 7720 6372 7320 746f 2063 616c 6375  new crs to calcu
+00010cc0: 6c61 7465 2074 6865 206e 6577 2063 656c  late the new cel
+00010cd0: 6c20 7369 7a65 0d0a 2020 2020 2020 2020  l size..        
+00010ce0: 2020 2020 6e65 775f 7973 2c20 6e65 775f      new_ys, new_
+00010cf0: 7873 203d 2046 6561 7475 7265 436f 6c6c  xs = FeatureColl
+00010d00: 6563 7469 6f6e 2e72 6570 726f 6a65 6374  ection.reproject
+00010d10: 5f70 6f69 6e74 7328 0d0a 2020 2020 2020  _points(..      
+00010d20: 2020 2020 2020 2020 2020 7973 2c20 7873            ys, xs
+00010d30: 2c20 6672 6f6d 5f65 7073 673d 7372 635f  , from_epsg=src_
+00010d40: 6570 7367 2c20 746f 5f65 7073 673d 746f  epsg, to_epsg=to
+00010d50: 5f65 7073 672c 2070 7265 6369 7369 6f6e  _epsg, precision
+00010d60: 3d36 0d0a 2020 2020 2020 2020 2020 2020  =6..            
+00010d70: 290d 0a20 2020 2020 2020 2065 6c73 653a  )..        else:
+00010d80: 0d0a 2020 2020 2020 2020 2020 2020 6e65  ..            ne
+00010d90: 775f 7873 203d 2078 730d 0a20 2020 2020  w_xs = xs..     
+00010da0: 2020 2020 2020 2023 206e 6577 5f79 7320         # new_ys 
+00010db0: 3d20 7973 0d0a 0d0a 2020 2020 2020 2020  = ys....        
+00010dc0: 2320 544f 444f 3a20 7468 6520 6675 6e63  # TODO: the func
+00010dd0: 7469 6f6e 2064 6f65 7320 6e6f 7420 616c  tion does not al
+00010de0: 7761 7973 206d 6169 6e74 6169 6e20 616c  ways maintain al
+00010df0: 6967 6e6d 656e 742c 2062 6173 6564 206f  ignment, based o
+00010e00: 6e20 7468 6520 636f 6e76 6572 7369 6f6e  n the conversion
+00010e10: 206f 6620 7468 6520 6365 6c6c 5f73 697a   of the cell_siz
+00010e20: 6520 616e 6420 7468 650d 0a20 2020 2020  e and the..     
+00010e30: 2020 2023 2070 6976 6f74 2070 6f69 6e74     # pivot point
+00010e40: 0d0a 2020 2020 2020 2020 7069 7865 6c5f  ..        pixel_
+00010e50: 7370 6163 696e 6720 3d20 6e70 2e61 6273  spacing = np.abs
+00010e60: 286e 6577 5f78 735b 305d 202d 206e 6577  (new_xs[0] - new
+00010e70: 5f78 735b 315d 290d 0a0d 0a20 2020 2020  _xs[1])....     
+00010e80: 2020 2023 2063 7265 6174 6520 6120 6e65     # create a ne
+00010e90: 7720 7261 7374 6572 0d0a 2020 2020 2020  w raster..      
+00010ea0: 2020 636f 6c73 203d 2069 6e74 286e 702e    cols = int(np.
+00010eb0: 726f 756e 6428 6162 7328 6c72 7820 2d20  round(abs(lrx - 
+00010ec0: 756c 7829 202f 2070 6978 656c 5f73 7061  ulx) / pixel_spa
+00010ed0: 6369 6e67 2929 0d0a 2020 2020 2020 2020  cing))..        
+00010ee0: 726f 7773 203d 2069 6e74 286e 702e 726f  rows = int(np.ro
+00010ef0: 756e 6428 6162 7328 756c 7920 2d20 6c72  und(abs(uly - lr
+00010f00: 7929 202f 2070 6978 656c 5f73 7061 6369  y) / pixel_spaci
+00010f10: 6e67 2929 0d0a 0d0a 2020 2020 2020 2020  ng))....        
+00010f20: 6474 7970 6520 3d20 7365 6c66 2e64 7479  dtype = self.dty
+00010f30: 7065 5b30 5d0d 0a20 2020 2020 2020 2064  pe[0]..        d
+00010f40: 7374 203d 2044 6174 6173 6574 2e5f 6372  st = Dataset._cr
+00010f50: 6561 7465 5f67 6461 6c5f 6461 7461 7365  eate_gdal_datase
+00010f60: 7428 636f 6c73 2c20 726f 7773 2c20 7365  t(cols, rows, se
+00010f70: 6c66 2e62 616e 645f 636f 756e 742c 2064  lf.band_count, d
+00010f80: 7479 7065 290d 0a0d 0a20 2020 2020 2020  type)....       
+00010f90: 2023 206e 6577 2067 656f 7472 616e 7366   # new geotransf
+00010fa0: 6f72 6d0d 0a20 2020 2020 2020 206e 6577  orm..        new
+00010fb0: 5f67 656f 203d 2028 0d0a 2020 2020 2020  _geo = (..      
+00010fc0: 2020 2020 2020 756c 782c 0d0a 2020 2020        ulx,..    
+00010fd0: 2020 2020 2020 2020 7069 7865 6c5f 7370          pixel_sp
+00010fe0: 6163 696e 672c 0d0a 2020 2020 2020 2020  acing,..        
+00010ff0: 2020 2020 7372 635f 6774 5b32 5d2c 0d0a      src_gt[2],..
+00011000: 2020 2020 2020 2020 2020 2020 756c 792c              uly,
+00011010: 0d0a 2020 2020 2020 2020 2020 2020 7372  ..            sr
+00011020: 635f 6774 5b34 5d2c 0d0a 2020 2020 2020  c_gt[4],..      
+00011030: 2020 2020 2020 6e70 2e73 6967 6e28 7372        np.sign(sr
+00011040: 635f 6774 5b2d 315d 2920 2a20 7069 7865  c_gt[-1]) * pixe
+00011050: 6c5f 7370 6163 696e 672c 0d0a 2020 2020  l_spacing,..    
+00011060: 2020 2020 290d 0a20 2020 2020 2020 2023      )..        #
+00011070: 2073 6574 2074 6865 2067 656f 7472 616e   set the geotran
+00011080: 7366 6f72 6d0d 0a20 2020 2020 2020 2064  sform..        d
+00011090: 7374 2e53 6574 4765 6f54 7261 6e73 666f  st.SetGeoTransfo
+000110a0: 726d 286e 6577 5f67 656f 290d 0a20 2020  rm(new_geo)..   
+000110b0: 2020 2020 2023 2073 6574 2074 6865 2070       # set the p
+000110c0: 726f 6a65 6374 696f 6e0d 0a20 2020 2020  rojection..     
+000110d0: 2020 2064 7374 2e53 6574 5072 6f6a 6563     dst.SetProjec
+000110e0: 7469 6f6e 2864 7374 5f73 722e 4578 706f  tion(dst_sr.Expo
+000110f0: 7274 546f 576b 7428 2929 0d0a 2020 2020  rtToWkt())..    
+00011100: 2020 2020 2320 7365 7420 7468 6520 6e6f      # set the no
+00011110: 2064 6174 6120 7661 6c75 650d 0a20 2020   data value..   
+00011120: 2020 2020 2064 7374 5f6f 626a 203d 2044       dst_obj = D
+00011130: 6174 6173 6574 2864 7374 290d 0a20 2020  ataset(dst)..   
+00011140: 2020 2020 2064 7374 5f6f 626a 2e5f 7365       dst_obj._se
+00011150: 745f 6e6f 5f64 6174 615f 7661 6c75 6528  t_no_data_value(
+00011160: 7365 6c66 2e6e 6f5f 6461 7461 5f76 616c  self.no_data_val
+00011170: 7565 290d 0a20 2020 2020 2020 2023 2070  ue)..        # p
+00011180: 6572 666f 726d 2074 6865 2070 726f 6a65  erform the proje
+00011190: 6374 696f 6e20 2620 7265 7361 6d70 6c69  ction & resampli
+000111a0: 6e67 0d0a 2020 2020 2020 2020 6764 616c  ng..        gdal
+000111b0: 2e52 6570 726f 6a65 6374 496d 6167 6528  .ReprojectImage(
+000111c0: 0d0a 2020 2020 2020 2020 2020 2020 7365  ..            se
+000111d0: 6c66 2e72 6173 7465 722c 0d0a 2020 2020  lf.raster,..    
+000111e0: 2020 2020 2020 2020 6473 745f 6f62 6a2e          dst_obj.
+000111f0: 7261 7374 6572 2c0d 0a20 2020 2020 2020  raster,..       
+00011200: 2020 2020 2073 7263 5f73 722e 4578 706f       src_sr.Expo
+00011210: 7274 546f 576b 7428 292c 0d0a 2020 2020  rtToWkt(),..    
+00011220: 2020 2020 2020 2020 6473 745f 7372 2e45          dst_sr.E
+00011230: 7870 6f72 7454 6f57 6b74 2829 2c0d 0a20  xportToWkt(),.. 
+00011240: 2020 2020 2020 2020 2020 206d 6574 686f             metho
+00011250: 642c 0d0a 2020 2020 2020 2020 290d 0a20  d,..        ).. 
+00011260: 2020 2020 2020 2072 6574 7572 6e20 6473         return ds
+00011270: 745f 6f62 6a0d 0a0d 0a20 2020 2064 6566  t_obj....    def
+00011280: 2066 696c 6c5f 6761 7073 2873 656c 662c   fill_gaps(self,
+00011290: 206d 6173 6b2c 2073 7263 5f61 7272 6179   mask, src_array
+000112a0: 293a 0d0a 2020 2020 2020 2020 2222 2266  ):..        """f
+000112b0: 696c 6c5f 6761 7073 2e0d 0a0d 0a20 2020  ill_gaps.....   
+000112c0: 2020 2020 2050 6172 616d 6574 6572 730d       Parameters.
+000112d0: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+000112e0: 2d2d 2d0d 0a20 2020 2020 2020 206d 6173  ---..        mas
+000112f0: 6b3a 205b 6e70 2e6e 6461 7272 6179 5d0d  k: [np.ndarray].
+00011300: 0a20 2020 2020 2020 2073 7263 5f61 7272  .        src_arr
+00011310: 6179 3a20 5b6e 702e 6e64 6172 7261 795d  ay: [np.ndarray]
+00011320: 0d0a 0d0a 2020 2020 2020 2020 5265 7475  ....        Retu
+00011330: 726e 730d 0a20 2020 2020 2020 202d 2d2d  rns..        ---
+00011340: 2d2d 2d2d 0d0a 2020 2020 2020 2020 6e70  ----..        np
+00011350: 2e6e 6461 7272 6179 0d0a 2020 2020 2020  .ndarray..      
+00011360: 2020 2222 220d 0a20 2020 2020 2020 2023    """..        #
+00011370: 2061 6c69 676e 2066 756e 6374 696f 6e20   align function 
+00011380: 6f6e 6c79 2065 7175 6174 6520 7468 6520  only equate the 
+00011390: 6e6f 206f 6620 726f 7773 2061 6e64 2063  no of rows and c
+000113a0: 6f6c 756d 6e73 206f 6e6c 790d 0a20 2020  olumns only..   
+000113b0: 2020 2020 2023 206d 6174 6368 206e 6f64       # match nod
+000113c0: 6174 6176 616c 7565 2069 6e73 6572 7473  atavalue inserts
+000113d0: 206e 6f64 6174 6176 616c 7565 2069 6e20   nodatavalue in 
+000113e0: 7372 6320 7261 7374 6572 2074 6f20 616c  src raster to al
+000113f0: 6c20 706c 6163 6573 206c 696b 6520 6d61  l places like ma
+00011400: 736b 0d0a 2020 2020 2020 2020 2320 7374  sk..        # st
+00011410: 696c 6c20 706c 6163 6573 2074 6861 7420  ill places that 
+00011420: 6861 7320 6e6f 6461 7461 7661 6c75 6520  has nodatavalue 
+00011430: 696e 2074 6865 2073 7263 2072 6173 7465  in the src raste
+00011440: 7220 6275 7420 6974 2069 7320 6e6f 7420  r but it is not 
+00011450: 6e6f 6461 7461 7661 6c75 6520 696e 2074  nodatavalue in t
+00011460: 6865 206d 6173 6b0d 0a20 2020 2020 2020  he mask..       
+00011470: 2023 2061 6e64 206e 6f77 2068 6173 2074   # and now has t
+00011480: 6f20 6265 2066 696c 6c65 6420 7769 7468  o be filled with
+00011490: 2076 616c 7565 730d 0a20 2020 2020 2020   values..       
+000114a0: 2023 2063 6f6d 7061 7265 206e 6f20 6f66   # compare no of
+000114b0: 2065 6c65 6d65 6e74 2074 6861 7420 6973   element that is
+000114c0: 206e 6f74 206e 6f64 6174 6176 616c 7565   not nodatavalue
+000114d0: 2069 6e20 626f 7468 2072 6173 7465 7273   in both rasters
+000114e0: 2074 6f20 6d61 6b65 2073 7572 6520 7468   to make sure th
+000114f0: 6579 2061 7265 206d 6174 6368 6564 0d0a  ey are matched..
+00011500: 2020 2020 2020 2020 2320 6966 2062 6f74          # if bot
+00011510: 6820 696e 7075 7473 2061 7265 2072 6173  h inputs are ras
+00011520: 7465 7273 0d0a 2020 2020 2020 2020 6d61  ters..        ma
+00011530: 736b 5f61 7272 6179 203d 206d 6173 6b2e  sk_array = mask.
+00011540: 7265 6164 5f61 7272 6179 2829 0d0a 2020  read_array()..  
+00011550: 2020 2020 2020 726f 7720 3d20 6d61 736b        row = mask
+00011560: 2e72 6f77 730d 0a20 2020 2020 2020 2063  .rows..        c
+00011570: 6f6c 203d 206d 6173 6b2e 636f 6c75 6d6e  ol = mask.column
+00011580: 730d 0a20 2020 2020 2020 206d 6173 6b5f  s..        mask_
+00011590: 6e6f 7661 6c20 3d20 6d61 736b 2e6e 6f5f  noval = mask.no_
+000115a0: 6461 7461 5f76 616c 7565 5b30 5d0d 0a0d  data_value[0]...
+000115b0: 0a20 2020 2020 2020 2069 6620 6973 696e  .        if isin
+000115c0: 7374 616e 6365 286d 6173 6b2c 2044 6174  stance(mask, Dat
+000115d0: 6173 6574 2920 616e 6420 6973 696e 7374  aset) and isinst
+000115e0: 616e 6365 2873 656c 662c 2044 6174 6173  ance(self, Datas
+000115f0: 6574 293a 0d0a 2020 2020 2020 2020 2020  et):..          
+00011600: 2020 2320 7468 6572 6520 6d69 6768 7420    # there might 
+00011610: 6265 2063 656c 6c73 2074 6861 7420 6172  be cells that ar
+00011620: 6520 6f75 7420 6f66 2064 6f6d 6169 6e20  e out of domain 
+00011630: 696e 2074 6865 2073 7263 2062 7574 206e  in the src but n
+00011640: 6f74 206f 7574 206f 6620 646f 6d61 696e  ot out of domain
+00011650: 2069 6e20 7468 6520 6d61 736b 0d0a 2020   in the mask..  
+00011660: 2020 2020 2020 2020 2020 2320 736f 2063            # so c
+00011670: 6861 6e67 6520 616c 6c20 7468 6520 7372  hange all the sr
+00011680: 635f 6e6f 7661 6c20 746f 206d 6173 6b5f  c_noval to mask_
+00011690: 6e6f 7661 6c20 696e 2074 6865 2073 7263  noval in the src
+000116a0: 5f61 7272 6179 0d0a 2020 2020 2020 2020  _array..        
+000116b0: 2020 2020 2320 7372 635f 6172 7261 795b      # src_array[
+000116c0: 6e70 2e69 7363 6c6f 7365 2873 7263 5f61  np.isclose(src_a
+000116d0: 7272 6179 2c20 7365 6c66 2e6e 6f5f 6461  rray, self.no_da
+000116e0: 7461 5f76 616c 7565 5b30 5d2c 2072 746f  ta_value[0], rto
+000116f0: 6c3d 302e 3030 3129 5d20 3d20 6d61 736b  l=0.001)] = mask
+00011700: 5f6e 6f76 616c 0d0a 2020 2020 2020 2020  _noval..        
+00011710: 2020 2020 2320 7468 656e 2063 6f75 6e74      # then count
+00011720: 2074 6865 6d20 286f 7574 206f 6620 646f   them (out of do
+00011730: 6d61 696e 2063 656c 6c73 2920 696e 2074  main cells) in t
+00011740: 6865 2073 7263 5f61 7272 6179 0d0a 2020  he src_array..  
+00011750: 2020 2020 2020 2020 2020 656c 656d 5f73            elem_s
+00011760: 7263 203d 2073 7263 5f61 7272 6179 2e73  rc = src_array.s
+00011770: 697a 6520 2d20 6e70 2e63 6f75 6e74 5f6e  ize - np.count_n
+00011780: 6f6e 7a65 726f 280d 0a20 2020 2020 2020  onzero(..       
+00011790: 2020 2020 2020 2020 2028 7372 635f 6172           (src_ar
+000117a0: 7261 795b 6e70 2e69 7363 6c6f 7365 2873  ray[np.isclose(s
+000117b0: 7263 5f61 7272 6179 2c20 7365 6c66 2e6e  rc_array, self.n
+000117c0: 6f5f 6461 7461 5f76 616c 7565 5b30 5d2c  o_data_value[0],
+000117d0: 2072 746f 6c3d 302e 3030 3129 5d29 0d0a   rtol=0.001)])..
+000117e0: 2020 2020 2020 2020 2020 2020 290d 0a20              ).. 
+000117f0: 2020 2020 2020 2020 2020 2023 2063 6f75             # cou
+00011800: 6e74 2074 6865 206f 7574 206f 6620 646f  nt the out of do
+00011810: 6d69 616e 2063 656c 6c73 2069 6e20 7468  mian cells in th
+00011820: 6520 6d61 736b 0d0a 2020 2020 2020 2020  e mask..        
+00011830: 2020 2020 656c 656d 5f6d 6173 6b20 3d20      elem_mask = 
+00011840: 6d61 736b 5f61 7272 6179 2e73 697a 6520  mask_array.size 
+00011850: 2d20 6e70 2e63 6f75 6e74 5f6e 6f6e 7a65  - np.count_nonze
+00011860: 726f 280d 0a20 2020 2020 2020 2020 2020  ro(..           
+00011870: 2020 2020 2028 6d61 736b 5f61 7272 6179       (mask_array
+00011880: 5b6e 702e 6973 636c 6f73 6528 6d61 736b  [np.isclose(mask
+00011890: 5f61 7272 6179 2c20 6d61 736b 5f6e 6f76  _array, mask_nov
+000118a0: 616c 2c20 7274 6f6c 3d30 2e30 3031 295d  al, rtol=0.001)]
+000118b0: 290d 0a20 2020 2020 2020 2020 2020 2029  )..            )
+000118c0: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
+000118d0: 2320 6966 206e 6f74 2065 7175 616c 2074  # if not equal t
+000118e0: 6865 6e20 7374 6f72 6520 696e 6469 6365  hen store indice
+000118f0: 7320 6f66 2074 686f 7365 2063 656c 6c73  s of those cells
+00011900: 2074 6861 7420 646f 6573 6e27 7420 6d61   that doesn't ma
+00011910: 7463 6873 0d0a 2020 2020 2020 2020 2020  tchs..          
+00011920: 2020 6966 2065 6c65 6d5f 6d61 736b 203e    if elem_mask >
+00011930: 2065 6c65 6d5f 7372 633a 0d0a 2020 2020   elem_src:..    
+00011940: 2020 2020 2020 2020 2020 2020 726f 7773              rows
+00011950: 203d 205b 0d0a 2020 2020 2020 2020 2020   = [..          
+00011960: 2020 2020 2020 2020 2020 690d 0a20 2020            i..   
+00011970: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011980: 2066 6f72 2069 2069 6e20 7261 6e67 6528   for i in range(
+00011990: 726f 7729 0d0a 2020 2020 2020 2020 2020  row)..          
+000119a0: 2020 2020 2020 2020 2020 666f 7220 6a20            for j 
+000119b0: 696e 2072 616e 6765 2863 6f6c 290d 0a20  in range(col).. 
+000119c0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000119d0: 2020 2069 6620 6e70 2e69 7363 6c6f 7365     if np.isclose
+000119e0: 2873 7263 5f61 7272 6179 5b69 2c20 6a5d  (src_array[i, j]
+000119f0: 2c20 7365 6c66 2e6e 6f5f 6461 7461 5f76  , self.no_data_v
+00011a00: 616c 7565 5b30 5d2c 2072 746f 6c3d 302e  alue[0], rtol=0.
+00011a10: 3030 3129 0d0a 2020 2020 2020 2020 2020  001)..          
+00011a20: 2020 2020 2020 2020 2020 616e 6420 6e6f            and no
+00011a30: 7420 6e70 2e69 7363 6c6f 7365 286d 6173  t np.isclose(mas
+00011a40: 6b5f 6172 7261 795b 692c 206a 5d2c 206d  k_array[i, j], m
+00011a50: 6173 6b5f 6e6f 7661 6c2c 2072 746f 6c3d  ask_noval, rtol=
+00011a60: 302e 3030 3129 0d0a 2020 2020 2020 2020  0.001)..        
+00011a70: 2020 2020 2020 2020 5d0d 0a20 2020 2020          ]..     
+00011a80: 2020 2020 2020 2020 2020 2063 6f6c 7320             cols 
+00011a90: 3d20 5b0d 0a20 2020 2020 2020 2020 2020  = [..           
+00011aa0: 2020 2020 2020 2020 206a 0d0a 2020 2020           j..    
+00011ab0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011ac0: 666f 7220 6920 696e 2072 616e 6765 2872  for i in range(r
+00011ad0: 6f77 290d 0a20 2020 2020 2020 2020 2020  ow)..           
+00011ae0: 2020 2020 2020 2020 2066 6f72 206a 2069           for j i
+00011af0: 6e20 7261 6e67 6528 636f 6c29 0d0a 2020  n range(col)..  
+00011b00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011b10: 2020 6966 206e 702e 6973 636c 6f73 6528    if np.isclose(
+00011b20: 7372 635f 6172 7261 795b 692c 206a 5d2c  src_array[i, j],
+00011b30: 2073 656c 662e 6e6f 5f64 6174 615f 7661   self.no_data_va
+00011b40: 6c75 655b 305d 2c20 7274 6f6c 3d30 2e30  lue[0], rtol=0.0
+00011b50: 3031 290d 0a20 2020 2020 2020 2020 2020  01)..           
+00011b60: 2020 2020 2020 2020 2061 6e64 206e 6f74           and not
+00011b70: 206e 702e 6973 636c 6f73 6528 6d61 736b   np.isclose(mask
+00011b80: 5f61 7272 6179 5b69 2c20 6a5d 2c20 6d61  _array[i, j], ma
+00011b90: 736b 5f6e 6f76 616c 2c20 7274 6f6c 3d30  sk_noval, rtol=0
+00011ba0: 2e30 3031 290d 0a20 2020 2020 2020 2020  .001)..         
+00011bb0: 2020 2020 2020 205d 0d0a 2020 2020 2020         ]..      
+00011bc0: 2020 2020 2020 2320 696e 7465 7270 6f6c        # interpol
+00011bd0: 6174 6520 7468 6f73 6520 6d69 7373 696e  ate those missin
+00011be0: 6720 6365 6c6c 7320 6279 206e 6561 7265  g cells by neare
+00011bf0: 7374 206e 6569 6768 626f 7572 0d0a 2020  st neighbour..  
+00011c00: 2020 2020 2020 2020 2020 6966 2065 6c65            if ele
+00011c10: 6d5f 6d61 736b 203e 2065 6c65 6d5f 7372  m_mask > elem_sr
+00011c20: 633a 0d0a 2020 2020 2020 2020 2020 2020  c:..            
+00011c30: 2020 2020 7372 635f 6172 7261 7920 3d20      src_array = 
+00011c40: 4461 7461 7365 742e 5f6e 6561 7265 7374  Dataset._nearest
+00011c50: 5f6e 6569 6768 626f 7572 280d 0a20 2020  _neighbour(..   
+00011c60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00011c70: 2073 7263 5f61 7272 6179 2c20 7365 6c66   src_array, self
+00011c80: 2e6e 6f5f 6461 7461 5f76 616c 7565 5b30  .no_data_value[0
+00011c90: 5d2c 2072 6f77 732c 2063 6f6c 730d 0a20  ], rows, cols.. 
+00011ca0: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+00011cb0: 0d0a 2020 2020 2020 2020 2020 2020 7265  ..            re
+00011cc0: 7475 726e 2073 7263 5f61 7272 6179 0d0a  turn src_array..
+00011cd0: 0d0a 2020 2020 6465 6620 5f63 726f 705f  ..    def _crop_
+00011ce0: 616c 6c69 676e 6564 280d 0a20 2020 2020  alligned(..     
+00011cf0: 2020 2073 656c 662c 0d0a 2020 2020 2020     self,..      
+00011d00: 2020 6d61 736b 3a20 556e 696f 6e5b 6764    mask: Union[gd
+00011d10: 616c 2e44 6174 6173 6574 2c20 6e70 2e6e  al.Dataset, np.n
+00011d20: 6461 7272 6179 5d2c 0d0a 2020 2020 2020  darray],..      
+00011d30: 2020 6d61 736b 5f6e 6f76 616c 3a20 556e    mask_noval: Un
+00011d40: 696f 6e5b 696e 742c 2066 6c6f 6174 5d20  ion[int, float] 
+00011d50: 3d20 4e6f 6e65 2c0d 0a20 2020 2020 2020  = None,..       
+00011d60: 2066 696c 6c5f 6761 7073 3a20 626f 6f6c   fill_gaps: bool
+00011d70: 203d 2046 616c 7365 2c0d 0a20 2020 2029   = False,..    )
+00011d80: 202d 3e20 556e 696f 6e5b 6e70 2e6e 6461   -> Union[np.nda
+00011d90: 7272 6179 2c20 6764 616c 2e44 6174 6173  rray, gdal.Datas
+00011da0: 6574 5d3a 0d0a 2020 2020 2020 2020 2222  et]:..        ""
+00011db0: 2263 726f 7041 6c6c 6967 6e65 642e 0d0a  "cropAlligned...
+00011dc0: 0d0a 2020 2020 2020 2020 6372 6f70 416c  ..        cropAl
+00011dd0: 6c69 676e 6564 2063 6c69 702f 6372 6f70  ligned clip/crop
+00011de0: 2028 6d61 7463 6865 7320 7468 6520 6c6f   (matches the lo
+00011df0: 6361 7469 6f6e 206f 6620 6e6f 6461 7461  cation of nodata
+00011e00: 2076 616c 7565 2066 726f 6d20 6d61 736b   value from mask
+00011e10: 2074 6f20 7372 630d 0a20 2020 2020 2020   to src..       
+00011e20: 2072 6173 7465 7229 2c0d 0a20 2020 2020   raster),..     
+00011e30: 2020 2020 2020 202d 2042 6f74 6820 7261         - Both ra
+00011e40: 7374 6572 7320 6861 7665 2074 6f20 6861  sters have to ha
+00011e50: 7665 2074 6865 2073 616d 6520 6469 6d65  ve the same dime
+00011e60: 6e73 696f 6e73 2028 6e6f 206f 6620 726f  nsions (no of ro
+00011e70: 7773 2026 2063 6f6c 756d 6e73 290d 0a20  ws & columns).. 
+00011e80: 2020 2020 2020 2020 2020 2073 6f20 4d61             so Ma
+00011e90: 7463 6852 6173 7465 7241 6c69 676e 6d65  tchRasterAlignme
+00011ea0: 6e74 2073 686f 756c 6420 6265 2075 7365  nt should be use
+00011eb0: 6420 7072 696f 7220 746f 2074 6869 7320  d prior to this 
+00011ec0: 6675 6e63 7469 6f6e 2074 6f20 616c 6967  function to alig
+00011ed0: 6e20 626f 7468 0d0a 2020 2020 2020 2020  n both..        
+00011ee0: 2020 2020 7261 7374 6572 730d 0a0d 0a20      rasters.... 
+00011ef0: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
+00011f00: 730d 0a20 2020 2020 2020 202d 2d2d 2d2d  s..        -----
+00011f10: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 206d  -----..        m
+00011f20: 6173 6b3a 205b 4461 7461 7365 742f 6e70  ask: [Dataset/np
+00011f30: 2e6e 6461 7272 6179 5d0d 0a20 2020 2020  .ndarray]..     
+00011f40: 2020 2020 2020 206d 6173 6b20 7261 7374         mask rast
+00011f50: 6572 2074 6f20 6765 7420 7468 6520 6c6f  er to get the lo
+00011f60: 6361 7469 6f6e 206f 6620 7468 6520 4e6f  cation of the No
+00011f70: 4461 7461 5661 6c75 6520 616e 640d 0a20  DataValue and.. 
+00011f80: 2020 2020 2020 2020 2020 2077 6865 7265             where
+00011f90: 2069 7420 6973 2069 6e20 7468 6520 6172   it is in the ar
+00011fa0: 7261 790d 0a20 2020 2020 2020 206d 6173  ray..        mas
+00011fb0: 6b5f 6e6f 7661 6c3a 205b 6e75 6d65 7269  k_noval: [numeri
+00011fc0: 635d 0d0a 2020 2020 2020 2020 2020 2020  c]..            
+00011fd0: 696e 2063 6173 6520 7468 6520 6d61 736b  in case the mask
+00011fe0: 2069 7320 6e70 2e6e 6461 7272 6179 2c20   is np.ndarray, 
+00011ff0: 7468 6520 6d61 736b 5f6e 6f76 616c 2068  the mask_noval h
+00012000: 6176 6520 746f 2062 6520 6769 7665 6e2e  ave to be given.
+00012010: 0d0a 2020 2020 2020 2020 6669 6c6c 5f67  ..        fill_g
+00012020: 6170 733a 205b 626f 6f6c 5d0d 0a20 2020  aps: [bool]..   
+00012030: 2020 2020 2020 2020 2044 6566 6175 6c74           Default
+00012040: 2069 7320 4661 6c73 652e 0d0a 0d0a 2020   is False.....  
+00012050: 2020 2020 2020 5265 7475 726e 730d 0a20        Returns.. 
+00012060: 2020 2020 2020 202d 2d2d 2d2d 2d2d 0d0a         -------..
+00012070: 2020 2020 2020 2020 6473 743a 205b 6764          dst: [gd
+00012080: 616c 2e64 6174 6173 6574 5d0d 0a20 2020  al.dataset]..   
+00012090: 2020 2020 2020 2020 2074 6865 2073 6563           the sec
+000120a0: 6f6e 6420 7261 7374 6572 2077 6974 6820  ond raster with 
+000120b0: 4e6f 4461 7461 5661 6c75 6520 7374 6f72  NoDataValue stor
+000120c0: 6564 2069 6e20 6974 7320 6365 6c6c 730d  ed in its cells.
+000120d0: 0a20 2020 2020 2020 2020 2020 2065 7861  .            exa
+000120e0: 6374 6c79 2074 6865 2073 616d 6520 6c69  ctly the same li
+000120f0: 6b65 2073 7263 2072 6173 7465 720d 0a20  ke src raster.. 
+00012100: 2020 2020 2020 2022 2222 0d0a 2020 2020         """..    
+00012110: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
+00012120: 6528 6d61 736b 2c20 4461 7461 7365 7429  e(mask, Dataset)
+00012130: 3a0d 0a20 2020 2020 2020 2020 2020 206d  :..            m
+00012140: 6173 6b5f 6774 203d 206d 6173 6b2e 6765  ask_gt = mask.ge
+00012150: 6f74 7261 6e73 666f 726d 0d0a 2020 2020  otransform..    
+00012160: 2020 2020 2020 2020 6d61 736b 5f65 7073          mask_eps
+00012170: 6720 3d20 6d61 736b 2e65 7073 670d 0a20  g = mask.epsg.. 
+00012180: 2020 2020 2020 2020 2020 2072 6f77 203d             row =
+00012190: 206d 6173 6b2e 726f 7773 0d0a 2020 2020   mask.rows..    
+000121a0: 2020 2020 2020 2020 636f 6c20 3d20 6d61          col = ma
+000121b0: 736b 2e63 6f6c 756d 6e73 0d0a 2020 2020  sk.columns..    
+000121c0: 2020 2020 2020 2020 6d61 736b 5f6e 6f76          mask_nov
+000121d0: 616c 203d 206d 6173 6b2e 6e6f 5f64 6174  al = mask.no_dat
+000121e0: 615f 7661 6c75 655b 305d 0d0a 2020 2020  a_value[0]..    
+000121f0: 2020 2020 2020 2020 6d61 736b 5f61 7272          mask_arr
+00012200: 6179 203d 206d 6173 6b2e 7265 6164 5f61  ay = mask.read_a
+00012210: 7272 6179 2829 0d0a 2020 2020 2020 2020  rray()..        
+00012220: 656c 6966 2069 7369 6e73 7461 6e63 6528  elif isinstance(
+00012230: 6d61 736b 2c20 6e70 2e6e 6461 7272 6179  mask, np.ndarray
+00012240: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
+00012250: 6966 206d 6173 6b5f 6e6f 7661 6c20 6973  if mask_noval is
+00012260: 204e 6f6e 653a 0d0a 2020 2020 2020 2020   None:..        
+00012270: 2020 2020 2020 2020 7261 6973 6520 5661          raise Va
+00012280: 6c75 6545 7272 6f72 280d 0a20 2020 2020  lueError(..     
+00012290: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+000122a0: 596f 7520 6861 7665 2074 6f20 656e 7465  You have to ente
+000122b0: 7220 7468 6520 7661 6c75 6520 6f66 2074  r the value of t
+000122c0: 6865 206e 6f5f 7661 6c20 7061 7261 6d65  he no_val parame
+000122d0: 7465 7220 7768 656e 2074 6865 206d 6173  ter when the mas
+000122e0: 6b20 6973 2061 206e 756d 7079 2061 7272  k is a numpy arr
+000122f0: 6179 220d 0a20 2020 2020 2020 2020 2020  ay"..           
+00012300: 2020 2020 2029 0d0a 2020 2020 2020 2020       )..        
+00012310: 2020 2020 6d61 736b 5f61 7272 6179 203d      mask_array =
+00012320: 206d 6173 6b2e 636f 7079 2829 0d0a 2020   mask.copy()..  
+00012330: 2020 2020 2020 2020 2020 726f 772c 2063            row, c
+00012340: 6f6c 203d 206d 6173 6b2e 7368 6170 650d  ol = mask.shape.
+00012350: 0a20 2020 2020 2020 2065 6c73 653a 0d0a  .        else:..
+00012360: 2020 2020 2020 2020 2020 2020 7261 6973              rais
+00012370: 6520 5479 7065 4572 726f 7228 0d0a 2020  e TypeError(..  
+00012380: 2020 2020 2020 2020 2020 2020 2020 2254                "T
+00012390: 6865 2073 6563 6f6e 6420 7061 7261 6d65  he second parame
+000123a0: 7465 7220 276d 6173 6b27 2068 6173 2074  ter 'mask' has t
+000123b0: 6f20 6265 2065 6974 6865 7220 6764 616c  o be either gdal
+000123c0: 2e44 6174 6163 7562 6520 6f72 206e 756d  .Datacube or num
+000123d0: 7079 2061 7272 6179 220d 0a20 2020 2020  py array"..     
+000123e0: 2020 2020 2020 2020 2020 2066 2267 6976             f"giv
+000123f0: 656e 202d 207b 7479 7065 286d 6173 6b29  en - {type(mask)
+00012400: 7d22 0d0a 2020 2020 2020 2020 2020 2020  }"..            
+00012410: 290d 0a0d 0a20 2020 2020 2020 2062 616e  )....        ban
+00012420: 645f 636f 756e 7420 3d20 7365 6c66 2e62  d_count = self.b
+00012430: 616e 645f 636f 756e 740d 0a20 2020 2020  and_count..     
+00012440: 2020 2073 7263 5f73 7265 6620 3d20 6f73     src_sref = os
+00012450: 722e 5370 6174 6961 6c52 6566 6572 656e  r.SpatialReferen
+00012460: 6365 2877 6b74 3d73 656c 662e 6372 7329  ce(wkt=self.crs)
+00012470: 0d0a 2020 2020 2020 2020 7372 635f 6172  ..        src_ar
+00012480: 7261 7920 3d20 7365 6c66 2e72 6561 645f  ray = self.read_
+00012490: 6172 7261 7928 290d 0a0d 0a20 2020 2020  array()....     
+000124a0: 2020 2069 6620 6e6f 7420 726f 7720 3d3d     if not row ==
+000124b0: 2073 656c 662e 726f 7773 206f 7220 6e6f   self.rows or no
+000124c0: 7420 636f 6c20 3d3d 2073 656c 662e 636f  t col == self.co
+000124d0: 6c75 6d6e 733a 0d0a 2020 2020 2020 2020  lumns:..        
+000124e0: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
+000124f0: 7272 6f72 280d 0a20 2020 2020 2020 2020  rror(..         
+00012500: 2020 2020 2020 2022 5477 6f20 7261 7374         "Two rast
+00012510: 6572 7320 6861 7320 6469 6666 6572 656e  ers has differen
+00012520: 7420 6e75 6d62 6572 206f 6620 636f 6c75  t number of colu
+00012530: 6d6e 7320 6f72 2072 6f77 7320 706c 6561  mns or rows plea
+00012540: 7365 2072 6573 616d 706c 6520 6f72 206d  se resample or m
+00012550: 6174 6368 2062 6f74 6820 7261 7374 6572  atch both raster
+00012560: 7322 0d0a 2020 2020 2020 2020 2020 2020  s"..            
+00012570: 290d 0a0d 0a20 2020 2020 2020 2069 6620  )....        if 
+00012580: 6973 696e 7374 616e 6365 286d 6173 6b2c  isinstance(mask,
+00012590: 2044 6174 6173 6574 293a 0d0a 2020 2020   Dataset):..    
+000125a0: 2020 2020 2020 2020 6966 2028 0d0a 2020          if (..  
+000125b0: 2020 2020 2020 2020 2020 2020 2020 6e6f                no
+000125c0: 7420 7365 6c66 2e70 6976 6f74 5f70 6f69  t self.pivot_poi
+000125d0: 6e74 203d 3d20 6d61 736b 2e70 6976 6f74  nt == mask.pivot
+000125e0: 5f70 6f69 6e74 0d0a 2020 2020 2020 2020  _point..        
+000125f0: 2020 2020 2020 2020 6f72 206e 6f74 2073          or not s
+00012600: 656c 662e 6365 6c6c 5f73 697a 6520 3d3d  elf.cell_size ==
+00012610: 206d 6173 6b2e 6365 6c6c 5f73 697a 650d   mask.cell_size.
+00012620: 0a20 2020 2020 2020 2020 2020 2029 3a0d  .            ):.
+00012630: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00012640: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
+00012650: 7228 0d0a 2020 2020 2020 2020 2020 2020  r(..            
+00012660: 2020 2020 2020 2020 226c 6f63 6174 696f          "locatio
+00012670: 6e20 6f66 2075 7070 6572 206c 6566 7420  n of upper left 
+00012680: 636f 726e 6572 206f 6620 626f 7468 2072  corner of both r
+00012690: 6173 7465 7273 2061 7265 206e 6f74 2074  asters are not t
+000126a0: 6865 2073 616d 6520 6f72 2063 656c 6c20  he same or cell 
+000126b0: 7369 7a65 2069 7320 220d 0a20 2020 2020  size is "..     
+000126c0: 2020 2020 2020 2020 2020 2020 2020 2022                 "
+000126d0: 6469 6666 6572 656e 7420 706c 6561 7365  different please
+000126e0: 206d 6174 6368 2062 6f74 6820 7261 7374   match both rast
+000126f0: 6572 7320 6669 7273 7420 220d 0a20 2020  ers first "..   
+00012700: 2020 2020 2020 2020 2020 2020 2029 0d0a               )..
+00012710: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
+00012720: 206e 6f74 206d 6173 6b5f 6570 7367 203d   not mask_epsg =
+00012730: 3d20 7365 6c66 2e65 7073 673a 0d0a 2020  = self.epsg:..  
+00012740: 2020 2020 2020 2020 2020 2020 2020 7261                ra
+00012750: 6973 6520 5661 6c75 6545 7272 6f72 280d  ise ValueError(.
+00012760: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00012770: 2020 2020 2022 4461 7461 7365 7420 4120       "Dataset A 
+00012780: 2620 4220 6172 6520 7573 696e 6720 6469  & B are using di
+00012790: 6666 6572 656e 7420 636f 6f72 6469 6e61  fferent coordina
+000127a0: 7465 2073 7973 7465 6d20 706c 6561 7365  te system please
+000127b0: 2072 6570 726f 6a65 6374 206f 6e65 206f   reproject one o
+000127c0: 6620 7468 656d 2074 6f20 220d 0a20 2020  f them to "..   
+000127d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000127e0: 2022 7468 6520 6f74 6865 7220 7261 7374   "the other rast
+000127f0: 6572 2063 6f6f 7264 696e 6174 6520 7379  er coordinate sy
+00012800: 7374 656d 220d 0a20 2020 2020 2020 2020  stem"..         
+00012810: 2020 2020 2020 2029 0d0a 0d0a 2020 2020         )....    
+00012820: 2020 2020 6966 2062 616e 645f 636f 756e      if band_coun
+00012830: 7420 3e20 313a 0d0a 2020 2020 2020 2020  t > 1:..        
+00012840: 2020 2020 666f 7220 6261 6e64 2069 6e20      for band in 
+00012850: 7261 6e67 6528 7365 6c66 2e62 616e 645f  range(self.band_
+00012860: 636f 756e 7429 3a0d 0a20 2020 2020 2020  count):..       
+00012870: 2020 2020 2020 2020 2069 6620 6d61 736b           if mask
+00012880: 5f6e 6f76 616c 2069 7320 4e6f 6e65 3a0d  _noval is None:.
+00012890: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000128a0: 2020 2020 2073 7263 5f61 7272 6179 5b62       src_array[b
+000128b0: 616e 642c 206e 702e 6973 6e61 6e28 6d61  and, np.isnan(ma
+000128c0: 736b 5f61 7272 6179 295d 203d 2073 656c  sk_array)] = sel
+000128d0: 662e 6e6f 5f64 6174 615f 7661 6c75 655b  f.no_data_value[
+000128e0: 6261 6e64 5d0d 0a20 2020 2020 2020 2020  band]..         
+000128f0: 2020 2020 2020 2065 6c73 653a 0d0a 2020         else:..  
+00012900: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012910: 2020 7372 635f 6172 7261 795b 0d0a 2020    src_array[..  
+00012920: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012930: 2020 2020 2020 6261 6e64 2c20 6e70 2e69        band, np.i
+00012940: 7363 6c6f 7365 286d 6173 6b5f 6172 7261  sclose(mask_arra
+00012950: 792c 206d 6173 6b5f 6e6f 7661 6c2c 2072  y, mask_noval, r
+00012960: 746f 6c3d 302e 3030 3129 0d0a 2020 2020  tol=0.001)..    
+00012970: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00012980: 5d20 3d20 7365 6c66 2e6e 6f5f 6461 7461  ] = self.no_data
+00012990: 5f76 616c 7565 5b62 616e 645d 0d0a 2020  _value[band]..  
+000129a0: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
+000129b0: 2020 2020 2020 2020 2069 6620 6d61 736b           if mask
+000129c0: 5f6e 6f76 616c 2069 7320 4e6f 6e65 3a0d  _noval is None:.
+000129d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000129e0: 2073 7263 5f61 7272 6179 5b6e 702e 6973   src_array[np.is
+000129f0: 6e61 6e28 6d61 736b 5f61 7272 6179 295d  nan(mask_array)]
+00012a00: 203d 2073 656c 662e 6e6f 5f64 6174 615f   = self.no_data_
+00012a10: 7661 6c75 655b 305d 0d0a 2020 2020 2020  value[0]..      
+00012a20: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
+00012a30: 2020 2020 2020 2020 2020 2020 2073 7263               src
+00012a40: 5f61 7272 6179 5b0d 0a20 2020 2020 2020  _array[..       
+00012a50: 2020 2020 2020 2020 2020 2020 206e 702e               np.
+00012a60: 6973 636c 6f73 6528 6d61 736b 5f61 7272  isclose(mask_arr
+00012a70: 6179 2c20 6d61 736b 5f6e 6f76 616c 2c20  ay, mask_noval, 
+00012a80: 7274 6f6c 3d30 2e30 3031 290d 0a20 2020  rtol=0.001)..   
+00012a90: 2020 2020 2020 2020 2020 2020 205d 203d               ] =
+00012aa0: 2073 656c 662e 6e6f 5f64 6174 615f 7661   self.no_data_va
+00012ab0: 6c75 655b 305d 0d0a 0d0a 2020 2020 2020  lue[0]....      
+00012ac0: 2020 6966 2066 696c 6c5f 6761 7073 3a0d    if fill_gaps:.
+00012ad0: 0a20 2020 2020 2020 2020 2020 2073 7263  .            src
+00012ae0: 5f61 7272 6179 203d 2073 656c 662e 6669  _array = self.fi
+00012af0: 6c6c 5f67 6170 7328 6d61 736b 2c20 7372  ll_gaps(mask, sr
+00012b00: 635f 6172 7261 7929 0d0a 0d0a 2020 2020  c_array)....    
+00012b10: 2020 2020 6473 7420 3d20 4461 7461 7365      dst = Datase
+00012b20: 742e 5f63 7265 6174 655f 6764 616c 5f64  t._create_gdal_d
+00012b30: 6174 6173 6574 280d 0a20 2020 2020 2020  ataset(..       
+00012b40: 2020 2020 2063 6f6c 2c20 726f 772c 2062       col, row, b
+00012b50: 616e 645f 636f 756e 742c 2073 656c 662e  and_count, self.
+00012b60: 6474 7970 655b 305d 2c20 6472 6976 6572  dtype[0], driver
+00012b70: 3d22 4d45 4d22 0d0a 2020 2020 2020 2020  ="MEM"..        
+00012b80: 290d 0a20 2020 2020 2020 2023 2062 7574  )..        # but
+00012b90: 2077 6974 6820 6c6f 7420 6f66 2063 6f6d   with lot of com
+00012ba0: 7075 7461 7469 6f6e 0d0a 2020 2020 2020  putation..      
+00012bb0: 2020 2320 6966 2074 6865 206d 6173 6b20    # if the mask 
+00012bc0: 6973 2061 6e20 6172 7261 7920 616e 6420  is an array and 
+00012bd0: 7468 6520 6d61 736b 5f67 7420 6973 206e  the mask_gt is n
+00012be0: 6f74 2064 6566 696e 6564 2075 7365 2074  ot defined use t
+00012bf0: 6865 2073 7263 5f67 7420 6173 2062 6f74  he src_gt as bot
+00012c00: 6820 7468 6520 6d61 736b 2061 6e64 2074  h the mask and t
+00012c10: 6865 2073 7263 0d0a 2020 2020 2020 2020  he src..        
+00012c20: 2320 6172 6520 616c 6967 6e65 6420 736f  # are aligned so
+00012c30: 2074 6865 7920 6861 7665 2074 6865 2073   they have the s
+00012c40: 616d 2067 740d 0a20 2020 2020 2020 2074  am gt..        t
+00012c50: 7279 3a0d 0a20 2020 2020 2020 2020 2020  ry:..           
+00012c60: 2023 2073 6574 2074 6865 2067 656f 7472   # set the geotr
+00012c70: 616e 7366 6f72 6d0d 0a20 2020 2020 2020  ansform..       
+00012c80: 2020 2020 2064 7374 2e53 6574 4765 6f54       dst.SetGeoT
+00012c90: 7261 6e73 666f 726d 286d 6173 6b5f 6774  ransform(mask_gt
+00012ca0: 290d 0a20 2020 2020 2020 2020 2020 2023  )..            #
+00012cb0: 2073 6574 2074 6865 2070 726f 6a65 6374   set the project
+00012cc0: 696f 6e0d 0a20 2020 2020 2020 2020 2020  ion..           
+00012cd0: 2064 7374 2e53 6574 5072 6f6a 6563 7469   dst.SetProjecti
+00012ce0: 6f6e 286d 6173 6b2e 6372 7329 0d0a 2020  on(mask.crs)..  
+00012cf0: 2020 2020 2020 6578 6365 7074 2055 6e62        except Unb
+00012d00: 6f75 6e64 4c6f 6361 6c45 7272 6f72 3a0d  oundLocalError:.
+00012d10: 0a20 2020 2020 2020 2020 2020 2064 7374  .            dst
+00012d20: 2e53 6574 4765 6f54 7261 6e73 666f 726d  .SetGeoTransform
+00012d30: 2873 656c 662e 6765 6f74 7261 6e73 666f  (self.geotransfo
+00012d40: 726d 290d 0a20 2020 2020 2020 2020 2020  rm)..           
+00012d50: 2064 7374 2e53 6574 5072 6f6a 6563 7469   dst.SetProjecti
+00012d60: 6f6e 2873 7263 5f73 7265 662e 4578 706f  on(src_sref.Expo
+00012d70: 7274 546f 576b 7428 2929 0d0a 0d0a 2020  rtToWkt())....  
+00012d80: 2020 2020 2020 6473 745f 6f62 6a20 3d20        dst_obj = 
+00012d90: 4461 7461 7365 7428 6473 7429 0d0a 2020  Dataset(dst)..  
+00012da0: 2020 2020 2020 2320 7365 7420 7468 6520        # set the 
+00012db0: 6e6f 2064 6174 6120 7661 6c75 650d 0a20  no data value.. 
+00012dc0: 2020 2020 2020 2064 7374 5f6f 626a 2e5f         dst_obj._
+00012dd0: 7365 745f 6e6f 5f64 6174 615f 7661 6c75  set_no_data_valu
+00012de0: 6528 7365 6c66 2e6e 6f5f 6461 7461 5f76  e(self.no_data_v
+00012df0: 616c 7565 290d 0a20 2020 2020 2020 2069  alue)..        i
+00012e00: 6620 6261 6e64 5f63 6f75 6e74 203e 2031  f band_count > 1
+00012e10: 3a0d 0a20 2020 2020 2020 2020 2020 2066  :..            f
+00012e20: 6f72 2062 616e 6420 696e 2072 616e 6765  or band in range
+00012e30: 2862 616e 645f 636f 756e 7429 3a0d 0a20  (band_count):.. 
+00012e40: 2020 2020 2020 2020 2020 2020 2020 2064                 d
+00012e50: 7374 5f6f 626a 2e72 6173 7465 722e 4765  st_obj.raster.Ge
+00012e60: 7452 6173 7465 7242 616e 6428 6261 6e64  tRasterBand(band
+00012e70: 202b 2031 292e 5772 6974 6541 7272 6179   + 1).WriteArray
+00012e80: 2873 7263 5f61 7272 6179 5b62 616e 642c  (src_array[band,
+00012e90: 203a 2c20 3a5d 290d 0a20 2020 2020 2020   :, :])..       
+00012ea0: 2065 6c73 653a 0d0a 2020 2020 2020 2020   else:..        
+00012eb0: 2020 2020 6473 745f 6f62 6a2e 7261 7374      dst_obj.rast
+00012ec0: 6572 2e47 6574 5261 7374 6572 4261 6e64  er.GetRasterBand
+00012ed0: 2831 292e 5772 6974 6541 7272 6179 2873  (1).WriteArray(s
+00012ee0: 7263 5f61 7272 6179 290d 0a20 2020 2020  rc_array)..     
+00012ef0: 2020 2072 6574 7572 6e20 6473 745f 6f62     return dst_ob
+00012f00: 6a0d 0a0d 0a20 2020 2064 6566 205f 6368  j....    def _ch
+00012f10: 6563 6b5f 616c 6967 6e6d 656e 7428 7365  eck_alignment(se
+00012f20: 6c66 2c20 6d61 736b 2920 2d3e 2062 6f6f  lf, mask) -> boo
+00012f30: 6c3a 0d0a 2020 2020 2020 2020 2222 2243  l:..        """C
+00012f40: 6865 636b 2069 6620 7261 7374 6572 2069  heck if raster i
+00012f50: 7320 616c 6967 6e65 6420 7769 7468 2061  s aligned with a
+00012f60: 2067 6976 656e 206d 6173 6b20 7261 7374   given mask rast
+00012f70: 6572 2222 220d 0a20 2020 2020 2020 2069  er"""..        i
+00012f80: 6620 6e6f 7420 6973 696e 7374 616e 6365  f not isinstance
+00012f90: 286d 6173 6b2c 2044 6174 6173 6574 293a  (mask, Dataset):
+00012fa0: 0d0a 2020 2020 2020 2020 2020 2020 7261  ..            ra
+00012fb0: 6973 6520 5479 7065 4572 726f 7228 2254  ise TypeError("T
+00012fc0: 6865 2073 6563 6f6e 6420 7061 7261 6d65  he second parame
+00012fd0: 7465 7220 7368 6f75 6c64 2062 6520 6120  ter should be a 
+00012fe0: 4461 7461 7365 7422 290d 0a0d 0a20 2020  Dataset")....   
+00012ff0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+00013000: 2e72 6f77 7320 3d3d 206d 6173 6b2e 726f  .rows == mask.ro
+00013010: 7773 2061 6e64 2073 656c 662e 636f 6c75  ws and self.colu
+00013020: 6d6e 7320 3d3d 206d 6173 6b2e 636f 6c75  mns == mask.colu
+00013030: 6d6e 730d 0a0d 0a20 2020 2064 6566 2061  mns....    def a
+00013040: 6c69 676e 280d 0a20 2020 2020 2020 2073  lign(..        s
+00013050: 656c 662c 0d0a 2020 2020 2020 2020 616c  elf,..        al
+00013060: 6967 6e6d 656e 745f 7372 632c 0d0a 2020  ignment_src,..  
+00013070: 2020 2920 2d3e 2067 6461 6c2e 4461 7461    ) -> gdal.Data
+00013080: 7365 743a 0d0a 2020 2020 2020 2020 2222  set:..        ""
+00013090: 2261 6c69 676e 2e0d 0a0d 0a20 2020 2020  "align.....     
+000130a0: 2020 2061 6c69 676e 206d 6574 686f 6420     align method 
+000130b0: 636f 7069 6573 2074 6865 2066 6f6c 6c6f  copies the follo
+000130c0: 7769 6e67 2064 6174 610d 0a20 2020 2020  wing data..     
+000130d0: 2020 2020 2020 202d 2054 6865 2063 6f6f         - The coo
+000130e0: 7264 696e 6174 6520 7379 7374 656d 0d0a  rdinate system..
+000130f0: 2020 2020 2020 2020 2020 2020 2d20 5468              - Th
+00013100: 6520 6e75 6d62 6572 206f 6620 6f66 2072  e number of of r
+00013110: 6f77 7320 2620 636f 6c75 6d6e 730d 0a20  ows & columns.. 
+00013120: 2020 2020 2020 2020 2020 202d 2063 656c             - cel
+00013130: 6c20 7369 7a65 0d0a 2020 2020 2020 2020  l size..        
+00013140: 6672 6f6d 2061 6c69 676e 6d65 6e74 5f73  from alignment_s
+00013150: 7263 2074 6f20 6120 6461 7461 5f73 7263  rc to a data_src
+00013160: 2072 6173 7465 7220 2874 6865 2073 6f75   raster (the sou
+00013170: 7263 6520 6f66 2064 6174 6120 7661 6c75  rce of data valu
+00013180: 6573 2069 6e20 6365 6c6c 7329 0d0a 0d0a  es in cells)....
+00013190: 2020 2020 2020 2020 7468 6520 7265 7375          the resu
+000131a0: 6c74 2077 696c 6c20 6265 2061 2072 6173  lt will be a ras
+000131b0: 7465 7220 7769 7468 2074 6865 2073 616d  ter with the sam
+000131c0: 6520 7374 7275 6374 7572 6520 6c69 6b65  e structure like
+000131d0: 2061 6c69 676e 6d65 6e74 5f73 7263 2062   alignment_src b
+000131e0: 7574 2077 6974 680d 0a20 2020 2020 2020  ut with..       
+000131f0: 2076 616c 7565 7320 6672 6f6d 2064 6174   values from dat
+00013200: 615f 7372 6320 7573 696e 6720 4e65 6172  a_src using Near
+00013210: 6573 7420 4e65 6967 6862 6f75 7220 696e  est Neighbour in
+00013220: 7465 7270 6f6c 6174 696f 6e20 616c 676f  terpolation algo
+00013230: 7269 7468 6d0d 0a0d 0a20 2020 2020 2020  rithm....       
+00013240: 2050 6172 616d 6574 6572 730d 0a20 2020   Parameters..   
+00013250: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d       ----------.
+00013260: 0a20 2020 2020 2020 2061 6c69 676e 6d65  .        alignme
+00013270: 6e74 5f73 7263 203a 205b 4461 7461 7365  nt_src : [Datase
+00013280: 745d 0d0a 2020 2020 2020 2020 2020 2020  t]..            
+00013290: 7370 6174 6961 6c20 696e 666f 726d 6174  spatial informat
+000132a0: 696f 6e20 736f 7572 6365 2072 6173 7465  ion source raste
+000132b0: 7220 746f 2067 6574 2074 6865 2073 7061  r to get the spa
+000132c0: 7469 616c 2069 6e66 6f72 6d61 7469 6f6e  tial information
+000132d0: 0d0a 2020 2020 2020 2020 2020 2020 2863  ..            (c
+000132e0: 6f6f 7264 696e 6174 6520 7379 7374 656d  oordinate system
+000132f0: 2c20 6e6f 206f 6620 726f 7773 2026 2063  , no of rows & c
+00013300: 6f6c 756d 6e73 290d 0a20 2020 2020 2020  olumns)..       
+00013310: 2020 2020 2064 6174 6120 7661 6c75 6573       data values
+00013320: 2073 6f75 7263 6520 7261 7374 6572 2074   source raster t
+00013330: 6f20 6765 7420 7468 6520 6461 7461 2028  o get the data (
+00013340: 7661 6c75 6573 206f 6620 6561 6368 2063  values of each c
+00013350: 656c 6c29 0d0a 0d0a 2020 2020 2020 2020  ell)....        
+00013360: 5265 7475 726e 730d 0a20 2020 2020 2020  Returns..       
+00013370: 202d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020   -------..      
+00013380: 2020 6473 7420 3a20 5b44 6174 6173 6574    dst : [Dataset
+00013390: 5d0d 0a20 2020 2020 2020 2020 2020 2044  ]..            D
+000133a0: 6174 6173 6574 206f 626a 6563 740d 0a0d  ataset object...
+000133b0: 0a20 2020 2020 2020 2045 7861 6d70 6c65  .        Example
+000133c0: 730d 0a20 2020 2020 2020 202d 2d2d 2d2d  s..        -----
+000133d0: 2d2d 2d0d 0a20 2020 2020 2020 203e 3e3e  ---..        >>>
+000133e0: 2041 203d 2067 6461 6c2e 4f70 656e 2822   A = gdal.Open("
+000133f0: 6578 616d 706c 6573 2f47 4953 2f64 6174  examples/GIS/dat
+00013400: 612f 6163 6334 3030 302e 7469 6622 290d  a/acc4000.tif").
+00013410: 0a20 2020 2020 2020 203e 3e3e 2042 203d  .        >>> B =
+00013420: 2067 6461 6c2e 4f70 656e 2822 6578 616d   gdal.Open("exam
+00013430: 706c 6573 2f47 4953 2f64 6174 612f 736f  ples/GIS/data/so
+00013440: 696c 5f72 6173 7465 722e 7469 6622 290d  il_raster.tif").
+00013450: 0a20 2020 2020 2020 203e 3e3e 2052 6173  .        >>> Ras
+00013460: 7465 7242 4d61 7463 6865 6420 3d20 4461  terBMatched = Da
+00013470: 7461 7365 742e 616c 6967 6e28 412c 4229  taset.align(A,B)
+00013480: 0d0a 2020 2020 2020 2020 2222 220d 0a20  ..        """.. 
+00013490: 2020 2020 2020 2069 6620 6973 696e 7374         if isinst
+000134a0: 616e 6365 2861 6c69 676e 6d65 6e74 5f73  ance(alignment_s
+000134b0: 7263 2c20 4461 7461 7365 7429 3a0d 0a20  rc, Dataset):.. 
+000134c0: 2020 2020 2020 2020 2020 2073 7263 203d             src =
+000134d0: 2061 6c69 676e 6d65 6e74 5f73 7263 0d0a   alignment_src..
+000134e0: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
+000134f0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+00013500: 2054 7970 6545 7272 6f72 280d 0a20 2020   TypeError(..   
+00013510: 2020 2020 2020 2020 2020 2020 2022 4669               "Fi
+00013520: 7273 7420 7061 7261 6d65 7465 7220 7368  rst parameter sh
+00013530: 6f75 6c64 2062 6520 6120 4461 7461 7365  ould be a Datase
+00013540: 7420 7265 6164 2075 7369 6e67 2044 6174  t read using Dat
+00013550: 6173 6574 2e6f 7065 6e52 6173 7465 7220  aset.openRaster 
+00013560: 6f72 2061 2070 6174 6820 746f 2074 6865  or a path to the
+00013570: 2072 6173 7465 722c 2022 0d0a 2020 2020   raster, "..    
+00013580: 2020 2020 2020 2020 2020 2020 6622 6769              f"gi
+00013590: 7665 6e20 7b74 7970 6528 616c 6967 6e6d  ven {type(alignm
+000135a0: 656e 745f 7372 6329 7d22 0d0a 2020 2020  ent_src)}"..    
+000135b0: 2020 2020 2020 2020 290d 0a0d 0a20 2020          )....   
+000135c0: 2020 2020 2023 2072 6570 726f 6a65 6374       # reproject
+000135d0: 2074 6865 2072 6173 7465 7220 746f 206d   the raster to m
+000135e0: 6174 6368 2074 6865 2070 726f 6a65 6374  atch the project
+000135f0: 696f 6e20 6f66 2061 6c69 676e 6d65 6e74  ion of alignment
+00013600: 5f73 7263 0d0a 2020 2020 2020 2020 6966  _src..        if
+00013610: 206e 6f74 2073 656c 662e 6570 7367 203d   not self.epsg =
+00013620: 3d20 7372 632e 6570 7367 3a0d 0a20 2020  = src.epsg:..   
+00013630: 2020 2020 2020 2020 2072 6570 726f 6a65           reproje
+00013640: 6374 6564 5f52 6173 7465 7242 203d 2073  cted_RasterB = s
+00013650: 656c 662e 746f 5f63 7273 2873 7263 2e65  elf.to_crs(src.e
+00013660: 7073 6729 0d0a 2020 2020 2020 2020 656c  psg)..        el
+00013670: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
+00013680: 2072 6570 726f 6a65 6374 6564 5f52 6173   reprojected_Ras
+00013690: 7465 7242 203d 2073 656c 660d 0a20 2020  terB = self..   
+000136a0: 2020 2020 2023 2063 7265 6174 6520 6120       # create a 
+000136b0: 6e65 7720 7261 7374 6572 0d0a 2020 2020  new raster..    
+000136c0: 2020 2020 6473 7420 3d20 4461 7461 7365      dst = Datase
+000136d0: 742e 5f63 7265 6174 655f 6764 616c 5f64  t._create_gdal_d
+000136e0: 6174 6173 6574 280d 0a20 2020 2020 2020  ataset(..       
+000136f0: 2020 2020 2073 7263 2e63 6f6c 756d 6e73       src.columns
+00013700: 2c20 7372 632e 726f 7773 2c20 7365 6c66  , src.rows, self
+00013710: 2e62 616e 645f 636f 756e 742c 2073 7263  .band_count, src
+00013720: 2e64 7479 7065 5b30 5d2c 2064 7269 7665  .dtype[0], drive
+00013730: 723d 224d 454d 220d 0a20 2020 2020 2020  r="MEM"..       
+00013740: 2029 0d0a 2020 2020 2020 2020 2320 7365   )..        # se
+00013750: 7420 7468 6520 6765 6f74 7261 6e73 666f  t the geotransfo
+00013760: 726d 0d0a 2020 2020 2020 2020 6473 742e  rm..        dst.
+00013770: 5365 7447 656f 5472 616e 7366 6f72 6d28  SetGeoTransform(
+00013780: 7372 632e 6765 6f74 7261 6e73 666f 726d  src.geotransform
+00013790: 290d 0a20 2020 2020 2020 2023 2073 6574  )..        # set
+000137a0: 2074 6865 2070 726f 6a65 6374 696f 6e0d   the projection.
+000137b0: 0a20 2020 2020 2020 2064 7374 2e53 6574  .        dst.Set
+000137c0: 5072 6f6a 6563 7469 6f6e 2873 7263 2e63  Projection(src.c
+000137d0: 7273 290d 0a20 2020 2020 2020 2023 2073  rs)..        # s
+000137e0: 6574 2074 6865 206e 6f20 6461 7461 2076  et the no data v
+000137f0: 616c 7565 0d0a 2020 2020 2020 2020 6473  alue..        ds
+00013800: 745f 6f62 6a20 3d20 4461 7461 7365 7428  t_obj = Dataset(
+00013810: 6473 7429 0d0a 2020 2020 2020 2020 6473  dst)..        ds
+00013820: 745f 6f62 6a2e 5f73 6574 5f6e 6f5f 6461  t_obj._set_no_da
+00013830: 7461 5f76 616c 7565 2873 7263 2e6e 6f5f  ta_value(src.no_
+00013840: 6461 7461 5f76 616c 7565 290d 0a20 2020  data_value)..   
+00013850: 2020 2020 2023 2070 6572 666f 726d 2074       # perform t
+00013860: 6865 2070 726f 6a65 6374 696f 6e20 2620  he projection & 
+00013870: 7265 7361 6d70 6c69 6e67 0d0a 2020 2020  resampling..    
+00013880: 2020 2020 6d65 7468 6f64 203d 2067 6461      method = gda
+00013890: 6c2e 4752 415f 4e65 6172 6573 744e 6569  l.GRA_NearestNei
+000138a0: 6768 626f 7572 0d0a 2020 2020 2020 2020  ghbour..        
+000138b0: 2320 7265 7361 6d70 6c65 2074 6865 2072  # resample the r
+000138c0: 6570 726f 6a65 6374 6564 5f52 6173 7465  eprojected_Raste
+000138d0: 7242 0d0a 2020 2020 2020 2020 6764 616c  rB..        gdal
+000138e0: 2e52 6570 726f 6a65 6374 496d 6167 6528  .ReprojectImage(
+000138f0: 0d0a 2020 2020 2020 2020 2020 2020 7265  ..            re
+00013900: 7072 6f6a 6563 7465 645f 5261 7374 6572  projected_Raster
+00013910: 422e 7261 7374 6572 2c0d 0a20 2020 2020  B.raster,..     
+00013920: 2020 2020 2020 2064 7374 5f6f 626a 2e72         dst_obj.r
+00013930: 6173 7465 722c 0d0a 2020 2020 2020 2020  aster,..        
+00013940: 2020 2020 7372 632e 6372 732c 0d0a 2020      src.crs,..  
+00013950: 2020 2020 2020 2020 2020 7372 632e 6372            src.cr
+00013960: 732c 0d0a 2020 2020 2020 2020 2020 2020  s,..            
+00013970: 6d65 7468 6f64 2c0d 0a20 2020 2020 2020  method,..       
+00013980: 2029 0d0a 0d0a 2020 2020 2020 2020 7265   )....        re
+00013990: 7475 726e 2064 7374 5f6f 626a 0d0a 0d0a  turn dst_obj....
+000139a0: 2020 2020 6465 6620 5f63 726f 705f 7769      def _crop_wi
+000139b0: 7468 5f72 6173 7465 7228 0d0a 2020 2020  th_raster(..    
+000139c0: 2020 2020 7365 6c66 2c0d 0a20 2020 2020      self,..     
+000139d0: 2020 206d 6173 6b3a 2055 6e69 6f6e 5b67     mask: Union[g
+000139e0: 6461 6c2e 4461 7461 7365 742c 2073 7472  dal.Dataset, str
+000139f0: 5d2c 0d0a 2020 2020 2920 2d3e 2067 6461  ],..    ) -> gda
+00013a00: 6c2e 4461 7461 7365 743a 0d0a 2020 2020  l.Dataset:..    
+00013a10: 2020 2020 2222 2263 726f 702e 0d0a 0d0a      """crop.....
+00013a20: 2020 2020 2020 2020 2020 2020 6372 6f70              crop
+00013a30: 206d 6574 686f 6420 6372 6f70 7320 6120   method crops a 
+00013a40: 7261 7374 6572 2075 7369 6e67 2061 6e6f  raster using ano
+00013a50: 7468 6572 2072 6173 7465 7220 2862 6f74  ther raster (bot
+00013a60: 6820 7261 7374 6572 7320 646f 6573 206e  h rasters does n
+00013a70: 6f74 2068 6176 6520 746f 2062 6520 616c  ot have to be al
+00013a80: 6967 6e65 6429 2e0d 0a0d 0a20 2020 2020  igned).....     
+00013a90: 2020 2050 6172 616d 6574 6572 730d 0a20     Parameters.. 
+00013aa0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+00013ab0: 2d2d 0d0a 2020 2020 2020 2020 6d61 736b  --..        mask
+00013ac0: 203a 205b 7374 7269 6e67 2f44 6174 6173   : [string/Datas
+00013ad0: 6574 5d0d 0a20 2020 2020 2020 2020 2020  et]..           
+00013ae0: 2074 6865 2072 6173 7465 7220 796f 7520   the raster you 
+00013af0: 7761 6e74 2074 6f20 7573 6520 6173 2061  want to use as a
+00013b00: 206d 6173 6b20 746f 2063 726f 7020 6f74   mask to crop ot
+00013b10: 6865 7220 7261 7374 6572 2c0d 0a20 2020  her raster,..   
+00013b20: 2020 2020 2020 2020 2074 6865 206d 6173           the mas
+00013b30: 6b20 6361 6e20 6265 2061 6c73 6f20 6120  k can be also a 
+00013b40: 7061 7468 206f 7220 6120 6764 616c 206f  path or a gdal o
+00013b50: 626a 6563 742e 0d0a 0d0a 2020 2020 2020  bject.....      
+00013b60: 2020 5265 7475 726e 730d 0a20 2020 2020    Returns..     
+00013b70: 2020 202d 2d2d 2d2d 2d2d 0d0a 2020 2020     -------..    
+00013b80: 2020 2020 6473 7420 3a20 5b44 6174 6173      dst : [Datas
+00013b90: 6574 5d0d 0a20 2020 2020 2020 2020 2020  et]..           
+00013ba0: 2074 6865 2063 726f 7070 6564 2072 6173   the cropped ras
+00013bb0: 7465 7220 7769 6c6c 2062 6520 7265 7475  ter will be retu
+00013bc0: 726e 6564 2c20 6966 2074 6865 2073 6176  rned, if the sav
+00013bd0: 6520 7061 7261 6d65 7465 7220 7761 7320  e parameter was 
+00013be0: 5472 7565 2c0d 0a20 2020 2020 2020 2020  True,..         
+00013bf0: 2020 2074 6865 2063 726f 7070 6564 2072     the cropped r
+00013c00: 6173 7465 7220 7769 6c6c 2061 6c73 6f20  aster will also 
+00013c10: 6265 2073 6176 6564 2074 6f20 6469 736b  be saved to disk
+00013c20: 2069 6e20 7468 6520 4f75 7470 7574 5061   in the OutputPa
+00013c30: 7468 0d0a 2020 2020 2020 2020 2020 2020  th..            
+00013c40: 6469 7265 6374 6f72 792e 0d0a 2020 2020  directory...    
+00013c50: 2020 2020 2222 220d 0a20 2020 2020 2020      """..       
+00013c60: 2023 2067 6574 2069 6e66 6f72 6d61 7469   # get informati
+00013c70: 6f6e 2066 726f 6d20 7468 6520 6d61 736b  on from the mask
+00013c80: 2072 6173 7465 720d 0a20 2020 2020 2020   raster..       
+00013c90: 2069 6620 6973 696e 7374 616e 6365 286d   if isinstance(m
+00013ca0: 6173 6b2c 2073 7472 293a 0d0a 2020 2020  ask, str):..    
+00013cb0: 2020 2020 2020 2020 6d61 736b 203d 2044          mask = D
+00013cc0: 6174 6173 6574 2e72 6561 645f 6669 6c65  ataset.read_file
+00013cd0: 286d 6173 6b29 0d0a 2020 2020 2020 2020  (mask)..        
+00013ce0: 656c 6966 2069 7369 6e73 7461 6e63 6528  elif isinstance(
+00013cf0: 6d61 736b 2c20 4461 7461 7365 7429 3a0d  mask, Dataset):.
+00013d00: 0a20 2020 2020 2020 2020 2020 206d 6173  .            mas
+00013d10: 6b20 3d20 6d61 736b 0d0a 2020 2020 2020  k = mask..      
+00013d20: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
+00013d30: 2020 2020 2072 6169 7365 2054 7970 6545       raise TypeE
+00013d40: 7272 6f72 280d 0a20 2020 2020 2020 2020  rror(..         
+00013d50: 2020 2020 2020 2022 5365 636f 6e64 2070         "Second p
+00013d60: 6172 616d 6574 6572 2068 6173 2074 6f20  arameter has to 
+00013d70: 6265 2065 6974 6865 7220 7061 7468 2074  be either path t
+00013d80: 6f20 7468 6520 6d61 736b 2072 6173 7465  o the mask raste
+00013d90: 7220 6f72 2061 2067 6461 6c2e 4461 7461  r or a gdal.Data
+00013da0: 6375 6265 206f 626a 6563 7422 0d0a 2020  cube object"..  
+00013db0: 2020 2020 2020 2020 2020 290d 0a20 2020            )..   
+00013dc0: 2020 2020 2069 6620 6e6f 7420 7365 6c66       if not self
+00013dd0: 2e5f 6368 6563 6b5f 616c 6967 6e6d 656e  ._check_alignmen
+00013de0: 7428 6d61 736b 293a 0d0a 2020 2020 2020  t(mask):..      
+00013df0: 2020 2020 2020 2320 6669 7273 7420 616c        # first al
+00013e00: 6967 6e20 7468 6520 6d61 736b 2077 6974  ign the mask wit
+00013e10: 6820 7468 6520 7372 6320 7261 7374 6572  h the src raster
+00013e20: 0d0a 2020 2020 2020 2020 2020 2020 6d61  ..            ma
+00013e30: 736b 203d 206d 6173 6b2e 616c 6967 6e28  sk = mask.align(
+00013e40: 7365 6c66 290d 0a20 2020 2020 2020 2023  self)..        #
+00013e50: 2063 726f 7020 7468 6520 7372 6320 7261   crop the src ra
+00013e60: 7374 6572 2077 6974 6820 7468 6520 616c  ster with the al
+00013e70: 6967 6e65 6420 6d61 736b 0d0a 2020 2020  igned mask..    
+00013e80: 2020 2020 6473 745f 6f62 6a20 3d20 7365      dst_obj = se
+00013e90: 6c66 2e5f 6372 6f70 5f61 6c6c 6967 6e65  lf._crop_alligne
+00013ea0: 6428 6d61 736b 290d 0a0d 0a20 2020 2020  d(mask)....     
+00013eb0: 2020 2072 6574 7572 6e20 6473 745f 6f62     return dst_ob
+00013ec0: 6a0d 0a0d 0a20 2020 2064 6566 205f 6372  j....    def _cr
+00013ed0: 6f70 5f77 6974 685f 706f 6c79 676f 6e28  op_with_polygon(
+00013ee0: 7365 6c66 2c20 706f 6c79 3a20 4765 6f44  self, poly: GeoD
+00013ef0: 6174 6146 7261 6d65 293a 0d0a 2020 2020  ataFrame):..    
+00013f00: 2020 2020 2222 2263 726f 7057 6974 6850      """cropWithP
+00013f10: 6f6c 7967 6f6e 2e0d 0a0d 0a20 2020 2020  olygon.....     
+00013f20: 2020 2020 2020 2063 6c69 7020 7468 6520         clip the 
+00013f30: 5261 7374 6572 206f 626a 6563 7420 7573  Raster object us
+00013f40: 696e 6720 6120 706f 6c79 676f 6e20 7665  ing a polygon ve
+00013f50: 6374 6f72 2e0d 0a0d 0a20 2020 2020 2020  ctor.....       
+00013f60: 2050 6172 616d 6574 6572 730d 0a20 2020   Parameters..   
+00013f70: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d       ----------.
+00013f80: 0a20 2020 2020 2020 2070 6f6c 793a 205b  .        poly: [
+00013f90: 506f 6c79 676f 6e20 4765 6f44 6174 6146  Polygon GeoDataF
+00013fa0: 7261 6d65 5d0d 0a20 2020 2020 2020 2020  rame]..         
+00013fb0: 2020 2047 656f 6461 7461 4672 616d 6520     GeodataFrame 
+00013fc0: 7769 7468 2061 2067 656f 6d65 7472 7920  with a geometry 
+00013fd0: 6f66 2070 6f6c 7967 6f6e 2074 7970 652e  of polygon type.
+00013fe0: 0d0a 2020 2020 2020 2020 5265 7475 726e  ..        Return
+00013ff0: 730d 0a20 2020 2020 2020 202d 2d2d 2d2d  s..        -----
+00014000: 2d2d 0d0a 2020 2020 2020 2020 4461 7461  --..        Data
+00014010: 7365 740d 0a20 2020 2020 2020 2022 2222  set..        """
+00014020: 0d0a 2020 2020 2020 2020 6966 206e 6f74  ..        if not
+00014030: 2069 7369 6e73 7461 6e63 6528 706f 6c79   isinstance(poly
+00014040: 2c20 4765 6f44 6174 6146 7261 6d65 293a  , GeoDataFrame):
+00014050: 0d0a 2020 2020 2020 2020 2020 2020 7261  ..            ra
+00014060: 6973 6520 5479 7065 4572 726f 7228 0d0a  ise TypeError(..
+00014070: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00014080: 2254 6865 2073 6563 6f6e 6420 7061 7261  "The second para
+00014090: 6d65 7465 723a 2070 6f6c 7920 7368 6f75  meter: poly shou
+000140a0: 6c64 2062 6520 6f66 2074 7970 6520 4765  ld be of type Ge
+000140b0: 6f44 6174 6146 7261 6d65 2022 0d0a 2020  oDataFrame "..  
+000140c0: 2020 2020 2020 2020 2020 290d 0a0d 0a20            ).... 
+000140d0: 2020 2020 2020 2070 6f6c 795f 6570 7367         poly_epsg
+000140e0: 203d 2070 6f6c 792e 6372 732e 746f 5f65   = poly.crs.to_e
+000140f0: 7073 6728 290d 0a20 2020 2020 2020 2073  psg()..        s
+00014100: 7263 5f65 7073 6720 3d20 7365 6c66 2e65  rc_epsg = self.e
+00014110: 7073 670d 0a20 2020 2020 2020 2069 6620  psg..        if 
+00014120: 706f 6c79 5f65 7073 6720 213d 2073 7263  poly_epsg != src
+00014130: 5f65 7073 673a 0d0a 2020 2020 2020 2020  _epsg:..        
+00014140: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
+00014150: 7272 6f72 280d 0a20 2020 2020 2020 2020  rror(..         
+00014160: 2020 2020 2020 2022 5072 6f6a 6563 7469         "Projecti
+00014170: 6f6e 2045 7272 6f72 3a20 7468 6520 7261  on Error: the ra
+00014180: 7374 6572 2061 6e64 2076 6563 746f 7220  ster and vector 
+00014190: 706f 6c79 676f 6e20 6861 7665 2064 6966  polygon have dif
+000141a0: 6665 7265 6e74 2070 726f 6a65 6374 696f  ferent projectio
+000141b0: 6e20 706c 6561 7365 2022 0d0a 2020 2020  n please "..    
+000141c0: 2020 2020 2020 2020 2020 2020 2275 6e69              "uni
+000141d0: 6679 2070 726f 6a65 6374 696f 6e22 0d0a  fy projection"..
+000141e0: 2020 2020 2020 2020 2020 2020 290d 0a20              ).. 
+000141f0: 2020 2020 2020 2076 6563 746f 7220 3d20         vector = 
+00014200: 4665 6174 7572 6543 6f6c 6c65 6374 696f  FeatureCollectio
+00014210: 6e28 706f 6c79 290d 0a20 2020 2020 2020  n(poly)..       
+00014220: 206d 6173 6b20 3d20 7665 6374 6f72 2e74   mask = vector.t
+00014230: 6f5f 6461 7461 7365 7428 6461 7461 7365  o_dataset(datase
+00014240: 743d 7365 6c66 290d 0a20 2020 2020 2020  t=self)..       
+00014250: 2063 726f 7070 6564 5f6f 626a 203d 2073   cropped_obj = s
+00014260: 656c 662e 5f63 726f 705f 7769 7468 5f72  elf._crop_with_r
+00014270: 6173 7465 7228 6d61 736b 290d 0a0d 0a20  aster(mask).... 
+00014280: 2020 2020 2020 2023 2078 6d69 6e2c 2079         # xmin, y
+00014290: 6d69 6e2c 2078 6d61 782c 2079 6d61 7820  min, xmax, ymax 
+000142a0: 3d20 706f 6c79 2e62 6f75 6e64 732e 7661  = poly.bounds.va
+000142b0: 6c75 6573 2e74 6f6c 6973 7428 295b 305d  lues.tolist()[0]
+000142c0: 0d0a 2020 2020 2020 2020 2320 7769 6e64  ..        # wind
+000142d0: 6f77 203d 2028 786d 696e 2c20 796d 6178  ow = (xmin, ymax
+000142e0: 2c20 786d 6178 2c20 796d 696e 290d 0a20  , xmax, ymin).. 
+000142f0: 2020 2020 2020 2023 2023 2067 6461 6c2e         # # gdal.
+00014300: 5472 616e 736c 6174 654f 7074 696f 6e73  TranslateOptions
+00014310: 2864 7374 2c20 7373 2c20 7072 6f6a 5769  (dst, ss, projWi
+00014320: 6e3d 7769 6e64 6f77 290d 0a20 2020 2020  n=window)..     
+00014330: 2020 2023 2023 2063 6f70 7920 7468 6520     # # copy the 
+00014340: 7372 6320 7261 7374 6572 0d0a 2020 2020  src raster..    
+00014350: 2020 2020 2320 6472 7620 3d20 6764 616c      # drv = gdal
+00014360: 2e47 6574 4472 6976 6572 4279 4e61 6d65  .GetDriverByName
+00014370: 2822 4d45 4d22 290d 0a20 2020 2020 2020  ("MEM")..       
+00014380: 2023 2064 7374 203d 2064 7276 2e43 7265   # dst = drv.Cre
+00014390: 6174 6543 6f70 7928 2222 2c20 7365 6c66  ateCopy("", self
+000143a0: 2e72 6173 7465 722c 2030 290d 0a20 2020  .raster, 0)..   
+000143b0: 2020 2020 2023 2074 7279 3a0d 0a20 2020       # try:..   
+000143c0: 2020 2020 2023 2020 2020 2067 6461 6c2e       #     gdal.
+000143d0: 5472 616e 736c 6174 6528 6473 742c 2073  Translate(dst, s
+000143e0: 656c 662e 7261 7374 6572 2c20 7072 6f6a  elf.raster, proj
+000143f0: 5769 6e3d 7769 6e64 6f77 290d 0a20 2020  Win=window)..   
+00014400: 2020 2020 2023 2065 7863 6570 7420 5275       # except Ru
+00014410: 6e74 696d 6545 7272 6f72 3a0d 0a20 2020  ntimeError:..   
+00014420: 2020 2020 2023 2020 2020 2070 6173 730d       #     pass.
+00014430: 0a0d 0a20 2020 2020 2020 2023 2063 726f  ...        # cro
+00014440: 7070 6564 5f6f 626a 203d 2044 6174 6173  pped_obj = Datas
+00014450: 6574 2864 7374 290d 0a0d 0a20 2020 2020  et(dst)....     
+00014460: 2020 2072 6574 7572 6e20 6372 6f70 7065     return croppe
+00014470: 645f 6f62 6a0d 0a0d 0a20 2020 2064 6566  d_obj....    def
+00014480: 2063 726f 7028 7365 6c66 2c20 6d61 736b   crop(self, mask
+00014490: 3a20 556e 696f 6e5b 4765 6f44 6174 6146  : Union[GeoDataF
+000144a0: 7261 6d65 5d29 3a0d 0a20 2020 2020 2020  rame]):..       
+000144b0: 2022 2222 0d0a 0d0a 2020 2020 2020 2020   """....        
+000144c0: 2020 2020 636c 6970 2074 6865 2044 6174      clip the Dat
+000144d0: 6173 6574 206f 626a 6563 7420 7573 696e  aset object usin
+000144e0: 6720 6120 706f 6c79 676f 6e2f 616e 6f74  g a polygon/anot
+000144f0: 6865 7220 7261 7374 6572 2028 626f 7468  her raster (both
+00014500: 2072 6173 7465 7273 2064 6f65 7320 6e6f   rasters does no
+00014510: 7420 6861 7665 2074 6f20 6265 2061 6c69  t have to be ali
+00014520: 676e 6564 292e 0d0a 0d0a 2020 2020 2020  gned).....      
+00014530: 2020 5061 7261 6d65 7465 7273 0d0a 2020    Parameters..  
+00014540: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+00014550: 0d0a 2020 2020 2020 2020 6d61 736b 3a20  ..        mask: 
+00014560: 5b50 6f6c 7967 6f6e 2047 656f 4461 7461  [Polygon GeoData
+00014570: 4672 616d 652f 4461 7461 7365 7420 6f62  Frame/Dataset ob
+00014580: 6a65 6374 5d0d 0a20 2020 2020 2020 2020  ject]..         
+00014590: 2020 2047 656f 6461 7461 4672 616d 6520     GeodataFrame 
+000145a0: 7769 7468 2061 2067 656f 6d65 7472 7920  with a geometry 
+000145b0: 6f66 2070 6f6c 7967 6f6e 2074 7970 650d  of polygon type.
+000145c0: 0a0d 0a20 2020 2020 2020 2052 6574 7572  ...        Retur
+000145d0: 6e73 0d0a 2020 2020 2020 2020 2d2d 2d2d  ns..        ----
+000145e0: 2d2d 2d0d 0a20 2020 2020 2020 2044 6174  ---..        Dat
+000145f0: 6173 6574 204f 626a 6563 740d 0a20 2020  aset Object..   
+00014600: 2020 2020 2022 2222 0d0a 2020 2020 2020       """..      
+00014610: 2020 6966 2069 7369 6e73 7461 6e63 6528    if isinstance(
+00014620: 6d61 736b 2c20 4765 6f44 6174 6146 7261  mask, GeoDataFra
+00014630: 6d65 293a 0d0a 2020 2020 2020 2020 2020  me):..          
+00014640: 2020 6473 7420 3d20 7365 6c66 2e5f 6372    dst = self._cr
+00014650: 6f70 5f77 6974 685f 706f 6c79 676f 6e28  op_with_polygon(
+00014660: 6d61 736b 290d 0a20 2020 2020 2020 2065  mask)..        e
+00014670: 6c69 6620 6973 696e 7374 616e 6365 286d  lif isinstance(m
+00014680: 6173 6b2c 2044 6174 6173 6574 293a 0d0a  ask, Dataset):..
+00014690: 2020 2020 2020 2020 2020 2020 6473 7420              dst 
+000146a0: 3d20 7365 6c66 2e5f 6372 6f70 5f77 6974  = self._crop_wit
+000146b0: 685f 7261 7374 6572 286d 6173 6b29 0d0a  h_raster(mask)..
+000146c0: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
+000146d0: 2020 2020 2020 2020 2020 2072 6169 7365             raise
+000146e0: 2054 7970 6545 7272 6f72 280d 0a20 2020   TypeError(..   
+000146f0: 2020 2020 2020 2020 2020 2020 2022 5468               "Th
+00014700: 6520 7365 636f 6e64 2070 6172 616d 6574  e second paramet
+00014710: 6572 3a20 6d61 736b 2063 6f75 6c64 2062  er: mask could b
+00014720: 6520 6569 7468 6572 2047 656f 4461 7461  e either GeoData
+00014730: 4672 616d 6520 6f72 2044 6174 6173 6574  Frame or Dataset
+00014740: 206f 626a 6563 7422 0d0a 2020 2020 2020   object"..      
+00014750: 2020 2020 2020 290d 0a0d 0a20 2020 2020        )....     
+00014760: 2020 2072 6574 7572 6e20 6473 740d 0a0d     return dst...
+00014770: 0a20 2020 2040 7374 6174 6963 6d65 7468  .    @staticmeth
+00014780: 6f64 0d0a 2020 2020 6465 6620 5f6e 6561  od..    def _nea
+00014790: 7265 7374 5f6e 6569 6768 626f 7572 280d  rest_neighbour(.
+000147a0: 0a20 2020 2020 2020 2061 7272 6179 3a20  .        array: 
+000147b0: 6e70 2e6e 6461 7272 6179 2c20 6e6f 6461  np.ndarray, noda
+000147c0: 7461 7661 6c75 653a 2055 6e69 6f6e 5b66  tavalue: Union[f
+000147d0: 6c6f 6174 2c20 696e 745d 2c20 726f 7773  loat, int], rows
+000147e0: 3a20 6c69 7374 2c20 636f 6c73 3a20 6c69  : list, cols: li
+000147f0: 7374 0d0a 2020 2020 2920 2d3e 206e 702e  st..    ) -> np.
+00014800: 6e64 6172 7261 793a 0d0a 2020 2020 2020  ndarray:..      
+00014810: 2020 2222 226e 6561 7265 7374 4e65 6967    """nearestNeig
+00014820: 6862 6f75 722e 0d0a 0d0a 2020 2020 2020  hbour.....      
+00014830: 2020 2020 2020 2d20 6669 6c6c 7320 7468        - fills th
+00014840: 6520 6365 6c6c 7320 6f66 2061 2067 6976  e cells of a giv
+00014850: 656e 2069 6e64 6963 6573 2069 6e20 726f  en indices in ro
+00014860: 7773 2061 6e64 2063 6f6c 7320 7769 7468  ws and cols with
+00014870: 2074 6865 2076 616c 7565 206f 6620 7468   the value of th
+00014880: 6520 6e65 6172 6573 740d 0a20 2020 2020  e nearest..     
+00014890: 2020 2020 2020 206e 6569 6768 626f 7572         neighbour
+000148a0: 2e0d 0a20 2020 2020 2020 2020 2020 202d  ...            -
+000148b0: 2053 7320 7468 6520 7261 7374 6572 2067   Ss the raster g
+000148c0: 7269 6420 6973 2073 7175 6172 6520 736f  rid is square so
+000148d0: 2074 6865 2034 2070 6572 7065 6e64 6963   the 4 perpendic
+000148e0: 756c 6172 2064 6972 6563 7469 6f6e 2061  ular direction a
+000148f0: 7265 206f 6620 7468 6520 7361 6d65 2070  re of the same p
+00014900: 726f 7869 6d69 7479 2073 6f20 7468 6520  roximity so the 
+00014910: 6675 6e63 7469 6f6e 0d0a 2020 2020 2020  function..      
+00014920: 2020 2020 2020 6769 7665 7320 7072 696f        gives prio
+00014930: 7269 7479 2074 6f20 7468 6520 7269 6768  rity to the righ
+00014940: 7420 7468 656e 206c 6566 7420 7468 656e  t then left then
+00014950: 2062 6f74 746f 6d20 7468 656e 2074 6f70   bottom then top
+00014960: 2061 6e64 2074 6865 2073 616d 6520 666f   and the same fo
+00014970: 7220 3435 2064 6567 7265 6520 696e 636c  r 45 degree incl
+00014980: 696e 6564 2064 6972 6563 7469 6f6e 0d0a  ined direction..
+00014990: 2020 2020 2020 2020 2020 2020 7269 6768              righ
+000149a0: 7420 626f 7474 6f6d 2074 6865 6e20 6c65  t bottom then le
+000149b0: 6674 2062 6f74 746f 6d20 7468 656e 206c  ft bottom then l
+000149c0: 6566 7420 546f 7020 7468 656e 2072 6967  eft Top then rig
+000149d0: 6874 2054 6f70 2e0d 0a0d 0a20 2020 2020  ht Top.....     
+000149e0: 2020 2050 6172 616d 6574 6572 730d 0a20     Parameters.. 
+000149f0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+00014a00: 2d0d 0a20 2020 2020 2020 2061 7272 6179  -..        array
+00014a10: 3a20 5b6e 756d 7079 2e61 7272 6179 5d0d  : [numpy.array].
+00014a20: 0a20 2020 2020 2020 2020 2020 2041 7272  .            Arr
+00014a30: 6179 2074 6f20 6669 6c6c 2073 6f6d 6520  ay to fill some 
+00014a40: 6f66 2069 7473 2063 656c 6c73 2077 6974  of its cells wit
+00014a50: 6820 4e65 6172 6573 7420 7661 6c75 652e  h Nearest value.
+00014a60: 0d0a 2020 2020 2020 2020 6e6f 6461 7461  ..        nodata
+00014a70: 7661 6c75 653a 205b 666c 6f61 7433 325d  value: [float32]
+00014a80: 0d0a 2020 2020 2020 2020 2020 2020 7661  ..            va
+00014a90: 6c75 6520 7374 6f72 6564 2069 6e20 6365  lue stored in ce
+00014aa0: 6c6c 7320 7468 6174 2069 7320 6f75 7420  lls that is out 
+00014ab0: 6f66 2074 6865 2064 6f6d 6169 6e0d 0a20  of the domain.. 
+00014ac0: 2020 2020 2020 2072 6f77 733a 205b 4c69         rows: [Li
+00014ad0: 7374 5d0d 0a20 2020 2020 2020 2020 2020  st]..           
+00014ae0: 206c 6973 7420 6f66 2074 6865 2072 6f77   list of the row
+00014af0: 7320 696e 6465 7820 6f66 2074 6865 2063  s index of the c
+00014b00: 656c 6c73 2079 6f75 2077 616e 7420 746f  ells you want to
+00014b10: 2066 696c 6c20 6974 2077 6974 680d 0a20   fill it with.. 
+00014b20: 2020 2020 2020 2020 2020 206e 6561 7265             neare
+00014b30: 7374 206e 6569 6768 626f 7572 2e0d 0a20  st neighbour... 
+00014b40: 2020 2020 2020 2063 6f6c 733a 205b 4c69         cols: [Li
+00014b50: 7374 5d0d 0a20 2020 2020 2020 2020 2020  st]..           
+00014b60: 206c 6973 7420 6f66 2074 6865 2063 6f6c   list of the col
+00014b70: 756d 6e20 696e 6465 7820 6f66 2074 6865  umn index of the
+00014b80: 2063 656c 6c73 2079 6f75 2077 616e 7420   cells you want 
+00014b90: 746f 2066 696c 6c20 6974 2077 6974 680d  to fill it with.
+00014ba0: 0a20 2020 2020 2020 2020 2020 206e 6561  .            nea
+00014bb0: 7265 7374 206e 6569 6768 626f 7572 2e0d  rest neighbour..
+00014bc0: 0a0d 0a20 2020 2020 2020 2052 6574 7572  ...        Retur
+00014bd0: 6e73 0d0a 2020 2020 2020 2020 2d2d 2d2d  ns..        ----
+00014be0: 2d2d 2d0d 0a20 2020 2020 2020 2061 7272  ---..        arr
+00014bf0: 6179 3a20 5b6e 756d 7079 2061 7272 6179  ay: [numpy array
+00014c00: 5d0d 0a20 2020 2020 2020 2020 2020 2043  ]..            C
+00014c10: 656c 6c73 206f 6620 6769 7665 6e20 696e  ells of given in
+00014c20: 6469 6365 7320 7769 6c6c 2062 6520 6669  dices will be fi
+00014c30: 6c6c 6564 2077 6974 6820 7661 6c75 6520  lled with value 
+00014c40: 6f66 2074 6865 204e 6561 7265 7374 206e  of the Nearest n
+00014c50: 6569 6768 626f 7572 0d0a 0d0a 2020 2020  eighbour....    
+00014c60: 2020 2020 4578 616d 706c 6573 0d0a 2020      Examples..  
+00014c70: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 0d0a        --------..
+00014c80: 2020 2020 2020 2020 3e3e 3e20 7261 7374          >>> rast
+00014c90: 6572 203d 2067 6461 6c2e 4f70 656e 2822  er = gdal.Open("
+00014ca0: 6465 6d2e 7469 6622 290d 0a20 2020 2020  dem.tif")..     
+00014cb0: 2020 203e 3e3e 2072 6571 5f72 6f77 7320     >>> req_rows 
+00014cc0: 3d20 5b33 2c31 325d 0d0a 2020 2020 2020  = [3,12]..      
+00014cd0: 2020 3e3e 3e20 7265 715f 636f 6c73 203d    >>> req_cols =
+00014ce0: 205b 392c 325d 0d0a 2020 2020 2020 2020   [9,2]..        
+00014cf0: 3e3e 3e20 6e65 775f 6172 7261 7920 3d20  >>> new_array = 
+00014d00: 4461 7461 7365 742e 5f6e 6561 7265 7374  Dataset._nearest
+00014d10: 5f6e 6569 6768 626f 7572 2872 6173 7465  _neighbour(raste
+00014d20: 722c 2072 6571 5f72 6f77 732c 2072 6571  r, req_rows, req
+00014d30: 5f63 6f6c 7329 0d0a 2020 2020 2020 2020  _cols)..        
+00014d40: 2222 220d 0a20 2020 2020 2020 2069 6620  """..        if 
+00014d50: 6e6f 7420 6973 696e 7374 616e 6365 2861  not isinstance(a
+00014d60: 7272 6179 2c20 6e70 2e6e 6461 7272 6179  rray, np.ndarray
+00014d70: 293a 0d0a 2020 2020 2020 2020 2020 2020  ):..            
+00014d80: 7261 6973 6520 5479 7065 4572 726f 7228  raise TypeError(
+00014d90: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00014da0: 2020 2273 7263 2073 686f 756c 6420 6265    "src should be
+00014db0: 2072 6561 6420 7573 696e 6720 6764 616c   read using gdal
+00014dc0: 2028 6764 616c 2064 6174 6173 6574 2070   (gdal dataset p
+00014dd0: 6c65 6173 6520 7265 6164 2069 7420 7573  lease read it us
+00014de0: 696e 6720 6764 616c 206c 6962 7261 7279  ing gdal library
+00014df0: 2920 220d 0a20 2020 2020 2020 2020 2020  ) "..           
+00014e00: 2029 0d0a 2020 2020 2020 2020 6966 206e   )..        if n
+00014e10: 6f74 2069 7369 6e73 7461 6e63 6528 726f  ot isinstance(ro
+00014e20: 7773 2c20 6c69 7374 293a 0d0a 2020 2020  ws, list):..    
+00014e30: 2020 2020 2020 2020 7261 6973 6520 5479          raise Ty
+00014e40: 7065 4572 726f 7228 2272 6f77 7320 696e  peError("rows in
+00014e50: 7075 7420 6861 7320 746f 2062 6520 6f66  put has to be of
+00014e60: 2074 7970 6520 6c69 7374 2229 0d0a 2020   type list")..  
+00014e70: 2020 2020 2020 6966 206e 6f74 2069 7369        if not isi
+00014e80: 6e73 7461 6e63 6528 636f 6c73 2c20 6c69  nstance(cols, li
+00014e90: 7374 293a 0d0a 2020 2020 2020 2020 2020  st):..          
+00014ea0: 2020 7261 6973 6520 5479 7065 4572 726f    raise TypeErro
+00014eb0: 7228 2263 6f6c 7320 696e 7075 7420 6861  r("cols input ha
+00014ec0: 7320 746f 2062 6520 6f66 2074 7970 6520  s to be of type 
+00014ed0: 6c69 7374 2229 0d0a 0d0a 2020 2020 2020  list")....      
+00014ee0: 2020 2320 2020 2061 7272 6179 3d72 6173    #    array=ras
+00014ef0: 7465 722e 5265 6164 4173 4172 7261 7928  ter.ReadAsArray(
+00014f00: 290d 0a20 2020 2020 2020 2023 2020 2020  )..        #    
+00014f10: 6e6f 6461 7461 7661 6c75 653d 6e70 2e66  nodatavalue=np.f
+00014f20: 6c6f 6174 3332 2872 6173 7465 722e 4765  loat32(raster.Ge
+00014f30: 7452 6173 7465 7242 616e 6428 3129 2e47  tRasterBand(1).G
+00014f40: 6574 4e6f 4461 7461 5661 6c75 6528 2929  etNoDataValue())
+00014f50: 0d0a 0d0a 2020 2020 2020 2020 6e6f 5f72  ....        no_r
+00014f60: 6f77 7320 3d20 6e70 2e73 6861 7065 2861  ows = np.shape(a
+00014f70: 7272 6179 295b 305d 0d0a 2020 2020 2020  rray)[0]..      
+00014f80: 2020 6e6f 5f63 6f6c 7320 3d20 6e70 2e73    no_cols = np.s
+00014f90: 6861 7065 2861 7272 6179 295b 315d 0d0a  hape(array)[1]..
+00014fa0: 0d0a 2020 2020 2020 2020 666f 7220 6920  ..        for i 
+00014fb0: 696e 2072 616e 6765 286c 656e 2872 6f77  in range(len(row
+00014fc0: 7329 293a 0d0a 2020 2020 2020 2020 2020  s)):..          
+00014fd0: 2020 2320 6769 7665 2074 6865 2063 656c    # give the cel
+00014fe0: 6c20 7468 6520 7661 6c75 6520 6f66 2074  l the value of t
+00014ff0: 6865 2063 656c 6c20 7468 6174 2069 7320  he cell that is 
+00015000: 6174 2074 6865 2072 6967 6874 0d0a 2020  at the right..  
+00015010: 2020 2020 2020 2020 2020 6966 2061 7272            if arr
+00015020: 6179 5b72 6f77 735b 695d 2c20 636f 6c73  ay[rows[i], cols
+00015030: 5b69 5d20 2b20 315d 2021 3d20 6e6f 6461  [i] + 1] != noda
+00015040: 7461 7661 6c75 6520 616e 6420 636f 6c73  tavalue and cols
+00015050: 5b69 5d20 2b20 3120 3c3d 206e 6f5f 636f  [i] + 1 <= no_co
+00015060: 6c73 3a0d 0a20 2020 2020 2020 2020 2020  ls:..           
+00015070: 2020 2020 2061 7272 6179 5b72 6f77 735b       array[rows[
+00015080: 695d 2c20 636f 6c73 5b69 5d5d 203d 2061  i], cols[i]] = a
+00015090: 7272 6179 5b72 6f77 735b 695d 2c20 636f  rray[rows[i], co
+000150a0: 6c73 5b69 5d20 2b20 315d 0d0a 0d0a 2020  ls[i] + 1]....  
+000150b0: 2020 2020 2020 2020 2020 656c 6966 2061            elif a
+000150c0: 7272 6179 5b72 6f77 735b 695d 2c20 636f  rray[rows[i], co
+000150d0: 6c73 5b69 5d20 2d20 315d 2021 3d20 6e6f  ls[i] - 1] != no
+000150e0: 6461 7461 7661 6c75 6520 616e 6420 636f  datavalue and co
+000150f0: 6c73 5b69 5d20 2d20 3120 3e20 303a 0d0a  ls[i] - 1 > 0:..
+00015100: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015110: 2320 6769 7665 2074 6865 2063 656c 6c20  # give the cell 
+00015120: 7468 6520 7661 6c75 6520 6f66 2074 6865  the value of the
+00015130: 2063 656c 6c20 7468 6174 2069 7320 6174   cell that is at
+00015140: 2074 6865 206c 6566 740d 0a20 2020 2020   the left..     
+00015150: 2020 2020 2020 2020 2020 2061 7272 6179             array
+00015160: 5b72 6f77 735b 695d 2c20 636f 6c73 5b69  [rows[i], cols[i
+00015170: 5d5d 203d 2061 7272 6179 5b72 6f77 735b  ]] = array[rows[
+00015180: 695d 2c20 636f 6c73 5b69 5d20 2d20 315d  i], cols[i] - 1]
+00015190: 0d0a 0d0a 2020 2020 2020 2020 2020 2020  ....            
+000151a0: 656c 6966 2061 7272 6179 5b72 6f77 735b  elif array[rows[
+000151b0: 695d 202d 2031 2c20 636f 6c73 5b69 5d5d  i] - 1, cols[i]]
+000151c0: 2021 3d20 6e6f 6461 7461 7661 6c75 6520   != nodatavalue 
+000151d0: 616e 6420 726f 7773 5b69 5d20 2d20 3120  and rows[i] - 1 
+000151e0: 3e20 303a 0d0a 2020 2020 2020 2020 2020  > 0:..          
+000151f0: 2020 2020 2020 2320 6769 7665 2074 6865        # give the
+00015200: 2063 656c 6c20 7468 6520 7661 6c75 6520   cell the value 
+00015210: 6f66 2074 6865 2063 656c 6c20 7468 6174  of the cell that
+00015220: 2069 7320 6174 2074 6865 2062 6f74 746f   is at the botto
+00015230: 6d0d 0a20 2020 2020 2020 2020 2020 2020  m..             
+00015240: 2020 2061 7272 6179 5b72 6f77 735b 695d     array[rows[i]
+00015250: 2c20 636f 6c73 5b69 5d5d 203d 2061 7272  , cols[i]] = arr
+00015260: 6179 5b72 6f77 735b 695d 202d 2031 2c20  ay[rows[i] - 1, 
+00015270: 636f 6c73 5b69 5d5d 0d0a 0d0a 2020 2020  cols[i]]....    
+00015280: 2020 2020 2020 2020 656c 6966 2061 7272          elif arr
+00015290: 6179 5b72 6f77 735b 695d 202b 2031 2c20  ay[rows[i] + 1, 
+000152a0: 636f 6c73 5b69 5d5d 2021 3d20 6e6f 6461  cols[i]] != noda
+000152b0: 7461 7661 6c75 6520 616e 6420 726f 7773  tavalue and rows
+000152c0: 5b69 5d20 2b20 3120 3c3d 206e 6f5f 726f  [i] + 1 <= no_ro
+000152d0: 7773 3a0d 0a20 2020 2020 2020 2020 2020  ws:..           
+000152e0: 2020 2020 2023 2067 6976 6520 7468 6520       # give the 
+000152f0: 6365 6c6c 2074 6865 2076 616c 7565 206f  cell the value o
+00015300: 6620 7468 6520 6365 6c6c 2074 6861 7420  f the cell that 
+00015310: 6973 2061 7420 7468 6520 546f 700d 0a20  is at the Top.. 
+00015320: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+00015330: 7272 6179 5b72 6f77 735b 695d 2c20 636f  rray[rows[i], co
+00015340: 6c73 5b69 5d5d 203d 2061 7272 6179 5b72  ls[i]] = array[r
+00015350: 6f77 735b 695d 202b 2031 2c20 636f 6c73  ows[i] + 1, cols
+00015360: 5b69 5d5d 0d0a 0d0a 2020 2020 2020 2020  [i]]....        
+00015370: 2020 2020 656c 6966 2028 0d0a 2020 2020      elif (..    
+00015380: 2020 2020 2020 2020 2020 2020 6172 7261              arra
+00015390: 795b 726f 7773 5b69 5d20 2d20 312c 2063  y[rows[i] - 1, c
+000153a0: 6f6c 735b 695d 202b 2031 5d20 213d 206e  ols[i] + 1] != n
+000153b0: 6f64 6174 6176 616c 7565 0d0a 2020 2020  odatavalue..    
+000153c0: 2020 2020 2020 2020 2020 2020 616e 6420              and 
+000153d0: 726f 7773 5b69 5d20 2d20 3120 3e20 300d  rows[i] - 1 > 0.
+000153e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000153f0: 2061 6e64 2063 6f6c 735b 695d 202b 2031   and cols[i] + 1
+00015400: 203c 3d20 6e6f 5f63 6f6c 730d 0a20 2020   <= no_cols..   
+00015410: 2020 2020 2020 2020 2029 3a0d 0a20 2020           ):..   
+00015420: 2020 2020 2020 2020 2020 2020 2023 2067               # g
+00015430: 6976 6520 7468 6520 6365 6c6c 2074 6865  ive the cell the
+00015440: 2076 616c 7565 206f 6620 7468 6520 6365   value of the ce
+00015450: 6c6c 2074 6861 7420 6973 2061 7420 7468  ll that is at th
+00015460: 6520 7269 6768 7420 626f 7474 6f6d 0d0a  e right bottom..
+00015470: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015480: 6172 7261 795b 726f 7773 5b69 5d2c 2063  array[rows[i], c
+00015490: 6f6c 735b 695d 5d20 3d20 6172 7261 795b  ols[i]] = array[
+000154a0: 726f 7773 5b69 5d20 2d20 312c 2063 6f6c  rows[i] - 1, col
+000154b0: 735b 695d 202b 2031 5d0d 0a0d 0a20 2020  s[i] + 1]....   
+000154c0: 2020 2020 2020 2020 2065 6c69 6620 280d           elif (.
+000154d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000154e0: 2061 7272 6179 5b72 6f77 735b 695d 202d   array[rows[i] -
+000154f0: 2031 2c20 636f 6c73 5b69 5d20 2d20 315d   1, cols[i] - 1]
+00015500: 2021 3d20 6e6f 6461 7461 7661 6c75 650d   != nodatavalue.
+00015510: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00015520: 2061 6e64 2072 6f77 735b 695d 202d 2031   and rows[i] - 1
+00015530: 203e 2030 0d0a 2020 2020 2020 2020 2020   > 0..          
+00015540: 2020 2020 2020 616e 6420 636f 6c73 5b69        and cols[i
+00015550: 5d20 2d20 3120 3e20 300d 0a20 2020 2020  ] - 1 > 0..     
+00015560: 2020 2020 2020 2029 3a0d 0a20 2020 2020         ):..     
+00015570: 2020 2020 2020 2020 2020 2023 2067 6976             # giv
+00015580: 6520 7468 6520 6365 6c6c 2074 6865 2076  e the cell the v
+00015590: 616c 7565 206f 6620 7468 6520 6365 6c6c  alue of the cell
+000155a0: 2074 6861 7420 6973 2061 7420 7468 6520   that is at the 
+000155b0: 6c65 6674 2062 6f74 746f 6d0d 0a20 2020  left bottom..   
+000155c0: 2020 2020 2020 2020 2020 2020 2061 7272               arr
+000155d0: 6179 5b72 6f77 735b 695d 2c20 636f 6c73  ay[rows[i], cols
+000155e0: 5b69 5d5d 203d 2061 7272 6179 5b72 6f77  [i]] = array[row
+000155f0: 735b 695d 202d 2031 2c20 636f 6c73 5b69  s[i] - 1, cols[i
+00015600: 5d20 2d20 315d 0d0a 0d0a 2020 2020 2020  ] - 1]....      
+00015610: 2020 2020 2020 656c 6966 2028 0d0a 2020        elif (..  
+00015620: 2020 2020 2020 2020 2020 2020 2020 6172                ar
+00015630: 7261 795b 726f 7773 5b69 5d20 2b20 312c  ray[rows[i] + 1,
+00015640: 2063 6f6c 735b 695d 202d 2031 5d20 213d   cols[i] - 1] !=
+00015650: 206e 6f64 6174 6176 616c 7565 0d0a 2020   nodatavalue..  
+00015660: 2020 2020 2020 2020 2020 2020 2020 616e                an
+00015670: 6420 726f 7773 5b69 5d20 2b20 3120 3c3d  d rows[i] + 1 <=
+00015680: 206e 6f5f 726f 7773 0d0a 2020 2020 2020   no_rows..      
+00015690: 2020 2020 2020 2020 2020 616e 6420 636f            and co
+000156a0: 6c73 5b69 5d20 2d20 3120 3e20 300d 0a20  ls[i] - 1 > 0.. 
+000156b0: 2020 2020 2020 2020 2020 2029 3a0d 0a20             ):.. 
+000156c0: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+000156d0: 2067 6976 6520 7468 6520 6365 6c6c 2074   give the cell t
+000156e0: 6865 2076 616c 7565 206f 6620 7468 6520  he value of the 
+000156f0: 6365 6c6c 2074 6861 7420 6973 2061 7420  cell that is at 
+00015700: 7468 6520 6c65 6674 2054 6f70 0d0a 2020  the left Top..  
+00015710: 2020 2020 2020 2020 2020 2020 2020 6172                ar
+00015720: 7261 795b 726f 7773 5b69 5d2c 2063 6f6c  ray[rows[i], col
+00015730: 735b 695d 5d20 3d20 6172 7261 795b 726f  s[i]] = array[ro
+00015740: 7773 5b69 5d20 2b20 312c 2063 6f6c 735b  ws[i] + 1, cols[
+00015750: 695d 202d 2031 5d0d 0a0d 0a20 2020 2020  i] - 1]....     
+00015760: 2020 2020 2020 2065 6c69 6620 280d 0a20         elif (.. 
+00015770: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+00015780: 7272 6179 5b72 6f77 735b 695d 202b 2031  rray[rows[i] + 1
+00015790: 2c20 636f 6c73 5b69 5d20 2b20 315d 2021  , cols[i] + 1] !
+000157a0: 3d20 6e6f 6461 7461 7661 6c75 650d 0a20  = nodatavalue.. 
+000157b0: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+000157c0: 6e64 2072 6f77 735b 695d 202b 2031 203c  nd rows[i] + 1 <
+000157d0: 3d20 6e6f 5f72 6f77 730d 0a20 2020 2020  = no_rows..     
+000157e0: 2020 2020 2020 2020 2020 2061 6e64 2063             and c
+000157f0: 6f6c 735b 695d 202b 2031 203c 3d20 6e6f  ols[i] + 1 <= no
+00015800: 5f63 6f6c 730d 0a20 2020 2020 2020 2020  _cols..         
+00015810: 2020 2029 3a0d 0a20 2020 2020 2020 2020     ):..         
+00015820: 2020 2020 2020 2023 2067 6976 6520 7468         # give th
+00015830: 6520 6365 6c6c 2074 6865 2076 616c 7565  e cell the value
+00015840: 206f 6620 7468 6520 6365 6c6c 2074 6861   of the cell tha
+00015850: 7420 6973 2061 7420 7468 6520 7269 6768  t is at the righ
+00015860: 7420 546f 700d 0a20 2020 2020 2020 2020  t Top..         
+00015870: 2020 2020 2020 2061 7272 6179 5b72 6f77         array[row
+00015880: 735b 695d 2c20 636f 6c73 5b69 5d5d 203d  s[i], cols[i]] =
+00015890: 2061 7272 6179 5b72 6f77 735b 695d 202b   array[rows[i] +
+000158a0: 2031 2c20 636f 6c73 5b69 5d20 2b20 315d   1, cols[i] + 1]
+000158b0: 0d0a 2020 2020 2020 2020 2020 2020 656c  ..            el
+000158c0: 7365 3a0d 0a20 2020 2020 2020 2020 2020  se:..           
+000158d0: 2020 2020 2070 7269 6e74 2822 7468 6520       print("the 
+000158e0: 6365 6c6c 2069 7320 6973 6f6c 6174 6564  cell is isolated
+000158f0: 2028 4e6f 2073 7572 726f 756e 6469 6e67   (No surrounding
+00015900: 2063 656c 6c73 2065 7869 7374 2922 290d   cells exist)").
+00015910: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00015920: 6172 7261 790d 0a0d 0a20 2020 2064 6566  array....    def
+00015930: 206c 6f63 6174 655f 706f 696e 7473 280d   locate_points(.
+00015940: 0a20 2020 2020 2020 2073 656c 662c 0d0a  .        self,..
+00015950: 2020 2020 2020 2020 706f 696e 7473 3a20          points: 
+00015960: 556e 696f 6e5b 4765 6f44 6174 6146 7261  Union[GeoDataFra
+00015970: 6d65 2c20 4665 6174 7572 6543 6f6c 6c65  me, FeatureColle
+00015980: 6374 696f 6e2c 2044 6174 6146 7261 6d65  ction, DataFrame
+00015990: 5d2c 0d0a 2020 2020 2920 2d3e 206e 702e  ],..    ) -> np.
+000159a0: 6e64 6172 7261 793a 0d0a 2020 2020 2020  ndarray:..      
+000159b0: 2020 2222 226e 6561 7265 7374 4365 6c6c    """nearestCell
+000159c0: 2e0d 0a0d 0a20 2020 2020 2020 2020 2020  .....           
+000159d0: 206e 6561 7265 7374 4365 6c6c 2063 616c   nearestCell cal
+000159e0: 6375 6c61 7465 7320 7468 6520 7468 6520  culates the the 
+000159f0: 696e 6469 6365 7320 2872 6f77 732c 2063  indices (rows, c
+00015a00: 6f6c 2920 6f66 206e 6561 7265 7374 2063  ol) of nearest c
+00015a10: 656c 6c20 696e 2061 2067 6976 656e 0d0a  ell in a given..
+00015a20: 2020 2020 2020 2020 2020 2020 7261 7374              rast
+00015a30: 6572 2074 6f20 6120 7374 6174 696f 6e0d  er to a station.
+00015a40: 0a20 2020 2020 2020 2020 2020 2063 6f6f  .            coo
+00015a50: 7264 696e 6174 6520 7379 7374 656d 206f  rdinate system o
+00015a60: 6620 7468 6520 7261 7374 6572 2068 6173  f the raster has
+00015a70: 2074 6f20 6265 2070 726f 6a65 6374 6564   to be projected
+00015a80: 2074 6f20 6265 2061 626c 6520 746f 2063   to be able to c
+00015a90: 616c 6375 6c61 7465 0d0a 2020 2020 2020  alculate..      
+00015aa0: 2020 2020 2020 7468 6520 6469 7374 616e        the distan
+00015ab0: 6365 0d0a 0d0a 2020 2020 2020 2020 5061  ce....        Pa
+00015ac0: 7261 6d65 7465 7273 0d0a 2020 2020 2020  rameters..      
+00015ad0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020    ----------..  
+00015ae0: 2020 2020 2020 706f 696e 7473 3a20 5b44        points: [D
+00015af0: 6174 6166 7261 6d65 5d0d 0a20 2020 2020  ataframe]..     
+00015b00: 2020 2020 2020 2064 6174 6166 7261 6d65         dataframe
+00015b10: 2077 6974 6820 504f 494e 5420 6765 6f6d   with POINT geom
+00015b20: 6574 7279 2e0d 0a0d 0a20 2020 2020 2020  etry.....       
+00015b30: 2052 6574 7572 6e73 0d0a 2020 2020 2020   Returns..      
+00015b40: 2020 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020    -------..     
+00015b50: 2020 2061 7272 6179 3a0d 0a20 2020 2020     array:..     
+00015b60: 2020 2020 2020 2061 7272 6179 2077 6974         array wit
+00015b70: 6820 6120 7368 6170 6520 2861 6e79 2c20  h a shape (any, 
+00015b80: 3229 2c20 666f 7220 7468 6520 726f 772c  2), for the row,
+00015b90: 2063 6f6c 756d 6e20 696e 6469 6365 7320   column indices 
+00015ba0: 696e 2074 6865 2061 7272 6179 2e0d 0a20  in the array... 
+00015bb0: 2020 2020 2020 2020 2020 2061 7272 6179             array
+00015bc0: 285b 5b20 352c 2020 345d 2c0d 0a20 2020  ([[ 5,  4],..   
+00015bd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015be0: 5b20 322c 2020 395d 2c0d 0a20 2020 2020  [ 2,  9],..     
+00015bf0: 2020 2020 2020 2020 2020 2020 2020 5b20                [ 
+00015c00: 352c 2020 395d 5d29 0d0a 2020 2020 2020  5,  9]])..      
+00015c10: 2020 2222 220d 0a20 2020 2020 2020 2069    """..        i
+00015c20: 6620 6973 696e 7374 616e 6365 2870 6f69  f isinstance(poi
+00015c30: 6e74 732c 2047 656f 4461 7461 4672 616d  nts, GeoDataFram
+00015c40: 6529 3a0d 0a20 2020 2020 2020 2020 2020  e):..           
+00015c50: 2070 6f69 6e74 7320 3d20 4665 6174 7572   points = Featur
+00015c60: 6543 6f6c 6c65 6374 696f 6e28 706f 696e  eCollection(poin
+00015c70: 7473 290d 0a20 2020 2020 2020 2065 6c69  ts)..        eli
+00015c80: 6620 6973 696e 7374 616e 6365 2870 6f69  f isinstance(poi
+00015c90: 6e74 732c 2044 6174 6146 7261 6d65 293a  nts, DataFrame):
+00015ca0: 0d0a 2020 2020 2020 2020 2020 2020 6966  ..            if
+00015cb0: 2061 6c6c 2865 6c65 6d20 6e6f 7420 696e   all(elem not in
+00015cc0: 2070 6f69 6e74 732e 636f 6c75 6d6e 7320   points.columns 
+00015cd0: 666f 7220 656c 656d 2069 6e20 5b22 7822  for elem in ["x"
+00015ce0: 2c20 2279 225d 293a 0d0a 2020 2020 2020  , "y"]):..      
+00015cf0: 2020 2020 2020 2020 2020 7261 6973 6520            raise 
+00015d00: 5661 6c75 6545 7272 6f72 280d 0a20 2020  ValueError(..   
+00015d10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00015d20: 2022 4966 2074 6865 2069 6e70 7574 2069   "If the input i
+00015d30: 6e20 6120 4461 7461 4672 616d 652c 2069  n a DataFrame, i
+00015d40: 7420 7368 6f75 6c64 2068 6176 6520 7477  t should have tw
+00015d50: 6f20 636f 6c75 6d6e 7320 782c 2061 6e64  o columns x, and
+00015d60: 2079 220d 0a20 2020 2020 2020 2020 2020   y"..           
+00015d70: 2020 2020 2029 0d0a 2020 2020 2020 2020       )..        
+00015d80: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
+00015d90: 2020 2069 6620 6e6f 7420 6973 696e 7374     if not isinst
+00015da0: 616e 6365 2870 6f69 6e74 732c 2046 6561  ance(points, Fea
+00015db0: 7475 7265 436f 6c6c 6563 7469 6f6e 293a  tureCollection):
+00015dc0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00015dd0: 2020 7261 6973 6520 5479 7065 4572 726f    raise TypeErro
+00015de0: 7228 0d0a 2020 2020 2020 2020 2020 2020  r(..            
+00015df0: 2020 2020 2020 2020 6622 706c 6561 7365          f"please
+00015e00: 2063 6865 636b 2070 6f69 6e74 7320 696e   check points in
+00015e10: 7075 7420 6974 2073 686f 756c 6420 6265  put it should be
+00015e20: 2047 656f 4461 7461 4672 616d 652f 4665   GeoDataFrame/Fe
+00015e30: 6174 7572 6543 6f6c 6c65 6374 696f 6e20  atureCollection 
+00015e40: 2d20 6769 7665 6e20 7b74 7970 6528 706f  - given {type(po
+00015e50: 696e 7473 297d 220d 0a20 2020 2020 2020  ints)}"..       
+00015e60: 2020 2020 2020 2020 2029 0d0a 2020 2020           )..    
+00015e70: 2020 2020 6966 206e 6f74 2069 7369 6e73      if not isins
+00015e80: 7461 6e63 6528 706f 696e 7473 2c20 4461  tance(points, Da
+00015e90: 7461 4672 616d 6529 3a0d 0a20 2020 2020  taFrame):..     
+00015ea0: 2020 2020 2020 2023 2067 6574 2074 6865         # get the
+00015eb0: 2078 2c20 7920 636f 6f72 6469 6e61 7465   x, y coordinate
+00015ec0: 732e 0d0a 2020 2020 2020 2020 2020 2020  s...            
+00015ed0: 706f 696e 7473 2e78 7928 290d 0a20 2020  points.xy()..   
+00015ee0: 2020 2020 2020 2020 2070 6f69 6e74 7320           points 
+00015ef0: 3d20 706f 696e 7473 2e66 6561 7475 7265  = points.feature
+00015f00: 2e6c 6f63 5b3a 2c20 5b22 7822 2c20 2279  .loc[:, ["x", "y
+00015f10: 225d 5d2e 7661 6c75 6573 0d0a 2020 2020  "]].values..    
+00015f20: 2020 2020 656c 7365 3a0d 0a20 2020 2020      else:..     
+00015f30: 2020 2020 2020 2070 6f69 6e74 7320 3d20         points = 
+00015f40: 706f 696e 7473 2e6c 6f63 5b3a 2c20 5b22  points.loc[:, ["
+00015f50: 7822 2c20 2279 225d 5d2e 7661 6c75 6573  x", "y"]].values
+00015f60: 0d0a 0d0a 2020 2020 2020 2020 2320 7369  ....        # si
+00015f70: 6e63 6520 6669 7273 7420 726f 7720 6973  nce first row is
+00015f80: 2078 2d63 6f6f 7264 7320 736f 2074 6865   x-coords so the
+00015f90: 2066 6972 7374 2063 6f6c 756d 6e20 696e   first column in
+00015fa0: 2074 6865 2069 6e64 6963 6573 2069 7320   the indices is 
+00015fb0: 7468 6520 636f 6c75 6d6e 2069 6e64 6578  the column index
+00015fc0: 0d0a 2020 2020 2020 2020 696e 6469 6365  ..        indice
+00015fd0: 7320 3d20 6c6f 6361 7465 5f76 616c 7565  s = locate_value
+00015fe0: 7328 706f 696e 7473 2c20 7365 6c66 2e78  s(points, self.x
+00015ff0: 2c20 7365 6c66 2e79 290d 0a20 2020 2020  , self.y)..     
+00016000: 2020 2023 2072 6561 7272 616e 6765 2074     # rearrange t
+00016010: 6865 2063 6f6c 756d 6e73 2074 6f20 6d61  he columns to ma
+00016020: 6b65 2074 6865 2072 6f77 2069 6e64 6578  ke the row index
+00016030: 2066 6972 7374 0d0a 2020 2020 2020 2020   first..        
+00016040: 696e 6469 6365 7320 3d20 696e 6469 6365  indices = indice
+00016050: 735b 3a2c 205b 312c 2030 5d5d 0d0a 2020  s[:, [1, 0]]..  
+00016060: 2020 2020 2020 7265 7475 726e 2069 6e64        return ind
+00016070: 6963 6573 0d0a 0d0a 2020 2020 6465 6620  ices....    def 
+00016080: 6578 7472 6163 7428 0d0a 2020 2020 2020  extract(..      
+00016090: 2020 7365 6c66 2c0d 0a20 2020 2020 2020    self,..       
+000160a0: 2065 7863 6c75 6465 5f76 616c 7565 3a20   exclude_value: 
+000160b0: 416e 7920 3d20 4e6f 6e65 2c0d 0a20 2020  Any = None,..   
+000160c0: 2020 2020 2066 6561 7475 7265 3a20 556e       feature: Un
+000160d0: 696f 6e5b 4665 6174 7572 6543 6f6c 6c65  ion[FeatureColle
+000160e0: 6374 696f 6e2c 2047 656f 4461 7461 4672  ction, GeoDataFr
+000160f0: 616d 655d 203d 204e 6f6e 652c 0d0a 2020  ame] = None,..  
+00016100: 2020 2920 2d3e 204c 6973 743a 0d0a 2020    ) -> List:..  
+00016110: 2020 2020 2020 2222 2245 7874 7261 6374        """Extract
+00016120: 2e0d 0a0d 0a20 2020 2020 2020 2020 2020  .....           
+00016130: 202d 2045 7874 7261 6374 206d 6574 686f   - Extract metho
+00016140: 6420 6765 7420 616c 6c20 7468 6520 7661  d get all the va
+00016150: 6c75 6573 2069 6e20 6120 7261 7374 6572  lues in a raster
+00016160: 2c20 616e 6420 6578 636c 7564 6520 7468  , and exclude th
+00016170: 6520 7661 6c75 6573 2069 6e20 7468 6520  e values in the 
+00016180: 6578 636c 7564 655f 7661 6c75 6520 7061  exclude_value pa
+00016190: 7261 6d65 7465 722e 0d0a 2020 2020 2020  rameter...      
+000161a0: 2020 2020 2020 2d20 4966 2074 6865 2066        - If the f
+000161b0: 6561 7475 7265 2070 6172 616d 6574 6572  eature parameter
+000161c0: 2069 7320 6769 7665 6e20 7468 6520 7261   is given the ra
+000161d0: 7374 6572 2077 696c 6c20 6265 2063 6c69  ster will be cli
+000161e0: 7065 6420 746f 2074 6865 2065 7874 656e  ped to the exten
+000161f0: 7420 6f66 2074 6865 2067 6976 656e 2066  t of the given f
+00016200: 6561 7475 7265 2061 6e64 2074 6865 0d0a  eature and the..
+00016210: 2020 2020 2020 2020 2020 2020 7661 6c75              valu
+00016220: 6573 2077 6974 6869 6e20 7468 6520 6665  es within the fe
+00016230: 6174 7572 6520 6172 6520 6578 7472 6163  ature are extrac
+00016240: 7465 642e 0d0a 0d0a 2020 2020 2020 2020  ted.....        
+00016250: 5061 7261 6d65 7465 7273 0d0a 2020 2020  Parameters..    
+00016260: 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a      ----------..
+00016270: 2020 2020 2020 2020 6578 636c 7564 655f          exclude_
+00016280: 7661 6c75 653a 205b 4e75 6d65 7269 635d  value: [Numeric]
+00016290: 0d0a 2020 2020 2020 2020 2020 2020 7661  ..            va
+000162a0: 6c75 6573 2079 6f75 2077 616e 7420 746f  lues you want to
+000162b0: 2065 7863 6c75 6465 2066 726f 6d20 6578   exclude from ex
+000162c0: 7465 6163 7465 6420 7661 6c75 6573 0d0a  teacted values..
+000162d0: 2020 2020 2020 2020 6665 6174 7572 653a          feature:
+000162e0: 205b 4665 6174 7572 6543 6f6c 6c65 6374   [FeatureCollect
+000162f0: 696f 6e2f 4765 6f44 6174 6146 7261 6d65  ion/GeoDataFrame
+00016300: 5d0d 0a20 2020 2020 2020 2020 2020 2076  ]..            v
+00016310: 6563 746f 7220 6669 6c65 2063 6f6e 7461  ector file conta
+00016320: 696e 7320 6765 6f6d 6574 7269 6573 2079  ins geometries y
+00016330: 6f75 2077 616e 7420 746f 2065 7874 7261  ou want to extra
+00016340: 6374 2074 6865 2076 616c 7565 7320 6174  ct the values at
+00016350: 2074 6865 6972 206c 6f63 6174 696f 6e2e   their location.
+00016360: 2044 6566 6175 6c74 2069 7320 4e6f 6e65   Default is None
+00016370: 2e0d 0a20 2020 2020 2020 2022 2222 0d0a  ...        """..
+00016380: 2020 2020 2020 2020 6172 7220 3d20 7365          arr = se
+00016390: 6c66 2e72 6561 645f 6172 7261 7928 290d  lf.read_array().
+000163a0: 0a20 2020 2020 2020 206e 6f5f 6461 7461  .        no_data
+000163b0: 5f76 616c 7565 203d 2028 0d0a 2020 2020  _value = (..    
+000163c0: 2020 2020 2020 2020 7365 6c66 2e6e 6f5f          self.no_
+000163d0: 6461 7461 5f76 616c 7565 5b30 5d20 6966  data_value[0] if
+000163e0: 2073 656c 662e 6e6f 5f64 6174 615f 7661   self.no_data_va
+000163f0: 6c75 655b 305d 2069 7320 6e6f 7420 4e6f  lue[0] is not No
+00016400: 6e65 2065 6c73 6520 6e70 2e6e 616e 0d0a  ne else np.nan..
+00016410: 2020 2020 2020 2020 290d 0a20 2020 2020          )..     
+00016420: 2020 2069 6620 6665 6174 7572 6520 6973     if feature is
+00016430: 204e 6f6e 653a 0d0a 2020 2020 2020 2020   None:..        
+00016440: 2020 2020 6d61 736b 203d 2028 0d0a 2020      mask = (..  
+00016450: 2020 2020 2020 2020 2020 2020 2020 5b6e                [n
+00016460: 6f5f 6461 7461 5f76 616c 7565 2c20 6578  o_data_value, ex
+00016470: 636c 7564 655f 7661 6c75 655d 0d0a 2020  clude_value]..  
+00016480: 2020 2020 2020 2020 2020 2020 2020 6966                if
+00016490: 2065 7863 6c75 6465 5f76 616c 7565 2069   exclude_value i
+000164a0: 7320 6e6f 7420 4e6f 6e65 0d0a 2020 2020  s not None..    
+000164b0: 2020 2020 2020 2020 2020 2020 656c 7365              else
+000164c0: 205b 6e6f 5f64 6174 615f 7661 6c75 655d   [no_data_value]
+000164d0: 0d0a 2020 2020 2020 2020 2020 2020 290d  ..            ).
+000164e0: 0a20 2020 2020 2020 2020 2020 2076 616c  .            val
+000164f0: 7565 7320 3d20 6765 745f 7069 7865 6c73  ues = get_pixels
+00016500: 3228 6172 722c 206d 6173 6b29 0d0a 2020  2(arr, mask)..  
+00016510: 2020 2020 2020 656c 7365 3a0d 0a20 2020        else:..   
+00016520: 2020 2020 2020 2020 2069 6e64 6963 6573           indices
+00016530: 203d 2073 656c 662e 6c6f 6361 7465 5f70   = self.locate_p
+00016540: 6f69 6e74 7328 6665 6174 7572 6529 0d0a  oints(feature)..
+00016550: 2020 2020 2020 2020 2020 2020 7661 6c75              valu
+00016560: 6573 203d 2061 7272 5b69 6e64 6963 6573  es = arr[indices
+00016570: 5b3a 2c20 305d 2c20 696e 6469 6365 735b  [:, 0], indices[
+00016580: 3a2c 2031 5d5d 0d0a 2020 2020 2020 2020  :, 1]]..        
+00016590: 7265 7475 726e 2076 616c 7565 730d 0a0d  return values...
+000165a0: 0a20 2020 2064 6566 206f 7665 726c 6179  .    def overlay
+000165b0: 280d 0a20 2020 2020 2020 2073 656c 662c  (..        self,
+000165c0: 0d0a 2020 2020 2020 2020 636c 6173 7365  ..        classe
+000165d0: 735f 6d61 702c 0d0a 2020 2020 2020 2020  s_map,..        
+000165e0: 6261 6e64 3a20 696e 7420 3d20 302c 0d0a  band: int = 0,..
+000165f0: 2020 2020 2020 2020 6578 636c 7564 655f          exclude_
+00016600: 7661 6c75 653a 2055 6e69 6f6e 5b66 6c6f  value: Union[flo
+00016610: 6174 2c20 696e 745d 203d 204e 6f6e 652c  at, int] = None,
+00016620: 0d0a 2020 2020 2920 2d3e 2044 6963 745b  ..    ) -> Dict[
+00016630: 4c69 7374 5b66 6c6f 6174 5d2c 204c 6973  List[float], Lis
+00016640: 745b 666c 6f61 745d 5d3a 0d0a 2020 2020  t[float]]:..    
+00016650: 2020 2020 2222 224f 7665 726c 6179 2e0d      """Overlay..
+00016660: 0a0d 0a20 2020 2020 2020 2020 2020 206f  ...            o
+00016670: 7665 726c 6179 2065 7874 7261 6374 7320  verlay extracts 
+00016680: 616c 6c20 7468 6520 7661 6c75 6573 2069  all the values i
+00016690: 6e20 7261 7374 6572 2066 696c 652c 2069  n raster file, i
+000166a0: 6620 796f 7520 6861 7665 2074 776f 206d  f you have two m
+000166b0: 6170 7320 6f6e 6520 7769 7468 2063 6c61  aps one with cla
+000166c0: 7373 6573 2c20 616e 6420 7468 6520 6f74  sses, and the ot
+000166d0: 6865 7220 6d61 700d 0a20 2020 2020 2020  her map..       
+000166e0: 2020 2020 2063 6f6e 7461 696e 7320 616e       contains an
+000166f0: 7920 7479 7065 206f 6620 7661 6c75 6573  y type of values
+00016700: 2c20 616e 6420 796f 7520 7761 6e74 2074  , and you want t
+00016710: 6f20 6b6e 6f77 2074 6865 2076 616c 7565  o know the value
+00016720: 7320 696e 2065 6163 6820 636c 6173 732e  s in each class.
+00016730: 0d0a 0d0a 2020 2020 2020 2020 5061 7261  ....        Para
+00016740: 6d65 7465 7273 0d0a 2020 2020 2020 2020  meters..        
+00016750: 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020  ----------..    
+00016760: 2020 2020 636c 6173 7365 735f 6d61 703a      classes_map:
+00016770: 205b 4461 7461 7365 745d 0d0a 2020 2020   [Dataset]..    
+00016780: 2020 2020 2020 2020 4461 7461 7365 7420          Dataset 
+00016790: 4f62 6a65 6374 2066 6f72 2074 6865 2072  Object for the r
+000167a0: 6173 7465 7220 7468 6174 2068 6176 6520  aster that have 
+000167b0: 636c 6173 7365 7320 796f 7520 7761 6e74  classes you want
+000167c0: 2074 6f20 6f76 6572 6c61 7920 7769 7468   to overlay with
+000167d0: 2074 6865 2072 6173 7465 722e 0d0a 2020   the raster...  
+000167e0: 2020 2020 2020 6261 6e64 3a20 5b69 6e74        band: [int
+000167f0: 5d0d 0a20 2020 2020 2020 2020 2020 2069  ]..            i
+00016800: 6620 7468 6520 7261 7374 6572 2069 7320  f the raster is 
+00016810: 6d75 6c74 692d 6261 6e64 2072 6173 7465  multi-band raste
+00016820: 7220 6368 6f6f 7365 2074 6865 2062 616e  r choose the ban
+00016830: 6420 796f 7520 7761 6e74 2074 6f20 6f76  d you want to ov
+00016840: 6572 6c61 7920 7769 7468 2074 6865 2063  erlay with the c
+00016850: 6c61 7373 6573 206d 6170 2e20 4465 6661  lasses map. Defa
+00016860: 756c 7420 6973 2030 2e0d 0a20 2020 2020  ult is 0...     
+00016870: 2020 2065 7863 6c75 6465 5f76 616c 7565     exclude_value
+00016880: 3a20 5b4e 756d 6572 6963 5d0d 0a20 2020  : [Numeric]..   
+00016890: 2020 2020 2020 2020 2076 616c 7565 7320           values 
+000168a0: 796f 7520 7761 6e74 2074 6f20 6578 636c  you want to excl
+000168b0: 7564 6520 6672 6f6d 2065 7874 7261 6374  ude from extract
+000168c0: 6564 2076 616c 7565 732e 0d0a 0d0a 2020  ed values.....  
+000168d0: 2020 2020 2020 5265 7475 726e 730d 0a20        Returns.. 
+000168e0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 0d0a         -------..
+000168f0: 2020 2020 2020 2020 4469 6374 696f 6e61          Dictiona
+00016900: 7279 3a0d 0a20 2020 2020 2020 2020 2020  ry:..           
+00016910: 2064 6963 746f 6e61 7279 2077 6974 6820   dictonary with 
+00016920: 6120 6c69 7374 206f 6620 7661 6c75 6573  a list of values
+00016930: 2069 6e20 7468 6520 6261 7365 6d61 7020   in the basemap 
+00016940: 6173 206b 6579 7320 616e 6420 666f 7220  as keys and for 
+00016950: 6561 6368 206b 6579 2061 206c 6973 7420  each key a list 
+00016960: 6f66 2061 6c6c 2074 6865 2069 6e74 6572  of all the inter
+00016970: 7365 6374 6564 0d0a 2020 2020 2020 2020  sected..        
+00016980: 2020 2020 7661 6c75 6573 2069 6e20 7468      values in th
+00016990: 6520 6d61 7073 2066 726f 6d20 7468 6520  e maps from the 
+000169a0: 7061 7468 2e0d 0a20 2020 2020 2020 2022  path...        "
+000169b0: 2222 0d0a 2020 2020 2020 2020 6966 206e  ""..        if n
+000169c0: 6f74 2073 656c 662e 5f63 6865 636b 5f61  ot self._check_a
+000169d0: 6c69 676e 6d65 6e74 2863 6c61 7373 6573  lignment(classes
+000169e0: 5f6d 6170 293a 0d0a 2020 2020 2020 2020  _map):..        
+000169f0: 2020 2020 7261 6973 6520 416c 6967 6e6d      raise Alignm
+00016a00: 656e 7445 7272 6f72 280d 0a20 2020 2020  entError(..     
+00016a10: 2020 2020 2020 2020 2020 2022 5468 6520             "The 
+00016a20: 636c 6173 7320 4461 7461 7365 7420 6973  class Dataset is
+00016a30: 206e 6f74 2061 6c69 676e 6564 2077 6974   not aligned wit
+00016a40: 6820 7468 6520 6375 7272 656e 7420 7261  h the current ra
+00016a50: 7374 6572 2c20 706c 6173 6520 7573 6520  ster, plase use 
+00016a60: 7468 6520 6d65 7468 6f64 2022 0d0a 2020  the method "..  
+00016a70: 2020 2020 2020 2020 2020 2020 2020 2227                "'
+00016a80: 616c 6967 6e27 2074 6f20 616c 6967 6e20  align' to align 
+00016a90: 626f 7468 2072 6173 7465 7273 2e22 0d0a  both rasters."..
+00016aa0: 2020 2020 2020 2020 2020 2020 290d 0a20              ).. 
+00016ab0: 2020 2020 2020 2061 7272 203d 2073 656c         arr = sel
+00016ac0: 662e 7265 6164 5f61 7272 6179 2862 616e  f.read_array(ban
+00016ad0: 643d 6261 6e64 290d 0a20 2020 2020 2020  d=band)..       
+00016ae0: 206e 6f5f 6461 7461 5f76 616c 7565 203d   no_data_value =
+00016af0: 2028 0d0a 2020 2020 2020 2020 2020 2020   (..            
+00016b00: 7365 6c66 2e6e 6f5f 6461 7461 5f76 616c  self.no_data_val
+00016b10: 7565 5b30 5d20 6966 2073 656c 662e 6e6f  ue[0] if self.no
+00016b20: 5f64 6174 615f 7661 6c75 655b 305d 2069  _data_value[0] i
+00016b30: 7320 6e6f 7420 4e6f 6e65 2065 6c73 6520  s not None else 
+00016b40: 6e70 2e6e 616e 0d0a 2020 2020 2020 2020  np.nan..        
+00016b50: 290d 0a20 2020 2020 2020 206d 6173 6b20  )..        mask 
+00016b60: 3d20 280d 0a20 2020 2020 2020 2020 2020  = (..           
+00016b70: 205b 6e6f 5f64 6174 615f 7661 6c75 652c   [no_data_value,
+00016b80: 2065 7863 6c75 6465 5f76 616c 7565 5d0d   exclude_value].
+00016b90: 0a20 2020 2020 2020 2020 2020 2069 6620  .            if 
+00016ba0: 6578 636c 7564 655f 7661 6c75 6520 6973  exclude_value is
+00016bb0: 206e 6f74 204e 6f6e 650d 0a20 2020 2020   not None..     
+00016bc0: 2020 2020 2020 2065 6c73 6520 5b6e 6f5f         else [no_
+00016bd0: 6461 7461 5f76 616c 7565 5d0d 0a20 2020  data_value]..   
+00016be0: 2020 2020 2029 0d0a 2020 2020 2020 2020       )..        
+00016bf0: 696e 6420 3d20 6765 745f 696e 6469 6365  ind = get_indice
+00016c00: 7332 2861 7272 2c20 6d61 736b 290d 0a20  s2(arr, mask).. 
+00016c10: 2020 2020 2020 2063 6c61 7373 6573 203d         classes =
+00016c20: 2063 6c61 7373 6573 5f6d 6170 2e72 6561   classes_map.rea
+00016c30: 645f 6172 7261 7928 290d 0a20 2020 2020  d_array()..     
+00016c40: 2020 2076 616c 7565 7320 3d20 6469 6374     values = dict
+00016c50: 2829 0d0a 0d0a 2020 2020 2020 2020 2320  ()....        # 
+00016c60: 6578 7472 6163 7420 7661 6c75 6573 0d0a  extract values..
+00016c70: 2020 2020 2020 2020 666f 7220 692c 2069          for i, i
+00016c80: 6e64 5f69 2069 6e20 656e 756d 6572 6174  nd_i in enumerat
+00016c90: 6528 696e 6429 3a0d 0a20 2020 2020 2020  e(ind):..       
+00016ca0: 2020 2020 2023 2066 6972 7374 2063 6865       # first che
+00016cb0: 636b 2069 6620 7468 6520 7375 622d 6261  ck if the sub-ba
+00016cc0: 7369 6e20 6861 7320 6120 6c69 7374 2069  sin has a list i
+00016cd0: 6e20 7468 6520 6469 6374 2069 6620 6e6f  n the dict if no
+00016ce0: 7420 6372 6561 7465 2061 206c 6973 740d  t create a list.
+00016cf0: 0a20 2020 2020 2020 2020 2020 206b 6579  .            key
+00016d00: 203d 2063 6c61 7373 6573 5b69 6e64 5f69   = classes[ind_i
+00016d10: 5b30 5d2c 2069 6e64 5f69 5b31 5d5d 0d0a  [0], ind_i[1]]..
+00016d20: 2020 2020 2020 2020 2020 2020 6966 206b              if k
+00016d30: 6579 206e 6f74 2069 6e20 6c69 7374 2876  ey not in list(v
+00016d40: 616c 7565 732e 6b65 7973 2829 293a 0d0a  alues.keys()):..
+00016d50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00016d60: 7661 6c75 6573 5b6b 6579 5d20 3d20 6c69  values[key] = li
+00016d70: 7374 2829 0d0a 0d0a 2020 2020 2020 2020  st()....        
+00016d80: 2020 2020 7661 6c75 6573 5b6b 6579 5d2e      values[key].
+00016d90: 6170 7065 6e64 2861 7272 5b69 6e64 5f69  append(arr[ind_i
+00016da0: 5b30 5d2c 2069 6e64 5f69 5b31 5d5d 290d  [0], ind_i[1]]).
+00016db0: 0a0d 0a20 2020 2020 2020 2072 6574 7572  ...        retur
+00016dc0: 6e20 7661 6c75 6573 0d0a 0d0a 2020 2020  n values....    
+00016dd0: 6465 6620 666f 6f74 7072 696e 7428 0d0a  def footprint(..
+00016de0: 2020 2020 2020 2020 7365 6c66 2c0d 0a20          self,.. 
+00016df0: 2020 2020 2020 2062 616e 643a 2069 6e74         band: int
+00016e00: 203d 2030 2c0d 0a20 2020 2020 2020 2065   = 0,..        e
+00016e10: 7863 6c75 6465 5f76 616c 7565 733a 204f  xclude_values: O
+00016e20: 7074 696f 6e61 6c5b 4c69 7374 5b41 6e79  ptional[List[Any
+00016e30: 5d5d 203d 204e 6f6e 652c 0d0a 2020 2020  ]] = None,..    
+00016e40: 2920 2d3e 2055 6e69 6f6e 5b47 656f 4461  ) -> Union[GeoDa
+00016e50: 7461 4672 616d 652c 204e 6f6e 655d 3a0d  taFrame, None]:.
+00016e60: 0a20 2020 2020 2020 2022 2222 666f 6f74  .        """foot
+00016e70: 7072 696e 742e 0d0a 0d0a 2020 2020 2020  print.....      
+00016e80: 2020 2020 2020 6578 7472 6163 745f 6578        extract_ex
+00016e90: 7465 6e74 2074 616b 6573 2061 2067 6461  tent takes a gda
+00016ea0: 6c20 7261 7374 6572 206f 626a 6563 7420  l raster object 
+00016eb0: 616e 6420 7265 7475 726e 730d 0a0d 0a20  and returns.... 
+00016ec0: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
+00016ed0: 730d 0a20 2020 2020 2020 202d 2d2d 2d2d  s..        -----
+00016ee0: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 2062  -----..        b
+00016ef0: 616e 643a 205b 696e 745d 0d0a 2020 2020  and: [int]..    
+00016f00: 2020 2020 2020 2020 6261 6e64 2069 6e64          band ind
+00016f10: 6578 2e20 4465 6661 756c 7420 6973 2030  ex. Default is 0
+00016f20: 2e0d 0a20 2020 2020 2020 2065 7863 6c75  ...        exclu
+00016f30: 6465 5f76 616c 7565 733a 0d0a 2020 2020  de_values:..    
+00016f40: 2020 2020 2020 2020 6966 2079 6f75 2077          if you w
+00016f50: 616e 7420 746f 2065 7863 6c75 6465 5f76  ant to exclude_v
+00016f60: 616c 7565 7320 6120 6365 7274 6169 6e20  alues a certain 
+00016f70: 7661 6c75 6520 696e 2074 6865 2072 6173  value in the ras
+00016f80: 7465 7220 7769 7468 2061 6e6f 7468 6572  ter with another
+00016f90: 2076 616c 7565 2069 6e74 6572 2074 6865   value inter the
+00016fa0: 2074 776f 2076 616c 7565 7320 6173 2061   two values as a
+00016fb0: 206c 6973 7420 6f66 2074 7570 6c65 7320   list of tuples 
+00016fc0: 610d 0a20 2020 2020 2020 2020 2020 205b  a..            [
+00016fd0: 2876 616c 7565 5f74 6f5f 6265 5f65 7863  (value_to_be_exc
+00016fe0: 6c75 6465 5f76 616c 7565 7364 2c20 6e65  lude_valuesd, ne
+00016ff0: 775f 7661 6c75 6529 5d0d 0a20 2020 2020  w_value)]..     
+00017000: 2020 2020 2020 203e 3e3e 2065 7863 6c75         >>> exclu
+00017010: 6465 5f76 616c 7565 7320 3d20 5b30 5d0d  de_values = [0].
+00017020: 0a20 2020 2020 2020 2020 2020 202d 2054  .            - T
+00017030: 6869 7320 7061 7261 6d65 7465 7220 6973  his parameter is
+00017040: 2069 6e74 726f 6475 6365 6420 7061 7274   introduced part
+00017050: 6963 756c 6172 6c79 2066 6f72 2074 6865  icularly for the
+00017060: 2063 6173 6520 6f66 2072 6173 7465 7273   case of rasters
+00017070: 2074 6861 7420 6861 7320 7468 6520 6e6f   that has the no
+00017080: 6461 7461 7661 6c75 6520 7374 6f72 6564  datavalue stored
+00017090: 2069 6e20 7468 650d 0a20 2020 2020 2020   in the..       
+000170a0: 2020 2020 2061 7272 6179 2064 6f65 7320       array does 
+000170b0: 6e6f 7420 6d61 7463 6820 7468 6520 7661  not match the va
+000170c0: 6c75 6520 7374 6f72 6564 2069 6e20 6172  lue stored in ar
+000170d0: 7261 792c 2073 6f20 7468 6973 206f 7074  ray, so this opt
+000170e0: 696f 6e20 6361 6e20 636f 7272 6563 7420  ion can correct 
+000170f0: 7468 6973 2062 6568 6176 696f 722e 0d0a  this behavior...
+00017100: 0d0a 2020 2020 2020 2020 5265 7475 726e  ..        Return
+00017110: 730d 0a20 2020 2020 2020 202d 2d2d 2d2d  s..        -----
+00017120: 2d2d 0d0a 2020 2020 2020 2020 4765 6f44  --..        GeoD
+00017130: 6174 6146 7261 6d65 3a0d 0a20 2020 2020  ataFrame:..     
+00017140: 2020 2020 2020 202d 2067 656f 6461 7461         - geodata
+00017150: 6672 616d 6520 636f 6e74 6169 6e69 6e67  frame containing
+00017160: 2074 6865 2070 6f6c 7967 6f6e 2072 6570   the polygon rep
+00017170: 7265 7365 6e74 696e 6720 7468 6520 6578  resenting the ex
+00017180: 7465 6e74 206f 6620 7468 6520 7261 7374  tent of the rast
+00017190: 6572 2e20 7468 6520 6578 7465 6e74 2063  er. the extent c
+000171a0: 6f6c 756d 6e20 7368 6f75 6c64 0d0a 2020  olumn should..  
+000171b0: 2020 2020 2020 2020 2020 636f 6e74 6169            contai
+000171c0: 6e73 2061 2076 616c 7565 206f 6620 2032  ns a value of  2
+000171d0: 206f 6e6c 792e 0d0a 2020 2020 2020 2020   only...        
+000171e0: 2020 2020 2d20 6966 2074 6865 2064 6174      - if the dat
+000171f0: 6173 6574 2068 6164 2073 6570 6172 6174  aset had separat
+00017200: 6520 706f 6c79 676f 6e73 2065 6163 6820  e polygons each 
+00017210: 706f 6c79 676f 6e20 7769 6c6c 2062 6520  polygon will be 
+00017220: 696e 2061 2073 6570 6172 6174 6520 726f  in a separate ro
+00017230: 772e 0d0a 2020 2020 2020 2020 2222 220d  w...        """.
+00017240: 0a20 2020 2020 2020 2061 7272 203d 2073  .        arr = s
+00017250: 656c 662e 7265 6164 5f61 7272 6179 2862  elf.read_array(b
+00017260: 616e 643d 6261 6e64 290d 0a20 2020 2020  and=band)..     
+00017270: 2020 206e 6f5f 6461 7461 5f76 616c 203d     no_data_val =
+00017280: 2073 656c 662e 6e6f 5f64 6174 615f 7661   self.no_data_va
+00017290: 6c75 655b 6261 6e64 5d0d 0a0d 0a20 2020  lue[band]....   
+000172a0: 2020 2020 2069 6620 6e6f 5f64 6174 615f       if no_data_
+000172b0: 7661 6c20 6973 204e 6f6e 653a 0d0a 2020  val is None:..  
+000172c0: 2020 2020 2020 2020 2020 6966 206e 6f74            if not
+000172d0: 2028 6e70 2e69 736e 616e 2861 7272 2929   (np.isnan(arr))
+000172e0: 2e61 6e79 2829 3a0d 0a20 2020 2020 2020  .any():..       
+000172f0: 2020 2020 2020 2020 206c 6f67 6765 722e           logger.
+00017300: 7761 726e 696e 6728 0d0a 2020 2020 2020  warning(..      
+00017310: 2020 2020 2020 2020 2020 2020 2020 2274                "t
+00017320: 6865 206e 6f64 6174 6120 7661 6c75 6573  he nodata values
+00017330: 2073 746f 7265 6420 696e 2074 6865 2072   stored in the r
+00017340: 6173 7465 7220 646f 6573 206e 6f74 2065  aster does not e
+00017350: 7869 7374 2069 6e20 7468 6520 7261 7374  xist in the rast
+00017360: 6572 2022 0d0a 2020 2020 2020 2020 2020  er "..          
+00017370: 2020 2020 2020 2020 2020 2273 6f20 6569            "so ei
+00017380: 7468 6572 2074 6865 2072 6173 7465 7220  ther the raster 
+00017390: 6578 7465 6e74 2069 7320 616c 6c20 6675  extent is all fu
+000173a0: 6c6c 2077 6974 6820 6461 7461 206f 7220  ll with data or 
+000173b0: 7468 6520 6e6f 6461 7461 7661 6c75 6520  the nodatavalue 
+000173c0: 7374 6f72 6564 2069 6e20 7468 6520 7261  stored in the ra
+000173d0: 7374 6572 2069 7322 0d0a 2020 2020 2020  ster is"..      
+000173e0: 2020 2020 2020 2020 2020 2020 2020 2220                " 
+000173f0: 6e6f 7420 636f 7272 6563 7422 0d0a 2020  not correct"..  
+00017400: 2020 2020 2020 2020 2020 2020 2020 290d                ).
+00017410: 0a20 2020 2020 2020 2065 6c73 653a 0d0a  .        else:..
+00017420: 2020 2020 2020 2020 2020 2020 6966 206e              if n
+00017430: 6f74 2028 6e70 2e69 7363 6c6f 7365 2861  ot (np.isclose(a
+00017440: 7272 2c20 6e6f 5f64 6174 615f 7661 6c2c  rr, no_data_val,
+00017450: 2072 746f 6c3d 302e 3030 3030 3129 292e   rtol=0.00001)).
+00017460: 616e 7928 293a 0d0a 2020 2020 2020 2020  any():..        
+00017470: 2020 2020 2020 2020 6c6f 6767 6572 2e77          logger.w
+00017480: 6172 6e69 6e67 280d 0a20 2020 2020 2020  arning(..       
+00017490: 2020 2020 2020 2020 2020 2020 2022 7468               "th
+000174a0: 6520 6e6f 6461 7461 2076 616c 7565 7320  e nodata values 
+000174b0: 7374 6f72 6564 2069 6e20 7468 6520 7261  stored in the ra
+000174c0: 7374 6572 2064 6f65 7320 6e6f 7420 6578  ster does not ex
+000174d0: 6973 7420 696e 2074 6865 2072 6173 7465  ist in the raste
+000174e0: 7220 220d 0a20 2020 2020 2020 2020 2020  r "..           
+000174f0: 2020 2020 2020 2020 2022 736f 2065 6974           "so eit
+00017500: 6865 7220 7468 6520 7261 7374 6572 2065  her the raster e
+00017510: 7874 656e 7420 6973 2061 6c6c 2066 756c  xtent is all ful
+00017520: 6c20 7769 7468 2064 6174 6120 6f72 2074  l with data or t
+00017530: 6865 206e 6f64 6174 6176 616c 7565 2073  he nodatavalue s
+00017540: 746f 7265 6420 696e 2074 6865 2072 6173  tored in the ras
+00017550: 7465 7220 6973 220d 0a20 2020 2020 2020  ter is"..       
+00017560: 2020 2020 2020 2020 2020 2020 2022 206e               " n
+00017570: 6f74 2063 6f72 7265 6374 220d 0a20 2020  ot correct"..   
+00017580: 2020 2020 2020 2020 2020 2020 2029 0d0a               )..
+00017590: 2020 2020 2020 2020 2320 6966 2079 6f75          # if you
+000175a0: 2077 616e 7420 746f 2065 7863 6c75 6465   want to exclude
+000175b0: 5f76 616c 7565 7320 616e 7920 7661 6c75  _values any valu
+000175c0: 6520 696e 2074 6865 2072 6173 7465 720d  e in the raster.
+000175d0: 0a20 2020 2020 2020 2069 6620 6578 636c  .        if excl
+000175e0: 7564 655f 7661 6c75 6573 3a0d 0a20 2020  ude_values:..   
+000175f0: 2020 2020 2020 2020 2066 6f72 2076 616c           for val
+00017600: 2069 6e20 6578 636c 7564 655f 7661 6c75   in exclude_valu
+00017610: 6573 3a0d 0a20 2020 2020 2020 2020 2020  es:..           
+00017620: 2020 2020 2074 7279 3a0d 0a20 2020 2020       try:..     
+00017630: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+00017640: 2069 6e20 6361 7365 2074 6865 2076 616c   in case the val
+00017650: 3220 6973 204e 6f6e 6520 616e 6420 7468  2 is None and th
+00017660: 6520 6172 7261 7920 6973 2069 6e74 2074  e array is int t
+00017670: 7970 6520 7468 6520 666f 6c6c 6f77 696e  ype the followin
+00017680: 6720 6c69 6e65 2077 696c 6c20 6769 7665  g line will give
+00017690: 2065 7272 6f72 2061 7320 4e6f 6e65 0d0a   error as None..
+000176a0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000176b0: 2020 2020 2320 6973 2063 6f6e 7369 6465      # is conside
+000176c0: 7265 6420 6173 2066 6c6f 6174 0d0a 2020  red as float..  
+000176d0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+000176e0: 2020 6172 725b 6e70 2e69 7363 6c6f 7365    arr[np.isclose
+000176f0: 2861 7272 2c20 7661 6c29 5d20 3d20 6e6f  (arr, val)] = no
+00017700: 5f64 6174 615f 7661 6c0d 0a20 2020 2020  _data_val..     
+00017710: 2020 2020 2020 2020 2020 2065 7863 6570             excep
+00017720: 7420 5479 7065 4572 726f 723a 0d0a 2020  t TypeError:..  
+00017730: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017740: 2020 6172 7220 3d20 6172 722e 6173 7479    arr = arr.asty
+00017750: 7065 286e 702e 666c 6f61 7433 3229 0d0a  pe(np.float32)..
+00017760: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017770: 2020 2020 6172 725b 6e70 2e69 7363 6c6f      arr[np.isclo
+00017780: 7365 2861 7272 2c20 7661 6c29 5d20 3d20  se(arr, val)] = 
+00017790: 6e6f 5f64 6174 615f 7661 6c0d 0a0d 0a20  no_data_val.... 
+000177a0: 2020 2020 2020 2023 2072 6570 6c61 6365         # replace
+000177b0: 2061 6c6c 2074 6865 2076 616c 7565 7320   all the values 
+000177c0: 7769 7468 2032 0d0a 2020 2020 2020 2020  with 2..        
+000177d0: 6966 206e 6f5f 6461 7461 5f76 616c 2069  if no_data_val i
+000177e0: 7320 4e6f 6e65 3a0d 0a20 2020 2020 2020  s None:..       
+000177f0: 2020 2020 2023 2063 6865 636b 2069 6620       # check if 
+00017800: 7468 6520 7768 6f6c 6520 7261 7374 6572  the whole raster
+00017810: 2069 7320 6675 6c6c 206f 6620 6e6f 5f64   is full of no_d
+00017820: 6174 615f 7661 6c75 650d 0a20 2020 2020  ata_value..     
+00017830: 2020 2020 2020 2069 6620 286e 702e 6973         if (np.is
+00017840: 6e61 6e28 6172 7229 292e 616c 6c28 293a  nan(arr)).all():
+00017850: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00017860: 2020 6c6f 6767 6572 2e77 6172 6e69 6e67    logger.warning
+00017870: 2822 7468 6520 7261 7374 6572 2069 7320  ("the raster is 
+00017880: 6675 6c6c 206f 6620 6e6f 5f64 6174 615f  full of no_data_
+00017890: 7661 6c75 6522 290d 0a20 2020 2020 2020  value")..       
+000178a0: 2020 2020 2020 2020 2072 6574 7572 6e20           return 
+000178b0: 4e6f 6e65 0d0a 0d0a 2020 2020 2020 2020  None....        
+000178c0: 2020 2020 6172 725b 7e6e 702e 6973 6e61      arr[~np.isna
+000178d0: 6e28 6172 7229 5d20 3d20 320d 0a20 2020  n(arr)] = 2..   
+000178e0: 2020 2020 2065 6c73 653a 0d0a 2020 2020       else:..    
+000178f0: 2020 2020 2020 2020 2320 6368 6563 6b20          # check 
+00017900: 6966 2074 6865 2077 686f 6c65 2072 6173  if the whole ras
+00017910: 7465 7220 6973 2066 756c 6c20 6f66 206e  ter is full of n
+00017920: 6f64 6174 6176 616c 7565 0d0a 2020 2020  odatavalue..    
+00017930: 2020 2020 2020 2020 6966 2028 6e70 2e69          if (np.i
+00017940: 7363 6c6f 7365 2861 7272 2c20 6e6f 5f64  sclose(arr, no_d
+00017950: 6174 615f 7661 6c2c 2072 746f 6c3d 302e  ata_val, rtol=0.
+00017960: 3030 3030 3129 292e 616c 6c28 293a 0d0a  00001)).all():..
+00017970: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00017980: 6c6f 6767 6572 2e77 6172 6e69 6e67 2822  logger.warning("
+00017990: 7468 6520 7261 7374 6572 2069 7320 6675  the raster is fu
+000179a0: 6c6c 206f 6620 6e6f 5f64 6174 615f 7661  ll of no_data_va
+000179b0: 6c75 6522 290d 0a20 2020 2020 2020 2020  lue")..         
+000179c0: 2020 2020 2020 2072 6574 7572 6e20 4e6f         return No
+000179d0: 6e65 0d0a 0d0a 2020 2020 2020 2020 2020  ne....          
+000179e0: 2020 6172 725b 7e6e 702e 6973 636c 6f73    arr[~np.isclos
+000179f0: 6528 6172 722c 206e 6f5f 6461 7461 5f76  e(arr, no_data_v
+00017a00: 616c 2c20 7274 6f6c 3d30 2e30 3030 3031  al, rtol=0.00001
+00017a10: 295d 203d 2032 0d0a 2020 2020 2020 2020  )] = 2..        
+00017a20: 6e65 775f 6461 7461 7365 7420 3d20 7365  new_dataset = se
+00017a30: 6c66 2e63 7265 6174 655f 6672 6f6d 5f61  lf.create_from_a
+00017a40: 7272 6179 280d 0a20 2020 2020 2020 2020  rray(..         
+00017a50: 2020 2061 7272 2c20 7365 6c66 2e67 656f     arr, self.geo
+00017a60: 7472 616e 7366 6f72 6d2c 2073 656c 662e  transform, self.
+00017a70: 6570 7367 2c20 7365 6c66 2e6e 6f5f 6461  epsg, self.no_da
+00017a80: 7461 5f76 616c 7565 0d0a 2020 2020 2020  ta_value..      
+00017a90: 2020 290d 0a20 2020 2020 2020 2023 2074    )..        # t
+00017aa0: 6865 6e20 636f 6e76 6572 7420 7468 6520  hen convert the 
+00017ab0: 7261 7361 7465 7220 696e 746f 2070 6f6c  rasater into pol
+00017ac0: 7967 6f6e 0d0a 2020 2020 2020 2020 6764  ygon..        gd
+00017ad0: 6620 3d20 6e65 775f 6461 7461 7365 742e  f = new_dataset.
+00017ae0: 746f 5f70 6f6c 7967 6f6e 2862 616e 643d  to_polygon(band=
+00017af0: 6261 6e64 290d 0a0d 0a20 2020 2020 2020  band)....       
+00017b00: 2072 6574 7572 6e20 6764 660d 0a0d 0a20   return gdf.... 
+00017b10: 2020 2040 7374 6174 6963 6d65 7468 6f64     @staticmethod
+00017b20: 0d0a 2020 2020 6465 6620 6e6f 726d 616c  ..    def normal
+00017b30: 697a 6528 6172 7261 793a 206e 702e 6e64  ize(array: np.nd
+00017b40: 6172 7261 7929 3a0d 0a20 2020 2020 2020  array):..       
+00017b50: 2022 2222 0d0a 2020 2020 2020 2020 4e6f   """..        No
+00017b60: 726d 616c 697a 6573 206e 756d 7079 2061  rmalizes numpy a
+00017b70: 7272 6179 7320 696e 746f 2073 6361 6c65  rrays into scale
+00017b80: 2030 2e30 202d 2031 2e30 0d0a 0d0a 2020   0.0 - 1.0....  
+00017b90: 2020 2020 2020 5061 7261 6d65 7465 7273        Parameters
+00017ba0: 0d0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ..        ------
+00017bb0: 2d2d 2d2d 0d0a 2020 2020 2020 2020 6172  ----..        ar
+00017bc0: 7261 7920 3a20 5b61 7272 6179 5d0d 0a20  ray : [array].. 
+00017bd0: 2020 2020 2020 2020 2020 206e 756d 7079             numpy
+00017be0: 2061 7272 6179 0d0a 0d0a 2020 2020 2020   array....      
+00017bf0: 2020 5265 7475 726e 730d 0a20 2020 2020    Returns..     
+00017c00: 2020 202d 2d2d 2d2d 2d2d 0d0a 2020 2020     -------..    
+00017c10: 2020 2020 6172 7261 790d 0a20 2020 2020      array..     
+00017c20: 2020 2020 2020 2044 4553 4352 4950 5449         DESCRIPTI
+00017c30: 4f4e 2e0d 0a20 2020 2020 2020 2022 2222  ON...        """
+00017c40: 0d0a 2020 2020 2020 2020 6172 7261 795f  ..        array_
+00017c50: 6d69 6e20 3d20 6172 7261 792e 6d69 6e28  min = array.min(
+00017c60: 290d 0a20 2020 2020 2020 2061 7272 6179  )..        array
+00017c70: 5f6d 6178 203d 2061 7272 6179 2e6d 6178  _max = array.max
+00017c80: 2829 0d0a 2020 2020 2020 2020 7661 6c20  ()..        val 
+00017c90: 3d20 2861 7272 6179 202d 2061 7272 6179  = (array - array
+00017ca0: 5f6d 696e 2920 2f20 2861 7272 6179 5f6d  _min) / (array_m
+00017cb0: 6178 202d 2061 7272 6179 5f6d 696e 290d  ax - array_min).
+00017cc0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+00017cd0: 7661 6c0d 0a0d 0a20 2020 2040 7374 6174  val....    @stat
+00017ce0: 6963 6d65 7468 6f64 0d0a 2020 2020 6465  icmethod..    de
+00017cf0: 6620 5f77 696e 646f 7728 7372 633a 2067  f _window(src: g
+00017d00: 6461 6c2e 4461 7461 7365 742c 2073 697a  dal.Dataset, siz
+00017d10: 653a 2069 6e74 203d 2032 3536 293a 0d0a  e: int = 256):..
+00017d20: 2020 2020 2020 2020 2222 2244 6174 6173          """Datas
+00017d30: 6574 2073 7175 6172 6520 7769 6e64 6f77  et square window
+00017d40: 2073 697a 652f 6f66 6673 6574 732e 0d0a   size/offsets...
+00017d50: 0d0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
+00017d60: 7465 7273 0d0a 2020 2020 2020 2020 2d2d  ters..        --
+00017d70: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020  --------..      
+00017d80: 2020 7372 6320 3a20 5b67 6461 6c2e 4461    src : [gdal.Da
+00017d90: 7461 6375 6265 5d0d 0a20 2020 2020 2020  tacube]..       
+00017da0: 2020 2020 2067 6461 6c20 4461 7461 6375       gdal Datacu
+00017db0: 6265 206f 626a 6563 742e 0d0a 2020 2020  be object...    
+00017dc0: 2020 2020 7369 7a65 203a 205b 696e 745d      size : [int]
+00017dd0: 0d0a 2020 2020 2020 2020 2020 2020 5369  ..            Si
+00017de0: 7a65 206f 6620 7769 6e64 6f77 2069 6e20  ze of window in 
+00017df0: 7069 7865 6c73 2e20 4f6e 6520 7661 6c75  pixels. One valu
+00017e00: 6520 7265 7175 6972 6564 2077 6869 6368  e required which
+00017e10: 2069 7320 7573 6564 2066 6f72 2062 6f74   is used for bot
+00017e20: 6820 7468 650d 0a20 2020 2020 2020 2020  h the..         
+00017e30: 2020 2078 2061 6e64 2079 2073 697a 652e     x and y size.
+00017e40: 2045 2e67 2032 3536 206d 6561 6e73 2061   E.g 256 means a
+00017e50: 2032 3536 7832 3536 2077 696e 646f 772e   256x256 window.
+00017e60: 0d0a 0d0a 2020 2020 2020 2020 5969 656c  ....        Yiel
+00017e70: 6473 0d0a 2020 2020 2020 2020 2d2d 2d2d  ds..        ----
+00017e80: 2d2d 0d0a 2020 2020 2020 2020 7475 706c  --..        tupl
+00017e90: 655b 696e 745d 0d0a 2020 2020 2020 2020  e[int]..        
+00017ea0: 2020 2020 3420 656c 656d 656e 7420 7475      4 element tu
+00017eb0: 706c 6520 636f 6e74 6169 6e69 6e67 2074  ple containing t
+00017ec0: 6865 2078 2073 697a 652c 2079 2073 697a  he x size, y siz
+00017ed0: 652c 2078 206f 6666 7365 7420 616e 6420  e, x offset and 
+00017ee0: 7920 6f66 6673 6574 0d0a 2020 2020 2020  y offset..      
+00017ef0: 2020 2020 2020 6f66 2074 6865 2077 696e        of the win
+00017f00: 646f 772e 0d0a 2020 2020 2020 2020 2222  dow...        ""
+00017f10: 220d 0a20 2020 2020 2020 2063 6f6c 7320  "..        cols 
+00017f20: 3d20 7372 632e 5261 7374 6572 5853 697a  = src.RasterXSiz
+00017f30: 650d 0a20 2020 2020 2020 2072 6f77 7320  e..        rows 
+00017f40: 3d20 7372 632e 5261 7374 6572 5953 697a  = src.RasterYSiz
+00017f50: 650d 0a20 2020 2020 2020 2066 6f72 2078  e..        for x
+00017f60: 6f66 6620 696e 2072 616e 6765 2830 2c20  off in range(0, 
+00017f70: 636f 6c73 2c20 7369 7a65 293a 0d0a 2020  cols, size):..  
+00017f80: 2020 2020 2020 2020 2020 7873 697a 6520            xsize 
+00017f90: 3d20 7369 7a65 2069 6620 7369 7a65 202b  = size if size +
+00017fa0: 2078 6f66 6620 3c3d 2063 6f6c 7320 656c   xoff <= cols el
+00017fb0: 7365 2063 6f6c 7320 2d20 786f 6666 0d0a  se cols - xoff..
+00017fc0: 2020 2020 2020 2020 2020 2020 666f 7220              for 
+00017fd0: 796f 6666 2069 6e20 7261 6e67 6528 302c  yoff in range(0,
+00017fe0: 2072 6f77 732c 2073 697a 6529 3a0d 0a20   rows, size):.. 
+00017ff0: 2020 2020 2020 2020 2020 2020 2020 2079                 y
+00018000: 7369 7a65 203d 2073 697a 6520 6966 2073  size = size if s
+00018010: 697a 6520 2b20 796f 6666 203c 3d20 726f  ize + yoff <= ro
+00018020: 7773 2065 6c73 6520 726f 7773 202d 2079  ws else rows - y
+00018030: 6f66 660d 0a20 2020 2020 2020 2020 2020  off..           
+00018040: 2020 2020 2079 6965 6c64 2078 7369 7a65       yield xsize
+00018050: 2c20 7973 697a 652c 2078 6f66 662c 2079  , ysize, xoff, y
+00018060: 6f66 660d 0a0d 0a20 2020 2064 6566 2067  off....    def g
+00018070: 6574 5f74 696c 6528 7365 6c66 2c20 7369  et_tile(self, si
+00018080: 7a65 3d32 3536 293a 0d0a 2020 2020 2020  ze=256):..      
+00018090: 2020 2222 2267 6574 7320 6120 7261 7374    """gets a rast
+000180a0: 6572 2061 7272 6179 2069 6e20 7469 6c65  er array in tile
+000180b0: 732e 0d0a 0d0a 2020 2020 2020 2020 5061  s.....        Pa
+000180c0: 7261 6d65 7465 7273 0d0a 2020 2020 2020  rameters..      
+000180d0: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020    ----------..  
+000180e0: 2020 2020 2020 7369 7a65 203a 2069 6e74        size : int
+000180f0: 0d0a 2020 2020 2020 2020 2020 2020 5369  ..            Si
+00018100: 7a65 206f 6620 7769 6e64 6f77 2069 6e20  ze of window in 
+00018110: 7069 7865 6c73 2e20 4f6e 6520 7661 6c75  pixels. One valu
+00018120: 6520 7265 7175 6972 6564 2077 6869 6368  e required which
+00018130: 2069 7320 7573 6564 2066 6f72 2062 6f74   is used for bot
+00018140: 6820 7468 650d 0a20 2020 2020 2020 2020  h the..         
+00018150: 2020 2078 2061 6e64 2079 2073 697a 652e     x and y size.
+00018160: 2045 2e67 2032 3536 206d 6561 6e73 2061   E.g 256 means a
+00018170: 2032 3536 7832 3536 2077 696e 646f 772e   256x256 window.
+00018180: 0d0a 0d0a 2020 2020 2020 2020 5969 656c  ....        Yiel
+00018190: 6473 0d0a 2020 2020 2020 2020 2d2d 2d2d  ds..        ----
+000181a0: 2d2d 0d0a 2020 2020 2020 2020 6e70 2e6e  --..        np.n
+000181b0: 6461 7272 6179 0d0a 2020 2020 2020 2020  darray..        
+000181c0: 2020 2020 4461 7461 7365 7420 6172 7261      Dataset arra
+000181d0: 7920 696e 2066 6f72 6d20 5b62 616e 645d  y in form [band]
+000181e0: 5b79 5d5b 785d 2e0d 0a20 2020 2020 2020  [y][x]...       
+000181f0: 2022 2222 0d0a 2020 2020 2020 2020 666f   """..        fo
+00018200: 7220 7873 697a 652c 2079 7369 7a65 2c20  r xsize, ysize, 
+00018210: 786f 6666 2c20 796f 6666 2069 6e20 7365  xoff, yoff in se
+00018220: 6c66 2e5f 7769 6e64 6f77 2873 656c 662e  lf._window(self.
+00018230: 7261 7374 6572 2c20 7369 7a65 3d73 697a  raster, size=siz
+00018240: 6529 3a0d 0a20 2020 2020 2020 2020 2020  e):..           
+00018250: 2023 2072 6561 6420 7468 6520 6172 7261   # read the arra
+00018260: 7920 6174 2061 2063 6572 7461 696e 2069  y at a certain i
+00018270: 6e64 6563 6573 0d0a 2020 2020 2020 2020  ndeces..        
+00018280: 2020 2020 7969 656c 6420 7365 6c66 2e72      yield self.r
+00018290: 6173 7465 722e 5265 6164 4173 4172 7261  aster.ReadAsArra
+000182a0: 7928 0d0a 2020 2020 2020 2020 2020 2020  y(..            
+000182b0: 2020 2020 786f 6666 3d78 6f66 662c 2079      xoff=xoff, y
+000182c0: 6f66 663d 796f 6666 2c20 7873 697a 653d  off=yoff, xsize=
+000182d0: 7873 697a 652c 2079 7369 7a65 3d79 7369  xsize, ysize=ysi
+000182e0: 7a65 0d0a 2020 2020 2020 2020 2020 2020  ze..            
+000182f0: 290d 0a0d 0a20 2020 2040 7374 6174 6963  )....    @static
+00018300: 6d65 7468 6f64 0d0a 2020 2020 6465 6620  method..    def 
+00018310: 5f67 726f 7570 4e65 6967 6862 6f75 7273  _groupNeighbours
+00018320: 280d 0a20 2020 2020 2020 2061 7272 6179  (..        array
+00018330: 2c20 692c 206a 2c20 6c6f 7765 7276 616c  , i, j, lowerval
+00018340: 7565 2c20 7570 7065 7276 616c 7565 2c20  ue, uppervalue, 
+00018350: 706f 7369 7469 6f6e 2c20 7661 6c75 6573  position, values
+00018360: 2c20 636f 756e 742c 2063 6c75 7374 6572  , count, cluster
+00018370: 0d0a 2020 2020 293a 0d0a 2020 2020 2020  ..    ):..      
+00018380: 2020 2222 2267 726f 7570 206e 6569 6269    """group neibi
+00018390: 7572 696e 6720 6365 6c6c 7320 7769 7468  uring cells with
+000183a0: 2074 6865 2073 616d 6520 7661 6c75 6573   the same values
+000183b0: 2222 220d 0a0d 0a20 2020 2020 2020 2023  """....        #
+000183c0: 2062 6f74 746f 6d20 6365 6c6c 0d0a 2020   bottom cell..  
+000183d0: 2020 2020 2020 6966 2028 0d0a 2020 2020        if (..    
+000183e0: 2020 2020 2020 2020 6c6f 7765 7276 616c          lowerval
+000183f0: 7565 203c 3d20 6172 7261 795b 6920 2b20  ue <= array[i + 
+00018400: 312c 206a 5d20 3c3d 2075 7070 6572 7661  1, j] <= upperva
+00018410: 6c75 650d 0a20 2020 2020 2020 2020 2020  lue..           
+00018420: 2061 6e64 2063 6c75 7374 6572 5b69 202b   and cluster[i +
+00018430: 2031 2c20 6a5d 203d 3d20 300d 0a20 2020   1, j] == 0..   
+00018440: 2020 2020 2020 2020 2061 6e64 2069 202b           and i +
+00018450: 2031 203c 2061 7272 6179 2e73 6861 7065   1 < array.shape
+00018460: 5b30 5d0d 0a20 2020 2020 2020 2029 3a0d  [0]..        ):.
+00018470: 0a20 2020 2020 2020 2020 2020 2070 6f73  .            pos
+00018480: 6974 696f 6e2e 6170 7065 6e64 285b 6920  ition.append([i 
+00018490: 2b20 312c 206a 5d29 0d0a 2020 2020 2020  + 1, j])..      
+000184a0: 2020 2020 2020 7661 6c75 6573 2e61 7070        values.app
+000184b0: 656e 6428 6172 7261 795b 6920 2b20 312c  end(array[i + 1,
+000184c0: 206a 5d29 0d0a 2020 2020 2020 2020 2020   j])..          
+000184d0: 2020 636c 7573 7465 725b 6920 2b20 312c    cluster[i + 1,
+000184e0: 206a 5d20 3d20 636f 756e 740d 0a20 2020   j] = count..   
+000184f0: 2020 2020 2020 2020 2044 6174 6173 6574           Dataset
+00018500: 2e5f 6772 6f75 704e 6569 6768 626f 7572  ._groupNeighbour
+00018510: 7328 0d0a 2020 2020 2020 2020 2020 2020  s(..            
+00018520: 2020 2020 6172 7261 792c 0d0a 2020 2020      array,..    
+00018530: 2020 2020 2020 2020 2020 2020 6920 2b20              i + 
+00018540: 312c 0d0a 2020 2020 2020 2020 2020 2020  1,..            
+00018550: 2020 2020 6a2c 0d0a 2020 2020 2020 2020      j,..        
+00018560: 2020 2020 2020 2020 6c6f 7765 7276 616c          lowerval
+00018570: 7565 2c0d 0a20 2020 2020 2020 2020 2020  ue,..           
+00018580: 2020 2020 2075 7070 6572 7661 6c75 652c       uppervalue,
+00018590: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000185a0: 2020 706f 7369 7469 6f6e 2c0d 0a20 2020    position,..   
+000185b0: 2020 2020 2020 2020 2020 2020 2076 616c               val
+000185c0: 7565 732c 0d0a 2020 2020 2020 2020 2020  ues,..          
+000185d0: 2020 2020 2020 636f 756e 742c 0d0a 2020        count,..  
+000185e0: 2020 2020 2020 2020 2020 2020 2020 636c                cl
+000185f0: 7573 7465 722c 0d0a 2020 2020 2020 2020  uster,..        
+00018600: 2020 2020 290d 0a20 2020 2020 2020 2023      )..        #
+00018610: 2062 6f74 746f 6d20 7269 6768 740d 0a20   bottom right.. 
+00018620: 2020 2020 2020 2069 6620 280d 0a20 2020         if (..   
+00018630: 2020 2020 2020 2020 206a 202b 2031 203c           j + 1 <
+00018640: 2061 7272 6179 2e73 6861 7065 5b31 5d0d   array.shape[1].
+00018650: 0a20 2020 2020 2020 2020 2020 2061 6e64  .            and
+00018660: 2069 202b 2031 203c 2061 7272 6179 2e73   i + 1 < array.s
+00018670: 6861 7065 5b30 5d0d 0a20 2020 2020 2020  hape[0]..       
+00018680: 2020 2020 2061 6e64 206c 6f77 6572 7661       and lowerva
+00018690: 6c75 6520 3c3d 2061 7272 6179 5b69 202b  lue <= array[i +
+000186a0: 2031 2c20 6a20 2b20 315d 203c 3d20 7570   1, j + 1] <= up
+000186b0: 7065 7276 616c 7565 0d0a 2020 2020 2020  pervalue..      
+000186c0: 2020 2020 2020 616e 6420 636c 7573 7465        and cluste
+000186d0: 725b 6920 2b20 312c 206a 202b 2031 5d20  r[i + 1, j + 1] 
+000186e0: 3d3d 2030 0d0a 2020 2020 2020 2020 293a  == 0..        ):
+000186f0: 0d0a 2020 2020 2020 2020 2020 2020 706f  ..            po
+00018700: 7369 7469 6f6e 2e61 7070 656e 6428 5b69  sition.append([i
+00018710: 202b 2031 2c20 6a20 2b20 315d 290d 0a20   + 1, j + 1]).. 
+00018720: 2020 2020 2020 2020 2020 2076 616c 7565             value
+00018730: 732e 6170 7065 6e64 2861 7272 6179 5b69  s.append(array[i
+00018740: 202b 2031 2c20 6a20 2b20 315d 290d 0a20   + 1, j + 1]).. 
+00018750: 2020 2020 2020 2020 2020 2063 6c75 7374             clust
+00018760: 6572 5b69 202b 2031 2c20 6a20 2b20 315d  er[i + 1, j + 1]
+00018770: 203d 2063 6f75 6e74 0d0a 2020 2020 2020   = count..      
+00018780: 2020 2020 2020 4461 7461 7365 742e 5f67        Dataset._g
+00018790: 726f 7570 4e65 6967 6862 6f75 7273 280d  roupNeighbours(.
+000187a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000187b0: 2061 7272 6179 2c0d 0a20 2020 2020 2020   array,..       
+000187c0: 2020 2020 2020 2020 2069 202b 2031 2c0d           i + 1,.
+000187d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000187e0: 206a 202b 2031 2c0d 0a20 2020 2020 2020   j + 1,..       
+000187f0: 2020 2020 2020 2020 206c 6f77 6572 7661           lowerva
+00018800: 6c75 652c 0d0a 2020 2020 2020 2020 2020  lue,..          
+00018810: 2020 2020 2020 7570 7065 7276 616c 7565        uppervalue
+00018820: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+00018830: 2020 2070 6f73 6974 696f 6e2c 0d0a 2020     position,..  
+00018840: 2020 2020 2020 2020 2020 2020 2020 7661                va
+00018850: 6c75 6573 2c0d 0a20 2020 2020 2020 2020  lues,..         
+00018860: 2020 2020 2020 2063 6f75 6e74 2c0d 0a20         count,.. 
+00018870: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+00018880: 6c75 7374 6572 2c0d 0a20 2020 2020 2020  luster,..       
+00018890: 2020 2020 2029 0d0a 2020 2020 2020 2020       )..        
+000188a0: 2320 7269 6768 740d 0a20 2020 2020 2020  # right..       
+000188b0: 2069 6620 280d 0a20 2020 2020 2020 2020   if (..         
+000188c0: 2020 206a 202b 2031 203c 2061 7272 6179     j + 1 < array
+000188d0: 2e73 6861 7065 5b31 5d0d 0a20 2020 2020  .shape[1]..     
+000188e0: 2020 2020 2020 2061 6e64 206c 6f77 6572         and lower
+000188f0: 7661 6c75 6520 3c3d 2061 7272 6179 5b69  value <= array[i
+00018900: 2c20 6a20 2b20 315d 203c 3d20 7570 7065  , j + 1] <= uppe
+00018910: 7276 616c 7565 0d0a 2020 2020 2020 2020  rvalue..        
+00018920: 2020 2020 616e 6420 636c 7573 7465 725b      and cluster[
+00018930: 692c 206a 202b 2031 5d20 3d3d 2030 0d0a  i, j + 1] == 0..
+00018940: 2020 2020 2020 2020 293a 0d0a 2020 2020          ):..    
+00018950: 2020 2020 2020 2020 706f 7369 7469 6f6e          position
+00018960: 2e61 7070 656e 6428 5b69 2c20 6a20 2b20  .append([i, j + 
+00018970: 315d 290d 0a20 2020 2020 2020 2020 2020  1])..           
+00018980: 2076 616c 7565 732e 6170 7065 6e64 2861   values.append(a
+00018990: 7272 6179 5b69 2c20 6a20 2b20 315d 290d  rray[i, j + 1]).
+000189a0: 0a20 2020 2020 2020 2020 2020 2063 6c75  .            clu
+000189b0: 7374 6572 5b69 2c20 6a20 2b20 315d 203d  ster[i, j + 1] =
+000189c0: 2063 6f75 6e74 0d0a 2020 2020 2020 2020   count..        
+000189d0: 2020 2020 4461 7461 7365 742e 5f67 726f      Dataset._gro
+000189e0: 7570 4e65 6967 6862 6f75 7273 280d 0a20  upNeighbours(.. 
+000189f0: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+00018a00: 7272 6179 2c0d 0a20 2020 2020 2020 2020  rray,..         
+00018a10: 2020 2020 2020 2069 2c0d 0a20 2020 2020         i,..     
+00018a20: 2020 2020 2020 2020 2020 206a 202b 2031             j + 1
+00018a30: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+00018a40: 2020 206c 6f77 6572 7661 6c75 652c 0d0a     lowervalue,..
+00018a50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018a60: 7570 7065 7276 616c 7565 2c0d 0a20 2020  uppervalue,..   
+00018a70: 2020 2020 2020 2020 2020 2020 2070 6f73               pos
+00018a80: 6974 696f 6e2c 0d0a 2020 2020 2020 2020  ition,..        
+00018a90: 2020 2020 2020 2020 7661 6c75 6573 2c0d          values,.
+00018aa0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00018ab0: 2063 6f75 6e74 2c0d 0a20 2020 2020 2020   count,..       
+00018ac0: 2020 2020 2020 2020 2063 6c75 7374 6572           cluster
+00018ad0: 2c0d 0a20 2020 2020 2020 2020 2020 2029  ,..            )
+00018ae0: 0d0a 2020 2020 2020 2020 2320 7570 7065  ..        # uppe
+00018af0: 7220 7269 6768 740d 0a20 2020 2020 2020  r right..       
+00018b00: 2069 6620 280d 0a20 2020 2020 2020 2020   if (..         
+00018b10: 2020 206a 202b 2031 203c 2061 7272 6179     j + 1 < array
+00018b20: 2e73 6861 7065 5b31 5d0d 0a20 2020 2020  .shape[1]..     
+00018b30: 2020 2020 2020 2061 6e64 2069 202d 2031         and i - 1
+00018b40: 203e 3d20 300d 0a20 2020 2020 2020 2020   >= 0..         
+00018b50: 2020 2061 6e64 206c 6f77 6572 7661 6c75     and lowervalu
+00018b60: 6520 3c3d 2061 7272 6179 5b69 202d 2031  e <= array[i - 1
+00018b70: 2c20 6a20 2b20 315d 203c 3d20 7570 7065  , j + 1] <= uppe
+00018b80: 7276 616c 7565 0d0a 2020 2020 2020 2020  rvalue..        
+00018b90: 2020 2020 616e 6420 636c 7573 7465 725b      and cluster[
+00018ba0: 6920 2d20 312c 206a 202b 2031 5d20 3d3d  i - 1, j + 1] ==
+00018bb0: 2030 0d0a 2020 2020 2020 2020 293a 0d0a   0..        ):..
+00018bc0: 2020 2020 2020 2020 2020 2020 706f 7369              posi
+00018bd0: 7469 6f6e 2e61 7070 656e 6428 5b69 202d  tion.append([i -
+00018be0: 2031 2c20 6a20 2b20 315d 290d 0a20 2020   1, j + 1])..   
+00018bf0: 2020 2020 2020 2020 2076 616c 7565 732e           values.
+00018c00: 6170 7065 6e64 2861 7272 6179 5b69 202d  append(array[i -
+00018c10: 2031 2c20 6a20 2b20 315d 290d 0a20 2020   1, j + 1])..   
+00018c20: 2020 2020 2020 2020 2063 6c75 7374 6572           cluster
+00018c30: 5b69 202d 2031 2c20 6a20 2b20 315d 203d  [i - 1, j + 1] =
+00018c40: 2063 6f75 6e74 0d0a 2020 2020 2020 2020   count..        
+00018c50: 2020 2020 4461 7461 7365 742e 5f67 726f      Dataset._gro
+00018c60: 7570 4e65 6967 6862 6f75 7273 280d 0a20  upNeighbours(.. 
+00018c70: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+00018c80: 7272 6179 2c0d 0a20 2020 2020 2020 2020  rray,..         
+00018c90: 2020 2020 2020 2069 202d 2031 2c0d 0a20         i - 1,.. 
+00018ca0: 2020 2020 2020 2020 2020 2020 2020 206a                 j
+00018cb0: 202b 2031 2c0d 0a20 2020 2020 2020 2020   + 1,..         
+00018cc0: 2020 2020 2020 206c 6f77 6572 7661 6c75         lowervalu
+00018cd0: 652c 0d0a 2020 2020 2020 2020 2020 2020  e,..            
+00018ce0: 2020 2020 7570 7065 7276 616c 7565 2c0d      uppervalue,.
+00018cf0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00018d00: 2070 6f73 6974 696f 6e2c 0d0a 2020 2020   position,..    
+00018d10: 2020 2020 2020 2020 2020 2020 7661 6c75              valu
+00018d20: 6573 2c0d 0a20 2020 2020 2020 2020 2020  es,..           
+00018d30: 2020 2020 2063 6f75 6e74 2c0d 0a20 2020       count,..   
+00018d40: 2020 2020 2020 2020 2020 2020 2063 6c75               clu
+00018d50: 7374 6572 2c0d 0a20 2020 2020 2020 2020  ster,..         
+00018d60: 2020 2029 0d0a 2020 2020 2020 2020 2320     )..        # 
+00018d70: 746f 700d 0a20 2020 2020 2020 2069 6620  top..        if 
+00018d80: 280d 0a20 2020 2020 2020 2020 2020 2069  (..            i
+00018d90: 202d 2031 203e 3d20 300d 0a20 2020 2020   - 1 >= 0..     
+00018da0: 2020 2020 2020 2061 6e64 206c 6f77 6572         and lower
+00018db0: 7661 6c75 6520 3c3d 2061 7272 6179 5b69  value <= array[i
+00018dc0: 202d 2031 2c20 6a5d 203c 3d20 7570 7065   - 1, j] <= uppe
+00018dd0: 7276 616c 7565 0d0a 2020 2020 2020 2020  rvalue..        
+00018de0: 2020 2020 616e 6420 636c 7573 7465 725b      and cluster[
+00018df0: 6920 2d20 312c 206a 5d20 3d3d 2030 0d0a  i - 1, j] == 0..
+00018e00: 2020 2020 2020 2020 293a 0d0a 2020 2020          ):..    
+00018e10: 2020 2020 2020 2020 706f 7369 7469 6f6e          position
+00018e20: 2e61 7070 656e 6428 5b69 202d 2031 2c20  .append([i - 1, 
+00018e30: 6a5d 290d 0a20 2020 2020 2020 2020 2020  j])..           
+00018e40: 2076 616c 7565 732e 6170 7065 6e64 2861   values.append(a
+00018e50: 7272 6179 5b69 202d 2031 2c20 6a5d 290d  rray[i - 1, j]).
+00018e60: 0a20 2020 2020 2020 2020 2020 2063 6c75  .            clu
+00018e70: 7374 6572 5b69 202d 2031 2c20 6a5d 203d  ster[i - 1, j] =
+00018e80: 2063 6f75 6e74 0d0a 2020 2020 2020 2020   count..        
+00018e90: 2020 2020 4461 7461 7365 742e 5f67 726f      Dataset._gro
+00018ea0: 7570 4e65 6967 6862 6f75 7273 280d 0a20  upNeighbours(.. 
+00018eb0: 2020 2020 2020 2020 2020 2020 2020 2061                 a
+00018ec0: 7272 6179 2c0d 0a20 2020 2020 2020 2020  rray,..         
+00018ed0: 2020 2020 2020 2069 202d 2031 2c0d 0a20         i - 1,.. 
+00018ee0: 2020 2020 2020 2020 2020 2020 2020 206a                 j
+00018ef0: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+00018f00: 2020 206c 6f77 6572 7661 6c75 652c 0d0a     lowervalue,..
+00018f10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00018f20: 7570 7065 7276 616c 7565 2c0d 0a20 2020  uppervalue,..   
+00018f30: 2020 2020 2020 2020 2020 2020 2070 6f73               pos
+00018f40: 6974 696f 6e2c 0d0a 2020 2020 2020 2020  ition,..        
+00018f50: 2020 2020 2020 2020 7661 6c75 6573 2c0d          values,.
+00018f60: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00018f70: 2063 6f75 6e74 2c0d 0a20 2020 2020 2020   count,..       
+00018f80: 2020 2020 2020 2020 2063 6c75 7374 6572           cluster
+00018f90: 2c0d 0a20 2020 2020 2020 2020 2020 2029  ,..            )
+00018fa0: 0d0a 2020 2020 2020 2020 2320 746f 7020  ..        # top 
+00018fb0: 6c65 6674 0d0a 2020 2020 2020 2020 6966  left..        if
+00018fc0: 2028 0d0a 2020 2020 2020 2020 2020 2020   (..            
+00018fd0: 6920 2d20 3120 3e3d 2030 0d0a 2020 2020  i - 1 >= 0..    
+00018fe0: 2020 2020 2020 2020 616e 6420 6a20 2d20          and j - 
+00018ff0: 3120 3e3d 2030 0d0a 2020 2020 2020 2020  1 >= 0..        
+00019000: 2020 2020 616e 6420 6c6f 7765 7276 616c      and lowerval
+00019010: 7565 203c 3d20 6172 7261 795b 6920 2d20  ue <= array[i - 
+00019020: 312c 206a 202d 2031 5d20 3c3d 2075 7070  1, j - 1] <= upp
+00019030: 6572 7661 6c75 650d 0a20 2020 2020 2020  ervalue..       
+00019040: 2020 2020 2061 6e64 2063 6c75 7374 6572       and cluster
+00019050: 5b69 202d 2031 2c20 6a20 2d20 315d 203d  [i - 1, j - 1] =
+00019060: 3d20 300d 0a20 2020 2020 2020 2029 3a0d  = 0..        ):.
+00019070: 0a20 2020 2020 2020 2020 2020 2070 6f73  .            pos
+00019080: 6974 696f 6e2e 6170 7065 6e64 285b 6920  ition.append([i 
+00019090: 2d20 312c 206a 202d 2031 5d29 0d0a 2020  - 1, j - 1])..  
+000190a0: 2020 2020 2020 2020 2020 7661 6c75 6573            values
+000190b0: 2e61 7070 656e 6428 6172 7261 795b 6920  .append(array[i 
+000190c0: 2d20 312c 206a 202d 2031 5d29 0d0a 2020  - 1, j - 1])..  
+000190d0: 2020 2020 2020 2020 2020 636c 7573 7465            cluste
+000190e0: 725b 6920 2d20 312c 206a 202d 2031 5d20  r[i - 1, j - 1] 
+000190f0: 3d20 636f 756e 740d 0a20 2020 2020 2020  = count..       
+00019100: 2020 2020 2044 6174 6173 6574 2e5f 6772       Dataset._gr
+00019110: 6f75 704e 6569 6768 626f 7572 7328 0d0a  oupNeighbours(..
+00019120: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019130: 6172 7261 792c 0d0a 2020 2020 2020 2020  array,..        
+00019140: 2020 2020 2020 2020 6920 2d20 312c 0d0a          i - 1,..
+00019150: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019160: 6a20 2d20 312c 0d0a 2020 2020 2020 2020  j - 1,..        
+00019170: 2020 2020 2020 2020 6c6f 7765 7276 616c          lowerval
+00019180: 7565 2c0d 0a20 2020 2020 2020 2020 2020  ue,..           
+00019190: 2020 2020 2075 7070 6572 7661 6c75 652c       uppervalue,
+000191a0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000191b0: 2020 706f 7369 7469 6f6e 2c0d 0a20 2020    position,..   
+000191c0: 2020 2020 2020 2020 2020 2020 2076 616c               val
+000191d0: 7565 732c 0d0a 2020 2020 2020 2020 2020  ues,..          
+000191e0: 2020 2020 2020 636f 756e 742c 0d0a 2020        count,..  
+000191f0: 2020 2020 2020 2020 2020 2020 2020 636c                cl
+00019200: 7573 7465 722c 0d0a 2020 2020 2020 2020  uster,..        
+00019210: 2020 2020 290d 0a20 2020 2020 2020 2023      )..        #
+00019220: 206c 6566 740d 0a20 2020 2020 2020 2069   left..        i
+00019230: 6620 280d 0a20 2020 2020 2020 2020 2020  f (..           
+00019240: 206a 202d 2031 203e 3d20 300d 0a20 2020   j - 1 >= 0..   
+00019250: 2020 2020 2020 2020 2061 6e64 206c 6f77           and low
+00019260: 6572 7661 6c75 6520 3c3d 2061 7272 6179  ervalue <= array
+00019270: 5b69 2c20 6a20 2d20 315d 203c 3d20 7570  [i, j - 1] <= up
+00019280: 7065 7276 616c 7565 0d0a 2020 2020 2020  pervalue..      
+00019290: 2020 2020 2020 616e 6420 636c 7573 7465        and cluste
+000192a0: 725b 692c 206a 202d 2031 5d20 3d3d 2030  r[i, j - 1] == 0
+000192b0: 0d0a 2020 2020 2020 2020 293a 0d0a 2020  ..        ):..  
+000192c0: 2020 2020 2020 2020 2020 706f 7369 7469            positi
+000192d0: 6f6e 2e61 7070 656e 6428 5b69 2c20 6a20  on.append([i, j 
+000192e0: 2d20 315d 290d 0a20 2020 2020 2020 2020  - 1])..         
+000192f0: 2020 2076 616c 7565 732e 6170 7065 6e64     values.append
+00019300: 2861 7272 6179 5b69 2c20 6a20 2d20 315d  (array[i, j - 1]
+00019310: 290d 0a20 2020 2020 2020 2020 2020 2063  )..            c
+00019320: 6c75 7374 6572 5b69 2c20 6a20 2d20 315d  luster[i, j - 1]
+00019330: 203d 2063 6f75 6e74 0d0a 2020 2020 2020   = count..      
+00019340: 2020 2020 2020 4461 7461 7365 742e 5f67        Dataset._g
+00019350: 726f 7570 4e65 6967 6862 6f75 7273 280d  roupNeighbours(.
+00019360: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00019370: 2061 7272 6179 2c0d 0a20 2020 2020 2020   array,..       
+00019380: 2020 2020 2020 2020 2069 2c0d 0a20 2020           i,..   
+00019390: 2020 2020 2020 2020 2020 2020 206a 202d               j -
+000193a0: 2031 2c0d 0a20 2020 2020 2020 2020 2020   1,..           
+000193b0: 2020 2020 206c 6f77 6572 7661 6c75 652c       lowervalue,
+000193c0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+000193d0: 2020 7570 7065 7276 616c 7565 2c0d 0a20    uppervalue,.. 
+000193e0: 2020 2020 2020 2020 2020 2020 2020 2070                 p
+000193f0: 6f73 6974 696f 6e2c 0d0a 2020 2020 2020  osition,..      
+00019400: 2020 2020 2020 2020 2020 7661 6c75 6573            values
+00019410: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+00019420: 2020 2063 6f75 6e74 2c0d 0a20 2020 2020     count,..     
+00019430: 2020 2020 2020 2020 2020 2063 6c75 7374             clust
+00019440: 6572 2c0d 0a20 2020 2020 2020 2020 2020  er,..           
+00019450: 2029 0d0a 2020 2020 2020 2020 2320 626f   )..        # bo
+00019460: 7474 6f6d 206c 6566 740d 0a20 2020 2020  ttom left..     
+00019470: 2020 2069 6620 280d 0a20 2020 2020 2020     if (..       
+00019480: 2020 2020 206a 202d 2031 203e 3d20 300d       j - 1 >= 0.
+00019490: 0a20 2020 2020 2020 2020 2020 2061 6e64  .            and
+000194a0: 2069 202b 2031 203c 2061 7272 6179 2e73   i + 1 < array.s
+000194b0: 6861 7065 5b30 5d0d 0a20 2020 2020 2020  hape[0]..       
+000194c0: 2020 2020 2061 6e64 206c 6f77 6572 7661       and lowerva
+000194d0: 6c75 6520 3c3d 2061 7272 6179 5b69 202b  lue <= array[i +
+000194e0: 2031 2c20 6a20 2d20 315d 203c 3d20 7570   1, j - 1] <= up
+000194f0: 7065 7276 616c 7565 0d0a 2020 2020 2020  pervalue..      
+00019500: 2020 2020 2020 616e 6420 636c 7573 7465        and cluste
+00019510: 725b 6920 2b20 312c 206a 202d 2031 5d20  r[i + 1, j - 1] 
+00019520: 3d3d 2030 0d0a 2020 2020 2020 2020 293a  == 0..        ):
+00019530: 0d0a 2020 2020 2020 2020 2020 2020 706f  ..            po
+00019540: 7369 7469 6f6e 2e61 7070 656e 6428 5b69  sition.append([i
+00019550: 202b 2031 2c20 6a20 2d20 315d 290d 0a20   + 1, j - 1]).. 
+00019560: 2020 2020 2020 2020 2020 2076 616c 7565             value
+00019570: 732e 6170 7065 6e64 2861 7272 6179 5b69  s.append(array[i
+00019580: 202b 2031 2c20 6a20 2d20 315d 290d 0a20   + 1, j - 1]).. 
+00019590: 2020 2020 2020 2020 2020 2063 6c75 7374             clust
+000195a0: 6572 5b69 202b 2031 2c20 6a20 2d20 315d  er[i + 1, j - 1]
+000195b0: 203d 2063 6f75 6e74 0d0a 2020 2020 2020   = count..      
+000195c0: 2020 2020 2020 4461 7461 7365 742e 5f67        Dataset._g
+000195d0: 726f 7570 4e65 6967 6862 6f75 7273 280d  roupNeighbours(.
+000195e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000195f0: 2061 7272 6179 2c0d 0a20 2020 2020 2020   array,..       
+00019600: 2020 2020 2020 2020 2069 202b 2031 2c0d           i + 1,.
+00019610: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00019620: 206a 202d 2031 2c0d 0a20 2020 2020 2020   j - 1,..       
+00019630: 2020 2020 2020 2020 206c 6f77 6572 7661           lowerva
+00019640: 6c75 652c 0d0a 2020 2020 2020 2020 2020  lue,..          
+00019650: 2020 2020 2020 7570 7065 7276 616c 7565        uppervalue
+00019660: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+00019670: 2020 2070 6f73 6974 696f 6e2c 0d0a 2020     position,..  
+00019680: 2020 2020 2020 2020 2020 2020 2020 7661                va
+00019690: 6c75 6573 2c0d 0a20 2020 2020 2020 2020  lues,..         
+000196a0: 2020 2020 2020 2063 6f75 6e74 2c0d 0a20         count,.. 
+000196b0: 2020 2020 2020 2020 2020 2020 2020 2063                 c
+000196c0: 6c75 7374 6572 2c0d 0a20 2020 2020 2020  luster,..       
+000196d0: 2020 2020 2029 0d0a 0d0a 2020 2020 6465       )....    de
+000196e0: 6620 636c 7573 7465 7228 0d0a 2020 2020  f cluster(..    
+000196f0: 2020 2020 7365 6c66 2c20 6c6f 7765 725f      self, lower_
+00019700: 626f 756e 643a 2041 6e79 2c20 7570 7065  bound: Any, uppe
+00019710: 725f 626f 756e 643a 2041 6e79 0d0a 2020  r_bound: Any..  
+00019720: 2020 2920 2d3e 2054 7570 6c65 5b6e 702e    ) -> Tuple[np.
+00019730: 6e64 6172 7261 792c 2069 6e74 2c20 6c69  ndarray, int, li
+00019740: 7374 2c20 6c69 7374 5d3a 0d0a 2020 2020  st, list]:..    
+00019750: 2020 2020 2222 2243 6c75 7374 6572 0d0a      """Cluster..
+00019760: 0d0a 2020 2020 2020 2020 2020 2020 2d20  ..            - 
+00019770: 6772 6f75 7020 616c 6c20 7468 6520 636f  group all the co
+00019780: 6e6e 6563 7465 6420 7661 6c75 6573 2062  nnected values b
+00019790: 6574 7765 656e 2074 776f 206e 756d 6265  etween two numbe
+000197a0: 7273 2069 6e20 6120 7261 7374 6572 2069  rs in a raster i
+000197b0: 6e20 636c 7573 7465 7273 2e0d 0a0d 0a20  n clusters..... 
+000197c0: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
+000197d0: 730d 0a20 2020 2020 2020 202d 2d2d 2d2d  s..        -----
+000197e0: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 206c  -----..        l
+000197f0: 6f77 6572 5f62 6f75 6e64 203a 205b 6e75  ower_bound : [nu
+00019800: 6d65 7269 635d 0d0a 2020 2020 2020 2020  meric]..        
+00019810: 2020 2020 6c6f 7765 7220 626f 756e 6420      lower bound 
+00019820: 6f66 2074 6865 2063 6c75 7374 6572 2e0d  of the cluster..
+00019830: 0a20 2020 2020 2020 2075 7070 6572 5f62  .        upper_b
+00019840: 6f75 6e64 203a 205b 6e75 6d65 7269 635d  ound : [numeric]
+00019850: 0d0a 2020 2020 2020 2020 2020 2020 7570  ..            up
+00019860: 7065 7220 626f 756e 6420 6f66 2074 6865  per bound of the
+00019870: 2063 6c75 7374 6572 2e0d 0a0d 0a20 2020   cluster.....   
+00019880: 2020 2020 2052 6574 7572 6e73 0d0a 2020       Returns..  
+00019890: 2020 2020 2020 2d2d 2d2d 2d2d 2d0d 0a20        -------.. 
+000198a0: 2020 2020 2020 2063 6c75 7374 6572 203a         cluster :
+000198b0: 205b 6172 7261 795d 0d0a 2020 2020 2020   [array]..      
+000198c0: 2020 2020 2020 6172 7261 7920 636f 6e74        array cont
+000198d0: 6169 6e73 2069 6e74 6567 6572 206e 756d  ains integer num
+000198e0: 6265 7273 2072 6570 7265 7365 6e74 696e  bers representin
+000198f0: 6720 7468 6520 6e75 6d62 6572 206f 6620  g the number of 
+00019900: 7468 6520 636c 7573 7465 722e 0d0a 2020  the cluster...  
+00019910: 2020 2020 2020 636f 756e 7420 3a20 5b69        count : [i
+00019920: 6e74 6567 6572 5d0d 0a20 2020 2020 2020  nteger]..       
+00019930: 2020 2020 206e 756d 6265 7220 6f66 2074       number of t
+00019940: 6865 2063 6c75 7374 6572 7320 696e 2074  he clusters in t
+00019950: 6865 2061 7272 6179 2e0d 0a20 2020 2020  he array...     
+00019960: 2020 2070 6f73 6974 696f 6e20 3a20 5b6c     position : [l
+00019970: 6973 745d 0d0a 2020 2020 2020 2020 2020  ist]..          
+00019980: 2020 6c69 7374 2063 6f6e 7461 696e 7320    list contains 
+00019990: 7477 6f20 696e 6465 6365 7320 5b78 2c79  two indeces [x,y
+000199a0: 5d20 666f 7220 7468 6520 706f 7369 7469  ] for the positi
+000199b0: 6f6e 206f 6620 6561 6368 2076 616c 7565  on of each value
+000199c0: 202e 0d0a 2020 2020 2020 2020 7661 6c75   ...        valu
+000199d0: 6573 203a 205b 6e75 6d65 7269 635d 0d0a  es : [numeric]..
+000199e0: 2020 2020 2020 2020 2020 2020 7468 6520              the 
+000199f0: 7661 6c75 6573 2073 746f 7265 6420 696e  values stored in
+00019a00: 2065 6163 6820 6365 6c6c 2069 6e20 7468   each cell in th
+00019a10: 6520 636c 7573 7465 7220 2e0d 0a20 2020  e cluster ...   
+00019a20: 2020 2020 2022 2222 0d0a 2020 2020 2020       """..      
+00019a30: 2020 6461 7461 203d 2073 656c 662e 7265    data = self.re
+00019a40: 6164 5f61 7272 6179 2829 0d0a 2020 2020  ad_array()..    
+00019a50: 2020 2020 706f 7369 7469 6f6e 203d 205b      position = [
+00019a60: 5d0d 0a20 2020 2020 2020 2076 616c 7565  ]..        value
+00019a70: 7320 3d20 5b5d 0d0a 2020 2020 2020 2020  s = []..        
+00019a80: 636f 756e 7420 3d20 310d 0a20 2020 2020  count = 1..     
+00019a90: 2020 2063 6c75 7374 6572 203d 206e 702e     cluster = np.
+00019aa0: 7a65 726f 7328 7368 6170 653d 2864 6174  zeros(shape=(dat
+00019ab0: 612e 7368 6170 655b 305d 2c20 6461 7461  a.shape[0], data
+00019ac0: 2e73 6861 7065 5b31 5d29 290d 0a0d 0a20  .shape[1])).... 
+00019ad0: 2020 2020 2020 2066 6f72 2069 2069 6e20         for i in 
+00019ae0: 7261 6e67 6528 6461 7461 2e73 6861 7065  range(data.shape
+00019af0: 5b30 5d29 3a0d 0a20 2020 2020 2020 2020  [0]):..         
+00019b00: 2020 2066 6f72 206a 2069 6e20 7261 6e67     for j in rang
+00019b10: 6528 6461 7461 2e73 6861 7065 5b31 5d29  e(data.shape[1])
+00019b20: 3a0d 0a0d 0a20 2020 2020 2020 2020 2020  :....           
+00019b30: 2020 2020 2069 6620 6c6f 7765 725f 626f       if lower_bo
+00019b40: 756e 6420 3c3d 2064 6174 615b 692c 206a  und <= data[i, j
+00019b50: 5d20 3c3d 2075 7070 6572 5f62 6f75 6e64  ] <= upper_bound
+00019b60: 2061 6e64 2063 6c75 7374 6572 5b69 2c20   and cluster[i, 
+00019b70: 6a5d 203d 3d20 303a 0d0a 2020 2020 2020  j] == 0:..      
+00019b80: 2020 2020 2020 2020 2020 2020 2020 7365                se
+00019b90: 6c66 2e5f 6772 6f75 704e 6569 6768 626f  lf._groupNeighbo
+00019ba0: 7572 7328 0d0a 2020 2020 2020 2020 2020  urs(..          
+00019bb0: 2020 2020 2020 2020 2020 2020 2020 6461                da
+00019bc0: 7461 2c0d 0a20 2020 2020 2020 2020 2020  ta,..           
+00019bd0: 2020 2020 2020 2020 2020 2020 2069 2c0d               i,.
+00019be0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00019bf0: 2020 2020 2020 2020 206a 2c0d 0a20 2020           j,..   
+00019c00: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019c10: 2020 2020 206c 6f77 6572 5f62 6f75 6e64       lower_bound
+00019c20: 2c0d 0a20 2020 2020 2020 2020 2020 2020  ,..             
+00019c30: 2020 2020 2020 2020 2020 2075 7070 6572             upper
+00019c40: 5f62 6f75 6e64 2c0d 0a20 2020 2020 2020  _bound,..       
+00019c50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019c60: 2070 6f73 6974 696f 6e2c 0d0a 2020 2020   position,..    
+00019c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019c80: 2020 2020 7661 6c75 6573 2c0d 0a20 2020      values,..   
+00019c90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019ca0: 2020 2020 2063 6f75 6e74 2c0d 0a20 2020       count,..   
+00019cb0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019cc0: 2020 2020 2063 6c75 7374 6572 2c0d 0a20       cluster,.. 
+00019cd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00019ce0: 2020 2029 0d0a 2020 2020 2020 2020 2020     )..          
+00019cf0: 2020 2020 2020 2020 2020 6966 2063 6c75            if clu
+00019d00: 7374 6572 5b69 2c20 6a5d 203d 3d20 303a  ster[i, j] == 0:
+00019d10: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+00019d20: 2020 2020 2020 2020 2020 706f 7369 7469            positi
+00019d30: 6f6e 2e61 7070 656e 6428 5b69 2c20 6a5d  on.append([i, j]
+00019d40: 290d 0a20 2020 2020 2020 2020 2020 2020  )..             
+00019d50: 2020 2020 2020 2020 2020 2076 616c 7565             value
+00019d60: 732e 6170 7065 6e64 2864 6174 615b 692c  s.append(data[i,
+00019d70: 206a 5d29 0d0a 2020 2020 2020 2020 2020   j])..          
+00019d80: 2020 2020 2020 2020 2020 2020 2020 636c                cl
+00019d90: 7573 7465 725b 692c 206a 5d20 3d20 636f  uster[i, j] = co
+00019da0: 756e 740d 0a20 2020 2020 2020 2020 2020  unt..           
+00019db0: 2020 2020 2020 2020 2063 6f75 6e74 203d           count =
+00019dc0: 2063 6f75 6e74 202b 2031 0d0a 0d0a 2020   count + 1....  
+00019dd0: 2020 2020 2020 7265 7475 726e 2063 6c75        return clu
+00019de0: 7374 6572 2c20 636f 756e 742c 2070 6f73  ster, count, pos
+00019df0: 6974 696f 6e2c 2076 616c 7565 730d 0a0d  ition, values...
+00019e00: 0a20 2020 2064 6566 206c 6973 7441 7474  .    def listAtt
+00019e10: 7269 6275 7465 7328 7365 6c66 293a 0d0a  ributes(self):..
+00019e20: 2020 2020 2020 2020 2222 2250 7269 6e74          """Print
+00019e30: 2041 7474 7269 6275 7465 7320 4c69 7374   Attributes List
+00019e40: 2e22 2222 0d0a 0d0a 2020 2020 2020 2020  ."""....        
+00019e50: 7072 696e 7428 225c 6e22 290d 0a20 2020  print("\n")..   
+00019e60: 2020 2020 2070 7269 6e74 280d 0a20 2020       print(..   
+00019e70: 2020 2020 2020 2020 2066 2241 7474 7269           f"Attri
+00019e80: 6275 7465 7320 4c69 7374 206f 663a 207b  butes List of: {
+00019e90: 2072 6570 7228 7365 6c66 2e5f 5f64 6963   repr(self.__dic
+00019ea0: 745f 5f5b 276e 616d 6527 5d29 7d20 2d20  t__['name'])} - 
+00019eb0: 7b73 656c 662e 5f5f 636c 6173 735f 5f2e  {self.__class__.
+00019ec0: 5f5f 6e61 6d65 5f5f 7d20 2049 6e73 7461  __name__}  Insta
+00019ed0: 6e63 655c 6e22 0d0a 2020 2020 2020 2020  nce\n"..        
+00019ee0: 290d 0a20 2020 2020 2020 2073 656c 665f  )..        self_
+00019ef0: 6b65 7973 203d 206c 6973 7428 7365 6c66  keys = list(self
+00019f00: 2e5f 5f64 6963 745f 5f2e 6b65 7973 2829  .__dict__.keys()
+00019f10: 290d 0a20 2020 2020 2020 2073 656c 665f  )..        self_
+00019f20: 6b65 7973 2e73 6f72 7428 290d 0a20 2020  keys.sort()..   
+00019f30: 2020 2020 2066 6f72 206b 6579 2069 6e20       for key in 
+00019f40: 7365 6c66 5f6b 6579 733a 0d0a 2020 2020  self_keys:..    
+00019f50: 2020 2020 2020 2020 6966 206b 6579 2021          if key !
+00019f60: 3d20 226e 616d 6522 3a0d 0a20 2020 2020  = "name":..     
+00019f70: 2020 2020 2020 2020 2020 2070 7269 6e74             print
+00019f80: 2873 7472 286b 6579 2920 2b20 2220 3a20  (str(key) + " : 
+00019f90: 2220 2b20 7265 7072 2873 656c 662e 5f5f  " + repr(self.__
+00019fa0: 6469 6374 5f5f 5b6b 6579 5d29 290d 0a0d  dict__[key]))...
+00019fb0: 0a20 2020 2020 2020 2070 7269 6e74 2822  .        print("
+00019fc0: 5c6e 2229 0d0a 0d0a 0d0a 636c 6173 7320  \n")......class 
+00019fd0: 4461 7461 6375 6265 3a0d 0a20 2020 2022  Datacube:..    "
+00019fe0: 2222 4461 7461 4375 6265 2e22 2222 0d0a  ""DataCube."""..
+00019ff0: 0d0a 2020 2020 6669 6c65 733a 204c 6973  ..    files: Lis
+0001a000: 745b 7374 725d 0d0a 2020 2020 6461 7461  t[str]..    data
+0001a010: 3a20 6e70 2e6e 6461 7272 6179 0d0a 0d0a  : np.ndarray....
+0001a020: 2020 2020 2222 220d 0a20 2020 2066 696c      """..    fil
+0001a030: 6573 3a0d 0a20 2020 2020 2020 206c 6973  es:..        lis
+0001a040: 7420 6f66 2067 656f 7469 6666 2066 696c  t of geotiff fil
+0001a050: 6573 2720 6e61 6d65 730d 0a20 2020 2022  es' names..    "
+0001a060: 2222 0d0a 0d0a 2020 2020 6465 6620 5f5f  ""....    def __
+0001a070: 696e 6974 5f5f 280d 0a20 2020 2020 2020  init__(..       
+0001a080: 2073 656c 662c 0d0a 2020 2020 2020 2020   self,..        
+0001a090: 7372 633a 2044 6174 6173 6574 2c0d 0a20  src: Dataset,.. 
+0001a0a0: 2020 2020 2020 2074 696d 655f 6c65 6e67         time_leng
+0001a0b0: 7468 3a20 696e 742c 0d0a 2020 2020 2020  th: int,..      
+0001a0c0: 2020 6669 6c65 733a 204c 6973 745b 7374    files: List[st
+0001a0d0: 725d 203d 204e 6f6e 652c 0d0a 2020 2020  r] = None,..    
+0001a0e0: 293a 0d0a 2020 2020 2020 2020 7365 6c66  ):..        self
+0001a0f0: 2e5f 6261 7365 203d 2073 7263 0d0a 2020  ._base = src..  
+0001a100: 2020 2020 2020 7365 6c66 2e66 696c 6573        self.files
+0001a110: 203d 2066 696c 6573 0d0a 2020 2020 2020   = files..      
+0001a120: 2020 7365 6c66 2e5f 7469 6d65 5f6c 656e    self._time_len
+0001a130: 6774 6820 3d20 7469 6d65 5f6c 656e 6774  gth = time_lengt
+0001a140: 680d 0a0d 0a20 2020 2020 2020 2070 6173  h....        pas
+0001a150: 730d 0a0d 0a20 2020 2064 6566 205f 5f73  s....    def __s
+0001a160: 7472 5f5f 2873 656c 6629 3a0d 0a20 2020  tr__(self):..   
+0001a170: 2020 2020 206d 6573 7361 6765 203d 2066       message = f
+0001a180: 2222 220d 0a20 2020 2020 2020 2020 2020  """..           
+0001a190: 2046 696c 6573 3a20 7b6c 656e 2873 656c   Files: {len(sel
+0001a1a0: 662e 6669 6c65 7329 7d0d 0a20 2020 2020  f.files)}..     
+0001a1b0: 2020 2020 2020 2043 656c 6c20 7369 7a65         Cell size
+0001a1c0: 3a20 7b73 656c 662e 5f62 6173 652e 6365  : {self._base.ce
+0001a1d0: 6c6c 5f73 697a 657d 0d0a 2020 2020 2020  ll_size}..      
+0001a1e0: 2020 2020 2020 4550 5347 3a20 7b73 656c        EPSG: {sel
+0001a1f0: 662e 5f62 6173 652e 6570 7367 7d0d 0a20  f._base.epsg}.. 
+0001a200: 2020 2020 2020 2020 2020 2056 6172 6961             Varia
+0001a210: 626c 6573 3a20 7b73 656c 662e 5f62 6173  bles: {self._bas
+0001a220: 652e 7661 7269 6162 6c65 737d 0d0a 2020  e.variables}..  
+0001a230: 2020 2020 2020 2020 2020 4469 6d65 6e73            Dimens
+0001a240: 696f 6e3a 207b 7365 6c66 2e72 6f77 7320  ion: {self.rows 
+0001a250: 2a20 7365 6c66 2e63 6f6c 756d 6e73 7d0d  * self.columns}.
+0001a260: 0a20 2020 2020 2020 2020 2020 204d 6173  .            Mas
+0001a270: 6b3a 207b 7365 6c66 2e5f 6261 7365 2e6e  k: {self._base.n
+0001a280: 6f5f 6461 7461 5f76 616c 7565 5b30 5d7d  o_data_value[0]}
+0001a290: 0d0a 2020 2020 2020 2020 2222 220d 0a20  ..        """.. 
+0001a2a0: 2020 2020 2020 2072 6574 7572 6e20 6d65         return me
+0001a2b0: 7373 6167 650d 0a0d 0a20 2020 2040 7072  ssage....    @pr
+0001a2c0: 6f70 6572 7479 0d0a 2020 2020 6465 6620  operty..    def 
+0001a2d0: 6261 7365 2873 656c 6629 202d 3e20 4461  base(self) -> Da
+0001a2e0: 7461 7365 743a 0d0a 2020 2020 2020 2020  taset:..        
+0001a2f0: 2222 2262 6173 652e 0d0a 0d0a 2020 2020  """base.....    
+0001a300: 2020 2020 4261 7365 2044 6174 6173 6574      Base Dataset
+0001a310: 0d0a 2020 2020 2020 2020 2222 220d 0a20  ..        """.. 
+0001a320: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+0001a330: 6c66 2e5f 6261 7365 0d0a 0d0a 2020 2020  lf._base....    
+0001a340: 4070 726f 7065 7274 790d 0a20 2020 2064  @property..    d
+0001a350: 6566 2074 696d 655f 6c65 6e67 7468 2873  ef time_length(s
+0001a360: 656c 6629 202d 3e20 696e 743a 0d0a 2020  elf) -> int:..  
+0001a370: 2020 2020 2020 2222 226c 656e 6774 6820        """length 
+0001a380: 6f66 2074 6865 2064 6174 6173 6574 2e22  of the dataset."
+0001a390: 2222 0d0a 2020 2020 2020 2020 7265 7475  ""..        retu
+0001a3a0: 726e 2073 656c 662e 5f74 696d 655f 6c65  rn self._time_le
+0001a3b0: 6e67 7468 0d0a 0d0a 2020 2020 4070 726f  ngth....    @pro
+0001a3c0: 7065 7274 790d 0a20 2020 2064 6566 2072  perty..    def r
+0001a3d0: 6f77 7328 7365 6c66 293a 0d0a 2020 2020  ows(self):..    
+0001a3e0: 2020 2020 2222 224e 756d 6265 7220 6f66      """Number of
+0001a3f0: 2072 6f77 7322 2222 0d0a 2020 2020 2020   rows"""..      
+0001a400: 2020 7265 7475 726e 2073 656c 662e 5f62    return self._b
+0001a410: 6173 652e 726f 7773 0d0a 0d0a 2020 2020  ase.rows....    
+0001a420: 4070 726f 7065 7274 790d 0a20 2020 2064  @property..    d
+0001a430: 6566 2073 6861 7065 2873 656c 6629 3a0d  ef shape(self):.
+0001a440: 0a20 2020 2020 2020 2022 2222 4e75 6d62  .        """Numb
+0001a450: 6572 206f 6620 726f 7773 2222 220d 0a20  er of rows""".. 
+0001a460: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+0001a470: 6c66 2e74 696d 655f 6c65 6e67 7468 2c20  lf.time_length, 
+0001a480: 7365 6c66 2e72 6f77 732c 2073 656c 662e  self.rows, self.
+0001a490: 636f 6c75 6d6e 730d 0a0d 0a20 2020 2040  columns....    @
+0001a4a0: 7072 6f70 6572 7479 0d0a 2020 2020 6465  property..    de
+0001a4b0: 6620 636f 6c75 6d6e 7328 7365 6c66 293a  f columns(self):
+0001a4c0: 0d0a 2020 2020 2020 2020 2222 224e 756d  ..        """Num
+0001a4d0: 6265 7220 6f66 2063 6f6c 756d 6e73 2222  ber of columns""
+0001a4e0: 220d 0a20 2020 2020 2020 2072 6574 7572  "..        retur
+0001a4f0: 6e20 7365 6c66 2e5f 6261 7365 2e63 6f6c  n self._base.col
+0001a500: 756d 6e73 0d0a 0d0a 2020 2020 4063 6c61  umns....    @cla
+0001a510: 7373 6d65 7468 6f64 0d0a 2020 2020 6465  ssmethod..    de
+0001a520: 6620 6372 6561 7465 5f63 7562 6528 636c  f create_cube(cl
+0001a530: 732c 2073 7263 3a20 4461 7461 7365 742c  s, src: Dataset,
+0001a540: 2064 6174 6173 6574 5f6c 656e 6774 683a   dataset_length:
+0001a550: 2069 6e74 293a 0d0a 2020 2020 2020 2020   int):..        
+0001a560: 2222 2243 7265 6174 6520 4461 7461 6375  """Create Datacu
+0001a570: 6265 2e0d 0a0d 0a20 2020 2020 2020 2020  be.....         
+0001a580: 2020 202d 2043 7265 6174 6520 4461 7461     - Create Data
+0001a590: 6375 6265 2066 726f 6d20 6120 7361 6d70  cube from a samp
+0001a5a0: 6c65 2072 6173 7465 7220 616e 640d 0a0d  le raster and...
+0001a5b0: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
+0001a5c0: 6572 730d 0a20 2020 2020 2020 202d 2d2d  ers..        ---
+0001a5d0: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
+0001a5e0: 2073 7263 3a20 5b44 6174 6173 6574 5d0d   src: [Dataset].
+0001a5f0: 0a20 2020 2020 2020 2020 2020 2052 4173  .            RAs
+0001a600: 7465 7220 4f62 6a65 6374 0d0a 2020 2020  ter Object..    
+0001a610: 2020 2020 6461 7461 7365 745f 6c65 6e67      dataset_leng
+0001a620: 7468 3a20 5b69 6e74 5d0d 0a20 2020 2020  th: [int]..     
+0001a630: 2020 2020 2020 206c 656e 6774 6820 6f66         length of
+0001a640: 2074 6865 2064 6174 6173 6574 2e0d 0a0d   the dataset....
+0001a650: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
+0001a660: 0d0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ..        ------
+0001a670: 2d0d 0a20 2020 2020 2020 2044 6174 6163  -..        Datac
+0001a680: 7562 6520 6f62 6a65 6374 2e0d 0a20 2020  ube object...   
+0001a690: 2020 2020 2022 2222 0d0a 2020 2020 2020       """..      
+0001a6a0: 2020 7265 7475 726e 2063 6c73 2873 7263    return cls(src
+0001a6b0: 2c20 6461 7461 7365 745f 6c65 6e67 7468  , dataset_length
+0001a6c0: 290d 0a0d 0a20 2020 2064 6566 2075 7064  )....    def upd
+0001a6d0: 6174 655f 6375 6265 2873 656c 662c 2061  ate_cube(self, a
+0001a6e0: 7272 6179 3a20 6e70 2e6e 6461 7272 6179  rray: np.ndarray
+0001a6f0: 293a 0d0a 2020 2020 2020 2020 2222 2255  ):..        """U
+0001a700: 7064 6174 6520 6461 7461 7365 7420 6461  pdate dataset da
+0001a710: 7461 2e0d 0a0d 0a20 2020 2020 2020 2020  ta.....         
+0001a720: 2020 202d 2054 6869 7320 6675 6e63 7469     - This functi
+0001a730: 6f6e 2063 7265 6174 6573 2061 2047 656f  on creates a Geo
+0001a740: 7469 6666 2072 6173 7465 7220 6c69 6b65  tiff raster like
+0001a750: 2061 6e6f 7468 6572 2069 6e70 7574 2072   another input r
+0001a760: 6173 7465 722c 206e 6577 2072 6173 7465  aster, new raste
+0001a770: 7220 7769 6c6c 2068 6176 6520 7468 6520  r will have the 
+0001a780: 7361 6d65 0d0a 2020 2020 2020 2020 2020  same..          
+0001a790: 2020 7072 6f6a 6563 7469 6f6e 2c20 636f    projection, co
+0001a7a0: 6f72 6469 6e61 7465 7320 6f72 2074 6865  ordinates or the
+0001a7b0: 2074 6f70 206c 6566 7420 636f 726e 6572   top left corner
+0001a7c0: 206f 6620 7468 6520 6f72 6967 696e 616c   of the original
+0001a7d0: 2072 6173 7465 722c 2063 656c 6c20 7369   raster, cell si
+0001a7e0: 7a65 2c20 6e6f 6461 7461 2076 656c 7565  ze, nodata velue
+0001a7f0: 2c20 616e 6420 6e75 6d62 6572 0d0a 2020  , and number..  
+0001a800: 2020 2020 2020 2020 2020 6f66 2072 6f77            of row
+0001a810: 7320 616e 6420 636f 6c75 6d6e 730d 0a20  s and columns.. 
+0001a820: 2020 2020 2020 2020 2020 202d 2074 6865             - the
+0001a830: 2072 6173 7465 7220 616e 6420 7468 6520   raster and the 
+0001a840: 6769 7665 6e20 6172 7261 7920 7368 6f75  given array shou
+0001a850: 6c64 2068 6176 6520 7468 6520 7361 6d65  ld have the same
+0001a860: 206e 756d 6265 7220 6f66 2063 6f6c 756d   number of colum
+0001a870: 6e73 2061 6e64 2072 6f77 732e 0d0a 0d0a  ns and rows.....
+0001a880: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
+0001a890: 7273 0d0a 2020 2020 2020 2020 2d2d 2d2d  rs..        ----
+0001a8a0: 2d2d 2d2d 2d2d 0d0a 2020 2020 2020 2020  ------..        
+0001a8b0: 6172 7261 793a 205b 6e75 6d70 7920 6172  array: [numpy ar
+0001a8c0: 7261 795d 0d0a 2020 2020 2020 2020 2020  ray]..          
+0001a8d0: 2020 3344 2061 7272 6179 2074 6f20 6265    3D array to be
+0001a8e0: 2073 746f 7265 7320 6173 2061 2072 6173   stores as a ras
+0001a8f0: 7465 7273 2c20 7468 6520 6469 6d65 6e73  ters, the dimens
+0001a900: 696f 6e73 2073 686f 756c 6420 6265 0d0a  ions should be..
+0001a910: 2020 2020 2020 2020 2020 2020 5b72 6f77              [row
+0001a920: 732c 2063 6f6c 756d 6e73 2c20 7469 6d65  s, columns, time
+0001a930: 7365 7269 6573 206c 656e 6774 685d 0d0a  series length]..
+0001a940: 0d0a 2020 2020 2020 2020 5265 7475 726e  ..        Return
+0001a950: 730d 0a20 2020 2020 2020 202d 2d2d 2d2d  s..        -----
+0001a960: 2d2d 0d0a 2020 2020 2020 2020 7361 7665  --..        save
+0001a970: 2074 6865 206e 6577 2072 6173 7465 7220   the new raster 
+0001a980: 746f 2074 6865 2067 6976 656e 2070 6174  to the given pat
+0001a990: 680d 0a0d 0a20 2020 2020 2020 2045 7861  h....        Exa
+0001a9a0: 6d70 6c65 730d 0a20 2020 2020 2020 202d  mples..        -
+0001a9b0: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
+0001a9c0: 203e 3e3e 2073 7263 5f72 6173 7465 7220   >>> src_raster 
+0001a9d0: 3d20 6764 616c 2e4f 7065 6e28 2244 454d  = gdal.Open("DEM
+0001a9e0: 2e74 6966 2229 0d0a 2020 2020 2020 2020  .tif")..        
+0001a9f0: 3e3e 3e20 6e61 6d65 203d 205b 2251 5f32  >>> name = ["Q_2
+0001aa00: 3031 325f 3031 5f30 315f 3031 2e74 6966  012_01_01_01.tif
+0001aa10: 222c 2251 5f32 3031 325f 3031 5f30 315f  ","Q_2012_01_01_
+0001aa20: 3032 2e74 6966 222c 2251 5f32 3031 325f  02.tif","Q_2012_
+0001aa30: 3031 5f30 315f 3033 2e74 6966 222c 2251  01_01_03.tif","Q
+0001aa40: 5f32 3031 325f 3031 5f30 315f 3034 2e74  _2012_01_01_04.t
+0001aa50: 6966 225d 0d0a 2020 2020 2020 2020 3e3e  if"]..        >>
+0001aa60: 3e20 4461 7461 6375 6265 2e72 6173 7465  > Datacube.raste
+0001aa70: 7273 4c69 6b65 2873 7263 5f72 6173 7465  rsLike(src_raste
+0001aa80: 722c 2064 6174 612c 206e 616d 6529 0d0a  r, data, name)..
+0001aa90: 2020 2020 2020 2020 2222 220d 0a20 2020          """..   
+0001aaa0: 2020 2020 2073 656c 662e 6461 7461 203d       self.data =
+0001aab0: 2061 7272 6179 0d0a 0d0a 2020 2020 4063   array....    @c
+0001aac0: 6c61 7373 6d65 7468 6f64 0d0a 2020 2020  lassmethod..    
+0001aad0: 6465 6620 7265 6164 5f73 6570 6172 6174  def read_separat
+0001aae0: 655f 6669 6c65 7328 0d0a 2020 2020 2020  e_files(..      
+0001aaf0: 2020 636c 732c 0d0a 2020 2020 2020 2020    cls,..        
+0001ab00: 7061 7468 3a20 556e 696f 6e5b 7374 722c  path: Union[str,
+0001ab10: 204c 6973 745b 7374 725d 5d2c 0d0a 2020   List[str]],..  
+0001ab20: 2020 2020 2020 7769 7468 5f6f 7264 6572        with_order
+0001ab30: 3a20 626f 6f6c 203d 2046 616c 7365 2c0d  : bool = False,.
+0001ab40: 0a20 2020 2020 2020 2073 7461 7274 3a20  .        start: 
+0001ab50: 7374 7220 3d20 4e6f 6e65 2c0d 0a20 2020  str = None,..   
+0001ab60: 2020 2020 2065 6e64 3a20 7374 7220 3d20       end: str = 
+0001ab70: 4e6f 6e65 2c0d 0a20 2020 2020 2020 2066  None,..        f
+0001ab80: 6d74 3a20 7374 7220 3d20 2225 592d 256d  mt: str = "%Y-%m
+0001ab90: 2d25 6422 2c0d 0a20 2020 2020 2020 2066  -%d",..        f
+0001aba0: 7265 713a 2073 7472 203d 2022 6461 696c  req: str = "dail
+0001abb0: 7922 2c0d 0a20 2020 2020 2020 2073 6570  y",..        sep
+0001abc0: 6172 6174 6f72 3a20 7374 7220 3d20 225f  arator: str = "_
+0001abd0: 222c 0d0a 2020 2020 2020 2020 6578 7465  ",..        exte
+0001abe0: 6e73 696f 6e3a 2073 7472 203d 2022 2e74  nsion: str = ".t
+0001abf0: 6966 222c 0d0a 2020 2020 293a 0d0a 2020  if",..    ):..  
+0001ac00: 2020 2020 2020 2222 2272 6561 645f 7365        """read_se
+0001ac10: 7061 7261 7465 5f66 696c 6573 2e0d 0a0d  parate_files....
+0001ac20: 0a20 2020 2020 2020 2020 2020 202d 2072  .            - r
+0001ac30: 6561 6473 2072 6173 7465 7273 2066 726f  eads rasters fro
+0001ac40: 6d20 6120 666f 6c64 6572 2061 6e64 2063  m a folder and c
+0001ac50: 7265 6174 6573 2061 2033 6420 6172 7261  reates a 3d arra
+0001ac60: 7920 7769 7468 2074 6865 2073 616d 6520  y with the same 
+0001ac70: 3264 2064 696d 656e 7369 6f6e 7320 6f66  2d dimensions of
+0001ac80: 2074 6865 2066 6972 7374 2072 6173 7465   the first raste
+0001ac90: 7220 696e 0d0a 2020 2020 2020 2020 2020  r in..          
+0001aca0: 2020 7468 6520 666f 6c64 6572 2061 6e64    the folder and
+0001acb0: 206c 656e 2061 7320 7468 6520 6e75 6d62   len as the numb
+0001acc0: 6572 206f 6620 6669 6c65 730d 0a0d 0a20  er of files.... 
+0001acd0: 2020 2020 2020 2069 6e73 6964 6520 7468         inside th
+0001ace0: 6520 666f 6c64 6572 2e0d 0a20 2020 2020  e folder...     
+0001acf0: 2020 2020 2020 202d 2041 6c6c 2072 6173         - All ras
+0001ad00: 7465 7273 2073 686f 756c 6420 6861 7665  ters should have
+0001ad10: 2074 6865 2073 616d 6520 6469 6d65 6e73   the same dimens
+0001ad20: 696f 6e73 0d0a 2020 2020 2020 2020 2020  ions..          
+0001ad30: 2020 2d20 466f 6c64 6572 2073 686f 756c    - Folder shoul
+0001ad40: 6420 6f6e 6c79 2063 6f6e 7461 696e 2072  d only contain r
+0001ad50: 6173 7465 7220 6669 6c65 730d 0a20 2020  aster files..   
+0001ad60: 2020 2020 2020 2020 202d 2072 6173 7465           - raste
+0001ad70: 7220 6669 6c65 206e 616d 6520 7368 6f75  r file name shou
+0001ad80: 6c64 2068 6176 6520 7468 6520 6461 7465  ld have the date
+0001ad90: 2061 7420 7468 6520 656e 6420 6f66 2074   at the end of t
+0001ada0: 6865 2066 696c 6520 6e61 6d65 2062 6566  he file name bef
+0001adb0: 6f72 6520 7468 6520 6578 7465 6e73 696f  ore the extensio
+0001adc0: 6e20 6469 7265 6374 6c79 0d0a 2020 2020  n directly..    
+0001add0: 2020 2020 2020 2020 2020 7769 7468 2074            with t
+0001ade0: 6865 2059 5959 592e 4d4d 2e44 4420 2f20  he YYYY.MM.DD / 
+0001adf0: 5959 5959 2d4d 4d2d 4444 206f 7220 5959  YYYY-MM-DD or YY
+0001ae00: 5959 5f4d 4d5f 4444 0d0a 2020 2020 2020  YY_MM_DD..      
+0001ae10: 2020 2020 2020 2020 3e3e 3e20 2235 305f          >>> "50_
+0001ae20: 4d53 5745 505f 3139 3739 2e30 312e 3031  MSWEP_1979.01.01
+0001ae30: 2e74 6966 220d 0a0d 0a20 2020 2020 2020  .tif"....       
+0001ae40: 2050 6172 616d 6574 6572 730d 0a20 2020   Parameters..   
+0001ae50: 2020 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d       ----------.
+0001ae60: 0a20 2020 2020 2020 2070 6174 683a 5b53  .        path:[S
+0001ae70: 7472 696e 672f 6c69 7374 5d0d 0a20 2020  tring/list]..   
+0001ae80: 2020 2020 2020 2020 2070 6174 6820 6f66           path of
+0001ae90: 2074 6865 2066 6f6c 6465 7220 7468 6174   the folder that
+0001aea0: 2063 6f6e 7461 696e 7320 616c 6c20 7468   contains all th
+0001aeb0: 6520 7261 7374 6572 7320 6f72 0d0a 2020  e rasters or..  
+0001aec0: 2020 2020 2020 2020 2020 6120 6c69 7374            a list
+0001aed0: 2063 6f6e 7461 696e 7320 7468 6520 7061   contains the pa
+0001aee0: 7468 7320 6f66 2074 6865 2072 6173 7465  ths of the raste
+0001aef0: 7273 2074 6f20 7265 6164 2e0d 0a20 2020  rs to read...   
+0001af00: 2020 2020 2077 6974 685f 6f72 6465 723a       with_order:
+0001af10: 205b 626f 6f6c 5d0d 0a20 2020 2020 2020   [bool]..       
+0001af20: 2020 2020 2054 7275 6520 6966 2074 6865       True if the
+0001af30: 2072 6173 7465 7273 2066 6f6c 6c6f 7773   rasters follows
+0001af40: 2061 2063 6572 7461 696e 206f 7264 6572   a certain order
+0001af50: 2c20 7468 656e 2074 6865 2072 6173 7465  , then the raste
+0001af60: 7273 206e 616d 6573 2073 686f 756c 6420  rs names should 
+0001af70: 6861 7665 2061 0d0a 2020 2020 2020 2020  have a..        
+0001af80: 2020 2020 6e75 6d62 6572 2061 7420 7468      number at th
+0001af90: 6520 6265 6769 6e6e 696e 6720 6f66 2074  e beginning of t
+0001afa0: 6865 2066 696c 6520 6e61 6d65 2069 6e64  he file name ind
+0001afb0: 6963 6174 696e 6720 7468 6520 6f72 6465  icating the orde
+0001afc0: 722e 0d0a 2020 2020 2020 2020 2020 2020  r...            
+0001afd0: 3e3e 3e20 2230 315f 4d53 5745 505f 3139  >>> "01_MSWEP_19
+0001afe0: 3739 2e30 312e 3031 2e74 6966 220d 0a20  79.01.01.tif".. 
+0001aff0: 2020 2020 2020 2020 2020 203e 3e3e 2022             >>> "
+0001b000: 3032 5f4d 5357 4550 5f31 3937 392e 3031  02_MSWEP_1979.01
+0001b010: 2e30 322e 7469 6622 0d0a 2020 2020 2020  .02.tif"..      
+0001b020: 2020 2020 2020 3e3e 3e20 2e2e 2e0d 0a20        >>> ..... 
+0001b030: 2020 2020 2020 2020 2020 203e 3e3e 2022             >>> "
+0001b040: 3230 5f4d 5357 4550 5f31 3937 392e 3031  20_MSWEP_1979.01
+0001b050: 2e32 302e 7469 6622 0d0a 2020 2020 2020  .20.tif"..      
+0001b060: 2020 2020 2020 2d20 6375 7272 656e 746c        - currentl
+0001b070: 7920 7468 6520 6675 6e63 7469 6f6e 2064  y the function d
+0001b080: 6570 656e 6473 206d 6169 6e6c 7920 6f6e  epends mainly on
+0001b090: 2074 6865 2073 6570 6172 6174 6f72 2022   the separator "
+0001b0a0: 5f22 2074 6861 7420 7365 7061 7261 7465  _" that separate
+0001b0b0: 2074 6865 206f 7264 6572 206e 756d 6265   the order numbe
+0001b0c0: 7220 6672 6f6d 2074 6865 2072 6573 7420  r from the rest 
+0001b0d0: 6f66 0d0a 2020 2020 2020 2020 2020 2020  of..            
+0001b0e0: 6669 6c65 206e 616d 652e 0d0a 2020 2020  file name...    
+0001b0f0: 2020 2020 2020 2020 2d20 7468 6520 7365          - the se
+0001b100: 7061 7261 746f 7220 6265 7477 6565 6e20  parator between 
+0001b110: 7468 6520 6461 7465 2070 6172 7473 2059  the date parts Y
+0001b120: 5959 592e 4d4d 2e44 4420 6972 2059 5959  YYY.MM.DD ir YYY
+0001b130: 595f 4d4d 5f44 4420 6f72 2061 6e79 206f  Y_MM_DD or any o
+0001b140: 7468 6572 2073 6570 6172 6174 6f72 2064  ther separator d
+0001b150: 6f65 7320 6e6f 7420 6d61 7474 6572 2c0d  oes not matter,.
+0001b160: 0a20 2020 2020 2020 2020 2020 2068 6f77  .            how
+0001b170: 6576 6572 2074 6865 2073 6570 6172 6174  ever the separat
+0001b180: 6f72 2068 6173 2074 6f20 6265 206f 6e6c  or has to be onl
+0001b190: 7920 6f6e 6520 6c65 7474 6572 2e0d 0a20  y one letter... 
+0001b1a0: 2020 2020 2020 2066 6d74 3a20 5b73 7472         fmt: [str
+0001b1b0: 5d0d 0a20 2020 2020 2020 2020 2020 2066  ]..            f
+0001b1c0: 6f72 6d61 7420 6f66 2074 6865 2067 6976  ormat of the giv
+0001b1d0: 656e 2064 6174 650d 0a20 2020 2020 2020  en date..       
+0001b1e0: 2073 7461 7274 3a20 5b73 7472 5d0d 0a20   start: [str].. 
+0001b1f0: 2020 2020 2020 2020 2020 2073 7461 7274             start
+0001b200: 2064 6174 6520 6966 2079 6f75 2077 616e   date if you wan
+0001b210: 7420 746f 2072 6561 6420 7468 6520 696e  t to read the in
+0001b220: 7075 7420 7261 7374 6572 2066 6f72 2061  put raster for a
+0001b230: 2073 7065 6369 6669 6320 7065 7269 6f64   specific period
+0001b240: 206f 6e6c 7920 616e 6420 6e6f 7420 616c   only and not al
+0001b250: 6c20 7261 7374 6572 732c 0d0a 2020 2020  l rasters,..    
+0001b260: 2020 2020 2020 2020 6966 206e 6f74 2067          if not g
+0001b270: 6976 656e 2061 6c6c 2072 6173 7465 7273  iven all rasters
+0001b280: 2069 6e20 7468 6520 6769 7665 6e20 7061   in the given pa
+0001b290: 7468 2077 696c 6c20 6265 2072 6561 642e  th will be read.
+0001b2a0: 0d0a 2020 2020 2020 2020 2020 2020 4869  ..            Hi
+0001b2b0: 6e74 3a0d 0a20 2020 2020 2020 2020 2020  nt:..           
+0001b2c0: 2020 2020 2054 6865 2064 6174 6520 696e       The date in
+0001b2d0: 2074 6865 2072 6173 7465 7220 6669 6c65   the raster file
+0001b2e0: 206e 616d 6520 7368 6f75 6c64 2062 6520   name should be 
+0001b2f0: 7468 6520 6c61 7374 2073 7472 696e 6720  the last string 
+0001b300: 6265 666f 7220 7468 6520 6669 6c65 2065  befor the file e
+0001b310: 7874 656e 7369 6f6e 0d0a 2020 2020 2020  xtension..      
+0001b320: 2020 2020 2020 2020 2020 3e3e 3e20 2232            >>> "2
+0001b330: 305f 4d53 5745 505f 5959 5959 2e4d 4d2e  0_MSWEP_YYYY.MM.
+0001b340: 4444 2e74 6966 220d 0a20 2020 2020 2020  DD.tif"..       
+0001b350: 2065 6e64 3a20 5b73 7472 5d0d 0a20 2020   end: [str]..   
+0001b360: 2020 2020 2020 2020 2065 6e64 2064 6174           end dat
+0001b370: 6520 6966 2079 6f75 2077 616e 7420 746f  e if you want to
+0001b380: 2072 6561 6420 7468 6520 696e 7075 7420   read the input 
+0001b390: 7465 6d70 6572 6174 7572 6520 666f 7220  temperature for 
+0001b3a0: 6120 7370 6563 6966 6963 2070 6572 696f  a specific perio
+0001b3b0: 6420 6f6e 6c79 2c0d 0a20 2020 2020 2020  d only,..       
+0001b3c0: 2020 2020 2069 6620 6e6f 7420 6769 7665       if not give
+0001b3d0: 6e20 616c 6c20 7261 7374 6572 7320 696e  n all rasters in
+0001b3e0: 2074 6865 2067 6976 656e 2070 6174 6820   the given path 
+0001b3f0: 7769 6c6c 2062 6520 7265 6164 2e0d 0a20  will be read... 
+0001b400: 2020 2020 2020 2020 2020 2048 696e 743a             Hint:
+0001b410: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0001b420: 2020 5468 6520 6461 7465 2069 6e20 7468    The date in th
+0001b430: 6520 7261 7374 6572 2066 696c 6520 6e61  e raster file na
+0001b440: 6d65 2073 686f 756c 6420 6265 2074 6865  me should be the
+0001b450: 206c 6173 7420 7374 7269 6e67 2062 6566   last string bef
+0001b460: 6f72 2074 6865 2066 696c 6520 6578 7465  or the file exte
+0001b470: 6e73 696f 6e0d 0a20 2020 2020 2020 2020  nsion..         
+0001b480: 2020 2020 2020 203e 3e3e 2022 3230 5f4d         >>> "20_M
+0001b490: 5357 4550 5f59 5959 592e 4d4d 2e44 442e  SWEP_YYYY.MM.DD.
+0001b4a0: 7469 6622 0d0a 2020 2020 2020 2020 6672  tif"..        fr
+0001b4b0: 6571 3a20 5b73 7472 5d0d 0a20 2020 2020  eq: [str]..     
+0001b4c0: 2020 2020 2020 2066 7265 7175 656e 6379         frequency
+0001b4d0: 206f 6620 7468 6520 7261 7374 6572 7320   of the rasters 
+0001b4e0: 2264 6169 6c79 222c 2048 6f75 726c 792c  "daily", Hourly,
+0001b4f0: 206d 6f6e 7468 6c79 0d0a 2020 2020 2020   monthly..      
+0001b500: 2020 7365 7061 7261 746f 723a 205b 7374    separator: [st
+0001b510: 725d 0d0a 2020 2020 2020 2020 2020 2020  r]..            
+0001b520: 7365 7061 7261 746f 7220 6265 7477 6565  separator betwee
+0001b530: 6e20 7468 6520 6f72 6465 7220 696e 2074  n the order in t
+0001b540: 6865 2062 6567 696e 6e69 6e67 206f 6620  he beginning of 
+0001b550: 7468 6520 7261 7374 6572 2066 696c 6520  the raster file 
+0001b560: 6e61 6d65 2061 6e64 2074 6865 2072 6573  name and the res
+0001b570: 7420 6f66 2074 6865 2066 696c 650d 0a20  t of the file.. 
+0001b580: 2020 2020 2020 2020 2020 206e 616d 652e             name.
+0001b590: 2044 6566 6175 6c74 2069 7320 225f 222e   Default is "_".
+0001b5a0: 0d0a 2020 2020 2020 2020 6578 7465 6e73  ..        extens
+0001b5b0: 696f 6e3a 205b 7374 725d 0d0a 2020 2020  ion: [str]..    
+0001b5c0: 2020 2020 2020 2020 7468 6520 6578 7465          the exte
+0001b5d0: 6e73 696f 6e20 6f66 2074 6865 2066 696c  nsion of the fil
+0001b5e0: 6573 2079 6f75 2077 616e 7420 746f 2072  es you want to r
+0001b5f0: 6561 6420 6672 6f6d 2074 6865 2067 6976  ead from the giv
+0001b600: 656e 2070 6174 682e 2044 6566 6175 6c74  en path. Default
+0001b610: 2069 7320 222e 7469 6622 2e0d 0a0d 0a20   is ".tif"..... 
+0001b620: 2020 2020 2020 2052 6574 7572 6e73 0d0a         Returns..
+0001b630: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d0d          -------.
+0001b640: 0a20 2020 2020 2020 2061 7272 5f33 643a  .        arr_3d:
+0001b650: 205b 6e75 6d70 792e 6e64 6172 7261 795d   [numpy.ndarray]
+0001b660: 0d0a 2020 2020 2020 2020 2020 2020 3364  ..            3d
+0001b670: 2061 7272 6179 2063 6f6e 7461 696e 7320   array contains 
+0001b680: 6172 7261 7973 2072 6561 6420 6672 6f6d  arrays read from
+0001b690: 2061 6c6c 2072 6173 7465 7273 2069 6e20   all rasters in 
+0001b6a0: 7468 6520 666f 6c64 6572 2e0d 0a0d 0a20  the folder..... 
+0001b6b0: 2020 2020 2020 2045 7861 6d70 6c65 0d0a         Example..
+0001b6c0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d0d          -------.
+0001b6d0: 0a20 2020 2020 2020 203e 3e3e 2066 726f  .        >>> fro
+0001b6e0: 6d20 7079 7261 6d69 6473 2e64 6174 6173  m pyramids.datas
+0001b6f0: 6574 2069 6d70 6f72 7420 4461 7461 6375  et import Datacu
+0001b700: 6265 0d0a 2020 2020 2020 2020 3e3e 3e20  be..        >>> 
+0001b710: 7261 7374 6572 5f66 6f6c 6465 7220 3d20  raster_folder = 
+0001b720: 2265 7861 6d70 6c65 732f 4749 532f 6461  "examples/GIS/da
+0001b730: 7461 2f72 6173 7465 722d 666f 6c64 6572  ta/raster-folder
+0001b740: 220d 0a20 2020 2020 2020 203e 3e3e 2070  "..        >>> p
+0001b750: 7265 6320 3d20 4461 7461 6375 6265 2e72  rec = Datacube.r
+0001b760: 6561 645f 7365 7061 7261 7465 5f66 696c  ead_separate_fil
+0001b770: 6573 2872 6173 7465 725f 666f 6c64 6572  es(raster_folder
+0001b780: 290d 0a0d 0a20 2020 2020 2020 203e 3e3e  )....        >>>
+0001b790: 2069 6d70 6f72 7420 676c 6f62 0d0a 2020   import glob..  
+0001b7a0: 2020 2020 2020 3e3e 3e20 7365 6172 6368        >>> search
+0001b7b0: 5f63 7269 7465 7269 6120 3d20 222a 2e74  _criteria = "*.t
+0001b7c0: 6966 220d 0a20 2020 2020 2020 203e 3e3e  if"..        >>>
+0001b7d0: 2066 696c 655f 6c69 7374 203d 2067 6c6f   file_list = glo
+0001b7e0: 622e 676c 6f62 286f 732e 7061 7468 2e6a  b.glob(os.path.j
+0001b7f0: 6f69 6e28 7261 7374 6572 5f66 6f6c 6465  oin(raster_folde
+0001b800: 722c 2073 6561 7263 685f 6372 6974 6572  r, search_criter
+0001b810: 6961 2929 0d0a 2020 2020 2020 2020 3e3e  ia))..        >>
+0001b820: 3e20 7072 6563 203d 2044 6174 6163 7562  > prec = Datacub
+0001b830: 652e 7265 6164 5f73 6570 6172 6174 655f  e.read_separate_
+0001b840: 6669 6c65 7328 6669 6c65 5f6c 6973 742c  files(file_list,
+0001b850: 2077 6974 685f 6f72 6465 723d 4661 6c73   with_order=Fals
+0001b860: 6529 0d0a 2020 2020 2020 2020 2222 220d  e)..        """.
+0001b870: 0a20 2020 2020 2020 2069 6620 6e6f 7420  .        if not 
+0001b880: 6973 696e 7374 616e 6365 2870 6174 682c  isinstance(path,
+0001b890: 2073 7472 2920 616e 6420 6e6f 7420 6973   str) and not is
+0001b8a0: 696e 7374 616e 6365 2870 6174 682c 206c  instance(path, l
+0001b8b0: 6973 7429 3a0d 0a20 2020 2020 2020 2020  ist):..         
+0001b8c0: 2020 2072 6169 7365 2054 7970 6545 7272     raise TypeErr
+0001b8d0: 6f72 2866 2270 6174 6820 696e 7075 7420  or(f"path input 
+0001b8e0: 7368 6f75 6c64 2062 6520 7374 7269 6e67  should be string
+0001b8f0: 2f6c 6973 7420 7479 7065 2c20 6769 7665  /list type, give
+0001b900: 6e7b 7479 7065 2870 6174 6829 7d22 290d  n{type(path)}").
+0001b910: 0a0d 0a20 2020 2020 2020 2069 6620 6973  ...        if is
+0001b920: 696e 7374 616e 6365 2870 6174 682c 2073  instance(path, s
+0001b930: 7472 293a 0d0a 2020 2020 2020 2020 2020  tr):..          
+0001b940: 2020 2320 6368 6563 6b20 7765 7468 6572    # check wether
+0001b950: 2074 6865 2070 6174 6820 6578 6973 7420   the path exist 
+0001b960: 6f72 206e 6f74 0d0a 2020 2020 2020 2020  or not..        
+0001b970: 2020 2020 6966 206e 6f74 206f 732e 7061      if not os.pa
+0001b980: 7468 2e65 7869 7374 7328 7061 7468 293a  th.exists(path):
+0001b990: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0001b9a0: 2020 7261 6973 6520 4669 6c65 4e6f 7446    raise FileNotF
+0001b9b0: 6f75 6e64 4572 726f 7228 2254 6865 2070  oundError("The p
+0001b9c0: 6174 6820 796f 7520 6861 7665 2070 726f  ath you have pro
+0001b9d0: 7669 6465 6420 646f 6573 206e 6f74 2065  vided does not e
+0001b9e0: 7869 7374 2229 0d0a 2020 2020 2020 2020  xist")..        
+0001b9f0: 2020 2020 2320 6765 7420 6c69 7374 206f      # get list o
+0001ba00: 6620 616c 6c20 6669 6c65 730d 0a20 2020  f all files..   
+0001ba10: 2020 2020 2020 2020 2066 696c 6573 203d           files =
+0001ba20: 206f 732e 6c69 7374 6469 7228 7061 7468   os.listdir(path
+0001ba30: 290d 0a20 2020 2020 2020 2020 2020 2066  )..            f
+0001ba40: 696c 6573 203d 205b 6920 666f 7220 6920  iles = [i for i 
+0001ba50: 696e 2066 696c 6573 2069 6620 692e 656e  in files if i.en
+0001ba60: 6473 7769 7468 2865 7874 656e 7369 6f6e  dswith(extension
+0001ba70: 295d 0d0a 2020 2020 2020 2020 2020 2020  )]..            
+0001ba80: 2320 6669 6c65 7320 3d20 676c 6f62 2e67  # files = glob.g
+0001ba90: 6c6f 6228 6f73 2e70 6174 682e 6a6f 696e  lob(os.path.join
+0001baa0: 2870 6174 682c 2022 2a2e 7469 6622 2929  (path, "*.tif"))
+0001bab0: 0d0a 2020 2020 2020 2020 2020 2020 2320  ..            # 
+0001bac0: 6368 6563 6b20 7768 6574 6865 7220 7468  check whether th
+0001bad0: 6572 6520 6172 6520 6669 6c65 7320 6f72  ere are files or
+0001bae0: 206e 6f74 2069 6e73 6964 6520 7468 6520   not inside the 
+0001baf0: 666f 6c64 6572 0d0a 2020 2020 2020 2020  folder..        
+0001bb00: 2020 2020 6966 206c 656e 2866 696c 6573      if len(files
+0001bb10: 2920 3c20 313a 0d0a 2020 2020 2020 2020  ) < 1:..        
+0001bb20: 2020 2020 2020 2020 7261 6973 6520 4669          raise Fi
+0001bb30: 6c65 4e6f 7446 6f75 6e64 4572 726f 7228  leNotFoundError(
+0001bb40: 2254 6865 2070 6174 6820 796f 7520 6861  "The path you ha
+0001bb50: 7665 2070 726f 7669 6465 6420 6973 2065  ve provided is e
+0001bb60: 6d70 7479 2229 0d0a 2020 2020 2020 2020  mpty")..        
+0001bb70: 656c 7365 3a0d 0a20 2020 2020 2020 2020  else:..         
+0001bb80: 2020 2066 696c 6573 203d 2070 6174 685b     files = path[
+0001bb90: 3a5d 0d0a 2020 2020 2020 2020 2320 746f  :]..        # to
+0001bba0: 2073 6f72 7420 7468 6520 6669 6c65 7320   sort the files 
+0001bbb0: 696e 2074 6865 2073 616d 6520 6f72 6465  in the same orde
+0001bbc0: 7220 6173 2074 6865 2066 6972 7374 206e  r as the first n
+0001bbd0: 756d 6265 7220 696e 2074 6865 206e 616d  umber in the nam
+0001bbe0: 650d 0a20 2020 2020 2020 2069 6620 7769  e..        if wi
+0001bbf0: 7468 5f6f 7264 6572 3a0d 0a20 2020 2020  th_order:..     
+0001bc00: 2020 2020 2020 2074 7279 3a0d 0a20 2020         try:..   
+0001bc10: 2020 2020 2020 2020 2020 2020 2066 696c               fil
+0001bc20: 6573 4e6f 203d 205b 696e 7428 692e 7370  esNo = [int(i.sp
+0001bc30: 6c69 7428 7365 7061 7261 746f 7229 5b30  lit(separator)[0
+0001bc40: 5d29 2066 6f72 2069 2069 6e20 6669 6c65  ]) for i in file
+0001bc50: 735d 0d0a 2020 2020 2020 2020 2020 2020  s]..            
+0001bc60: 6578 6365 7074 2056 616c 7565 4572 726f  except ValueErro
+0001bc70: 723a 0d0a 2020 2020 2020 2020 2020 2020  r:..            
+0001bc80: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
+0001bc90: 7272 6f72 280d 0a20 2020 2020 2020 2020  rror(..         
+0001bca0: 2020 2020 2020 2020 2020 2022 706c 6561             "plea
+0001bcb0: 7365 2069 6e63 6c75 6465 2061 206e 756d  se include a num
+0001bcc0: 6265 7220 6174 2074 6865 2062 6567 696e  ber at the begin
+0001bcd0: 6e69 6e67 206f 6620 7468 6522 0d0a 2020  ning of the"..  
+0001bce0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001bcf0: 2020 2272 6173 7465 7273 206e 616d 6520    "rasters name 
+0001bd00: 746f 2069 6e64 6963 6174 6520 7468 6520  to indicate the 
+0001bd10: 6f72 6465 7220 6f66 2074 6865 2072 6173  order of the ras
+0001bd20: 7465 7273 2e20 746f 2064 6f20 736f 2070  ters. to do so p
+0001bd30: 6c65 6173 6522 0d0a 2020 2020 2020 2020  lease"..        
+0001bd40: 2020 2020 2020 2020 2020 2020 2275 7365              "use
+0001bd50: 2074 6865 2049 6e70 7574 732e 5265 6e61   the Inputs.Rena
+0001bd60: 6d65 4669 6c65 7320 6d65 7468 6f64 2074  meFiles method t
+0001bd70: 6f20 736f 6c76 6520 7468 6973 2069 7373  o solve this iss
+0001bd80: 7565 2061 6e64 2064 6f6e 2774 2022 0d0a  ue and don't "..
+0001bd90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001bda0: 2020 2020 2269 6e63 6c75 6465 2061 6e79      "include any
+0001bdb0: 206f 7468 6572 2066 696c 6573 2069 6e20   other files in 
+0001bdc0: 7468 6520 666f 6c64 6572 2077 6974 6820  the folder with 
+0001bdd0: 7468 6520 7261 7374 6572 7322 0d0a 2020  the rasters"..  
+0001bde0: 2020 2020 2020 2020 2020 2020 2020 290d                ).
+0001bdf0: 0a0d 0a20 2020 2020 2020 2020 2020 2066  ...            f
+0001be00: 696c 655f 7475 706c 6520 3d20 736f 7274  ile_tuple = sort
+0001be10: 6564 287a 6970 2866 696c 6573 4e6f 2c20  ed(zip(filesNo, 
+0001be20: 6669 6c65 7329 290d 0a20 2020 2020 2020  files))..       
+0001be30: 2020 2020 2066 696c 6573 203d 205b 7820       files = [x 
+0001be40: 666f 7220 5f2c 2078 2069 6e20 6669 6c65  for _, x in file
+0001be50: 5f74 7570 6c65 5d0d 0a0d 0a20 2020 2020  _tuple]....     
+0001be60: 2020 2069 6620 7374 6172 7420 6973 206e     if start is n
+0001be70: 6f74 204e 6f6e 6520 6f72 2065 6e64 2069  ot None or end i
+0001be80: 7320 6e6f 7420 4e6f 6e65 3a0d 0a20 2020  s not None:..   
+0001be90: 2020 2020 2020 2020 2073 7461 7274 203d           start =
+0001bea0: 2064 742e 6461 7465 7469 6d65 2e73 7472   dt.datetime.str
+0001beb0: 7074 696d 6528 7374 6172 742c 2066 6d74  ptime(start, fmt
+0001bec0: 290d 0a20 2020 2020 2020 2020 2020 2065  )..            e
+0001bed0: 6e64 203d 2064 742e 6461 7465 7469 6d65  nd = dt.datetime
+0001bee0: 2e73 7472 7074 696d 6528 656e 642c 2066  .strptime(end, f
+0001bef0: 6d74 290d 0a0d 0a20 2020 2020 2020 2020  mt)....         
+0001bf00: 2020 2023 2067 6574 2074 6865 2064 6174     # get the dat
+0001bf10: 6573 2066 6f72 2065 6163 6820 6669 6c65  es for each file
+0001bf20: 0d0a 2020 2020 2020 2020 2020 2020 6461  ..            da
+0001bf30: 7465 7320 3d20 6c69 7374 2829 0d0a 2020  tes = list()..  
+0001bf40: 2020 2020 2020 2020 2020 666f 7220 692c            for i,
+0001bf50: 2066 696c 655f 6920 696e 2065 6e75 6d65   file_i in enume
+0001bf60: 7261 7465 2866 696c 6573 293a 0d0a 2020  rate(files):..  
+0001bf70: 2020 2020 2020 2020 2020 2020 2020 6966                if
+0001bf80: 2066 7265 7120 3d3d 2022 6461 696c 7922   freq == "daily"
+0001bf90: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
+0001bfa0: 2020 2020 2020 206c 203d 206c 656e 2866         l = len(f
+0001bfb0: 696c 655f 6929 202d 2034 0d0a 2020 2020  ile_i) - 4..    
+0001bfc0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001bfd0: 6461 7920 3d20 696e 7428 6669 6c65 5f69  day = int(file_i
+0001bfe0: 5b6c 202d 2032 203a 206c 5d29 0d0a 2020  [l - 2 : l])..  
+0001bff0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c000: 2020 6d6f 6e74 6820 3d20 696e 7428 6669    month = int(fi
+0001c010: 6c65 5f69 5b6c 202d 2035 203a 206c 202d  le_i[l - 5 : l -
+0001c020: 2033 5d29 0d0a 2020 2020 2020 2020 2020   3])..          
+0001c030: 2020 2020 2020 2020 2020 7965 6172 203d            year =
+0001c040: 2069 6e74 2866 696c 655f 695b 6c20 2d20   int(file_i[l - 
+0001c050: 3130 203a 206c 202d 2036 5d29 0d0a 2020  10 : l - 6])..  
+0001c060: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c070: 2020 6461 7465 732e 6170 7065 6e64 2864    dates.append(d
+0001c080: 742e 6461 7465 7469 6d65 2879 6561 722c  t.datetime(year,
+0001c090: 206d 6f6e 7468 2c20 6461 7929 290d 0a20   month, day)).. 
+0001c0a0: 2020 2020 2020 2020 2020 2020 2020 2065                 e
+0001c0b0: 6c69 6620 6672 6571 203d 3d20 2268 6f75  lif freq == "hou
+0001c0c0: 726c 7922 3a0d 0a20 2020 2020 2020 2020  rly":..         
+0001c0d0: 2020 2020 2020 2020 2020 2079 6561 7220             year 
+0001c0e0: 3d20 696e 7428 6669 6c65 5f69 2e73 706c  = int(file_i.spl
+0001c0f0: 6974 2822 5f22 295b 2d34 5d29 0d0a 2020  it("_")[-4])..  
+0001c100: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c110: 2020 6d6f 6e74 6820 3d20 696e 7428 6669    month = int(fi
+0001c120: 6c65 5f69 2e73 706c 6974 2822 5f22 295b  le_i.split("_")[
+0001c130: 2d33 5d29 0d0a 2020 2020 2020 2020 2020  -3])..          
+0001c140: 2020 2020 2020 2020 2020 6461 7920 3d20            day = 
+0001c150: 696e 7428 6669 6c65 5f69 2e73 706c 6974  int(file_i.split
+0001c160: 2822 5f22 295b 2d32 5d29 0d0a 2020 2020  ("_")[-2])..    
+0001c170: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c180: 686f 7572 203d 2069 6e74 2866 696c 655f  hour = int(file_
+0001c190: 692e 7370 6c69 7428 225f 2229 5b2d 315d  i.split("_")[-1]
+0001c1a0: 2e73 706c 6974 2822 2e22 295b 305d 290d  .split(".")[0]).
+0001c1b0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001c1c0: 2020 2020 2064 6174 6573 2e61 7070 656e       dates.appen
+0001c1d0: 6428 6474 2e64 6174 6574 696d 6528 7965  d(dt.datetime(ye
+0001c1e0: 6172 2c20 6d6f 6e74 682c 2064 6179 2c20  ar, month, day, 
+0001c1f0: 686f 7572 2929 0d0a 0d0a 2020 2020 2020  hour))....      
+0001c200: 2020 2020 2020 7374 6172 7469 203d 2064        starti = d
+0001c210: 6174 6573 2e69 6e64 6578 2873 7461 7274  ates.index(start
+0001c220: 290d 0a20 2020 2020 2020 2020 2020 2065  )..            e
+0001c230: 6e64 6920 3d20 6461 7465 732e 696e 6465  ndi = dates.inde
+0001c240: 7828 656e 6429 202b 2031 0d0a 2020 2020  x(end) + 1..    
+0001c250: 2020 2020 2020 2020 6173 7365 7274 2061          assert a
+0001c260: 6c6c 280d 0a20 2020 2020 2020 2020 2020  ll(..           
+0001c270: 2020 2020 2066 696c 655f 692e 656e 6473       file_i.ends
+0001c280: 7769 7468 2822 2e74 6966 2229 2066 6f72  with(".tif") for
+0001c290: 2066 696c 655f 6920 696e 2066 696c 6573   file_i in files
+0001c2a0: 5b73 7461 7274 693a 656e 6469 5d0d 0a20  [starti:endi].. 
+0001c2b0: 2020 2020 2020 2020 2020 2029 2c20 2261             ), "a
+0001c2c0: 6c6c 2066 696c 6573 2069 6e20 7468 6520  ll files in the 
+0001c2d0: 6769 7665 6e20 666f 6c64 6572 2073 686f  given folder sho
+0001c2e0: 756c 6420 6861 7665 202e 7469 6620 6578  uld have .tif ex
+0001c2f0: 7465 6e73 696f 6e22 0d0a 2020 2020 2020  tension"..      
+0001c300: 2020 656c 7365 3a0d 0a20 2020 2020 2020    else:..       
+0001c310: 2020 2020 2073 7461 7274 6920 3d20 300d       starti = 0.
+0001c320: 0a20 2020 2020 2020 2020 2020 2065 6e64  .            end
+0001c330: 6920 3d20 6c65 6e28 6669 6c65 7329 0d0a  i = len(files)..
+0001c340: 2020 2020 2020 2020 2020 2020 2320 6368              # ch
+0001c350: 6563 6b20 7468 6174 2066 6f6c 6465 7220  eck that folder 
+0001c360: 6f6e 6c79 2063 6f6e 7461 696e 7320 7261  only contains ra
+0001c370: 7374 6572 730d 0a20 2020 2020 2020 2020  sters..         
+0001c380: 2020 2061 7373 6572 7420 616c 6c28 0d0a     assert all(..
+0001c390: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001c3a0: 6669 6c65 5f69 2e65 6e64 7377 6974 6828  file_i.endswith(
+0001c3b0: 6578 7465 6e73 696f 6e29 2066 6f72 2066  extension) for f
+0001c3c0: 696c 655f 6920 696e 2066 696c 6573 0d0a  ile_i in files..
+0001c3d0: 2020 2020 2020 2020 2020 2020 292c 2022              ), "
+0001c3e0: 616c 6c20 6669 6c65 7320 696e 2074 6865  all files in the
+0001c3f0: 2067 6976 656e 2066 6f6c 6465 7220 7368   given folder sh
+0001c400: 6f75 6c64 2068 6176 6520 2e74 6966 2065  ould have .tif e
+0001c410: 7874 656e 7369 6f6e 220d 0a0d 0a20 2020  xtension"....   
+0001c420: 2020 2020 2023 2066 696c 6573 2074 6f20       # files to 
+0001c430: 6265 2072 6561 640d 0a20 2020 2020 2020  be read..       
+0001c440: 2066 696c 6573 203d 2066 696c 6573 5b73   files = files[s
+0001c450: 7461 7274 693a 656e 6469 5d0d 0a20 2020  tarti:endi]..   
+0001c460: 2020 2020 2069 6620 6e6f 7420 6973 696e       if not isin
+0001c470: 7374 616e 6365 2870 6174 682c 206c 6973  stance(path, lis
+0001c480: 7429 3a0d 0a20 2020 2020 2020 2020 2020  t):..           
+0001c490: 2023 2061 6464 2074 6865 2070 6174 6820   # add the path 
+0001c4a0: 746f 2061 6c6c 2074 6865 2066 696c 6573  to all the files
+0001c4b0: 0d0a 2020 2020 2020 2020 2020 2020 6669  ..            fi
+0001c4c0: 6c65 7320 3d20 5b66 227b 7061 7468 7d2f  les = [f"{path}/
+0001c4d0: 7b69 7d22 2066 6f72 2069 2069 6e20 6669  {i}" for i in fi
+0001c4e0: 6c65 735d 0d0a 2020 2020 2020 2020 2320  les]..        # 
+0001c4f0: 6372 6561 7465 2061 2033 6420 6172 7261  create a 3d arra
+0001c500: 7920 7769 7468 2074 6865 2032 6420 6469  y with the 2d di
+0001c510: 6d65 6e73 696f 6e20 6f66 2074 6865 2066  mension of the f
+0001c520: 6972 7374 2072 6173 7465 7220 616e 6420  irst raster and 
+0001c530: 7468 6520 6c65 6e0d 0a20 2020 2020 2020  the len..       
+0001c540: 2023 206f 6620 7468 6520 6e75 6d62 6572   # of the number
+0001c550: 206f 6620 7261 7374 6572 7320 696e 2074   of rasters in t
+0001c560: 6865 2066 6f6c 6465 720d 0a20 2020 2020  he folder..     
+0001c570: 2020 2073 616d 706c 6520 3d20 4461 7461     sample = Data
+0001c580: 7365 742e 7265 6164 5f66 696c 6528 6669  set.read_file(fi
+0001c590: 6c65 735b 305d 290d 0a0d 0a20 2020 2020  les[0])....     
+0001c5a0: 2020 2072 6574 7572 6e20 636c 7328 7361     return cls(sa
+0001c5b0: 6d70 6c65 2c20 6c65 6e28 6669 6c65 7329  mple, len(files)
+0001c5c0: 2c20 6669 6c65 7329 0d0a 0d0a 2020 2020  , files)....    
+0001c5d0: 6465 6620 7265 6164 5f64 6174 6173 6574  def read_dataset
+0001c5e0: 2873 656c 662c 2062 616e 643a 2069 6e74  (self, band: int
+0001c5f0: 203d 2030 293a 0d0a 2020 2020 2020 2020   = 0):..        
+0001c600: 2222 2252 6561 6420 6172 7261 792e 0d0a  """Read array...
+0001c610: 0d0a 2020 2020 2020 2020 2020 2020 5265  ..            Re
+0001c620: 6164 2076 616c 7565 7320 666f 726d 2074  ad values form t
+0001c630: 6865 2067 6976 656e 2062 616e 6473 2061  he given bands a
+0001c640: 7320 4172 7261 7973 2066 6f72 2061 6c6c  s Arrays for all
+0001c650: 2066 696c 6573 0d0a 0d0a 2020 2020 2020   files....      
+0001c660: 2020 5061 7261 6d65 7465 7273 0d0a 2020    Parameters..  
+0001c670: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+0001c680: 0d0a 2020 2020 2020 2020 6261 6e64 3a20  ..        band: 
+0001c690: 5b69 6e74 5d0d 0a20 2020 2020 2020 2020  [int]..         
+0001c6a0: 2020 2069 6e64 6578 206f 6620 7468 6520     index of the 
+0001c6b0: 6261 6e64 2079 6f75 2077 616e 7420 746f  band you want to
+0001c6c0: 2072 6561 6420 6465 6661 756c 7420 6973   read default is
+0001c6d0: 2030 2e0d 0a0d 0a20 2020 2020 2020 2052   0.....        R
+0001c6e0: 6574 7572 6e73 0d0a 2020 2020 2020 2020  eturns..        
+0001c6f0: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
+0001c700: 2041 7272 6179 0d0a 2020 2020 2020 2020   Array..        
+0001c710: 2222 220d 0a20 2020 2020 2020 2023 2063  """..        # c
+0001c720: 6865 636b 2074 6865 2067 6976 656e 2062  heck the given b
+0001c730: 616e 6420 6e75 6d62 6572 0d0a 2020 2020  and number..    
+0001c740: 2020 2020 6966 206e 6f74 2068 6173 6174      if not hasat
+0001c750: 7472 2873 656c 662c 2022 6261 7365 2229  tr(self, "base")
+0001c760: 3a0d 0a20 2020 2020 2020 2020 2020 2072  :..            r
+0001c770: 6169 7365 2056 616c 7565 4572 726f 7228  aise ValueError(
+0001c780: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0001c790: 2020 2270 6c65 6173 6520 7573 6520 7468    "please use th
+0001c7a0: 6520 7265 6164 5f73 6570 6172 6174 655f  e read_separate_
+0001c7b0: 6669 6c65 7320 6d65 7468 6f64 2074 6f20  files method to 
+0001c7c0: 6765 7420 7468 6520 6669 6c65 7320 2874  get the files (t
+0001c7d0: 6966 662f 6173 6369 6929 2069 6e20 7468  iff/ascii) in th
+0001c7e0: 6522 0d0a 2020 2020 2020 2020 2020 2020  e"..            
+0001c7f0: 2020 2020 2264 6174 6173 6574 2064 6972      "dataset dir
+0001c800: 6563 746f 7279 220d 0a20 2020 2020 2020  ectory"..       
+0001c810: 2020 2020 2029 0d0a 2020 2020 2020 2020       )..        
+0001c820: 6966 2062 616e 6420 3e20 7365 6c66 2e62  if band > self.b
+0001c830: 6173 652e 6261 6e64 5f63 6f75 6e74 202d  ase.band_count -
+0001c840: 2031 3a0d 0a20 2020 2020 2020 2020 2020   1:..           
+0001c850: 2072 6169 7365 2056 616c 7565 4572 726f   raise ValueErro
+0001c860: 7228 0d0a 2020 2020 2020 2020 2020 2020  r(..            
+0001c870: 2020 2020 6622 7468 6520 7261 7374 6572      f"the raster
+0001c880: 2068 6173 206f 6e6c 7920 7b73 656c 662e   has only {self.
+0001c890: 6261 7365 2e62 616e 645f 636f 756e 747d  base.band_count}
+0001c8a0: 2063 6865 636b 2074 6865 2067 6976 656e   check the given
+0001c8b0: 2062 616e 6420 6e75 6d62 6572 220d 0a20   band number".. 
+0001c8c0: 2020 2020 2020 2020 2020 2029 0d0a 2020             )..  
+0001c8d0: 2020 2020 2020 2320 6669 6c6c 2074 6865        # fill the
+0001c8e0: 2061 7272 6179 2077 6974 6820 6e6f 5f64   array with no_d
+0001c8f0: 6174 615f 7661 6c75 6520 6461 7461 0d0a  ata_value data..
+0001c900: 2020 2020 2020 2020 7365 6c66 2e5f 6461          self._da
+0001c910: 7461 203d 206e 702e 6f6e 6573 280d 0a20  ta = np.ones(.. 
+0001c920: 2020 2020 2020 2020 2020 2028 0d0a 2020             (..  
+0001c930: 2020 2020 2020 2020 2020 2020 2020 7365                se
+0001c940: 6c66 2e74 696d 655f 6c65 6e67 7468 2c0d  lf.time_length,.
+0001c950: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001c960: 2073 656c 662e 6261 7365 2e72 6f77 732c   self.base.rows,
+0001c970: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0001c980: 2020 7365 6c66 2e62 6173 652e 636f 6c75    self.base.colu
+0001c990: 6d6e 732c 0d0a 2020 2020 2020 2020 2020  mns,..          
+0001c9a0: 2020 290d 0a20 2020 2020 2020 2029 0d0a    )..        )..
+0001c9b0: 2020 2020 2020 2020 7365 6c66 2e5f 6461          self._da
+0001c9c0: 7461 5b3a 2c20 3a2c 203a 5d20 3d20 6e70  ta[:, :, :] = np
+0001c9d0: 2e6e 616e 0d0a 0d0a 2020 2020 2020 2020  .nan....        
+0001c9e0: 666f 7220 692c 2066 696c 655f 6920 696e  for i, file_i in
+0001c9f0: 2065 6e75 6d65 7261 7465 2873 656c 662e   enumerate(self.
+0001ca00: 6669 6c65 7329 3a0d 0a20 2020 2020 2020  files):..       
+0001ca10: 2020 2020 2023 2072 6561 6420 7468 6520       # read the 
+0001ca20: 7469 6620 6669 6c65 0d0a 2020 2020 2020  tif file..      
+0001ca30: 2020 2020 2020 7261 7374 6572 5f69 203d        raster_i =
+0001ca40: 2067 6461 6c2e 4f70 656e 2866 227b 6669   gdal.Open(f"{fi
+0001ca50: 6c65 5f69 7d22 290d 0a20 2020 2020 2020  le_i}")..       
+0001ca60: 2020 2020 2073 656c 662e 5f64 6174 615b       self._data[
+0001ca70: 692c 203a 2c20 3a5d 203d 2072 6173 7465  i, :, :] = raste
+0001ca80: 725f 692e 4765 7452 6173 7465 7242 616e  r_i.GetRasterBan
+0001ca90: 6428 6261 6e64 202b 2031 292e 5265 6164  d(band + 1).Read
+0001caa0: 4173 4172 7261 7928 290d 0a0d 0a20 2020  AsArray()....   
+0001cab0: 2040 7072 6f70 6572 7479 0d0a 2020 2020   @property..    
+0001cac0: 6465 6620 6461 7461 2873 656c 6629 202d  def data(self) -
+0001cad0: 3e20 6e70 2e6e 6461 7272 6179 3a0d 0a20  > np.ndarray:.. 
+0001cae0: 2020 2020 2020 2022 2222 6461 7461 2061         """data a
+0001caf0: 7474 7269 6275 7465 2e0d 0a0d 0a20 2020  ttribute.....   
+0001cb00: 2020 2020 202d 2054 6865 2061 7474 7269       - The attri
+0001cb10: 6275 7465 2077 6865 7265 2074 6865 2064  bute where the d
+0001cb20: 6174 6173 6574 2061 7272 6179 2069 7320  ataset array is 
+0001cb30: 7374 6f72 6564 2e0d 0a20 2020 2020 2020  stored...       
+0001cb40: 202d 2074 6865 2033 4420 6e75 6d70 7920   - the 3D numpy 
+0001cb50: 6172 7261 792c 205b 6461 7461 7365 7420  array, [dataset 
+0001cb60: 6c65 6e67 7468 2c20 726f 7773 2c20 636f  length, rows, co
+0001cb70: 6c73 5d2c 205b 6461 7461 7365 7420 6c65  ls], [dataset le
+0001cb80: 6e67 7468 2c20 6c6f 6e73 2c20 6c61 7473  ngth, lons, lats
+0001cb90: 5d0d 0a20 2020 2020 2020 2022 2222 0d0a  ]..        """..
+0001cba0: 2020 2020 2020 2020 6966 206e 6f74 2068          if not h
+0001cbb0: 6173 6174 7472 2873 656c 662c 2022 5f64  asattr(self, "_d
+0001cbc0: 6174 6122 293a 0d0a 2020 2020 2020 2020  ata"):..        
+0001cbd0: 2020 2020 7261 6973 6520 5661 6c75 6545      raise ValueE
+0001cbe0: 7272 6f72 2822 706c 6561 7365 2075 7365  rror("please use
+0001cbf0: 2074 6865 2072 6561 645f 6461 7461 7365   the read_datase
+0001cc00: 7420 746f 2072 6561 6420 7468 6520 6461  t to read the da
+0001cc10: 7461 2066 6972 7374 2e22 290d 0a0d 0a20  ta first.").... 
+0001cc20: 2020 2020 2020 2072 6574 7572 6e20 7365         return se
+0001cc30: 6c66 2e5f 6461 7461 0d0a 0d0a 2020 2020  lf._data....    
+0001cc40: 4064 6174 612e 7365 7474 6572 0d0a 2020  @data.setter..  
+0001cc50: 2020 6465 6620 6461 7461 2873 656c 662c    def data(self,
+0001cc60: 2076 616c 293a 0d0a 2020 2020 2020 2020   val):..        
+0001cc70: 2222 2244 6174 6120 6174 7472 6962 7574  """Data attribut
+0001cc80: 652e 0d0a 0d0a 2020 2020 2020 2020 2d20  e.....        - 
+0001cc90: 7365 7474 696e 6720 7468 6520 6461 7461  setting the data
+0001cca0: 2028 6172 7261 7929 2064 6f65 7320 6e6f   (array) does no
+0001ccb0: 7420 616c 6c6f 7720 6469 6666 6572 656e  t allow differen
+0001ccc0: 7420 6469 6d65 6e73 696f 6e20 6672 6f6d  t dimension from
+0001ccd0: 2074 6865 2064 696d 656e 7369 6f6e 2074   the dimension t
+0001cce0: 6861 7420 6861 7665 2062 6565 6e0d 0a20  hat have been.. 
+0001ccf0: 2020 2020 2020 2064 6566 696e 6564 2069         defined i
+0001cd00: 6e63 7265 6174 696e 6720 7468 6520 6461  ncreating the da
+0001cd10: 7461 7365 742e 0d0a 2020 2020 2020 2020  taset...        
+0001cd20: 2222 220d 0a20 2020 2020 2020 2023 2069  """..        # i
+0001cd30: 6620 7468 6520 6174 7472 6962 7574 6520  f the attribute 
+0001cd40: 6973 2064 6566 696e 6564 2062 6566 6f72  is defined befor
+0001cd50: 6520 6368 6563 6b20 7468 6520 6469 6d65  e check the dime
+0001cd60: 6e73 696f 6e0d 0a20 2020 2020 2020 2069  nsion..        i
+0001cd70: 6620 6861 7361 7474 7228 7365 6c66 2c20  f hasattr(self, 
+0001cd80: 2264 6174 6122 293a 0d0a 2020 2020 2020  "data"):..      
+0001cd90: 2020 2020 2020 6966 2073 656c 662e 5f64        if self._d
+0001cda0: 6174 612e 7368 6170 6520 213d 2076 616c  ata.shape != val
+0001cdb0: 2e73 6861 7065 3a0d 0a20 2020 2020 2020  .shape:..       
+0001cdc0: 2020 2020 2020 2020 2072 6169 7365 2056           raise V
+0001cdd0: 616c 7565 4572 726f 7228 0d0a 2020 2020  alueError(..    
+0001cde0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001cdf0: 6622 5468 6520 6469 6d65 6e73 696f 6e20  f"The dimension 
+0001ce00: 6f66 2074 6865 206e 6577 2064 6174 613a  of the new data:
+0001ce10: 207b 7661 6c2e 7368 6170 657d 2c20 6469   {val.shape}, di
+0001ce20: 6666 6572 7320 6672 6f6d 2074 6865 2064  ffers from the d
+0001ce30: 696d 656e 7369 6f6e 206f 6620 7468 6520  imension of the 
+0001ce40: 220d 0a20 2020 2020 2020 2020 2020 2020  "..             
+0001ce50: 2020 2020 2020 2066 226f 7269 6769 6e61         f"origina
+0001ce60: 6c20 6461 7461 7365 743a 207b 7365 6c66  l dataset: {self
+0001ce70: 2e5f 6461 7461 2e73 6861 7065 7d2c 2070  ._data.shape}, p
+0001ce80: 6c65 6173 6520 7265 6465 6669 6e65 2074  lease redefine t
+0001ce90: 6865 2062 6173 6520 4461 7461 7365 7420  he base Dataset 
+0001cea0: 616e 6420 220d 0a20 2020 2020 2020 2020  and "..         
+0001ceb0: 2020 2020 2020 2020 2020 2066 2264 6174             f"dat
+0001cec0: 6173 6574 5f6c 656e 6774 6820 6669 7273  aset_length firs
+0001ced0: 7422 0d0a 2020 2020 2020 2020 2020 2020  t"..            
+0001cee0: 2020 2020 290d 0a0d 0a20 2020 2020 2020      )....       
+0001cef0: 2073 656c 662e 5f64 6174 6120 3d20 7661   self._data = va
+0001cf00: 6c0d 0a0d 0a20 2020 2040 6461 7461 2e64  l....    @data.d
+0001cf10: 656c 6574 6572 0d0a 2020 2020 6465 6620  eleter..    def 
+0001cf20: 6461 7461 2873 656c 6629 3a0d 0a20 2020  data(self):..   
+0001cf30: 2020 2020 2073 656c 662e 5f64 6174 6120       self._data 
+0001cf40: 3d20 4e6f 6e65 0d0a 0d0a 2020 2020 6465  = None....    de
+0001cf50: 6620 5f5f 6765 7469 7465 6d5f 5f28 7365  f __getitem__(se
+0001cf60: 6c66 2c20 6b65 7929 3a0d 0a20 2020 2020  lf, key):..     
+0001cf70: 2020 2069 6620 6e6f 7420 6861 7361 7474     if not hasatt
+0001cf80: 7228 7365 6c66 2c20 2264 6174 6122 293a  r(self, "data"):
+0001cf90: 0d0a 2020 2020 2020 2020 2020 2020 7261  ..            ra
+0001cfa0: 6973 6520 4174 7472 6962 7574 6545 7272  ise AttributeErr
+0001cfb0: 6f72 2822 506c 6561 7365 2075 7365 2074  or("Please use t
+0001cfc0: 6865 2072 6561 645f 6461 7461 7365 7420  he read_dataset 
+0001cfd0: 6d65 7468 6f64 2074 2072 6561 6420 7468  method t read th
+0001cfe0: 6520 6461 7461 2229 0d0a 2020 2020 2020  e data")..      
+0001cff0: 2020 7265 7475 726e 2073 656c 662e 5f64    return self._d
+0001d000: 6174 615b 6b65 792c 203a 2c20 3a5d 0d0a  ata[key, :, :]..
+0001d010: 0d0a 2020 2020 6465 6620 5f5f 7365 7469  ..    def __seti
+0001d020: 7465 6d5f 5f28 7365 6c66 2c20 6b65 792c  tem__(self, key,
+0001d030: 2076 616c 7565 3a20 6e70 2e6e 6461 7272   value: np.ndarr
+0001d040: 6179 293a 0d0a 2020 2020 2020 2020 6966  ay):..        if
+0001d050: 206e 6f74 2068 6173 6174 7472 2873 656c   not hasattr(sel
+0001d060: 662c 2022 6461 7461 2229 3a0d 0a20 2020  f, "data"):..   
+0001d070: 2020 2020 2020 2020 2072 6169 7365 2041           raise A
+0001d080: 7474 7269 6275 7465 4572 726f 7228 2250  ttributeError("P
+0001d090: 6c65 6173 6520 7573 6520 7468 6520 7265  lease use the re
+0001d0a0: 6164 5f64 6174 6173 6574 206d 6574 686f  ad_dataset metho
+0001d0b0: 6420 7420 7265 6164 2074 6865 2064 6174  d t read the dat
+0001d0c0: 6122 290d 0a20 2020 2020 2020 2073 656c  a")..        sel
+0001d0d0: 662e 5f64 6174 615b 6b65 792c 203a 2c20  f._data[key, :, 
+0001d0e0: 3a5d 203d 2076 616c 7565 0d0a 0d0a 2020  :] = value....  
+0001d0f0: 2020 6465 6620 5f5f 6c65 6e5f 5f28 7365    def __len__(se
+0001d100: 6c66 293a 0d0a 2020 2020 2020 2020 7265  lf):..        re
+0001d110: 7475 726e 2073 656c 662e 5f64 6174 612e  turn self._data.
+0001d120: 7368 6170 655b 305d 0d0a 0d0a 2020 2020  shape[0]....    
+0001d130: 6465 6620 5f5f 6974 6572 5f5f 2873 656c  def __iter__(sel
+0001d140: 6629 3a0d 0a20 2020 2020 2020 2072 6574  f):..        ret
+0001d150: 7572 6e20 6974 6572 2873 656c 662e 5f64  urn iter(self._d
+0001d160: 6174 615b 3a5d 290d 0a0d 0a20 2020 2064  ata[:])....    d
+0001d170: 6566 2068 6561 6428 7365 6c66 2c20 6e3a  ef head(self, n:
+0001d180: 2069 6e74 203d 2035 293a 0d0a 2020 2020   int = 5):..    
+0001d190: 2020 2020 2222 2246 6972 7374 2035 2044      """First 5 D
+0001d1a0: 6174 6173 6574 732e 2222 220d 0a20 2020  atasets."""..   
+0001d1b0: 2020 2020 2072 6574 7572 6e20 7365 6c66       return self
+0001d1c0: 2e5f 6461 7461 5b3a 6e2c 203a 2c20 3a5d  ._data[:n, :, :]
+0001d1d0: 0d0a 0d0a 2020 2020 6465 6620 7461 696c  ....    def tail
+0001d1e0: 2873 656c 662c 206e 3a20 696e 7420 3d20  (self, n: int = 
+0001d1f0: 2d35 293a 0d0a 2020 2020 2020 2020 2222  -5):..        ""
+0001d200: 224c 6173 7420 3520 4461 7461 7365 7473  "Last 5 Datasets
+0001d210: 2e22 2222 0d0a 2020 2020 2020 2020 7265  ."""..        re
+0001d220: 7475 726e 2073 656c 662e 5f64 6174 615b  turn self._data[
+0001d230: 6e3a 2c20 3a2c 203a 5d0d 0a0d 0a20 2020  n:, :, :]....   
+0001d240: 2064 6566 2066 6972 7374 2873 656c 6629   def first(self)
+0001d250: 3a0d 0a20 2020 2020 2020 2022 2222 4669  :..        """Fi
+0001d260: 7273 7420 4461 7461 7365 742e 2222 220d  rst Dataset.""".
+0001d270: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
+0001d280: 7365 6c66 2e5f 6461 7461 5b30 2c20 3a2c  self._data[0, :,
+0001d290: 203a 5d0d 0a0d 0a20 2020 2064 6566 206c   :]....    def l
+0001d2a0: 6173 7428 7365 6c66 293a 0d0a 2020 2020  ast(self):..    
+0001d2b0: 2020 2020 2222 224c 6173 7420 4461 7461      """Last Data
+0001d2c0: 7365 742e 2222 220d 0a20 2020 2020 2020  set."""..       
+0001d2d0: 2072 6574 7572 6e20 7365 6c66 2e5f 6461   return self._da
+0001d2e0: 7461 5b2d 312c 203a 2c20 3a5d 0d0a 0d0a  ta[-1, :, :]....
+0001d2f0: 2020 2020 6465 6620 696c 6f63 2873 656c      def iloc(sel
+0001d300: 662c 2069 293a 0d0a 2020 2020 2020 2020  f, i):..        
+0001d310: 2222 2269 6c6f 632e 0d0a 0d0a 2020 2020  """iloc.....    
+0001d320: 2020 2020 2020 2020 2d20 4163 6365 7373          - Access
+0001d330: 2064 6174 6173 6574 2061 7272 6179 2075   dataset array u
+0001d340: 7369 6e67 2069 6e64 6578 2e0d 0a0d 0a20  sing index..... 
+0001d350: 2020 2020 2020 2050 6172 616d 6574 6572         Parameter
+0001d360: 730d 0a20 2020 2020 2020 202d 2d2d 2d2d  s..        -----
+0001d370: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 2069  -----..        i
+0001d380: 3a20 5b69 6e74 5d0d 0a20 2020 2020 2020  : [int]..       
+0001d390: 2020 2020 2069 6e64 6578 0d0a 0d0a 2020       index....  
+0001d3a0: 2020 2020 2020 5265 7475 726e 730d 0a20        Returns.. 
+0001d3b0: 2020 2020 2020 202d 2d2d 2d2d 2d2d 0d0a         -------..
+0001d3c0: 2020 2020 2020 2020 4461 7461 7365 743a          Dataset:
+0001d3d0: 0d0a 2020 2020 2020 2020 2020 2020 4461  ..            Da
+0001d3e0: 7461 7365 7420 6f62 6a65 6374 2e0d 0a20  taset object... 
+0001d3f0: 2020 2020 2020 2022 2222 0d0a 2020 2020         """..    
+0001d400: 2020 2020 6966 206e 6f74 2068 6173 6174      if not hasat
+0001d410: 7472 2873 656c 662c 2022 6461 7461 2229  tr(self, "data")
+0001d420: 3a0d 0a20 2020 2020 2020 2020 2020 2072  :..            r
+0001d430: 6169 7365 2044 6174 6173 6574 4e6f 466f  aise DatasetNoFo
+0001d440: 756e 6445 7272 6f72 2822 706c 6561 7365  undError("please
+0001d450: 2072 6561 6420 7468 6520 6461 7461 7365   read the datase
+0001d460: 7420 6669 7273 7422 290d 0a20 2020 2020  t first")..     
+0001d470: 2020 2061 7272 203d 2073 656c 662e 5f64     arr = self._d
+0001d480: 6174 615b 692c 203a 2c20 3a5d 0d0a 2020  ata[i, :, :]..  
+0001d490: 2020 2020 2020 6473 7420 3d20 6764 616c        dst = gdal
+0001d4a0: 2e47 6574 4472 6976 6572 4279 4e61 6d65  .GetDriverByName
+0001d4b0: 2822 4d45 4d22 292e 4372 6561 7465 436f  ("MEM").CreateCo
+0001d4c0: 7079 2822 222c 2073 656c 662e 6261 7365  py("", self.base
+0001d4d0: 2e72 6173 7465 722c 2030 290d 0a20 2020  .raster, 0)..   
+0001d4e0: 2020 2020 2064 7374 2e47 6574 5261 7374       dst.GetRast
+0001d4f0: 6572 4261 6e64 2831 292e 5772 6974 6541  erBand(1).WriteA
+0001d500: 7272 6179 2861 7272 290d 0a20 2020 2020  rray(arr)..     
+0001d510: 2020 2072 6574 7572 6e20 4461 7461 7365     return Datase
+0001d520: 7428 6473 7429 0d0a 0d0a 2020 2020 6465  t(dst)....    de
+0001d530: 6620 706c 6f74 2873 656c 662c 2062 616e  f plot(self, ban
+0001d540: 643a 2069 6e74 203d 2030 2c20 6578 636c  d: int = 0, excl
+0001d550: 7564 655f 7661 6c75 653a 2041 6e79 203d  ude_value: Any =
+0001d560: 204e 6f6e 652c 202a 2a6b 7761 7267 7329   None, **kwargs)
+0001d570: 3a0d 0a20 2020 2020 2020 2022 2222 5265  :..        """Re
+0001d580: 6164 2041 7272 6179 0d0a 0d0a 2020 2020  ad Array....    
+0001d590: 2020 2020 2020 2020 2d20 7265 6164 2074          - read t
+0001d5a0: 6865 2076 616c 7565 7320 7374 6f72 6564  he values stored
+0001d5b0: 2069 6e20 6120 6769 7665 6e20 6261 6e64   in a given band
+0001d5c0: 2e0d 0a0d 0a20 2020 2020 2020 2050 6172  .....        Par
+0001d5d0: 616d 6574 6572 730d 0a20 2020 2020 2020  ameters..       
+0001d5e0: 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20 2020   ----------..   
+0001d5f0: 2020 2020 2062 616e 6420 3a20 5b69 6e74       band : [int
+0001d600: 6567 6572 5d0d 0a20 2020 2020 2020 2020  eger]..         
+0001d610: 2020 2074 6865 2062 616e 6420 796f 7520     the band you 
+0001d620: 7761 6e74 2074 6f20 6765 7420 6974 7320  want to get its 
+0001d630: 6461 7461 2e20 4465 6661 756c 7420 6973  data. Default is
+0001d640: 2030 0d0a 2020 2020 2020 2020 6578 636c   0..        excl
+0001d650: 7564 655f 7661 6c75 653a 205b 416e 795d  ude_value: [Any]
+0001d660: 0d0a 2020 2020 2020 2020 2020 2020 7661  ..            va
+0001d670: 6c75 6520 746f 2065 7865 636c 7564 6520  lue to execlude 
+0001d680: 6672 6f6d 2074 6865 2070 6c6f 742e 2044  from the plot. D
+0001d690: 6566 6175 6c74 2069 7320 4e6f 6e65 2e0d  efault is None..
+0001d6a0: 0a20 2020 2020 2020 202a 2a6b 7761 7267  .        **kwarg
+0001d6b0: 730d 0a20 2020 2020 2020 2020 2020 2070  s..            p
+0001d6c0: 6f69 6e74 7320 3a20 5b61 7272 6179 5d0d  oints : [array].
+0001d6d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001d6e0: 2033 2063 6f6c 756d 6e20 6172 7261 7920   3 column array 
+0001d6f0: 7769 7468 2074 6865 2066 6972 7374 2063  with the first c
+0001d700: 6f6c 756d 6e20 6173 2074 6865 2076 616c  olumn as the val
+0001d710: 7565 2079 6f75 2077 616e 7420 746f 2064  ue you want to d
+0001d720: 6973 706c 6179 2066 6f72 2074 6865 2070  isplay for the p
+0001d730: 6f69 6e74 2c20 7468 6520 7365 636f 6e64  oint, the second
+0001d740: 2069 7320 7468 6520 726f 7773 0d0a 2020   is the rows..  
+0001d750: 2020 2020 2020 2020 2020 2020 2020 696e                in
+0001d760: 6465 7820 6f66 2074 6865 2070 6f69 6e74  dex of the point
+0001d770: 2069 6e20 7468 6520 6172 7261 792c 2061   in the array, a
+0001d780: 6e64 2074 6865 2074 6869 7264 2063 6f6c  nd the third col
+0001d790: 756d 6e20 6173 2074 6865 2063 6f6c 756d  umn as the colum
+0001d7a0: 6e20 696e 6465 7820 696e 2074 6865 2061  n index in the a
+0001d7b0: 7272 6179 2e0d 0a20 2020 2020 2020 2020  rray...         
+0001d7c0: 2020 2020 2020 202d 2074 6865 2073 6563         - the sec
+0001d7d0: 6f6e 6420 616e 6420 7468 6972 6420 636f  ond and third co
+0001d7e0: 6c75 6d6e 2074 656c 6c73 2074 6865 206c  lumn tells the l
+0001d7f0: 6f63 6174 696f 6e20 6f66 2074 6865 2070  ocation of the p
+0001d800: 6f69 6e74 2069 6e20 7468 6520 6172 7261  oint in the arra
+0001d810: 792e 0d0a 2020 2020 2020 2020 2020 2020  y...            
+0001d820: 706f 696e 745f 636f 6c6f 723a 205b 7374  point_color: [st
+0001d830: 725d 0d0a 2020 2020 2020 2020 2020 2020  r]..            
+0001d840: 2020 2020 636f 6c6f 722e 0d0a 2020 2020      color...    
+0001d850: 2020 2020 2020 2020 706f 696e 745f 7369          point_si
+0001d860: 7a65 3a20 5b41 6e79 5d0d 0a20 2020 2020  ze: [Any]..     
+0001d870: 2020 2020 2020 2020 2020 2073 697a 6520             size 
+0001d880: 6f66 2074 6865 2070 6f69 6e74 2e0d 0a20  of the point... 
+0001d890: 2020 2020 2020 2020 2020 2070 6964 5f63             pid_c
+0001d8a0: 6f6c 6f72 3a20 5b73 7472 5d0d 0a20 2020  olor: [str]..   
+0001d8b0: 2020 2020 2020 2020 2020 2020 2074 6865               the
+0001d8c0: 2063 6f6c 6f72 206f 6620 7468 6520 616e   color of the an
+0001d8d0: 6f74 6174 696f 6e20 6f66 2074 6865 2070  otation of the p
+0001d8e0: 6f69 6e74 2e20 4465 6661 756c 7420 6973  oint. Default is
+0001d8f0: 2062 6c75 652e 0d0a 2020 2020 2020 2020   blue...        
+0001d900: 2020 2020 7069 645f 7369 7a65 3a20 5b41      pid_size: [A
+0001d910: 6e79 5d0d 0a20 2020 2020 2020 2020 2020  ny]..           
+0001d920: 2020 2020 2073 697a 6520 6f66 2074 6865       size of the
+0001d930: 2070 6f69 6e74 2061 6e6e 6f74 6174 696f   point annotatio
+0001d940: 6e2e 0d0a 2020 2020 2020 2020 2020 2020  n...            
+0001d950: 6669 6773 697a 6520 3a20 5b74 7570 6c65  figsize : [tuple
+0001d960: 5d2c 206f 7074 696f 6e61 6c0d 0a20 2020  ], optional..   
+0001d970: 2020 2020 2020 2020 2020 2020 2066 6967               fig
+0001d980: 7572 6520 7369 7a65 2e20 5468 6520 6465  ure size. The de
+0001d990: 6661 756c 7420 6973 2028 382c 3829 2e0d  fault is (8,8)..
+0001d9a0: 0a20 2020 2020 2020 2020 2020 2074 6974  .            tit
+0001d9b0: 6c65 203a 205b 7374 725d 2c20 6f70 7469  le : [str], opti
 0001d9c0: 6f6e 616c 0d0a 2020 2020 2020 2020 2020  onal..          
-0001d9d0: 2020 2020 2020 2020 2020 7661 6c75 6520            value 
-0001d9e0: 6e65 6564 6564 2066 6f72 206f 7074 696f  needed for optio
-0001d9f0: 6e20 332e 2054 6865 2064 6566 6175 6c74  n 3. The default
-0001da00: 2069 7320 302e 3030 3031 2e0d 0a20 2020   is 0.0001...   
-0001da10: 2020 2020 2020 2020 2020 2020 206c 696e               lin
-0001da20: 655f 7363 616c 6520 3a20 5b66 6c6f 6174  e_scale : [float
-0001da30: 5d2c 206f 7074 696f 6e61 6c0d 0a20 2020  ], optional..   
-0001da40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001da50: 2076 616c 7565 206e 6565 6465 6420 666f   value needed fo
-0001da60: 7220 6f70 7469 6f6e 2033 2e20 5468 6520  r option 3. The 
-0001da70: 6465 6661 756c 7420 6973 2030 2e30 3031  default is 0.001
-0001da80: 2e0d 0a20 2020 2020 2020 2020 2020 2020  ...             
-0001da90: 2020 2062 6f75 6e64 733a 205b 4c69 7374     bounds: [List
-0001daa0: 5d0d 0a20 2020 2020 2020 2020 2020 2020  ]..             
-0001dab0: 2020 2020 2020 2061 206c 6973 7420 6f66         a list of
-0001dac0: 206e 756d 6265 7220 746f 2062 6520 7573   number to be us
-0001dad0: 6564 2061 7320 6120 6469 7363 7265 7465  ed as a discrete
-0001dae0: 2062 6f75 6e64 7320 666f 7220 7468 6520   bounds for the 
-0001daf0: 636f 6c6f 7220 7363 616c 6520 342e 4465  color scale 4.De
-0001db00: 6661 756c 7420 6973 204e 6f6e 652c 0d0a  fault is None,..
-0001db10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001db20: 6d69 6470 6f69 6e74 203a 205b 666c 6f61  midpoint : [floa
-0001db30: 745d 2c20 6f70 7469 6f6e 616c 0d0a 2020  t], optional..  
-0001db40: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001db50: 2020 7661 6c75 6520 6e65 6564 6564 2066    value needed f
-0001db60: 6f72 206f 7074 696f 6e20 352e 2054 6865  or option 5. The
-0001db70: 2064 6566 6175 6c74 2069 7320 302e 0d0a   default is 0...
-0001db80: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001db90: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0001dba0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0001dbb0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0001dbc0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
-0001dbd0: 2d2d 0d0a 2020 2020 2020 2020 2020 2020  --..            
-0001dbe0: 636d 6170 203a 205b 7374 725d 2c20 6f70  cmap : [str], op
-0001dbf0: 7469 6f6e 616c 0d0a 2020 2020 2020 2020  tional..        
-0001dc00: 2020 2020 2020 2020 636f 6c6f 7220 7374          color st
-0001dc10: 796c 652e 2054 6865 2064 6566 6175 6c74  yle. The default
-0001dc20: 2069 7320 2763 6f6f 6c77 6172 6d5f 7227   is 'coolwarm_r'
-0001dc30: 2e0d 0a20 2020 2020 2020 2020 2020 2064  ...            d
-0001dc40: 6973 706c 6179 5f63 656c 6c5f 7661 6c75  isplay_cell_valu
-0001dc50: 6520 3a20 5b62 6f6f 6c5d 0d0a 2020 2020  e : [bool]..    
-0001dc60: 2020 2020 2020 2020 2020 2020 5472 7565              True
-0001dc70: 2069 6620 796f 7520 7761 6e74 2074 6f20   if you want to 
-0001dc80: 6469 7370 6c61 7920 7468 6520 7661 6c75  display the valu
-0001dc90: 6573 206f 6620 7468 6520 6365 6c6c 7320  es of the cells 
-0001dca0: 6173 2061 2074 6578 740d 0a20 2020 2020  as a text..     
-0001dcb0: 2020 2020 2020 206e 756d 5f73 697a 6520         num_size 
-0001dcc0: 3a20 696e 7465 6765 722c 206f 7074 696f  : integer, optio
-0001dcd0: 6e61 6c0d 0a20 2020 2020 2020 2020 2020  nal..           
-0001dce0: 2020 2020 2073 697a 6520 6f66 2074 6865       size of the
-0001dcf0: 206e 756d 6265 7273 2070 6c6f 7474 6564   numbers plotted
-0001dd00: 2069 6e74 6f70 206f 6620 6561 6368 2063   intop of each c
-0001dd10: 656c 6c73 2e20 5468 6520 6465 6661 756c  ells. The defaul
-0001dd20: 7420 6973 2038 2e0d 0a20 2020 2020 2020  t is 8...       
-0001dd30: 2020 2020 2062 6163 6b67 726f 756e 645f       background_
-0001dd40: 636f 6c6f 725f 7468 7265 7368 6f6c 6420  color_threshold 
-0001dd50: 3a20 5b66 6c6f 6174 2f69 6e74 6567 6572  : [float/integer
-0001dd60: 5d2c 206f 7074 696f 6e61 6c0d 0a20 2020  ], optional..   
-0001dd70: 2020 2020 2020 2020 2020 2020 2074 6872               thr
-0001dd80: 6573 686f 6c64 2076 616c 7565 2069 6620  eshold value if 
-0001dd90: 7468 6520 7661 6c75 6520 6f66 2074 6865  the value of the
-0001dda0: 2063 656c 6c20 6973 2067 7265 6174 6572   cell is greater
-0001ddb0: 2c20 7468 6520 706c 6f74 7465 640d 0a20  , the plotted.. 
-0001ddc0: 2020 2020 2020 2020 2020 2020 2020 206e                 n
-0001ddd0: 756d 6265 7273 2077 696c 6c20 6265 2062  umbers will be b
-0001dde0: 6c61 636b 2061 6e64 2069 6620 736d 616c  lack and if smal
-0001ddf0: 6c65 7220 7468 6520 706c 6f74 7465 6420  ler the plotted 
-0001de00: 6e75 6d62 6572 2077 696c 6c20 6265 2077  number will be w
-0001de10: 6869 7465 0d0a 2020 2020 2020 2020 2020  hite..          
-0001de20: 2020 2020 2020 6966 204e 6f6e 6520 6769        if None gi
-0001de30: 7665 6e20 7468 6520 6d61 7876 616c 7565  ven the maxvalue
-0001de40: 2f32 2077 696c 6c20 6265 2063 6f6e 7369  /2 will be consi
-0001de50: 6465 7265 642e 2054 6865 2064 6566 6175  dered. The defau
-0001de60: 6c74 2069 7320 4e6f 6e65 2e0d 0a0d 0a20  lt is None..... 
-0001de70: 2020 2020 2020 2052 6574 7572 6e73 0d0a         Returns..
-0001de80: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d0d          -------.
-0001de90: 0a20 2020 2020 2020 2061 7865 733a 205b  .        axes: [
-0001dea0: 6669 6775 7265 2061 7865 735d 2e0d 0a20  figure axes]... 
-0001deb0: 2020 2020 2020 2020 2020 2074 6865 2061             the a
-0001dec0: 7865 7320 6f66 2074 6865 206d 6174 706c  xes of the matpl
-0001ded0: 6f74 6c69 6220 6669 6775 7265 0d0a 2020  otlib figure..  
-0001dee0: 2020 2020 2020 6669 673a 205b 6d61 7470        fig: [matp
-0001def0: 6c6f 746c 6962 2066 6967 7572 6520 6f62  lotlib figure ob
-0001df00: 6a65 6374 5d0d 0a20 2020 2020 2020 2020  ject]..         
-0001df10: 2020 2074 6865 2066 6967 7572 6520 6f62     the figure ob
-0001df20: 6a65 6374 0d0a 2020 2020 2020 2020 2222  ject..        ""
-0001df30: 220d 0a20 2020 2020 2020 2069 6d70 6f72  "..        impor
-0001df40: 745f 636c 656f 7061 7472 6128 0d0a 2020  t_cleopatra(..  
-0001df50: 2020 2020 2020 2020 2020 2254 6865 2063            "The c
-0001df60: 7572 7265 6e74 2066 756e 6372 696f 6e20  urrent funcrion 
-0001df70: 7573 6573 2063 6c65 6f70 6174 7261 2070  uses cleopatra p
-0001df80: 6163 6b61 6765 2074 6f20 666f 7220 706c  ackage to for pl
-0001df90: 6f74 7469 6e67 2c20 706c 6561 7365 2069  otting, please i
-0001dfa0: 6e73 7461 6c6c 2069 7420 6d61 6e75 616c  nstall it manual
-0001dfb0: 6c79 2c20 666f 7220 6d6f 7265 2069 6e66  ly, for more inf
-0001dfc0: 6f20 220d 0a20 2020 2020 2020 2020 2020  o "..           
-0001dfd0: 2022 6368 6563 6b20 6874 7470 733a 2f2f   "check https://
-0001dfe0: 6769 7468 7562 2e63 6f6d 2f53 6572 6170  github.com/Serap
-0001dff0: 6965 756d 2d6f 662d 616c 6578 2f63 6c65  ieum-of-alex/cle
-0001e000: 6f70 6174 7261 220d 0a20 2020 2020 2020  opatra"..       
-0001e010: 2029 0d0a 2020 2020 2020 2020 6672 6f6d   )..        from
-0001e020: 2063 6c65 6f70 6174 7261 2e61 7272 6179   cleopatra.array
-0001e030: 2069 6d70 6f72 7420 4172 7261 790d 0a0d   import Array...
-0001e040: 0a20 2020 2020 2020 2064 6174 6120 3d20  .        data = 
-0001e050: 7365 6c66 2e64 6174 610d 0a0d 0a20 2020  self.data....   
-0001e060: 2020 2020 2065 7863 6c75 6465 5f76 616c       exclude_val
-0001e070: 7565 203d 2028 0d0a 2020 2020 2020 2020  ue = (..        
-0001e080: 2020 2020 5b73 656c 662e 6261 7365 2e6e      [self.base.n
-0001e090: 6f5f 6461 7461 5f76 616c 7565 5b62 616e  o_data_value[ban
-0001e0a0: 645d 2c20 6578 636c 7564 655f 7661 6c75  d], exclude_valu
-0001e0b0: 655d 0d0a 2020 2020 2020 2020 2020 2020  e]..            
-0001e0c0: 6966 2065 7863 6c75 6465 5f76 616c 7565  if exclude_value
-0001e0d0: 2069 7320 6e6f 7420 4e6f 6e65 0d0a 2020   is not None..  
-0001e0e0: 2020 2020 2020 2020 2020 656c 7365 205b            else [
-0001e0f0: 7365 6c66 2e62 6173 652e 6e6f 5f64 6174  self.base.no_dat
-0001e100: 615f 7661 6c75 655b 6261 6e64 5d5d 0d0a  a_value[band]]..
-0001e110: 2020 2020 2020 2020 290d 0a0d 0a20 2020          )....   
-0001e120: 2020 2020 2063 6c65 6f20 3d20 4172 7261       cleo = Arra
-0001e130: 7928 6461 7461 2c20 6578 636c 7564 655f  y(data, exclude_
-0001e140: 7661 6c75 653d 6578 636c 7564 655f 7661  value=exclude_va
-0001e150: 6c75 6529 0d0a 2020 2020 2020 2020 7469  lue)..        ti
-0001e160: 6d65 203d 206c 6973 7428 7261 6e67 6528  me = list(range(
-0001e170: 7365 6c66 2e74 696d 655f 6c65 6e67 7468  self.time_length
-0001e180: 2929 0d0a 2020 2020 2020 2020 616e 696d  ))..        anim
-0001e190: 203d 2063 6c65 6f2e 616e 696d 6174 6528   = cleo.animate(
-0001e1a0: 7469 6d65 2c20 2a2a 6b77 6172 6773 290d  time, **kwargs).
-0001e1b0: 0a20 2020 2020 2020 2072 6574 7572 6e20  .        return 
-0001e1c0: 616e 696d 0d0a 0d0a 2020 2020 6465 6620  anim....    def 
-0001e1d0: 746f 5f66 696c 6528 7365 6c66 2c20 7061  to_file(self, pa
-0001e1e0: 7468 3a20 7374 722c 2064 7269 7665 723a  th: str, driver:
-0001e1f0: 2073 7472 203d 2022 6765 6f74 6966 6622   str = "geotiff"
-0001e200: 2c20 6261 6e64 3a20 696e 7420 3d20 3029  , band: int = 0)
-0001e210: 3a0d 0a20 2020 2020 2020 2022 2222 5361  :..        """Sa
-0001e220: 7665 2074 6f20 6765 6f74 6966 6620 666f  ve to geotiff fo
-0001e230: 726d 6174 2e0d 0a0d 0a20 2020 2020 2020  rmat.....       
-0001e240: 2020 2020 2073 6176 6552 6173 7465 7220       saveRaster 
-0001e250: 7361 7665 7320 6120 7261 7374 6572 2074  saves a raster t
-0001e260: 6f20 6120 7061 7468 0d0a 0d0a 2020 2020  o a path....    
-0001e270: 2020 2020 5061 7261 6d65 7465 7273 0d0a      Parameters..
-0001e280: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
-0001e290: 2d2d 0d0a 2020 2020 2020 2020 7061 7468  --..        path
-0001e2a0: 3a20 5b73 7472 696e 675d 0d0a 2020 2020  : [string]..    
-0001e2b0: 2020 2020 2020 2020 6120 7061 7468 2069          a path i
-0001e2c0: 6e63 6c75 646e 6720 7468 6520 6e61 6d65  ncludng the name
-0001e2d0: 206f 6620 7468 6520 7261 7374 6572 2061   of the raster a
-0001e2e0: 6e64 2065 7874 656e 7469 6f6e 2e0d 0a20  nd extention... 
-0001e2f0: 2020 2020 2020 2020 2020 203e 3e3e 2070             >>> p
-0001e300: 6174 6820 3d20 2264 6174 612f 6372 6f70  ath = "data/crop
-0001e310: 7065 642e 7469 6622 0d0a 2020 2020 2020  ped.tif"..      
-0001e320: 2020 6472 6976 6572 3a20 5b73 7472 5d0d    driver: [str].
-0001e330: 0a20 2020 2020 2020 2020 2020 2064 7269  .            dri
-0001e340: 7665 7220 3d20 2267 656f 7469 6666 222e  ver = "geotiff".
-0001e350: 0d0a 2020 2020 2020 2020 6261 6e64 3a20  ..        band: 
-0001e360: 5b69 6e74 5d0d 0a20 2020 2020 2020 2020  [int]..         
-0001e370: 2020 2062 616e 6420 696e 6465 782c 206e     band index, n
-0001e380: 6565 6465 6420 6f6e 6c79 2069 6e20 6361  eeded only in ca
-0001e390: 7365 206f 6620 6173 6369 6920 6472 6976  se of ascii driv
-0001e3a0: 6572 732e 2044 6566 6175 6c74 2069 7320  ers. Default is 
-0001e3b0: 312e 0d0a 0d0a 2020 2020 2020 2020 4578  1.....        Ex
-0001e3c0: 616d 706c 6573 0d0a 2020 2020 2020 2020  amples..        
-0001e3d0: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020  --------..      
-0001e3e0: 2020 3e3e 3e20 7261 7374 6572 5f6f 626a    >>> raster_obj
-0001e3f0: 203d 2044 6174 6173 6574 2e72 6561 645f   = Dataset.read_
-0001e400: 6669 6c65 2822 7061 7468 2f74 6f2f 6669  file("path/to/fi
-0001e410: 6c65 2f2a 2a2a 2e74 6966 2229 0d0a 2020  le/***.tif")..  
-0001e420: 2020 2020 2020 3e3e 3e20 6f75 7470 7574        >>> output
-0001e430: 5f70 6174 6820 3d20 2265 7861 6d70 6c65  _path = "example
-0001e440: 732f 4749 532f 6461 7461 2f73 6176 655f  s/GIS/data/save_
-0001e450: 7261 7374 6572 5f74 6573 742e 7469 6622  raster_test.tif"
-0001e460: 0d0a 2020 2020 2020 2020 3e3e 3e20 7261  ..        >>> ra
-0001e470: 7374 6572 5f6f 626a 2e74 6f5f 6669 6c65  ster_obj.to_file
-0001e480: 286f 7574 7075 745f 7061 7468 290d 0a20  (output_path).. 
-0001e490: 2020 2020 2020 2022 2222 0d0a 2020 2020         """..    
-0001e4a0: 2020 2020 6966 206e 6f74 2050 6174 6828      if not Path(
-0001e4b0: 7061 7468 292e 6578 6973 7473 2829 3a0d  path).exists():.
-0001e4c0: 0a20 2020 2020 2020 2020 2020 2050 6174  .            Pat
-0001e4d0: 6828 7061 7468 292e 6d6b 6469 7228 7061  h(path).mkdir(pa
-0001e4e0: 7265 6e74 733d 5472 7565 2c20 6578 6973  rents=True, exis
-0001e4f0: 745f 6f6b 3d54 7275 6529 0d0a 2020 2020  t_ok=True)..    
-0001e500: 2020 2020 6578 7420 3d20 4341 5441 4c4f      ext = CATALO
-0001e510: 472e 6765 745f 6578 7465 6e73 696f 6e28  G.get_extension(
-0001e520: 6472 6976 6572 290d 0a0d 0a20 2020 2020  driver)....     
-0001e530: 2020 2066 6f72 2069 2069 6e20 7261 6e67     for i in rang
-0001e540: 6528 7365 6c66 2e74 696d 655f 6c65 6e67  e(self.time_leng
-0001e550: 7468 293a 0d0a 2020 2020 2020 2020 2020  th):..          
-0001e560: 2020 7372 6320 3d20 7365 6c66 2e69 6c6f    src = self.ilo
-0001e570: 6328 6929 0d0a 2020 2020 2020 2020 2020  c(i)..          
-0001e580: 2020 7372 632e 746f 5f66 696c 6528 6622    src.to_file(f"
-0001e590: 7b70 6174 687d 2f7b 697d 2e7b 6578 747d  {path}/{i}.{ext}
-0001e5a0: 222c 2062 616e 643d 6261 6e64 290d 0a0d  ", band=band)...
-0001e5b0: 0a20 2020 2064 6566 2074 6f5f 6372 7328  .    def to_crs(
-0001e5c0: 0d0a 2020 2020 2020 2020 7365 6c66 2c0d  ..        self,.
-0001e5d0: 0a20 2020 2020 2020 2074 6f5f 6570 7367  .        to_epsg
-0001e5e0: 3a20 696e 7420 3d20 3338 3537 2c0d 0a20  : int = 3857,.. 
-0001e5f0: 2020 2020 2020 206d 6574 686f 643a 2073         method: s
-0001e600: 7472 203d 2022 6e65 6172 6573 7420 6e65  tr = "nearest ne
-0001e610: 6962 6f75 7222 2c0d 0a20 2020 2020 2020  ibour",..       
-0001e620: 206d 6169 6e74 6169 6e5f 616c 6967 686d   maintain_alighm
-0001e630: 656e 743a 2069 6e74 203d 2046 616c 7365  ent: int = False
-0001e640: 2c0d 0a20 2020 2029 3a0d 0a20 2020 2020  ,..    ):..     
-0001e650: 2020 2022 2222 746f 5f65 7073 672e 0d0a     """to_epsg...
-0001e660: 0d0a 2020 2020 2020 2020 2020 2020 2d20  ..            - 
-0001e670: 746f 5f65 7073 6720 7265 7072 6f6a 6563  to_epsg reprojec
-0001e680: 7473 2061 2072 6173 7465 7220 746f 2061  ts a raster to a
-0001e690: 6e79 2070 726f 6a65 6374 696f 6e20 2864  ny projection (d
-0001e6a0: 6566 6175 6c74 2074 6865 2057 4753 3834  efault the WGS84
-0001e6b0: 2077 6562 206d 6572 6361 746f 7220 7072   web mercator pr
-0001e6c0: 6f6a 6563 7469 6f6e 2c0d 0a20 2020 2020  ojection,..     
-0001e6d0: 2020 2020 2020 2077 6974 686f 7574 2072         without r
-0001e6e0: 6573 616d 706c 696e 6729 2054 6865 2066  esampling) The f
-0001e6f0: 756e 6374 696f 6e20 7265 7475 726e 7320  unction returns 
-0001e700: 6120 4744 414c 2069 6e2d 6d65 6d6f 7279  a GDAL in-memory
-0001e710: 2066 696c 6520 6f62 6a65 6374 2c20 7768   file object, wh
-0001e720: 6572 6520 796f 7520 6361 6e20 5265 6164  ere you can Read
-0001e730: 4173 4172 7261 7920 6574 632e 0d0a 0d0a  AsArray etc.....
-0001e740: 2020 2020 2020 2020 5061 7261 6d65 7465          Paramete
-0001e750: 7273 0d0a 2020 2020 2020 2020 2d2d 2d2d  rs..        ----
-0001e760: 2d2d 2d2d 2d2d 0d0a 2020 2020 2020 2020  ------..        
-0001e770: 746f 5f65 7073 673a 205b 696e 7465 6765  to_epsg: [intege
-0001e780: 725d 0d0a 2020 2020 2020 2020 2020 2020  r]..            
-0001e790: 7265 6665 7265 6e63 6520 6e75 6d62 6572  reference number
-0001e7a0: 2074 6f20 7468 6520 6e65 7720 7072 6f6a   to the new proj
-0001e7b0: 6563 7469 6f6e 2028 6874 7470 733a 2f2f  ection (https://
-0001e7c0: 6570 7367 2e69 6f2f 290d 0a20 2020 2020  epsg.io/)..     
-0001e7d0: 2020 2020 2020 2028 6465 6661 756c 7420         (default 
-0001e7e0: 3338 3537 2074 6865 2072 6566 6572 656e  3857 the referen
-0001e7f0: 6365 206e 6f20 6f66 2057 4753 3834 2077  ce no of WGS84 w
-0001e800: 6562 206d 6572 6361 746f 7220 290d 0a20  eb mercator ).. 
-0001e810: 2020 2020 2020 206d 6574 686f 643a 205b         method: [
-0001e820: 5374 7269 6e67 5d0d 0a20 2020 2020 2020  String]..       
-0001e830: 2020 2020 2072 6573 616d 706c 696e 6720       resampling 
-0001e840: 7465 6368 6e69 7175 6520 6465 6661 756c  technique defaul
-0001e850: 7420 6973 2022 4e65 6172 6573 7422 0d0a  t is "Nearest"..
-0001e860: 2020 2020 2020 2020 2020 2020 6874 7470              http
-0001e870: 733a 2f2f 6769 7367 656f 6772 6170 6879  s://gisgeography
-0001e880: 2e63 6f6d 2f72 6173 7465 722d 7265 7361  .com/raster-resa
-0001e890: 6d70 6c69 6e67 2f0d 0a20 2020 2020 2020  mpling/..       
-0001e8a0: 2020 2020 2022 4e65 6172 6573 7422 2066       "Nearest" f
-0001e8b0: 6f72 206e 6561 7265 7374 206e 6569 6768  or nearest neigh
-0001e8c0: 626f 7572 2c22 6375 6269 6322 2066 6f72  bour,"cubic" for
-0001e8d0: 2063 7562 6963 2063 6f6e 766f 6c75 7469   cubic convoluti
-0001e8e0: 6f6e 2c0d 0a20 2020 2020 2020 2020 2020  on,..           
-0001e8f0: 2022 6269 6c69 6e65 6172 2220 666f 7220   "bilinear" for 
-0001e900: 6269 6c69 6e65 6172 0d0a 2020 2020 2020  bilinear..      
-0001e910: 2020 6d61 696e 7461 696e 5f61 6c69 6768    maintain_aligh
-0001e920: 6d65 6e74 203a 205b 626f 6f6c 5d0d 0a20  ment : [bool].. 
-0001e930: 2020 2020 2020 2020 2020 2054 7275 6520             True 
-0001e940: 746f 206d 6169 6e74 6169 6e20 7468 6520  to maintain the 
-0001e950: 6e75 6d62 6572 206f 6620 726f 7773 2061  number of rows a
-0001e960: 6e64 2063 6f6c 756d 6e73 206f 6620 7468  nd columns of th
-0001e970: 6520 7261 7374 6572 2074 6865 2073 616d  e raster the sam
-0001e980: 6520 6166 7465 7220 7265 7072 6f6a 6563  e after reprojec
-0001e990: 7469 6f6e 2e20 4465 6661 756c 7420 6973  tion. Default is
-0001e9a0: 2046 616c 7365 2e0d 0a0d 0a20 2020 2020   False.....     
-0001e9b0: 2020 2052 6574 7572 6e73 0d0a 2020 2020     Returns..    
-0001e9c0: 2020 2020 2d2d 2d2d 2d2d 2d0d 0a20 2020      -------..   
-0001e9d0: 2020 2020 2072 6173 7465 723a 0d0a 2020       raster:..  
-0001e9e0: 2020 2020 2020 2020 2020 6764 616c 2064            gdal d
-0001e9f0: 6174 6173 6574 2028 796f 7520 6361 6e20  ataset (you can 
-0001ea00: 7265 6164 2069 7420 6279 2052 6561 6441  read it by ReadA
-0001ea10: 7341 7272 6179 290d 0a0d 0a20 2020 2020  sArray)....     
-0001ea20: 2020 2045 7861 6d70 6c65 730d 0a20 2020     Examples..   
-0001ea30: 2020 2020 202d 2d2d 2d2d 2d2d 2d0d 0a20       --------.. 
-0001ea40: 2020 2020 2020 203e 3e3e 2066 726f 6d20         >>> from 
-0001ea50: 7079 7261 6d69 6473 2e64 6174 6173 6574  pyramids.dataset
-0001ea60: 2069 6d70 6f72 7420 4461 7461 7365 740d   import Dataset.
-0001ea70: 0a20 2020 2020 2020 203e 3e3e 2073 7263  .        >>> src
-0001ea80: 203d 2044 6174 6173 6574 2e72 6561 645f   = Dataset.read_
-0001ea90: 6669 6c65 2822 7061 7468 2f72 6173 7465  file("path/raste
-0001eaa0: 725f 6e61 6d65 2e74 6966 2229 0d0a 2020  r_name.tif")..  
-0001eab0: 2020 2020 2020 3e3e 3e20 7072 6f6a 6563        >>> projec
-0001eac0: 7465 645f 7261 7374 6572 203d 2073 7263  ted_raster = src
-0001ead0: 2e74 6f5f 6372 7328 746f 5f65 7073 673d  .to_crs(to_epsg=
-0001eae0: 3338 3537 290d 0a20 2020 2020 2020 2022  3857)..        "
-0001eaf0: 2222 0d0a 2020 2020 2020 2020 666f 7220  ""..        for 
-0001eb00: 6920 696e 2072 616e 6765 2873 656c 662e  i in range(self.
-0001eb10: 7469 6d65 5f6c 656e 6774 6829 3a0d 0a20  time_length):.. 
-0001eb20: 2020 2020 2020 2020 2020 2073 7263 203d             src =
-0001eb30: 2073 656c 662e 696c 6f63 2869 290d 0a20   self.iloc(i).. 
-0001eb40: 2020 2020 2020 2020 2020 2064 7374 203d             dst =
-0001eb50: 2073 7263 2e74 6f5f 6372 7328 0d0a 2020   src.to_crs(..  
-0001eb60: 2020 2020 2020 2020 2020 2020 2020 746f                to
-0001eb70: 5f65 7073 672c 206d 6574 686f 643d 6d65  _epsg, method=me
-0001eb80: 7468 6f64 2c20 6d61 696e 7461 696e 5f61  thod, maintain_a
-0001eb90: 6c69 6768 6d65 6e74 3d6d 6169 6e74 6169  lighment=maintai
-0001eba0: 6e5f 616c 6967 686d 656e 740d 0a20 2020  n_alighment..   
-0001ebb0: 2020 2020 2020 2020 2029 0d0a 2020 2020           )..    
-0001ebc0: 2020 2020 2020 2020 6172 7220 3d20 6473          arr = ds
-0001ebd0: 742e 7265 6164 5f61 7272 6179 2829 0d0a  t.read_array()..
-0001ebe0: 2020 2020 2020 2020 2020 2020 6966 2069              if i
-0001ebf0: 203d 3d20 303a 0d0a 2020 2020 2020 2020   == 0:..        
-0001ec00: 2020 2020 2020 2020 2320 6372 6561 7465          # create
-0001ec10: 2074 6865 2061 7272 6179 0d0a 2020 2020   the array..    
-0001ec20: 2020 2020 2020 2020 2020 2020 6172 7261              arra
-0001ec30: 7920 3d20 280d 0a20 2020 2020 2020 2020  y = (..         
-0001ec40: 2020 2020 2020 2020 2020 206e 702e 6f6e             np.on
-0001ec50: 6573 280d 0a20 2020 2020 2020 2020 2020  es(..           
-0001ec60: 2020 2020 2020 2020 2020 2020 2028 0d0a               (..
-0001ec70: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ec80: 2020 2020 2020 2020 2020 2020 7365 6c66              self
-0001ec90: 2e74 696d 655f 6c65 6e67 7468 2c0d 0a20  .time_length,.. 
-0001eca0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ecb0: 2020 2020 2020 2020 2020 2061 7272 2e73             arr.s
-0001ecc0: 6861 7065 5b30 5d2c 0d0a 2020 2020 2020  hape[0],..      
-0001ecd0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ece0: 2020 2020 2020 6172 722e 7368 6170 655b        arr.shape[
-0001ecf0: 315d 2c0d 0a20 2020 2020 2020 2020 2020  1],..           
-0001ed00: 2020 2020 2020 2020 2020 2020 2029 0d0a               )..
-0001ed10: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001ed20: 2020 2020 290d 0a20 2020 2020 2020 2020      )..         
-0001ed30: 2020 2020 2020 2020 2020 202a 206e 702e             * np.
-0001ed40: 6e61 6e0d 0a20 2020 2020 2020 2020 2020  nan..           
-0001ed50: 2020 2020 2029 0d0a 2020 2020 2020 2020       )..        
-0001ed60: 2020 2020 6172 7261 795b 692c 203a 2c20      array[i, :, 
-0001ed70: 3a5d 203d 2061 7272 0d0a 0d0a 2020 2020  :] = arr....    
-0001ed80: 2020 2020 7365 6c66 2e5f 6461 7461 203d      self._data =
-0001ed90: 2061 7272 6179 0d0a 2020 2020 2020 2020   array..        
-0001eda0: 2320 7573 6520 7468 6520 6c61 7374 2073  # use the last s
-0001edb0: 7263 2061 730d 0a20 2020 2020 2020 2073  rc as..        s
-0001edc0: 656c 662e 5f62 6173 6520 3d20 6473 740d  elf._base = dst.
-0001edd0: 0a0d 0a20 2020 2064 6566 2063 726f 7028  ...    def crop(
-0001ede0: 0d0a 2020 2020 2020 2020 7365 6c66 2c0d  ..        self,.
-0001edf0: 0a20 2020 2020 2020 206d 6173 6b3a 2055  .        mask: U
-0001ee00: 6e69 6f6e 5b44 6174 6173 6574 2c20 7374  nion[Dataset, st
-0001ee10: 725d 2c0d 0a20 2020 2029 202d 3e20 4e6f  r],..    ) -> No
-0001ee20: 6e65 3a0d 0a20 2020 2020 2020 2022 2222  ne:..        """
-0001ee30: 6372 6f70 416c 6967 6e65 6446 6f6c 6465  cropAlignedFolde
-0001ee40: 722e 0d0a 0d0a 2020 2020 2020 2020 2020  r.....          
-0001ee50: 2020 6372 6f70 416c 6967 6e65 6446 6f6c    cropAlignedFol
-0001ee60: 6465 7220 6d61 7463 6865 7320 7468 6520  der matches the 
-0001ee70: 6c6f 6361 7469 6f6e 206f 6620 6e6f 6461  location of noda
-0001ee80: 7461 2076 616c 7565 2066 726f 6d20 7372  ta value from sr
-0001ee90: 6320 7261 7374 6572 2074 6f20 6473 740d  c raster to dst.
-0001eea0: 0a20 2020 2020 2020 2020 2020 2072 6173  .            ras
-0001eeb0: 7465 722c 204d 6173 6b20 6973 2077 6865  ter, Mask is whe
-0001eec0: 7265 2074 6865 204e 6f44 6174 6176 616c  re the NoDataval
-0001eed0: 7565 2077 696c 6c20 6265 2074 616b 656e  ue will be taken
-0001eee0: 2061 6e64 2074 6865 206c 6f63 6174 696f   and the locatio
-0001eef0: 6e20 6f66 0d0a 2020 2020 2020 2020 2020  n of..          
-0001ef00: 2020 7468 6973 2076 616c 7565 2073 7263    this value src
-0001ef10: 5f64 6972 2069 7320 7061 7468 2074 6f20  _dir is path to 
-0001ef20: 7468 6520 666f 6c64 6572 2077 6865 7265  the folder where
-0001ef30: 2072 6173 7465 7273 2065 7869 7374 2077   rasters exist w
-0001ef40: 6865 7265 2077 650d 0a20 2020 2020 2020  here we..       
-0001ef50: 2020 2020 206e 6565 6420 746f 2070 7574       need to put
-0001ef60: 2074 6865 204e 6f44 6174 6156 616c 7565   the NoDataValue
-0001ef70: 206f 6620 7468 6520 6d61 736b 2069 6e20   of the mask in 
-0001ef80: 5261 7374 6572 4220 6174 2074 6865 2073  RasterB at the s
-0001ef90: 616d 6520 6c6f 6361 7469 6f6e 730d 0a0d  ame locations...
-0001efa0: 0a20 2020 2020 2020 2050 6172 616d 6574  .        Paramet
-0001efb0: 6572 730d 0a20 2020 2020 2020 202d 2d2d  ers..        ---
-0001efc0: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
-0001efd0: 206d 6173 6b20 3a20 5b73 7472 2f44 6174   mask : [str/Dat
-0001efe0: 6173 6574 5d0d 0a20 2020 2020 2020 2020  aset]..         
-0001eff0: 2020 2070 6174 682f 4461 7461 7365 7420     path/Dataset 
-0001f000: 6f62 6a65 6374 206f 6620 7468 6520 6d61  object of the ma
-0001f010: 736b 2072 6173 7465 7220 746f 2063 726f  sk raster to cro
-0001f020: 7020 7468 6520 7261 7374 6572 7320 2874  p the rasters (t
-0001f030: 6f20 6765 7420 7468 6520 4e6f 4461 7461  o get the NoData
-0001f040: 2076 616c 7565 0d0a 2020 2020 2020 2020   value..        
-0001f050: 2020 2020 616e 6420 6974 206c 6f63 6174      and it locat
-0001f060: 696f 6e20 696e 2074 6865 2061 7272 6179  ion in the array
-0001f070: 2920 4d61 736b 2073 686f 756c 6420 696e  ) Mask should in
-0001f080: 636c 7564 6520 7468 6520 6e61 6d65 206f  clude the name o
-0001f090: 6620 7468 6520 7261 7374 6572 2061 6e64  f the raster and
-0001f0a0: 2074 6865 0d0a 2020 2020 2020 2020 2020   the..          
-0001f0b0: 2020 6578 7465 6e73 696f 6e20 6c69 6b65    extension like
-0001f0c0: 2022 6461 7461 2f64 656d 2e74 6966 222c   "data/dem.tif",
-0001f0d0: 206f 7220 796f 7520 6361 6e20 7265 6164   or you can read
-0001f0e0: 2074 6865 206d 6173 6b20 7261 7374 6572   the mask raster
-0001f0f0: 2075 7369 6e67 2067 6461 6c20 616e 6420   using gdal and 
-0001f100: 7573 650d 0a20 2020 2020 2020 2020 2020  use..           
-0001f110: 2069 7320 7468 6520 6669 7273 7420 7061   is the first pa
-0001f120: 7261 6d65 7465 7220 746f 2074 6865 2066  rameter to the f
-0001f130: 756e 6374 696f 6e2e 0d0a 0d0a 2020 2020  unction.....    
-0001f140: 2020 2020 5265 7475 726e 730d 0a20 2020      Returns..   
-0001f150: 2020 2020 202d 2d2d 2d2d 2d2d 0d0a 2020       -------..  
-0001f160: 2020 2020 2020 6e65 7720 7261 7374 6572        new raster
-0001f170: 7320 6861 7665 2074 6865 2076 616c 7565  s have the value
-0001f180: 7320 6672 6f6d 2072 6173 7465 7273 2069  s from rasters i
-0001f190: 6e20 425f 696e 7075 745f 7061 7468 2077  n B_input_path w
-0001f1a0: 6974 6820 7468 6520 4e6f 4461 7461 5661  ith the NoDataVa
-0001f1b0: 6c75 6520 696e 2074 6865 2073 616d 650d  lue in the same.
-0001f1c0: 0a20 2020 2020 2020 206c 6f63 6174 696f  .        locatio
-0001f1d0: 6e73 206c 696b 6520 7261 7374 6572 2041  ns like raster A
-0001f1e0: 2e0d 0a0d 0a20 2020 2020 2020 2045 7861  .....        Exa
-0001f1f0: 6d70 6c65 730d 0a20 2020 2020 2020 202d  mples..        -
-0001f200: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
-0001f210: 203e 3e3e 2064 656d 5f70 6174 6820 3d20   >>> dem_path = 
-0001f220: 2265 7861 6d70 6c65 732f 4749 532f 6461  "examples/GIS/da
-0001f230: 7461 2f61 6363 3430 3030 2e74 6966 220d  ta/acc4000.tif".
-0001f240: 0a20 2020 2020 2020 203e 3e3e 2073 7263  .        >>> src
-0001f250: 5f70 6174 6820 3d20 2265 7861 6d70 6c65  _path = "example
-0001f260: 732f 4749 532f 6461 7461 2f61 6c69 676e  s/GIS/data/align
-0001f270: 6564 5f72 6173 7465 7273 2f22 0d0a 2020  ed_rasters/"..  
-0001f280: 2020 2020 2020 3e3e 3e20 6f75 745f 7061        >>> out_pa
-0001f290: 7468 203d 2022 6578 616d 706c 6573 2f47  th = "examples/G
-0001f2a0: 4953 2f64 6174 612f 6372 6f70 5f61 6c69  IS/data/crop_ali
-0001f2b0: 676e 6564 5f66 6f6c 6465 722f 220d 0a20  gned_folder/".. 
-0001f2c0: 2020 2020 2020 203e 3e3e 2044 6174 6163         >>> Datac
-0001f2d0: 7562 652e 6372 6f70 2864 656d 5f70 6174  ube.crop(dem_pat
-0001f2e0: 682c 2073 7263 5f70 6174 682c 206f 7574  h, src_path, out
-0001f2f0: 5f70 6174 6829 0d0a 2020 2020 2020 2020  _path)..        
-0001f300: 2222 220d 0a20 2020 2020 2020 2066 6f72  """..        for
-0001f310: 2069 2069 6e20 7261 6e67 6528 7365 6c66   i in range(self
-0001f320: 2e74 696d 655f 6c65 6e67 7468 293a 0d0a  .time_length):..
-0001f330: 2020 2020 2020 2020 2020 2020 7372 6320              src 
-0001f340: 3d20 7365 6c66 2e69 6c6f 6328 6929 0d0a  = self.iloc(i)..
-0001f350: 2020 2020 2020 2020 2020 2020 6473 7420              dst 
-0001f360: 3d20 7372 632e 6372 6f70 286d 6173 6b29  = src.crop(mask)
-0001f370: 0d0a 2020 2020 2020 2020 2020 2020 6172  ..            ar
-0001f380: 7220 3d20 6473 742e 7265 6164 5f61 7272  r = dst.read_arr
-0001f390: 6179 2829 0d0a 2020 2020 2020 2020 2020  ay()..          
-0001f3a0: 2020 6966 2069 203d 3d20 303a 0d0a 2020    if i == 0:..  
-0001f3b0: 2020 2020 2020 2020 2020 2020 2020 2320                # 
-0001f3c0: 6372 6561 7465 2074 6865 2061 7272 6179  create the array
-0001f3d0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-0001f3e0: 2020 6172 7261 7920 3d20 280d 0a20 2020    array = (..   
-0001f3f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f400: 206e 702e 6f6e 6573 280d 0a20 2020 2020   np.ones(..     
-0001f410: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f420: 2020 2028 0d0a 2020 2020 2020 2020 2020     (..          
-0001f430: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f440: 2020 7365 6c66 2e74 696d 655f 6c65 6e67    self.time_leng
-0001f450: 7468 2c0d 0a20 2020 2020 2020 2020 2020  th,..           
-0001f460: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f470: 2061 7272 2e73 6861 7065 5b30 5d2c 0d0a   arr.shape[0],..
-0001f480: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f490: 2020 2020 2020 2020 2020 2020 6172 722e              arr.
-0001f4a0: 7368 6170 655b 315d 2c0d 0a20 2020 2020  shape[1],..     
-0001f4b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f4c0: 2020 2029 0d0a 2020 2020 2020 2020 2020     )..          
-0001f4d0: 2020 2020 2020 2020 2020 290d 0a20 2020            )..   
-0001f4e0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-0001f4f0: 202a 206e 702e 6e61 6e0d 0a20 2020 2020   * np.nan..     
-0001f500: 2020 2020 2020 2020 2020 2029 0d0a 2020             )..  
-0001f510: 2020 2020 2020 2020 2020 6172 7261 795b            array[
-0001f520: 692c 203a 2c20 3a5d 203d 2061 7272 0d0a  i, :, :] = arr..
-0001f530: 0d0a 2020 2020 2020 2020 7365 6c66 2e5f  ..        self._
-0001f540: 6461 7461 203d 2061 7272 6179 0d0a 2020  data = array..  
-0001f550: 2020 2020 2020 2320 7573 6520 7468 6520        # use the 
-0001f560: 6c61 7374 2073 7263 2061 730d 0a20 2020  last src as..   
-0001f570: 2020 2020 2073 656c 662e 5f62 6173 6520       self._base 
-0001f580: 3d20 6473 740d 0a0d 0a20 2020 2023 2023  = dst....    # #
-0001f590: 2054 4f44 4f3a 206d 6572 6765 2052 6570   TODO: merge Rep
-0001f5a0: 726f 6a65 6374 4461 7461 7365 7420 616e  rojectDataset an
-0001f5b0: 6420 5072 6f6a 6563 7452 6173 7465 7220  d ProjectRaster 
-0001f5c0: 7468 6579 2061 7265 2061 6c6d 6f73 7420  they are almost 
-0001f5d0: 7468 6520 7361 6d65 0d0a 2020 2020 2320  the same..    # 
-0001f5e0: 2320 544f 444f 3a20 7374 696c 6c20 6e65  # TODO: still ne
-0001f5f0: 6564 7320 746f 2062 6520 7465 7374 6564  eds to be tested
-0001f600: 0d0a 2020 2020 2320 4073 7461 7469 636d  ..    # @staticm
-0001f610: 6574 686f 640d 0a20 2020 2023 2064 6566  ethod..    # def
-0001f620: 2074 6f5f 6570 7367 280d 0a20 2020 2023   to_epsg(..    #
-0001f630: 2020 2020 2020 2020 2073 7263 3a20 6764           src: gd
-0001f640: 616c 2e44 6174 6163 7562 652c 0d0a 2020  al.Datacube,..  
-0001f650: 2020 2320 2020 2020 2020 2020 746f 5f65    #         to_e
-0001f660: 7073 673a 2069 6e74 203d 2033 3835 372c  psg: int = 3857,
-0001f670: 0d0a 2020 2020 2320 2020 2020 2020 2020  ..    #         
-0001f680: 6365 6c6c 5f73 697a 653a 2069 6e74 203d  cell_size: int =
-0001f690: 205b 5d2c 0d0a 2020 2020 2320 2020 2020   [],..    #     
-0001f6a0: 2020 2020 6d65 7468 6f64 3a20 7374 7220      method: str 
-0001f6b0: 3d20 224e 6561 7265 7374 222c 0d0a 2020  = "Nearest",..  
-0001f6c0: 2020 230d 0a20 2020 2023 2029 202d 3e20    #..    # ) -> 
-0001f6d0: 6764 616c 2e44 6174 6163 7562 653a 0d0a  gdal.Datacube:..
-0001f6e0: 2020 2020 2320 2020 2020 2222 2274 6f5f      #     """to_
-0001f6f0: 6570 7367 2e0d 0a20 2020 2023 0d0a 2020  epsg...    #..  
-0001f700: 2020 2320 2020 2020 2020 2020 2d20 746f    #         - to
-0001f710: 5f65 7073 6720 7265 7072 6f6a 6563 7473  _epsg reprojects
-0001f720: 2061 6e64 2072 6573 616d 706c 6573 2061   and resamples a
-0001f730: 2066 6f6c 6465 7220 6f66 2072 6173 7465   folder of raste
-0001f740: 7273 2074 6f20 616e 7920 7072 6f6a 6563  rs to any projec
-0001f750: 7469 6f6e 0d0a 2020 2020 2320 2020 2020  tion..    #     
-0001f760: 2020 2020 2864 6566 6175 6c74 2074 6865      (default the
-0001f770: 2057 4753 3834 2077 6562 206d 6572 6361   WGS84 web merca
-0001f780: 746f 7220 7072 6f6a 6563 7469 6f6e 2c20  tor projection, 
-0001f790: 7769 7468 6f75 7420 7265 7361 6d70 6c69  without resampli
-0001f7a0: 6e67 290d 0a20 2020 2023 0d0a 2020 2020  ng)..    #..    
-0001f7b0: 2320 2020 2020 5061 7261 6d65 7465 7273  #     Parameters
-0001f7c0: 0d0a 2020 2020 2320 2020 2020 2d2d 2d2d  ..    #     ----
-0001f7d0: 2d2d 2d2d 2d2d 0d0a 2020 2020 2320 2020  ------..    #   
-0001f7e0: 2020 7372 633a 205b 6764 616c 2064 6174    src: [gdal dat
-0001f7f0: 6173 6574 5d0d 0a20 2020 2023 2020 2020  aset]..    #    
-0001f800: 2020 2020 2067 6461 6c20 6461 7461 7365       gdal datase
-0001f810: 7420 6f62 6a65 6374 2028 7372 633d 6764  t object (src=gd
-0001f820: 616c 2e4f 7065 6e28 2264 656d 2e74 6966  al.Open("dem.tif
-0001f830: 2229 290d 0a20 2020 2023 2020 2020 2074  "))..    #     t
-0001f840: 6f5f 6570 7367 3a20 5b69 6e74 6567 6572  o_epsg: [integer
-0001f850: 5d0d 0a20 2020 2023 2020 2020 2020 2020  ]..    #        
-0001f860: 2020 7265 6665 7265 6e63 6520 6e75 6d62    reference numb
-0001f870: 6572 2074 6f20 7468 6520 6e65 7720 7072  er to the new pr
-0001f880: 6f6a 6563 7469 6f6e 2028 6874 7470 733a  ojection (https:
-0001f890: 2f2f 6570 7367 2e69 6f2f 290d 0a20 2020  //epsg.io/)..   
-0001f8a0: 2023 2020 2020 2020 2020 2028 6465 6661   #         (defa
-0001f8b0: 756c 7420 3338 3537 2074 6865 2072 6566  ult 3857 the ref
-0001f8c0: 6572 656e 6365 206e 6f20 6f66 2057 4753  erence no of WGS
-0001f8d0: 3834 2077 6562 206d 6572 6361 746f 7220  84 web mercator 
-0001f8e0: 290d 0a20 2020 2023 2020 2020 2063 656c  )..    #     cel
-0001f8f0: 6c5f 7369 7a65 3a20 5b69 6e74 6567 6572  l_size: [integer
-0001f900: 5d0d 0a20 2020 2023 2020 2020 2020 2020  ]..    #        
-0001f910: 2020 6e75 6d62 6572 2074 6f20 7265 7361    number to resa
-0001f920: 6d70 6c65 2074 6865 2072 6173 7465 7220  mple the raster 
-0001f930: 6365 6c6c 2073 697a 6520 746f 2061 206e  cell size to a n
-0001f940: 6577 2063 656c 6c20 7369 7a65 0d0a 2020  ew cell size..  
-0001f950: 2020 2320 2020 2020 2020 2020 2864 6566    #         (def
-0001f960: 6175 6c74 2065 6d70 7479 2073 6f20 7261  ault empty so ra
-0001f970: 7374 6572 2077 696c 6c20 6e6f 7420 6265  ster will not be
-0001f980: 2072 6573 616d 706c 6564 290d 0a20 2020   resampled)..   
-0001f990: 2023 2020 2020 206d 6574 686f 643a 205b   #     method: [
-0001f9a0: 5374 7269 6e67 5d0d 0a20 2020 2023 2020  String]..    #  
-0001f9b0: 2020 2020 2020 2072 6573 616d 706c 696e         resamplin
-0001f9c0: 6720 7465 6368 6e69 7175 6520 6465 6661  g technique defa
-0001f9d0: 756c 7420 6973 2022 4e65 6172 6573 7422  ult is "Nearest"
-0001f9e0: 0d0a 2020 2020 2320 2020 2020 2020 2020  ..    #         
-0001f9f0: 6874 7470 733a 2f2f 6769 7367 656f 6772  https://gisgeogr
-0001fa00: 6170 6879 2e63 6f6d 2f72 6173 7465 722d  aphy.com/raster-
-0001fa10: 7265 7361 6d70 6c69 6e67 2f0d 0a20 2020  resampling/..   
-0001fa20: 2023 2020 2020 2020 2020 2022 4e65 6172   #         "Near
-0001fa30: 6573 7422 2066 6f72 206e 6561 7265 7374  est" for nearest
-0001fa40: 206e 6569 6768 626f 7572 2c22 6375 6269   neighbour,"cubi
-0001fa50: 6322 2066 6f72 2063 7562 6963 2063 6f6e  c" for cubic con
-0001fa60: 766f 6c75 7469 6f6e 2c0d 0a20 2020 2023  volution,..    #
-0001fa70: 2020 2020 2020 2020 2022 6269 6c69 6e65           "biline
-0001fa80: 6172 2220 666f 7220 6269 6c69 6e65 6172  ar" for bilinear
-0001fa90: 0d0a 2020 2020 230d 0a20 2020 2023 2020  ..    #..    #  
-0001faa0: 2020 2052 6574 7572 6e73 0d0a 2020 2020     Returns..    
-0001fab0: 2320 2020 2020 2d2d 2d2d 2d2d 2d0d 0a20  #     -------.. 
-0001fac0: 2020 2023 2020 2020 2072 6173 7465 723a     #     raster:
-0001fad0: 205b 6764 616c 2044 6174 6163 7562 655d   [gdal Datacube]
-0001fae0: 0d0a 2020 2020 2320 2020 2020 2020 2020  ..    #         
-0001faf0: 2061 2047 4441 4c20 696e 2d6d 656d 6f72   a GDAL in-memor
-0001fb00: 7920 6669 6c65 206f 626a 6563 742c 2077  y file object, w
-0001fb10: 6865 7265 2079 6f75 2063 616e 2052 6561  here you can Rea
-0001fb20: 6441 7341 7272 6179 2065 7463 2e0d 0a20  dAsArray etc... 
-0001fb30: 2020 2023 2020 2020 2022 2222 0d0a 2020     #     """..  
-0001fb40: 2020 2320 2020 2020 6966 206e 6f74 2069    #     if not i
-0001fb50: 7369 6e73 7461 6e63 6528 7372 632c 2067  sinstance(src, g
-0001fb60: 6461 6c2e 4461 7461 6375 6265 293a 0d0a  dal.Datacube):..
-0001fb70: 2020 2020 2320 2020 2020 2020 2020 7261      #         ra
-0001fb80: 6973 6520 5479 7065 4572 726f 7228 0d0a  ise TypeError(..
-0001fb90: 2020 2020 2320 2020 2020 2020 2020 2020      #           
-0001fba0: 2020 2273 7263 2073 686f 756c 6420 6265    "src should be
-0001fbb0: 2072 6561 6420 7573 696e 6720 6764 616c   read using gdal
-0001fbc0: 2028 6764 616c 2064 6174 6173 6574 2070   (gdal dataset p
-0001fbd0: 6c65 6173 6520 7265 6164 2069 7420 7573  lease read it us
-0001fbe0: 696e 6720 6764 616c 220d 0a20 2020 2023  ing gdal"..    #
-0001fbf0: 2020 2020 2020 2020 2020 2020 2066 2220               f" 
-0001fc00: 6c69 6272 6172 7929 2067 6976 656e 207b  library) given {
-0001fc10: 7479 7065 2873 7263 297d 220d 0a20 2020  type(src)}"..   
-0001fc20: 2023 2020 2020 2020 2020 2029 0d0a 2020   #         )..  
-0001fc30: 2020 2320 2020 2020 6966 206e 6f74 2069    #     if not i
-0001fc40: 7369 6e73 7461 6e63 6528 746f 5f65 7073  sinstance(to_eps
-0001fc50: 672c 2069 6e74 293a 0d0a 2020 2020 2320  g, int):..    # 
-0001fc60: 2020 2020 2020 2020 7261 6973 6520 5479          raise Ty
-0001fc70: 7065 4572 726f 7228 0d0a 2020 2020 2320  peError(..    # 
-0001fc80: 2020 2020 2020 2020 2020 2020 2270 6c65              "ple
-0001fc90: 6173 6520 656e 7465 7220 636f 7272 6563  ase enter correc
-0001fca0: 7420 696e 7465 6765 7220 6e75 6d62 6572  t integer number
-0001fcb0: 2066 6f72 2074 6f5f 6570 7367 206d 6f72   for to_epsg mor
-0001fcc0: 6520 696e 666f 726d 6174 696f 6e20 220d  e information ".
-0001fcd0: 0a20 2020 2023 2020 2020 2020 2020 2020  .    #          
-0001fce0: 2020 2066 2268 7474 7073 3a2f 2f65 7073     f"https://eps
-0001fcf0: 672e 696f 2f2c 2067 6976 656e 207b 7479  g.io/, given {ty
-0001fd00: 7065 2874 6f5f 6570 7367 297d 220d 0a20  pe(to_epsg)}".. 
-0001fd10: 2020 2023 2020 2020 2020 2020 2029 0d0a     #         )..
-0001fd20: 2020 2020 2320 2020 2020 6966 206e 6f74      #     if not
-0001fd30: 2069 7369 6e73 7461 6e63 6528 6d65 7468   isinstance(meth
-0001fd40: 6f64 2c20 7374 7229 3a0d 0a20 2020 2023  od, str):..    #
-0001fd50: 2020 2020 2020 2020 2072 6169 7365 2054           raise T
-0001fd60: 7970 6545 7272 6f72 280d 0a20 2020 2023  ypeError(..    #
-0001fd70: 2020 2020 2020 2020 2020 2020 2022 706c               "pl
-0001fd80: 6561 7365 2065 6e74 6572 2063 6f72 7265  ease enter corre
-0001fd90: 6374 206d 6574 686f 6420 6d6f 7265 2069  ct method more i
-0001fda0: 6e66 6f72 6d61 7469 6f6e 2073 6565 2022  nformation see "
-0001fdb0: 2022 646f 636d 656e 7461 7469 6f6e 2022   "docmentation "
-0001fdc0: 0d0a 2020 2020 2320 2020 2020 2020 2020  ..    #         
-0001fdd0: 290d 0a20 2020 2023 0d0a 2020 2020 2320  )..    #..    # 
-0001fde0: 2020 2020 6966 2063 656c 6c5f 7369 7a65      if cell_size
-0001fdf0: 3a0d 0a20 2020 2023 2020 2020 2020 2020  :..    #        
-0001fe00: 2061 7373 6572 7420 6973 696e 7374 616e   assert isinstan
-0001fe10: 6365 2863 656c 6c5f 7369 7a65 2c20 696e  ce(cell_size, in
-0001fe20: 7429 206f 7220 6973 696e 7374 616e 6365  t) or isinstance
-0001fe30: 280d 0a20 2020 2023 2020 2020 2020 2020  (..    #        
-0001fe40: 2020 2020 2063 656c 6c5f 7369 7a65 2c20       cell_size, 
-0001fe50: 666c 6f61 740d 0a20 2020 2023 2020 2020  float..    #    
-0001fe60: 2020 2020 2029 2c20 2270 6c65 6173 6520       ), "please 
-0001fe70: 656e 7465 7220 616e 2069 6e74 6567 6572  enter an integer
-0001fe80: 206f 7220 666c 6f61 7420 6365 6c6c 2073   or float cell s
-0001fe90: 697a 6522 0d0a 2020 2020 230d 0a20 2020  ize"..    #..   
-0001fea0: 2023 2020 2020 2069 6620 6d65 7468 6f64   #     if method
-0001feb0: 203d 3d20 224e 6561 7265 7374 223a 0d0a   == "Nearest":..
-0001fec0: 2020 2020 2320 2020 2020 2020 2020 6d65      #         me
-0001fed0: 7468 6f64 203d 2067 6461 6c2e 4752 415f  thod = gdal.GRA_
-0001fee0: 4e65 6172 6573 744e 6569 6768 626f 7572  NearestNeighbour
-0001fef0: 0d0a 2020 2020 2320 2020 2020 656c 6966  ..    #     elif
-0001ff00: 206d 6574 686f 6420 3d3d 2022 6375 6269   method == "cubi
-0001ff10: 6322 3a0d 0a20 2020 2023 2020 2020 2020  c":..    #      
-0001ff20: 2020 206d 6574 686f 6420 3d20 6764 616c     method = gdal
-0001ff30: 2e47 5241 5f43 7562 6963 0d0a 2020 2020  .GRA_Cubic..    
-0001ff40: 2320 2020 2020 656c 6966 206d 6574 686f  #     elif metho
-0001ff50: 6420 3d3d 2022 6269 6c69 6e65 6172 223a  d == "bilinear":
-0001ff60: 0d0a 2020 2020 2320 2020 2020 2020 2020  ..    #         
-0001ff70: 6d65 7468 6f64 203d 2067 6461 6c2e 4752  method = gdal.GR
-0001ff80: 415f 4269 6c69 6e65 6172 0d0a 2020 2020  A_Bilinear..    
-0001ff90: 230d 0a20 2020 2023 2020 2020 2073 7263  #..    #     src
-0001ffa0: 5f70 726f 6a20 3d20 7372 632e 4765 7450  _proj = src.GetP
-0001ffb0: 726f 6a65 6374 696f 6e28 290d 0a20 2020  rojection()..   
-0001ffc0: 2023 2020 2020 2073 7263 5f67 7420 3d20   #     src_gt = 
-0001ffd0: 7372 632e 4765 7447 656f 5472 616e 7366  src.GetGeoTransf
-0001ffe0: 6f72 6d28 290d 0a20 2020 2023 2020 2020  orm()..    #    
-0001fff0: 2073 7263 5f78 203d 2073 7263 2e52 6173   src_x = src.Ras
-00020000: 7465 7258 5369 7a65 0d0a 2020 2020 2320  terXSize..    # 
-00020010: 2020 2020 7372 635f 7920 3d20 7372 632e      src_y = src.
-00020020: 5261 7374 6572 5953 697a 650d 0a20 2020  RasterYSize..   
-00020030: 2023 2020 2020 2064 7479 7065 203d 2073   #     dtype = s
-00020040: 7263 2e47 6574 5261 7374 6572 4261 6e64  rc.GetRasterBand
-00020050: 2831 292e 4461 7461 5479 7065 0d0a 2020  (1).DataType..  
-00020060: 2020 2320 2020 2020 2320 7370 6174 6961    #     # spatia
-00020070: 6c20 7265 660d 0a20 2020 2023 2020 2020  l ref..    #    
-00020080: 2073 7263 5f73 7220 3d20 6f73 722e 5370   src_sr = osr.Sp
-00020090: 6174 6961 6c52 6566 6572 656e 6365 2877  atialReference(w
-000200a0: 6b74 3d73 7263 5f70 726f 6a29 0d0a 2020  kt=src_proj)..  
-000200b0: 2020 2320 2020 2020 7372 635f 6570 7367    #     src_epsg
-000200c0: 203d 2073 7263 5f73 722e 4765 7441 7474   = src_sr.GetAtt
-000200d0: 7256 616c 7565 2822 4155 5448 4f52 4954  rValue("AUTHORIT
-000200e0: 5922 2c20 3129 0d0a 2020 2020 230d 0a20  Y", 1)..    #.. 
-000200f0: 2020 2023 2020 2020 2023 2064 6973 7469     #     # disti
-00020100: 6e61 7469 6f6e 0d0a 2020 2020 2320 2020  nation..    #   
-00020110: 2020 2320 7370 6174 6961 6c20 7265 660d    # spatial ref.
-00020120: 0a20 2020 2023 2020 2020 2064 7374 5f65  .    #     dst_e
-00020130: 7073 6720 3d20 6f73 722e 5370 6174 6961  psg = osr.Spatia
-00020140: 6c52 6566 6572 656e 6365 2829 0d0a 2020  lReference()..  
-00020150: 2020 2320 2020 2020 6473 745f 6570 7367    #     dst_epsg
-00020160: 2e49 6d70 6f72 7446 726f 6d45 5053 4728  .ImportFromEPSG(
-00020170: 746f 5f65 7073 6729 0d0a 2020 2020 2320  to_epsg)..    # 
-00020180: 2020 2020 2320 7472 616e 7366 6f72 6d61      # transforma
-00020190: 7469 6f6e 2066 6163 746f 7273 0d0a 2020  tion factors..  
-000201a0: 2020 2320 2020 2020 7478 203d 206f 7372    #     tx = osr
-000201b0: 2e43 6f6f 7264 696e 6174 6554 7261 6e73  .CoordinateTrans
-000201c0: 666f 726d 6174 696f 6e28 7372 635f 7372  formation(src_sr
-000201d0: 2c20 6473 745f 6570 7367 290d 0a20 2020  , dst_epsg)..   
-000201e0: 2023 0d0a 2020 2020 2320 2020 2020 2320   #..    #     # 
-000201f0: 696e 6361 7365 2074 6865 2073 6f75 7263  incase the sourc
-00020200: 6520 6372 7320 6973 2047 4353 2061 6e64  e crs is GCS and
-00020210: 206c 6f6e 6769 7475 6465 2069 7320 696e   longitude is in
-00020220: 2074 6865 2077 6573 7420 6865 6d69 7370   the west hemisp
-00020230: 6865 7265 2067 6461 6c0d 0a20 2020 2023  here gdal..    #
-00020240: 2020 2020 2023 2072 6561 6473 206c 6f6e       # reads lon
-00020250: 6769 7475 6465 2066 726f 6e20 3020 746f  gitude fron 0 to
-00020260: 2033 3630 2061 6e64 2074 7261 6e73 666f   360 and transfo
-00020270: 726d 6174 696f 6e20 6661 6374 6f72 2077  rmation factor w
-00020280: 6f6e 7420 776f 726b 2077 6974 6820 7661  ont work with va
-00020290: 6c65 7573 0d0a 2020 2020 2320 2020 2020  leus..    #     
-000202a0: 2320 6772 6561 7465 7220 7468 616e 2031  # greater than 1
-000202b0: 3830 0d0a 2020 2020 2320 2020 2020 6966  80..    #     if
-000202c0: 2073 7263 5f65 7073 6720 3d3d 2022 3433   src_epsg == "43
-000202d0: 3236 2220 616e 6420 7372 635f 6774 5b30  26" and src_gt[0
-000202e0: 5d20 3e20 3138 303a 0d0a 2020 2020 2320  ] > 180:..    # 
-000202f0: 2020 2020 2020 2020 6c6e 675f 6e65 7720          lng_new 
-00020300: 3d20 7372 635f 6774 5b30 5d20 2d20 3336  = src_gt[0] - 36
-00020310: 300d 0a20 2020 2023 2020 2020 2020 2020  0..    #        
-00020320: 2023 2074 7261 6e73 666f 726d 2074 6865   # transform the
-00020330: 2072 6967 6874 2075 7070 6572 2063 6f72   right upper cor
-00020340: 6e65 7220 706f 696e 740d 0a20 2020 2023  ner point..    #
-00020350: 2020 2020 2020 2020 2028 756c 782c 2075           (ulx, u
-00020360: 6c79 2c20 756c 7a29 203d 2074 782e 5472  ly, ulz) = tx.Tr
-00020370: 616e 7366 6f72 6d50 6f69 6e74 286c 6e67  ansformPoint(lng
-00020380: 5f6e 6577 2c20 7372 635f 6774 5b33 5d29  _new, src_gt[3])
-00020390: 0d0a 2020 2020 2320 2020 2020 2020 2020  ..    #         
-000203a0: 2320 7472 616e 7366 6f72 6d20 7468 6520  # transform the 
-000203b0: 7269 6768 7420 6c6f 7765 7220 636f 726e  right lower corn
-000203c0: 6572 2070 6f69 6e74 0d0a 2020 2020 2320  er point..    # 
-000203d0: 2020 2020 2020 2020 286c 7278 2c20 6c72          (lrx, lr
-000203e0: 792c 206c 727a 2920 3d20 7478 2e54 7261  y, lrz) = tx.Tra
-000203f0: 6e73 666f 726d 506f 696e 7428 0d0a 2020  nsformPoint(..  
-00020400: 2020 2320 2020 2020 2020 2020 2020 2020    #             
-00020410: 6c6e 675f 6e65 7720 2b20 7372 635f 6774  lng_new + src_gt
-00020420: 5b31 5d20 2a20 7372 635f 782c 2073 7263  [1] * src_x, src
-00020430: 5f67 745b 335d 202b 2073 7263 5f67 745b  _gt[3] + src_gt[
-00020440: 355d 202a 2073 7263 5f79 0d0a 2020 2020  5] * src_y..    
-00020450: 2320 2020 2020 2020 2020 290d 0a20 2020  #         )..   
-00020460: 2023 2020 2020 2065 6c73 653a 0d0a 2020   #     else:..  
-00020470: 2020 2320 2020 2020 2020 2020 2320 7472    #         # tr
-00020480: 616e 7366 6f72 6d20 7468 6520 7269 6768  ansform the righ
-00020490: 7420 7570 7065 7220 636f 726e 6572 2070  t upper corner p
-000204a0: 6f69 6e74 0d0a 2020 2020 2320 2020 2020  oint..    #     
-000204b0: 2020 2020 2875 6c78 2c20 756c 792c 2075      (ulx, uly, u
-000204c0: 6c7a 2920 3d20 7478 2e54 7261 6e73 666f  lz) = tx.Transfo
-000204d0: 726d 506f 696e 7428 7372 635f 6774 5b30  rmPoint(src_gt[0
-000204e0: 5d2c 2073 7263 5f67 745b 335d 290d 0a20  ], src_gt[3]).. 
-000204f0: 2020 2023 2020 2020 2020 2020 2023 2074     #         # t
-00020500: 7261 6e73 666f 726d 2074 6865 2072 6967  ransform the rig
-00020510: 6874 206c 6f77 6572 2063 6f72 6e65 7220  ht lower corner 
-00020520: 706f 696e 740d 0a20 2020 2023 2020 2020  point..    #    
-00020530: 2020 2020 2028 6c72 782c 206c 7279 2c20       (lrx, lry, 
-00020540: 6c72 7a29 203d 2074 782e 5472 616e 7366  lrz) = tx.Transf
-00020550: 6f72 6d50 6f69 6e74 280d 0a20 2020 2023  ormPoint(..    #
-00020560: 2020 2020 2020 2020 2020 2020 2073 7263               src
-00020570: 5f67 745b 305d 202b 2073 7263 5f67 745b  _gt[0] + src_gt[
-00020580: 315d 202a 2073 7263 5f78 2c20 7372 635f  1] * src_x, src_
-00020590: 6774 5b33 5d20 2b20 7372 635f 6774 5b35  gt[3] + src_gt[5
-000205a0: 5d20 2a20 7372 635f 790d 0a20 2020 2023  ] * src_y..    #
-000205b0: 2020 2020 2020 2020 2029 0d0a 2020 2020           )..    
-000205c0: 230d 0a20 2020 2023 2020 2020 2069 6620  #..    #     if 
-000205d0: 6e6f 7420 6365 6c6c 5f73 697a 653a 0d0a  not cell_size:..
-000205e0: 2020 2020 2320 2020 2020 2020 2020 2320      #         # 
-000205f0: 7468 6520 7265 7375 6c74 2072 6173 7465  the result raste
-00020600: 7220 6861 7320 7468 6520 7361 6d65 2070  r has the same p
-00020610: 6978 6365 6c20 7369 7a65 2061 7320 7468  ixcel size as th
-00020620: 6520 736f 7572 6365 0d0a 2020 2020 2320  e source..    # 
-00020630: 2020 2020 2020 2020 2320 6368 6563 6b20          # check 
-00020640: 6966 2074 6865 2063 6f6f 7264 696e 6174  if the coordinat
-00020650: 6520 7379 7374 656d 2069 7320 4743 5320  e system is GCS 
-00020660: 636f 6e76 6572 7420 7468 6520 6469 7374  convert the dist
-00020670: 616e 6365 2066 726f 6d20 616e 6775 6c61  ance from angula
-00020680: 7220 746f 206d 6574 7269 630d 0a20 2020  r to metric..   
-00020690: 2023 2020 2020 2020 2020 2069 6620 7372   #         if sr
-000206a0: 635f 6570 7367 203d 3d20 2234 3332 3622  c_epsg == "4326"
-000206b0: 3a0d 0a20 2020 2023 2020 2020 2020 2020  :..    #        
-000206c0: 2020 2020 2063 6f6f 7264 735f 3120 3d20       coords_1 = 
-000206d0: 2873 7263 5f67 745b 335d 2c20 7372 635f  (src_gt[3], src_
-000206e0: 6774 5b30 5d29 0d0a 2020 2020 2320 2020  gt[0])..    #   
-000206f0: 2020 2020 2020 2020 2020 636f 6f72 6473            coords
-00020700: 5f32 203d 2028 7372 635f 6774 5b33 5d2c  _2 = (src_gt[3],
-00020710: 2073 7263 5f67 745b 305d 202b 2073 7263   src_gt[0] + src
-00020720: 5f67 745b 315d 290d 0a20 2020 2023 2020  _gt[1])..    #  
-00020730: 2020 2020 2020 2020 2020 2023 2020 2020             #    
-00020740: 2020 2020 2020 2020 7069 7865 6c5f 7370          pixel_sp
-00020750: 6163 696e 673d 6765 6f70 792e 6469 7374  acing=geopy.dist
-00020760: 616e 6365 2e76 696e 6365 6e74 7928 636f  ance.vincenty(co
-00020770: 6f72 6473 5f31 2c20 636f 6f72 6473 5f32  ords_1, coords_2
-00020780: 292e 6d0d 0a20 2020 2023 2020 2020 2020  ).m..    #      
-00020790: 2020 2020 2020 2070 6978 656c 5f73 7061         pixel_spa
-000207a0: 6369 6e67 203d 2046 6561 7475 7265 436f  cing = FeatureCo
-000207b0: 6c6c 6563 7469 6f6e 2e47 4353 4469 7374  llection.GCSDist
-000207c0: 616e 6365 2863 6f6f 7264 735f 312c 2063  ance(coords_1, c
-000207d0: 6f6f 7264 735f 3229 0d0a 2020 2020 2320  oords_2)..    # 
-000207e0: 2020 2020 2020 2020 656c 7365 3a0d 0a20          else:.. 
-000207f0: 2020 2023 2020 2020 2020 2020 2020 2020     #            
-00020800: 2070 6978 656c 5f73 7061 6369 6e67 203d   pixel_spacing =
-00020810: 2073 7263 5f67 745b 315d 0d0a 2020 2020   src_gt[1]..    
-00020820: 2320 2020 2020 656c 7365 3a0d 0a20 2020  #     else:..   
-00020830: 2023 2020 2020 2020 2020 2023 2069 6620   #         # if 
-00020840: 7372 635f 6570 7367 2e47 6574 4174 7472  src_epsg.GetAttr
-00020850: 5661 6c75 6528 2741 5554 484f 5249 5459  Value('AUTHORITY
-00020860: 272c 2031 2920 213d 2022 3433 3236 223a  ', 1) != "4326":
-00020870: 0d0a 2020 2020 2320 2020 2020 2020 2020  ..    #         
-00020880: 2320 2020 2020 6173 7365 7274 2028 6365  #     assert (ce
-00020890: 6c6c 5f73 697a 6520 3e20 3129 2c20 2270  ll_size > 1), "p
-000208a0: 6c65 6173 6520 656e 7465 7220 6365 6c6c  lease enter cell
-000208b0: 2073 697a 6520 6772 6561 7465 7220 7468   size greater th
-000208c0: 616e 2031 220d 0a20 2020 2023 2020 2020  an 1"..    #    
-000208d0: 2020 2020 2023 2069 6620 7468 6520 7573       # if the us
-000208e0: 6572 2069 6e70 7574 2061 2063 656c 6c20  er input a cell 
-000208f0: 7369 7a65 2072 6573 616d 706c 6520 7468  size resample th
-00020900: 6520 7261 7374 6572 0d0a 2020 2020 2320  e raster..    # 
-00020910: 2020 2020 2020 2020 7069 7865 6c5f 7370          pixel_sp
-00020920: 6163 696e 6720 3d20 6365 6c6c 5f73 697a  acing = cell_siz
-00020930: 650d 0a20 2020 2023 0d0a 2020 2020 2320  e..    #..    # 
-00020940: 2020 2020 2320 6372 6561 7465 2061 206e      # create a n
-00020950: 6577 2072 6173 7465 720d 0a20 2020 2023  ew raster..    #
-00020960: 2020 2020 2063 6f6c 7320 3d20 696e 7428       cols = int(
-00020970: 6e70 2e72 6f75 6e64 2861 6273 286c 7278  np.round(abs(lrx
-00020980: 202d 2075 6c78 2920 2f20 7069 7865 6c5f   - ulx) / pixel_
-00020990: 7370 6163 696e 6729 290d 0a20 2020 2023  spacing))..    #
-000209a0: 2020 2020 2072 6f77 7320 3d20 696e 7428       rows = int(
-000209b0: 6e70 2e72 6f75 6e64 2861 6273 2875 6c79  np.round(abs(uly
-000209c0: 202d 206c 7279 2920 2f20 7069 7865 6c5f   - lry) / pixel_
-000209d0: 7370 6163 696e 6729 290d 0a20 2020 2023  spacing))..    #
-000209e0: 2020 2020 2064 7374 203d 2044 6174 6173       dst = Datas
-000209f0: 6574 2e5f 6372 6561 7465 5f64 6174 6173  et._create_datas
-00020a00: 6574 2863 6f6c 732c 2072 6f77 732c 2031  et(cols, rows, 1
-00020a10: 2c20 6474 7970 652c 2064 7269 7665 723d  , dtype, driver=
-00020a20: 224d 454d 2229 0d0a 2020 2020 230d 0a20  "MEM")..    #.. 
-00020a30: 2020 2023 2020 2020 2023 206e 6577 2067     #     # new g
-00020a40: 656f 7472 616e 7366 6f72 6d0d 0a20 2020  eotransform..   
-00020a50: 2023 2020 2020 206e 6577 5f67 656f 203d   #     new_geo =
-00020a60: 2028 756c 782c 2070 6978 656c 5f73 7061   (ulx, pixel_spa
-00020a70: 6369 6e67 2c20 7372 635f 6774 5b32 5d2c  cing, src_gt[2],
-00020a80: 2075 6c79 2c20 7372 635f 6774 5b34 5d2c   uly, src_gt[4],
-00020a90: 202d 7069 7865 6c5f 7370 6163 696e 6729   -pixel_spacing)
-00020aa0: 0d0a 2020 2020 2320 2020 2020 2320 7365  ..    #     # se
-00020ab0: 7420 7468 6520 6765 6f74 7261 6e73 666f  t the geotransfo
-00020ac0: 726d 0d0a 2020 2020 2320 2020 2020 6473  rm..    #     ds
-00020ad0: 742e 5365 7447 656f 5472 616e 7366 6f72  t.SetGeoTransfor
-00020ae0: 6d28 6e65 775f 6765 6f29 0d0a 2020 2020  m(new_geo)..    
-00020af0: 2320 2020 2020 2320 7365 7420 7468 6520  #     # set the 
-00020b00: 7072 6f6a 6563 7469 6f6e 0d0a 2020 2020  projection..    
-00020b10: 2320 2020 2020 6473 742e 5365 7450 726f  #     dst.SetPro
-00020b20: 6a65 6374 696f 6e28 6473 745f 6570 7367  jection(dst_epsg
-00020b30: 2e45 7870 6f72 7454 6f57 6b74 2829 290d  .ExportToWkt()).
-00020b40: 0a20 2020 2023 2020 2020 2023 2073 6574  .    #     # set
-00020b50: 2074 6865 206e 6f20 6461 7461 2076 616c   the no data val
-00020b60: 7565 0d0a 2020 2020 2320 2020 2020 6e6f  ue..    #     no
-00020b70: 5f64 6174 615f 7661 6c75 6520 3d20 7372  _data_value = sr
-00020b80: 632e 4765 7452 6173 7465 7242 616e 6428  c.GetRasterBand(
-00020b90: 3129 2e47 6574 4e6f 4461 7461 5661 6c75  1).GetNoDataValu
-00020ba0: 6528 290d 0a20 2020 2023 2020 2020 2064  e()..    #     d
-00020bb0: 7374 203d 2044 6174 6173 6574 2e5f 7365  st = Dataset._se
-00020bc0: 745f 6e6f 5f64 6174 615f 7661 6c75 6528  t_no_data_value(
-00020bd0: 6473 742c 206e 6f5f 6461 7461 5f76 616c  dst, no_data_val
-00020be0: 7565 290d 0a20 2020 2023 2020 2020 2023  ue)..    #     #
-00020bf0: 2070 6572 666f 726d 2074 6865 2070 726f   perform the pro
-00020c00: 6a65 6374 696f 6e20 2620 7265 7361 6d70  jection & resamp
-00020c10: 6c69 6e67 0d0a 2020 2020 2320 2020 2020  ling..    #     
-00020c20: 6764 616c 2e52 6570 726f 6a65 6374 496d  gdal.ReprojectIm
-00020c30: 6167 6528 0d0a 2020 2020 2320 2020 2020  age(..    #     
-00020c40: 2020 2020 7372 632c 2064 7374 2c20 7372      src, dst, sr
-00020c50: 635f 7372 2e45 7870 6f72 7454 6f57 6b74  c_sr.ExportToWkt
-00020c60: 2829 2c20 6473 745f 6570 7367 2e45 7870  (), dst_epsg.Exp
-00020c70: 6f72 7454 6f57 6b74 2829 2c20 6d65 7468  ortToWkt(), meth
-00020c80: 6f64 0d0a 2020 2020 2320 2020 2020 290d  od..    #     ).
-00020c90: 0a20 2020 2023 0d0a 2020 2020 2320 2020  .    #..    #   
-00020ca0: 2020 7265 7475 726e 2064 7374 0d0a 0d0a    return dst....
-00020cb0: 2020 2020 6465 6620 616c 6967 6e28 7365      def align(se
-00020cc0: 6c66 2c20 616c 6967 6e6d 656e 745f 7372  lf, alignment_sr
-00020cd0: 633a 2044 6174 6173 6574 293a 0d0a 2020  c: Dataset):..  
-00020ce0: 2020 2020 2020 2222 226d 6174 6368 4461        """matchDa
-00020cf0: 7461 416c 6967 6e6d 656e 742e 0d0a 0d0a  taAlignment.....
-00020d00: 2020 2020 2020 2020 7468 6973 2066 756e          this fun
-00020d10: 6374 696f 6e20 6d61 7463 6865 7320 7468  ction matches th
-00020d20: 6520 636f 6f72 6469 6e61 7465 2073 7973  e coordinate sys
-00020d30: 7465 6d20 616e 6420 7468 6520 6e75 6d62  tem and the numb
-00020d40: 6572 206f 6620 6f66 2072 6f77 7320 2620  er of of rows & 
-00020d50: 636f 6c75 6d6e 730d 0a20 2020 2020 2020  columns..       
-00020d60: 2062 6574 7765 656e 2074 776f 2072 6173   between two ras
-00020d70: 7465 7273 0d0a 2020 2020 2020 2020 5261  ters..        Ra
-00020d80: 7374 6572 2041 2069 7320 7468 6520 736f  ster A is the so
-00020d90: 7572 6365 206f 6620 7468 6520 636f 6f72  urce of the coor
-00020da0: 6469 6e61 7465 2073 7973 7465 6d2c 206e  dinate system, n
-00020db0: 6f20 6f66 2072 6f77 7320 616e 6420 6e6f  o of rows and no
-00020dc0: 206f 6620 636f 6c75 6d6e 7320 2620 6365   of columns & ce
-00020dd0: 6c6c 2073 697a 650d 0a20 2020 2020 2020  ll size..       
-00020de0: 2072 6173 7465 7273 5f64 6972 2069 7320   rasters_dir is 
-00020df0: 7061 7468 2074 6f20 7468 6520 666f 6c64  path to the fold
-00020e00: 6572 2077 6865 7265 2052 6173 7465 7220  er where Raster 
-00020e10: 4220 6578 6973 7420 7768 6572 6520 2052  B exist where  R
-00020e20: 6173 7465 7220 4220 6973 0d0a 2020 2020  aster B is..    
-00020e30: 2020 2020 7468 6520 736f 7572 6365 206f      the source o
-00020e40: 6620 6461 7461 2076 616c 7565 7320 696e  f data values in
-00020e50: 2063 656c 6c73 0d0a 2020 2020 2020 2020   cells..        
-00020e60: 7468 6520 7265 7375 6c74 2077 696c 6c20  the result will 
-00020e70: 6265 2061 2072 6173 7465 7220 7769 7468  be a raster with
-00020e80: 2074 6865 2073 616d 6520 7374 7275 6374   the same struct
-00020e90: 7572 6520 6c69 6b65 2052 6173 7465 7241  ure like RasterA
-00020ea0: 2062 7574 2077 6974 680d 0a20 2020 2020   but with..     
-00020eb0: 2020 2076 616c 7565 7320 6672 6f6d 2052     values from R
-00020ec0: 6173 7465 7242 2075 7369 6e67 204e 6561  asterB using Nea
-00020ed0: 7265 7374 204e 6569 6768 626f 7572 2069  rest Neighbour i
-00020ee0: 6e74 6572 706f 6c61 7469 6f6e 2061 6c67  nterpolation alg
-00020ef0: 6f72 6974 686d 0d0a 0d0a 2020 2020 2020  orithm....      
-00020f00: 2020 5061 7261 6d65 7465 7273 0d0a 2020    Parameters..  
-00020f10: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
-00020f20: 0d0a 2020 2020 2020 2020 616c 6967 6e6d  ..        alignm
-00020f30: 656e 745f 7372 633a 205b 5374 7269 6e67  ent_src: [String
-00020f40: 5d0d 0a20 2020 2020 2020 2020 2020 2070  ]..            p
-00020f50: 6174 6820 746f 2074 6865 2073 7061 7469  ath to the spati
-00020f60: 616c 2069 6e66 6f72 6d61 7469 6f6e 2073  al information s
-00020f70: 6f75 7263 6520 7261 7374 6572 2074 6f20  ource raster to 
-00020f80: 6765 7420 7468 6520 7370 6174 6961 6c20  get the spatial 
-00020f90: 696e 666f 726d 6174 696f 6e0d 0a20 2020  information..   
-00020fa0: 2020 2020 2020 2020 2028 636f 6f72 6469           (coordi
-00020fb0: 6e61 7465 2073 7973 7465 6d2c 206e 6f20  nate system, no 
-00020fc0: 6f66 2072 6f77 7320 2620 636f 6c75 6d6e  of rows & column
-00020fd0: 7329 2061 6c69 676e 6d65 6e74 5f73 7263  s) alignment_src
-00020fe0: 2073 686f 756c 6420 696e 636c 7564 6520   should include 
-00020ff0: 7468 6520 6e61 6d65 206f 6620 7468 6520  the name of the 
-00021000: 7261 7374 6572 0d0a 2020 2020 2020 2020  raster..        
-00021010: 2020 2020 616e 6420 7468 6520 6578 7465      and the exte
-00021020: 6e73 696f 6e20 6c69 6b65 2022 6461 7461  nsion like "data
-00021030: 2f64 656d 2e74 6966 220d 0a0d 0a20 2020  /dem.tif"....   
-00021040: 2020 2020 2052 6574 7572 6e73 0d0a 2020       Returns..  
-00021050: 2020 2020 2020 2d2d 2d2d 2d2d 2d0d 0a20        -------.. 
-00021060: 2020 2020 2020 206e 6577 2072 6173 7465         new raste
-00021070: 7273 3a0d 0a20 2020 2020 2020 2020 2020  rs:..           
-00021080: 20d9 8c52 6173 7465 7273 2068 6176 6520   ..Rasters have 
-00021090: 7468 6520 7661 6c75 6573 2066 726f 6d20  the values from 
-000210a0: 7261 7374 6572 7320 696e 2072 6173 7465  rasters in raste
-000210b0: 7273 5f64 6972 2077 6974 6820 7468 6520  rs_dir with the 
-000210c0: 7361 6d65 0d0a 2020 2020 2020 2020 2020  same..          
-000210d0: 2020 6365 6c6c 2073 697a 652c 206e 6f20    cell size, no 
-000210e0: 6f66 2072 6f77 7320 2620 636f 6c75 6d6e  of rows & column
-000210f0: 732c 2063 6f6f 7264 696e 6174 6520 7379  s, coordinate sy
-00021100: 7374 656d 2061 6e64 2061 6c69 676e 6d65  stem and alignme
-00021110: 6e74 206c 696b 6520 7261 7374 6572 2041  nt like raster A
-00021120: 0d0a 0d0a 2020 2020 2020 2020 4578 616d  ....        Exam
-00021130: 706c 6573 0d0a 2020 2020 2020 2020 2d2d  ples..        --
-00021140: 2d2d 2d2d 2d2d 0d0a 2020 2020 2020 2020  ------..        
-00021150: 3e3e 3e20 6465 6d5f 7061 7468 203d 2022  >>> dem_path = "
-00021160: 3031 4749 532f 696e 7075 7473 2f34 3030  01GIS/inputs/400
-00021170: 302f 6163 6334 3030 302e 7469 6622 0d0a  0/acc4000.tif"..
-00021180: 2020 2020 2020 2020 3e3e 3e20 7072 6563          >>> prec
-00021190: 5f69 6e5f 7061 7468 203d 2022 3032 5072  _in_path = "02Pr
-000211a0: 6563 6970 6974 6174 696f 6e2f 4348 4952  ecipitation/CHIR
-000211b0: 5053 2f44 6169 6c79 2f22 0d0a 2020 2020  PS/Daily/"..    
-000211c0: 2020 2020 3e3e 3e20 7072 6563 5f6f 7574      >>> prec_out
-000211d0: 5f70 6174 6820 3d20 2230 3250 7265 6369  _path = "02Preci
-000211e0: 7069 7461 7469 6f6e 2f34 6b6d 2f22 0d0a  pitation/4km/"..
-000211f0: 2020 2020 2020 2020 3e3e 3e20 4461 7461          >>> Data
-00021200: 7365 742e 616c 6967 6e28 6465 6d5f 7061  set.align(dem_pa
-00021210: 7468 2c70 7265 635f 696e 5f70 6174 682c  th,prec_in_path,
-00021220: 7072 6563 5f6f 7574 5f70 6174 6829 0d0a  prec_out_path)..
-00021230: 2020 2020 2020 2020 2222 220d 0a20 2020          """..   
-00021240: 2020 2020 2069 6620 6e6f 7420 6973 696e       if not isin
-00021250: 7374 616e 6365 2861 6c69 676e 6d65 6e74  stance(alignment
-00021260: 5f73 7263 2c20 4461 7461 7365 7429 3a0d  _src, Dataset):.
-00021270: 0a20 2020 2020 2020 2020 2020 2072 6169  .            rai
-00021280: 7365 2054 7970 6545 7272 6f72 2822 616c  se TypeError("al
-00021290: 6967 6e6d 656e 745f 7372 6320 696e 7075  ignment_src inpu
-000212a0: 7420 7368 6f75 6c64 2062 6520 6120 4461  t should be a Da
-000212b0: 7461 7365 7420 6f62 6a65 6374 2229 0d0a  taset object")..
-000212c0: 0d0a 2020 2020 2020 2020 666f 7220 6920  ..        for i 
-000212d0: 696e 2072 616e 6765 2873 656c 662e 7469  in range(self.ti
-000212e0: 6d65 5f6c 656e 6774 6829 3a0d 0a20 2020  me_length):..   
-000212f0: 2020 2020 2020 2020 2073 7263 203d 2073           src = s
-00021300: 656c 662e 696c 6f63 2869 290d 0a20 2020  elf.iloc(i)..   
-00021310: 2020 2020 2020 2020 2064 7374 203d 2073           dst = s
-00021320: 7263 2e61 6c69 676e 2861 6c69 676e 6d65  rc.align(alignme
-00021330: 6e74 5f73 7263 290d 0a20 2020 2020 2020  nt_src)..       
-00021340: 2020 2020 2061 7272 203d 2064 7374 2e72       arr = dst.r
-00021350: 6561 645f 6172 7261 7928 290d 0a20 2020  ead_array()..   
-00021360: 2020 2020 2020 2020 2069 6620 6920 3d3d           if i ==
-00021370: 2030 3a0d 0a20 2020 2020 2020 2020 2020   0:..           
-00021380: 2020 2020 2023 2063 7265 6174 6520 7468       # create th
-00021390: 6520 6172 7261 790d 0a20 2020 2020 2020  e array..       
-000213a0: 2020 2020 2020 2020 2061 7272 6179 203d           array =
-000213b0: 2028 0d0a 2020 2020 2020 2020 2020 2020   (..            
-000213c0: 2020 2020 2020 2020 6e70 2e6f 6e65 7328          np.ones(
-000213d0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000213e0: 2020 2020 2020 2020 2020 280d 0a20 2020            (..   
-000213f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021400: 2020 2020 2020 2020 2073 656c 662e 7469           self.ti
-00021410: 6d65 5f6c 656e 6774 682c 0d0a 2020 2020  me_length,..    
-00021420: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021430: 2020 2020 2020 2020 6172 722e 7368 6170          arr.shap
-00021440: 655b 305d 2c0d 0a20 2020 2020 2020 2020  e[0],..         
-00021450: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021460: 2020 2061 7272 2e73 6861 7065 5b31 5d2c     arr.shape[1],
-00021470: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-00021480: 2020 2020 2020 2020 2020 290d 0a20 2020            )..   
-00021490: 2020 2020 2020 2020 2020 2020 2020 2020                  
-000214a0: 2029 0d0a 2020 2020 2020 2020 2020 2020   )..            
-000214b0: 2020 2020 2020 2020 2a20 6e70 2e6e 616e          * np.nan
-000214c0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
-000214d0: 2020 290d 0a20 2020 2020 2020 2020 2020    )..           
-000214e0: 2061 7272 6179 5b69 2c20 3a2c 203a 5d20   array[i, :, :] 
-000214f0: 3d20 6172 720d 0a0d 0a20 2020 2020 2020  = arr....       
-00021500: 2073 656c 662e 5f64 6174 6120 3d20 6172   self._data = ar
-00021510: 7261 790d 0a20 2020 2020 2020 2023 2075  ray..        # u
-00021520: 7365 2074 6865 206c 6173 7420 7372 6320  se the last src 
-00021530: 6173 0d0a 2020 2020 2020 2020 7365 6c66  as..        self
-00021540: 2e5f 6261 7365 203d 2064 7374 0d0a 0d0a  ._base = dst....
-00021550: 2020 2020 4073 7461 7469 636d 6574 686f      @staticmetho
-00021560: 640d 0a20 2020 2064 6566 206d 6572 6765  d..    def merge
-00021570: 280d 0a20 2020 2020 2020 2073 7263 3a20  (..        src: 
-00021580: 4c69 7374 5b73 7472 5d2c 0d0a 2020 2020  List[str],..    
-00021590: 2020 2020 6473 743a 2073 7472 2c0d 0a20      dst: str,.. 
-000215a0: 2020 2020 2020 206e 6f5f 6461 7461 5f76         no_data_v
-000215b0: 616c 7565 3a20 556e 696f 6e5b 666c 6f61  alue: Union[floa
-000215c0: 742c 2069 6e74 2c20 7374 725d 203d 2022  t, int, str] = "
-000215d0: 3022 2c0d 0a20 2020 2020 2020 2069 6e69  0",..        ini
-000215e0: 743a 2055 6e69 6f6e 5b66 6c6f 6174 2c20  t: Union[float, 
-000215f0: 696e 742c 2073 7472 5d20 3d20 226e 616e  int, str] = "nan
-00021600: 222c 0d0a 2020 2020 2020 2020 6e3a 2055  ",..        n: U
-00021610: 6e69 6f6e 5b66 6c6f 6174 2c20 696e 742c  nion[float, int,
-00021620: 2073 7472 5d20 3d20 226e 616e 222c 0d0a   str] = "nan",..
-00021630: 2020 2020 293a 0d0a 2020 2020 2020 2020      ):..        
-00021640: 2222 226d 6572 6765 2e0d 0a0d 0a20 2020  """merge.....   
-00021650: 2020 2020 2020 2020 206d 6572 6765 7320           merges 
-00021660: 6772 6f75 7020 6f66 2072 6173 7465 7273  group of rasters
-00021670: 2069 6e74 6f20 6f6e 6520 7261 7374 6572   into one raster
-00021680: 0d0a 0d0a 2020 2020 2020 2020 5061 7261  ....        Para
-00021690: 6d65 7465 7273 0d0a 2020 2020 2020 2020  meters..        
-000216a0: 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020  ----------..    
-000216b0: 2020 2020 7372 633a 204c 6973 745b 7374      src: List[st
-000216c0: 725d 0d0a 2020 2020 2020 2020 2020 2020  r]..            
-000216d0: 6c69 7374 206f 6620 7468 6520 7061 7468  list of the path
-000216e0: 2074 6f20 616c 6c20 696e 7075 7420 7261   to all input ra
-000216f0: 7374 6572 0d0a 2020 2020 2020 2020 6473  ster..        ds
-00021700: 743a 205b 7374 725d 0d0a 2020 2020 2020  t: [str]..      
-00021710: 2020 2020 2020 7061 7468 2074 6f20 7468        path to th
-00021720: 6520 6f75 7470 7574 2072 6173 7465 720d  e output raster.
-00021730: 0a20 2020 2020 2020 206e 6f5f 6461 7461  .        no_data
-00021740: 5f76 616c 7565 3a20 5b66 6c6f 6174 2f69  _value: [float/i
-00021750: 6e74 5d0d 0a20 2020 2020 2020 2020 2020  nt]..           
-00021760: 2041 7373 6967 6e20 6120 7370 6563 6966   Assign a specif
-00021770: 6965 6420 6e6f 6461 7461 2076 616c 7565  ied nodata value
-00021780: 2074 6f20 6f75 7470 7574 2062 616e 6473   to output bands
-00021790: 2e0d 0a20 2020 2020 2020 2069 6e69 743a  ...        init:
-000217a0: 205b 666c 6f61 742f 696e 745d 0d0a 2020   [float/int]..  
-000217b0: 2020 2020 2020 2020 2020 5072 652d 696e            Pre-in
-000217c0: 6974 6961 6c69 7a65 2074 6865 206f 7574  itialize the out
-000217d0: 7075 7420 696d 6167 6520 6261 6e64 7320  put image bands 
-000217e0: 7769 7468 2074 6865 7365 2076 616c 7565  with these value
-000217f0: 732e 2048 6f77 6576 6572 2c20 6974 2069  s. However, it i
-00021800: 7320 6e6f 7420 6d61 726b 6564 2061 7320  s not marked as 
-00021810: 7468 6520 6e6f 6461 7461 2076 616c 7565  the nodata value
-00021820: 0d0a 2020 2020 2020 2020 2020 2020 696e  ..            in
-00021830: 2074 6865 206f 7574 7075 7420 6669 6c65   the output file
-00021840: 2e20 4966 206f 6e6c 7920 6f6e 6520 7661  . If only one va
-00021850: 6c75 6520 6973 2067 6976 656e 2c20 7468  lue is given, th
-00021860: 6520 7361 6d65 2076 616c 7565 2069 7320  e same value is 
-00021870: 7573 6564 2069 6e20 616c 6c20 7468 6520  used in all the 
-00021880: 6261 6e64 732e 0d0a 2020 2020 2020 2020  bands...        
-00021890: 6e3a 205b 666c 6f61 742f 696e 745d 0d0a  n: [float/int]..
-000218a0: 2020 2020 2020 2020 2020 2020 4967 6e6f              Igno
-000218b0: 7265 2070 6978 656c 7320 6672 6f6d 2066  re pixels from f
-000218c0: 696c 6573 2062 6569 6e67 206d 6572 6765  iles being merge
-000218d0: 6420 696e 2077 6974 6820 7468 6973 2070  d in with this p
-000218e0: 6978 656c 2076 616c 7565 2e0d 0a0d 0a20  ixel value..... 
-000218f0: 2020 2020 2020 2052 6574 7572 6e73 0d0a         Returns..
-00021900: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d0d          -------.
-00021910: 0a20 2020 2020 2020 204e 6f6e 650d 0a20  .        None.. 
-00021920: 2020 2020 2020 2022 2222 0d0a 2020 2020         """..    
-00021930: 2020 2020 2320 7275 6e20 7468 6520 636f      # run the co
-00021940: 6d6d 616e 640d 0a20 2020 2020 2020 2023  mmand..        #
-00021950: 2063 6d64 203d 2022 6764 616c 5f6d 6572   cmd = "gdal_mer
-00021960: 6765 2e70 7920 2d6f 206d 6572 6765 645f  ge.py -o merged_
-00021970: 696d 6167 655f 312e 7469 6622 0d0a 2020  image_1.tif"..  
-00021980: 2020 2020 2020 2320 7375 6270 726f 6365        # subproce
-00021990: 7373 2e63 616c 6c28 636d 642e 7370 6c69  ss.call(cmd.spli
-000219a0: 7428 2920 2b20 6669 6c65 5f6c 6973 7429  t() + file_list)
-000219b0: 0d0a 2020 2020 2020 2020 2320 7672 7420  ..        # vrt 
-000219c0: 3d20 6764 616c 2e42 7569 6c64 5652 5428  = gdal.BuildVRT(
-000219d0: 226d 6572 6765 642e 7672 7422 2c20 6669  "merged.vrt", fi
-000219e0: 6c65 5f6c 6973 7429 0d0a 2020 2020 2020  le_list)..      
-000219f0: 2020 2320 7372 6320 3d20 6764 616c 2e54    # src = gdal.T
-00021a00: 7261 6e73 6c61 7465 2822 6d65 7267 6564  ranslate("merged
-00021a10: 5f69 6d61 6765 2e74 6966 222c 2076 7274  _image.tif", vrt
-00021a20: 290d 0a0d 0a20 2020 2020 2020 2070 6172  )....        par
-00021a30: 616d 6574 6572 7320 3d20 280d 0a20 2020  ameters = (..   
-00021a40: 2020 2020 2020 2020 205b 2222 2c20 222d           ["", "-
-00021a50: 6f22 2c20 6473 745d 0d0a 2020 2020 2020  o", dst]..      
-00021a60: 2020 2020 2020 2b20 7372 630d 0a20 2020        + src..   
-00021a70: 2020 2020 2020 2020 202b 205b 0d0a 2020           + [..  
-00021a80: 2020 2020 2020 2020 2020 2020 2020 222d                "-
-00021a90: 636f 222c 0d0a 2020 2020 2020 2020 2020  co",..          
-00021aa0: 2020 2020 2020 2243 4f4d 5052 4553 533d        "COMPRESS=
-00021ab0: 4c5a 5722 2c0d 0a20 2020 2020 2020 2020  LZW",..         
-00021ac0: 2020 2020 2020 2022 2d69 6e69 7422 2c0d         "-init",.
-00021ad0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-00021ae0: 2073 7472 2869 6e69 7429 2c0d 0a20 2020   str(init),..   
-00021af0: 2020 2020 2020 2020 2020 2020 2022 2d61               "-a
-00021b00: 5f6e 6f64 6174 6122 2c0d 0a20 2020 2020  _nodata",..     
-00021b10: 2020 2020 2020 2020 2020 2073 7472 286e             str(n
-00021b20: 6f5f 6461 7461 5f76 616c 7565 292c 0d0a  o_data_value),..
-00021b30: 2020 2020 2020 2020 2020 2020 2020 2020                  
-00021b40: 222d 6e22 2c0d 0a20 2020 2020 2020 2020  "-n",..         
-00021b50: 2020 2020 2020 2073 7472 286e 292c 0d0a         str(n),..
-00021b60: 2020 2020 2020 2020 2020 2020 5d0d 0a20              ].. 
-00021b70: 2020 2020 2020 2029 2020 2320 272d 7365         )  # '-se
-00021b80: 7061 7261 7465 270d 0a20 2020 2020 2020  parate'..       
-00021b90: 2067 6461 6c5f 6d65 7267 652e 6d61 696e   gdal_merge.main
-00021ba0: 2870 6172 616d 6574 6572 7329 0d0a 0d0a  (parameters)....
-00021bb0: 2020 2020 6465 6620 6170 706c 7928 7365      def apply(se
-00021bc0: 6c66 2c20 7566 756e 633a 2043 616c 6c61  lf, ufunc: Calla
-00021bd0: 626c 6529 3a0d 0a20 2020 2020 2020 2022  ble):..        "
-00021be0: 2222 666f 6c64 6572 4361 6c63 756c 6174  ""folderCalculat
-00021bf0: 6f72 2e0d 0a0d 0a20 2020 2020 2020 2074  or.....        t
-00021c00: 6869 7320 6675 6e63 7469 6f6e 206d 6174  his function mat
-00021c10: 6368 6573 2074 6865 206c 6f63 6174 696f  ches the locatio
-00021c20: 6e20 6f66 206e 6f64 6174 6120 7661 6c75  n of nodata valu
-00021c30: 6520 6672 6f6d 2073 7263 2072 6173 7465  e from src raste
-00021c40: 7220 746f 2064 7374 0d0a 2020 2020 2020  r to dst..      
-00021c50: 2020 7261 7374 6572 0d0a 2020 2020 2020    raster..      
-00021c60: 2020 4461 7461 7365 7420 4120 6973 2077    Dataset A is w
-00021c70: 6865 7265 2074 6865 204e 6f44 6174 6176  here the NoDatav
-00021c80: 616c 7565 2077 696c 6c20 6265 2074 616b  alue will be tak
-00021c90: 656e 2061 6e64 2074 6865 206c 6f63 6174  en and the locat
-00021ca0: 696f 6e20 6f66 2074 6869 7320 7661 6c75  ion of this valu
-00021cb0: 650d 0a20 2020 2020 2020 2042 5f69 6e70  e..        B_inp
-00021cc0: 7574 5f70 6174 6820 6973 2070 6174 6820  ut_path is path 
-00021cd0: 746f 2074 6865 2066 6f6c 6465 7220 7768  to the folder wh
-00021ce0: 6572 6520 4461 7461 7365 7420 4220 6578  ere Dataset B ex
-00021cf0: 6973 7420 7768 6572 6520 2077 6520 6e65  ist where  we ne
-00021d00: 6564 2074 6f20 7075 740d 0a20 2020 2020  ed to put..     
-00021d10: 2020 2074 6865 204e 6f44 6174 6156 616c     the NoDataVal
-00021d20: 7565 206f 6620 5261 7374 6572 4120 696e  ue of RasterA in
-00021d30: 2052 6173 7465 7242 2061 7420 7468 6520   RasterB at the 
-00021d40: 7361 6d65 206c 6f63 6174 696f 6e73 0d0a  same locations..
-00021d50: 0d0a 2020 2020 2020 2020 5061 7261 6d65  ..        Parame
-00021d60: 7465 7273 0d0a 2020 2020 2020 2020 2d2d  ters..        --
-00021d70: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020  --------..      
-00021d80: 2020 7566 756e 633a 205b 6675 6e63 7469    ufunc: [functi
-00021d90: 6f6e 5d0d 0a20 2020 2020 2020 2020 2020  on]..           
-00021da0: 2063 616c 6c61 626c 6520 756e 6976 6572   callable univer
-00021db0: 7361 6c20 6675 6e63 7469 6f6e 2075 6675  sal function ufu
-00021dc0: 6e63 2028 6275 696c 7469 6e20 6f72 2075  nc (builtin or u
-00021dd0: 7365 7220 6465 6669 6e65 6429 0d0a 2020  ser defined)..  
-00021de0: 2020 2020 2020 2020 2020 6874 7470 733a            https:
-00021df0: 2f2f 6e75 6d70 792e 6f72 672f 646f 632f  //numpy.org/doc/
-00021e00: 7374 6162 6c65 2f72 6566 6572 656e 6365  stable/reference
-00021e10: 2f75 6675 6e63 732e 6874 6d6c 0d0a 2020  /ufuncs.html..  
-00021e20: 2020 2020 2020 2020 2020 2d20 746f 2063            - to c
-00021e30: 7265 6174 6520 6120 7566 756e 6320 6672  reate a ufunc fr
-00021e40: 6f6d 2061 206e 6f72 6d61 6c20 6675 6e63  om a normal func
-00021e50: 7469 6f6e 2028 6874 7470 733a 2f2f 6e75  tion (https://nu
-00021e60: 6d70 792e 6f72 672f 646f 632f 7374 6162  mpy.org/doc/stab
-00021e70: 6c65 2f72 6566 6572 656e 6365 2f67 656e  le/reference/gen
-00021e80: 6572 6174 6564 2f6e 756d 7079 2e66 726f  erated/numpy.fro
-00021e90: 6d70 7966 756e 632e 6874 6d6c 290d 0a0d  mpyfunc.html)...
-00021ea0: 0a20 2020 2020 2020 2052 6574 7572 6e73  .        Returns
-00021eb0: 0d0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ..        ------
-00021ec0: 2d0d 0a20 2020 2020 2020 206e 6577 2072  -..        new r
-00021ed0: 6173 7465 7273 2077 696c 6c20 6265 2073  asters will be s
-00021ee0: 6176 6564 2074 6f20 7468 6520 7361 7665  aved to the save
-00021ef0: 5f74 6f0d 0a0d 0a20 2020 2020 2020 2045  _to....        E
-00021f00: 7861 6d70 6c65 730d 0a20 2020 2020 2020  xamples..       
-00021f10: 202d 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020   --------..     
-00021f20: 2020 203e 3e3e 2064 6566 2066 756e 6328     >>> def func(
-00021f30: 7661 6c29 3a0d 0a20 2020 2020 2020 203e  val):..        >
-00021f40: 3e3e 2020 2020 7265 7475 726e 2076 616c  >>    return val
-00021f50: 2532 0d0a 2020 2020 2020 2020 3e3e 3e20  %2..        >>> 
-00021f60: 7566 756e 6320 3d20 6e70 2e66 726f 6d70  ufunc = np.fromp
-00021f70: 7966 756e 6328 6675 6e63 2c20 312c 2031  yfunc(func, 1, 1
-00021f80: 290d 0a20 2020 2020 2020 203e 3e3e 2064  )..        >>> d
-00021f90: 6174 6173 6574 2e61 7070 6c79 2875 6675  ataset.apply(ufu
-00021fa0: 6e63 290d 0a20 2020 2020 2020 2022 2222  nc)..        """
-00021fb0: 0d0a 2020 2020 2020 2020 6966 206e 6f74  ..        if not
-00021fc0: 2063 616c 6c61 626c 6528 7566 756e 6329   callable(ufunc)
-00021fd0: 3a0d 0a20 2020 2020 2020 2020 2020 2072  :..            r
-00021fe0: 6169 7365 2054 7970 6545 7272 6f72 2822  aise TypeError("
-00021ff0: 7365 636f 6e64 2061 7267 756d 656e 7420  second argument 
-00022000: 7368 6f75 6c64 2062 6520 6120 6675 6e63  should be a func
-00022010: 7469 6f6e 2229 0d0a 2020 2020 2020 2020  tion")..        
-00022020: 6172 7220 3d20 7365 6c66 2e64 6174 610d  arr = self.data.
-00022030: 0a20 2020 2020 2020 206e 6f5f 6461 7461  .        no_data
-00022040: 5f76 616c 7565 203d 2073 656c 662e 6261  _value = self.ba
-00022050: 7365 2e6e 6f5f 6461 7461 5f76 616c 7565  se.no_data_value
-00022060: 5b30 5d0d 0a20 2020 2020 2020 2023 2065  [0]..        # e
-00022070: 7865 6375 7465 2074 6865 2066 756e 6374  xecute the funct
-00022080: 696f 6e20 6f6e 2065 6163 6820 7261 7374  ion on each rast
-00022090: 6572 0d0a 2020 2020 2020 2020 6172 725b  er..        arr[
-000220a0: 7e6e 702e 6973 636c 6f73 6528 6172 722c  ~np.isclose(arr,
-000220b0: 206e 6f5f 6461 7461 5f76 616c 7565 2c20   no_data_value, 
-000220c0: 7274 6f6c 3d30 2e30 3031 295d 203d 2075  rtol=0.001)] = u
-000220d0: 6675 6e63 280d 0a20 2020 2020 2020 2020  func(..         
-000220e0: 2020 2061 7272 5b7e 6e70 2e69 7363 6c6f     arr[~np.isclo
-000220f0: 7365 2861 7272 2c20 6e6f 5f64 6174 615f  se(arr, no_data_
-00022100: 7661 6c75 652c 2072 746f 6c3d 302e 3030  value, rtol=0.00
-00022110: 3129 5d0d 0a20 2020 2020 2020 2029 0d0a  1)]..        )..
-00022120: 0d0a 2020 2020 6465 6620 6f76 6572 6c61  ..    def overla
-00022130: 7928 0d0a 2020 2020 2020 2020 7365 6c66  y(..        self
-00022140: 2c0d 0a20 2020 2020 2020 2063 6c61 7373  ,..        class
-00022150: 6573 5f6d 6170 2c0d 0a20 2020 2020 2020  es_map,..       
-00022160: 2065 7863 6c75 6465 5f76 616c 7565 3a20   exclude_value: 
-00022170: 556e 696f 6e5b 666c 6f61 742c 2069 6e74  Union[float, int
-00022180: 5d20 3d20 4e6f 6e65 2c0d 0a20 2020 2029  ] = None,..    )
-00022190: 202d 3e20 4469 6374 5b4c 6973 745b 666c   -> Dict[List[fl
-000221a0: 6f61 745d 2c20 4c69 7374 5b66 6c6f 6174  oat], List[float
-000221b0: 5d5d 3a0d 0a20 2020 2020 2020 2022 2222  ]]:..        """
-000221c0: 7468 6973 2066 756e 6374 696f 6e20 6973  this function is
-000221d0: 2077 7269 7474 656e 2074 6f20 6578 7472   written to extr
-000221e0: 6163 7420 616e 6420 7265 7475 726e 2061  act and return a
-000221f0: 206c 6973 7420 6f66 2061 6c6c 2074 6865   list of all the
-00022200: 2076 616c 7565 7320 696e 2061 6e20 4153   values in an AS
-00022210: 4349 4920 6669 6c65 2e0d 0a0d 0a20 2020  CII file.....   
-00022220: 2020 2020 2050 6172 616d 6574 6572 730d       Parameters.
-00022230: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
-00022240: 2d2d 2d0d 0a20 2020 2020 2020 2063 6c61  ---..        cla
-00022250: 7373 6573 5f6d 6170 3a20 5b44 6174 6173  sses_map: [Datas
-00022260: 6574 5d0d 0a20 2020 2020 2020 2020 2020  et]..           
-00022270: 2044 6174 6173 6574 204f 626a 6563 7420   Dataset Object 
-00022280: 6670 7220 7468 6520 7261 7374 6572 2074  fpr the raster t
-00022290: 6861 7420 6861 7665 2063 6c61 7373 6573  hat have classes
-000222a0: 2079 6f75 2077 616e 7420 746f 206f 7665   you want to ove
-000222b0: 726c 6179 2077 6974 6820 7468 6520 7261  rlay with the ra
-000222c0: 7374 6572 2e0d 0a20 2020 2020 2020 2065  ster...        e
-000222d0: 7863 6c75 6465 5f76 616c 7565 3a20 5b4e  xclude_value: [N
-000222e0: 756d 6572 6963 5d0d 0a20 2020 2020 2020  umeric]..       
-000222f0: 2020 2020 2076 616c 7565 7320 796f 7520       values you 
-00022300: 7761 6e74 2074 6f20 6578 636c 7564 6520  want to exclude 
-00022310: 6672 6f6d 2065 7874 7261 6374 6564 2076  from extracted v
-00022320: 616c 7565 732e 0d0a 0d0a 2020 2020 2020  alues.....      
-00022330: 2020 5265 7475 726e 730d 0a20 2020 2020    Returns..     
-00022340: 2020 202d 2d2d 2d2d 2d2d 0d0a 2020 2020     -------..    
-00022350: 2020 2020 4469 6374 696f 6e61 7279 3a0d      Dictionary:.
-00022360: 0a20 2020 2020 2020 2020 2020 2064 6963  .            dic
-00022370: 746f 6e61 7279 2077 6974 6820 6120 6c69  tonary with a li
-00022380: 7374 206f 6620 7661 6c75 6573 2069 6e20  st of values in 
-00022390: 7468 6520 6261 7365 6d61 7020 6173 206b  the basemap as k
-000223a0: 6579 7320 616e 6420 666f 7220 6561 6368  eys and for each
-000223b0: 206b 6579 2061 206c 6973 7420 6f66 2061   key a list of a
-000223c0: 6c6c 2074 6865 2069 6e74 6572 7365 6374  ll the intersect
-000223d0: 6564 0d0a 2020 2020 2020 2020 2020 2020  ed..            
-000223e0: 7661 6c75 6573 2069 6e20 7468 6520 6d61  values in the ma
-000223f0: 7073 2066 726f 6d20 7468 6520 7061 7468  ps from the path
-00022400: 2e0d 0a20 2020 2020 2020 2022 2222 0d0a  ...        """..
-00022410: 2020 2020 2020 2020 7661 6c75 6573 203d          values =
-00022420: 207b 7d0d 0a20 2020 2020 2020 2066 6f72   {}..        for
-00022430: 2069 2069 6e20 7261 6e67 6528 7365 6c66   i in range(self
-00022440: 2e74 696d 655f 6c65 6e67 7468 293a 0d0a  .time_length):..
-00022450: 2020 2020 2020 2020 2020 2020 7372 6320              src 
-00022460: 3d20 7365 6c66 2e69 6c6f 6328 6929 0d0a  = self.iloc(i)..
-00022470: 2020 2020 2020 2020 2020 2020 6469 6374              dict
-00022480: 5f69 203d 2073 7263 2e6f 7665 726c 6179  _i = src.overlay
-00022490: 2863 6c61 7373 6573 5f6d 6170 2c20 6578  (classes_map, ex
-000224a0: 636c 7564 655f 7661 6c75 6529 0d0a 0d0a  clude_value)....
-000224b0: 2020 2020 2020 2020 2020 2020 2320 7468              # th
-000224c0: 6573 6520 6172 6520 7468 6520 6465 7374  ese are the dest
-000224d0: 696e 6374 2076 616c 7565 7320 6672 6f6d  inct values from
-000224e0: 2074 6865 2042 6173 654d 6170 2077 6869   the BaseMap whi
-000224f0: 6368 2061 7265 206b 6579 7320 696e 2074  ch are keys in t
-00022500: 6865 0d0a 2020 2020 2020 2020 2020 2020  he..            
-00022510: 2320 4578 7472 6163 7465 6456 616c 7565  # ExtractedValue
-00022520: 7369 2064 6963 7420 7769 7468 2065 6163  si dict with eac
-00022530: 6820 6f6e 6520 6861 7669 6e67 2061 206c  h one having a l
-00022540: 6973 7420 6f66 2076 616c 7565 730d 0a20  ist of values.. 
-00022550: 2020 2020 2020 2020 2020 2063 6c61 7373             class
-00022560: 6573 203d 206c 6973 7428 6469 6374 5f69  es = list(dict_i
-00022570: 2e6b 6579 7328 2929 0d0a 0d0a 2020 2020  .keys())....    
-00022580: 2020 2020 2020 2020 666f 7220 636c 6173          for clas
-00022590: 735f 6920 696e 2063 6c61 7373 6573 3a0d  s_i in classes:.
-000225a0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
-000225b0: 2069 6620 636c 6173 735f 6920 6e6f 7420   if class_i not 
-000225c0: 696e 2076 616c 7565 732e 6b65 7973 2829  in values.keys()
-000225d0: 3a0d 0a20 2020 2020 2020 2020 2020 2020  :..             
-000225e0: 2020 2020 2020 2076 616c 7565 735b 636c         values[cl
-000225f0: 6173 735f 695d 203d 206c 6973 7428 290d  ass_i] = list().
-00022600: 0a0d 0a20 2020 2020 2020 2020 2020 2020  ...             
-00022610: 2020 2076 616c 7565 735b 636c 6173 735f     values[class_
-00022620: 695d 203d 2076 616c 7565 735b 636c 6173  i] = values[clas
-00022630: 735f 695d 202b 2064 6963 745f 695b 636c  s_i] + dict_i[cl
-00022640: 6173 735f 695d 0d0a 0d0a 2020 2020 2020  ass_i]....      
-00022650: 2020 7265 7475 726e 2076 616c 7565 730d    return values.
-00022660: 0a0d 0a20 2020 2023 2040 7374 6174 6963  ...    # @static
-00022670: 6d65 7468 6f64 0d0a 2020 2020 2320 6465  method..    # de
-00022680: 6620 7265 6164 4e43 280d 0a20 2020 2023  f readNC(..    #
-00022690: 2020 2020 2020 2020 2070 6174 682c 0d0a           path,..
-000226a0: 2020 2020 2320 2020 2020 2020 2020 7361      #         sa
-000226b0: 7665 5f74 6f3a 2073 7472 2c0d 0a20 2020  ve_to: str,..   
-000226c0: 2023 2020 2020 2020 2020 2073 6570 6172   #         separ
-000226d0: 6174 6f72 3a20 7374 7220 3d20 225f 222c  ator: str = "_",
-000226e0: 0d0a 2020 2020 2320 2020 2020 2020 2020  ..    #         
-000226f0: 7469 6d65 5f76 6172 5f6e 616d 653a 2073  time_var_name: s
-00022700: 7472 203d 204e 6f6e 652c 0d0a 2020 2020  tr = None,..    
-00022710: 2320 2020 2020 2020 2020 7072 6566 6978  #         prefix
-00022720: 3a20 7374 7220 3d20 4e6f 6e65 2c0d 0a20  : str = None,.. 
-00022730: 2020 2023 2029 3a0d 0a20 2020 2023 0d0a     # ):..    #..
-00022740: 2020 2020 2320 2020 2020 6966 2069 7369      #     if isi
-00022750: 6e73 7461 6e63 6528 7061 7468 2c20 7374  nstance(path, st
-00022760: 7229 3a0d 0a20 2020 2023 2020 2020 2020  r):..    #      
-00022770: 2020 206e 6320 3d20 6e65 7443 4446 342e     nc = netCDF4.
-00022780: 4461 7461 6375 6265 2870 6174 6829 0d0a  Datacube(path)..
-00022790: 2020 2020 2320 2020 2020 656c 6966 2069      #     elif i
-000227a0: 7369 6e73 7461 6e63 6528 7061 7468 2c20  sinstance(path, 
-000227b0: 6c69 7374 293a 0d0a 2020 2020 2320 2020  list):..    #   
-000227c0: 2020 2020 2020 6e63 203d 206e 6574 4344        nc = netCD
-000227d0: 4634 2e4d 4644 6174 6173 6574 2870 6174  F4.MFDataset(pat
-000227e0: 6829 0d0a 2020 2020 2320 2020 2020 656c  h)..    #     el
-000227f0: 7365 3a0d 0a20 2020 2023 2020 2020 2020  se:..    #      
-00022800: 2020 2072 6169 7365 2054 7970 6545 7272     raise TypeErr
-00022810: 6f72 280d 0a20 2020 2023 2020 2020 2020  or(..    #      
-00022820: 2020 2020 2020 2022 4669 7273 7420 7061         "First pa
-00022830: 7261 6d65 7465 7220 746f 2074 6865 206e  rameter to the n
-00022840: 6374 6f54 6966 6620 6675 6e63 7469 6f6e  ctoTiff function
-00022850: 2073 686f 756c 6420 6265 2065 6974 6865   should be eithe
-00022860: 7220 7374 7220 6f72 206c 6973 7422 0d0a  r str or list"..
-00022870: 2020 2020 2320 2020 2020 2020 2020 290d      #         ).
-00022880: 0a20 2020 2023 0d0a 2020 2020 2320 2020  .    #..    #   
-00022890: 2020 2320 6765 7420 7468 6520 7661 7269    # get the vari
-000228a0: 6162 6c65 0d0a 2020 2020 2320 2020 2020  able..    #     
-000228b0: 5661 7220 3d20 6c69 7374 286e 632e 7375  Var = list(nc.su
-000228c0: 6273 6574 732e 6b65 7973 2829 295b 2d31  bsets.keys())[-1
-000228d0: 5d0d 0a20 2020 2023 2020 2020 2023 2065  ]..    #     # e
-000228e0: 7874 7261 6374 2074 6865 2064 6174 610d  xtract the data.
-000228f0: 0a20 2020 2023 2020 2020 2064 6174 6173  .    #     datas
-00022900: 6574 203d 206e 635b 5661 725d 0d0a 2020  et = nc[Var]..  
-00022910: 2020 2320 2020 2020 2320 6765 7420 7468    #     # get th
-00022920: 6520 6465 7461 696c 7320 6f66 2074 6865  e details of the
-00022930: 2066 696c 650d 0a20 2020 2023 2020 2020   file..    #    
-00022940: 2067 656f 2c20 6570 7367 2c20 5f2c 205f   geo, epsg, _, _
-00022950: 2c20 7469 6d65 5f6c 656e 2c20 7469 6d65  , time_len, time
-00022960: 5f76 6172 2c20 6e6f 5f64 6174 615f 7661  _var, no_data_va
-00022970: 6c75 652c 2064 6174 6174 7970 6520 3d20  lue, datatype = 
-00022980: 4e43 2e67 6574 4e43 4465 7461 696c 7328  NC.getNCDetails(
-00022990: 0d0a 2020 2020 2320 2020 2020 2020 2020  ..    #         
-000229a0: 6e63 2c20 7469 6d65 5f76 6172 5f6e 616d  nc, time_var_nam
-000229b0: 653d 7469 6d65 5f76 6172 5f6e 616d 650d  e=time_var_name.
-000229c0: 0a20 2020 2023 2020 2020 2029 0d0a 2020  .    #     )..  
-000229d0: 2020 2320 2020 2020 7072 696e 7428 2273    #     print("s
-000229e0: 7373 2229 0d0a                           ss")..
+0001d9d0: 2020 2020 2020 7469 746c 6520 6f66 2074        title of t
+0001d9e0: 6865 2070 6c6f 742e 2054 6865 2064 6566  he plot. The def
+0001d9f0: 6175 6c74 2069 7320 2754 6f74 616c 2044  ault is 'Total D
+0001da00: 6973 6368 6172 6765 272e 0d0a 2020 2020  ischarge'...    
+0001da10: 2020 2020 2020 2020 7469 746c 655f 7369          title_si
+0001da20: 7a65 203a 205b 696e 7465 6765 725d 2c20  ze : [integer], 
+0001da30: 6f70 7469 6f6e 616c 0d0a 2020 2020 2020  optional..      
+0001da40: 2020 2020 2020 2020 2020 7469 746c 6520            title 
+0001da50: 7369 7a65 2e20 5468 6520 6465 6661 756c  size. The defaul
+0001da60: 7420 6973 2031 352e 0d0a 2020 2020 2020  t is 15...      
+0001da70: 2020 2020 2020 6f72 6965 6e74 6174 696f        orientatio
+0001da80: 6e20 3a20 5b73 7472 696e 675d 2c20 6f70  n : [string], op
+0001da90: 7469 6f6e 616c 0d0a 2020 2020 2020 2020  tional..        
+0001daa0: 2020 2020 2020 2020 6f72 696e 7461 7469          orintati
+0001dab0: 6f6e 206f 6620 7468 6520 636f 6c6f 7262  on of the colorb
+0001dac0: 6172 2068 6f72 697a 6f6e 7461 6c2f 7665  ar horizontal/ve
+0001dad0: 7274 6963 616c 2e20 5468 6520 6465 6661  rtical. The defa
+0001dae0: 756c 7420 6973 2027 7665 7274 6963 616c  ult is 'vertical
+0001daf0: 272e 0d0a 2020 2020 2020 2020 2020 2020  '...            
+0001db00: 726f 7461 7469 6f6e 203a 205b 6e75 6d62  rotation : [numb
+0001db10: 6572 5d2c 206f 7074 696f 6e61 6c0d 0a20  er], optional.. 
+0001db20: 2020 2020 2020 2020 2020 2020 2020 2072                 r
+0001db30: 6f74 6174 696f 6e20 6f66 2074 6865 2063  otation of the c
+0001db40: 6f6c 6f72 6261 7220 6c61 6265 6c2e 2054  olorbar label. T
+0001db50: 6865 2064 6566 6175 6c74 2069 7320 2d39  he default is -9
+0001db60: 302e 0d0a 2020 2020 2020 2020 2020 2020  0...            
+0001db70: 6f72 6965 6e74 6174 696f 6e20 3a20 5b73  orientation : [s
+0001db80: 7472 696e 675d 2c20 6f70 7469 6f6e 616c  tring], optional
+0001db90: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0001dba0: 2020 6f72 696e 7461 7469 6f6e 206f 6620    orintation of 
+0001dbb0: 7468 6520 636f 6c6f 7262 6172 2068 6f72  the colorbar hor
+0001dbc0: 697a 6f6e 7461 6c2f 7665 7274 6963 616c  izontal/vertical
+0001dbd0: 2e20 5468 6520 6465 6661 756c 7420 6973  . The default is
+0001dbe0: 2027 7665 7274 6963 616c 272e 0d0a 2020   'vertical'...  
+0001dbf0: 2020 2020 2020 2020 2020 6362 6172 5f6c            cbar_l
+0001dc00: 656e 6774 6820 3a20 5b66 6c6f 6174 5d2c  ength : [float],
+0001dc10: 206f 7074 696f 6e61 6c0d 0a20 2020 2020   optional..     
+0001dc20: 2020 2020 2020 2020 2020 2072 6174 696f             ratio
+0001dc30: 2074 6f20 636f 6e74 726f 6c20 7468 6520   to control the 
+0001dc40: 6865 6967 6874 206f 6620 7468 6520 636f  height of the co
+0001dc50: 6c6f 7262 6172 2e20 5468 6520 6465 6661  lorbar. The defa
+0001dc60: 756c 7420 6973 2030 2e37 352e 0d0a 2020  ult is 0.75...  
+0001dc70: 2020 2020 2020 2020 2020 7469 636b 735f            ticks_
+0001dc80: 7370 6163 696e 6720 3a20 5b69 6e74 6567  spacing : [integ
+0001dc90: 6572 5d2c 206f 7074 696f 6e61 6c0d 0a20  er], optional.. 
+0001dca0: 2020 2020 2020 2020 2020 2020 2020 2053                 S
+0001dcb0: 7061 6369 6e67 2069 6e20 7468 6520 636f  pacing in the co
+0001dcc0: 6c6f 7262 6172 2074 6963 6b73 2e20 5468  lorbar ticks. Th
+0001dcd0: 6520 6465 6661 756c 7420 6973 2032 2e0d  e default is 2..
+0001dce0: 0a20 2020 2020 2020 2020 2020 2063 6261  .            cba
+0001dcf0: 725f 6c61 6265 6c5f 7369 7a65 203a 2069  r_label_size : i
+0001dd00: 6e74 6567 6572 2c20 6f70 7469 6f6e 616c  nteger, optional
+0001dd10: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0001dd20: 2020 7369 7a65 206f 6620 7468 6520 636f    size of the co
+0001dd30: 6c6f 7220 6261 7220 6c61 6265 6c2e 2054  lor bar label. T
+0001dd40: 6865 2064 6566 6175 6c74 2069 7320 3132  he default is 12
+0001dd50: 2e0d 0a20 2020 2020 2020 2020 2020 2063  ...            c
+0001dd60: 6261 725f 6c61 6265 6c20 3a20 7374 722c  bar_label : str,
+0001dd70: 206f 7074 696f 6e61 6c0d 0a20 2020 2020   optional..     
+0001dd80: 2020 2020 2020 2020 2020 206c 6162 656c             label
+0001dd90: 206f 6620 7468 6520 636f 6c6f 7220 6261   of the color ba
+0001dda0: 722e 2054 6865 2064 6566 6175 6c74 2069  r. The default i
+0001ddb0: 7320 2744 6973 6368 6172 6765 206d 332f  s 'Discharge m3/
+0001ddc0: 7327 2e0d 0a20 2020 2020 2020 2020 2020  s'...           
+0001ddd0: 2063 6f6c 6f72 5f73 6361 6c65 203a 2069   color_scale : i
+0001dde0: 6e74 6567 6572 2c20 6f70 7469 6f6e 616c  nteger, optional
+0001ddf0: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0001de00: 2020 7468 6572 6520 6172 6520 3520 6f70    there are 5 op
+0001de10: 7469 6f6e 7320 746f 2063 6861 6e67 6520  tions to change 
+0001de20: 7468 6520 7363 616c 6520 6f66 2074 6865  the scale of the
+0001de30: 2063 6f6c 6f72 732e 2054 6865 2064 6566   colors. The def
+0001de40: 6175 6c74 2069 7320 312e 0d0a 2020 2020  ault is 1...    
+0001de50: 2020 2020 2020 2020 2020 2020 312d 2063              1- c
+0001de60: 6f6c 6f72 5f73 6361 6c65 2031 2069 7320  olor_scale 1 is 
+0001de70: 7468 6520 6e6f 726d 616c 2073 6361 6c65  the normal scale
+0001de80: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0001de90: 2020 322d 2063 6f6c 6f72 5f73 6361 6c65    2- color_scale
+0001dea0: 2032 2069 7320 7468 6520 706f 7765 7220   2 is the power 
+0001deb0: 7363 616c 650d 0a20 2020 2020 2020 2020  scale..         
+0001dec0: 2020 2020 2020 2033 2d20 636f 6c6f 725f         3- color_
+0001ded0: 7363 616c 6520 3320 6973 2074 6865 2053  scale 3 is the S
+0001dee0: 796d 4c6f 674e 6f72 6d20 7363 616c 650d  ymLogNorm scale.
+0001def0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001df00: 2034 2d20 636f 6c6f 725f 7363 616c 6520   4- color_scale 
+0001df10: 3420 6973 2074 6865 2050 6f77 6572 4e6f  4 is the PowerNo
+0001df20: 726d 2073 6361 6c65 0d0a 2020 2020 2020  rm scale..      
+0001df30: 2020 2020 2020 2020 2020 352d 2063 6f6c            5- col
+0001df40: 6f72 5f73 6361 6c65 2035 2069 7320 7468  or_scale 5 is th
+0001df50: 6520 426f 756e 6461 7279 4e6f 726d 2073  e BoundaryNorm s
+0001df60: 6361 6c65 0d0a 2020 2020 2020 2020 2020  cale..          
+0001df70: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+0001df80: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0001df90: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0001dfa0: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0001dfb0: 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020 2020  --------..      
+0001dfc0: 2020 2020 2020 2020 2020 6761 6d6d 6120            gamma 
+0001dfd0: 3a20 5b66 6c6f 6174 5d2c 206f 7074 696f  : [float], optio
+0001dfe0: 6e61 6c0d 0a20 2020 2020 2020 2020 2020  nal..           
+0001dff0: 2020 2020 2020 2020 2076 616c 7565 206e           value n
+0001e000: 6565 6465 6420 666f 7220 6f70 7469 6f6e  eeded for option
+0001e010: 2032 202e 2054 6865 2064 6566 6175 6c74   2 . The default
+0001e020: 2069 7320 312e 2f32 2e2e 0d0a 2020 2020   is 1./2....    
+0001e030: 2020 2020 2020 2020 2020 2020 6c69 6e65              line
+0001e040: 5f74 6872 6573 686f 6c64 203a 205b 666c  _threshold : [fl
+0001e050: 6f61 745d 2c20 6f70 7469 6f6e 616c 0d0a  oat], optional..
+0001e060: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e070: 2020 2020 7661 6c75 6520 6e65 6564 6564      value needed
+0001e080: 2066 6f72 206f 7074 696f 6e20 332e 2054   for option 3. T
+0001e090: 6865 2064 6566 6175 6c74 2069 7320 302e  he default is 0.
+0001e0a0: 3030 3031 2e0d 0a20 2020 2020 2020 2020  0001...         
+0001e0b0: 2020 2020 2020 206c 696e 655f 7363 616c         line_scal
+0001e0c0: 6520 3a20 5b66 6c6f 6174 5d2c 206f 7074  e : [float], opt
+0001e0d0: 696f 6e61 6c0d 0a20 2020 2020 2020 2020  ional..         
+0001e0e0: 2020 2020 2020 2020 2020 2076 616c 7565             value
+0001e0f0: 206e 6565 6465 6420 666f 7220 6f70 7469   needed for opti
+0001e100: 6f6e 2033 2e20 5468 6520 6465 6661 756c  on 3. The defaul
+0001e110: 7420 6973 2030 2e30 3031 2e0d 0a20 2020  t is 0.001...   
+0001e120: 2020 2020 2020 2020 2020 2020 2062 6f75               bou
+0001e130: 6e64 733a 205b 4c69 7374 5d0d 0a20 2020  nds: [List]..   
+0001e140: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e150: 2061 206c 6973 7420 6f66 206e 756d 6265   a list of numbe
+0001e160: 7220 746f 2062 6520 7573 6564 2061 7320  r to be used as 
+0001e170: 6120 6469 7363 7265 7465 2062 6f75 6e64  a discrete bound
+0001e180: 7320 666f 7220 7468 6520 636f 6c6f 7220  s for the color 
+0001e190: 7363 616c 6520 342e 4465 6661 756c 7420  scale 4.Default 
+0001e1a0: 6973 204e 6f6e 652c 0d0a 2020 2020 2020  is None,..      
+0001e1b0: 2020 2020 2020 2020 2020 6d69 6470 6f69            midpoi
+0001e1c0: 6e74 203a 205b 666c 6f61 745d 2c20 6f70  nt : [float], op
+0001e1d0: 7469 6f6e 616c 0d0a 2020 2020 2020 2020  tional..        
+0001e1e0: 2020 2020 2020 2020 2020 2020 7661 6c75              valu
+0001e1f0: 6520 6e65 6564 6564 2066 6f72 206f 7074  e needed for opt
+0001e200: 696f 6e20 352e 2054 6865 2064 6566 6175  ion 5. The defau
+0001e210: 6c74 2069 7320 302e 0d0a 2020 2020 2020  lt is 0...      
+0001e220: 2020 2020 2020 2020 2020 2d2d 2d2d 2d2d            ------
+0001e230: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0001e240: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0001e250: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d  ----------------
+0001e260: 2d2d 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020  ------------..  
+0001e270: 2020 2020 2020 2020 2020 636d 6170 203a            cmap :
+0001e280: 205b 7374 725d 2c20 6f70 7469 6f6e 616c   [str], optional
+0001e290: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0001e2a0: 2020 636f 6c6f 7220 7374 796c 652e 2054    color style. T
+0001e2b0: 6865 2064 6566 6175 6c74 2069 7320 2763  he default is 'c
+0001e2c0: 6f6f 6c77 6172 6d5f 7227 2e0d 0a20 2020  oolwarm_r'...   
+0001e2d0: 2020 2020 2020 2020 2064 6973 706c 6179           display
+0001e2e0: 5f63 656c 6c5f 7661 6c75 6520 3a20 5b62  _cell_value : [b
+0001e2f0: 6f6f 6c5d 0d0a 2020 2020 2020 2020 2020  ool]..          
+0001e300: 2020 2020 2020 5472 7565 2069 6620 796f        True if yo
+0001e310: 7520 7761 6e74 2074 6f20 6469 7370 6c61  u want to displa
+0001e320: 7920 7468 6520 7661 6c75 6573 206f 6620  y the values of 
+0001e330: 7468 6520 6365 6c6c 7320 6173 2061 2074  the cells as a t
+0001e340: 6578 740d 0a20 2020 2020 2020 2020 2020  ext..           
+0001e350: 206e 756d 5f73 697a 6520 3a20 696e 7465   num_size : inte
+0001e360: 6765 722c 206f 7074 696f 6e61 6c0d 0a20  ger, optional.. 
+0001e370: 2020 2020 2020 2020 2020 2020 2020 2073                 s
+0001e380: 697a 6520 6f66 2074 6865 206e 756d 6265  ize of the numbe
+0001e390: 7273 2070 6c6f 7474 6564 2069 6e74 6f70  rs plotted intop
+0001e3a0: 206f 6620 6561 6368 2063 656c 6c73 2e20   of each cells. 
+0001e3b0: 5468 6520 6465 6661 756c 7420 6973 2038  The default is 8
+0001e3c0: 2e0d 0a20 2020 2020 2020 2020 2020 2062  ...            b
+0001e3d0: 6163 6b67 726f 756e 645f 636f 6c6f 725f  ackground_color_
+0001e3e0: 7468 7265 7368 6f6c 6420 3a20 5b66 6c6f  threshold : [flo
+0001e3f0: 6174 2f69 6e74 6567 6572 5d2c 206f 7074  at/integer], opt
+0001e400: 696f 6e61 6c0d 0a20 2020 2020 2020 2020  ional..         
+0001e410: 2020 2020 2020 2074 6872 6573 686f 6c64         threshold
+0001e420: 2076 616c 7565 2069 6620 7468 6520 7661   value if the va
+0001e430: 6c75 6520 6f66 2074 6865 2063 656c 6c20  lue of the cell 
+0001e440: 6973 2067 7265 6174 6572 2c20 7468 6520  is greater, the 
+0001e450: 706c 6f74 7465 640d 0a20 2020 2020 2020  plotted..       
+0001e460: 2020 2020 2020 2020 206e 756d 6265 7273           numbers
+0001e470: 2077 696c 6c20 6265 2062 6c61 636b 2061   will be black a
+0001e480: 6e64 2069 6620 736d 616c 6c65 7220 7468  nd if smaller th
+0001e490: 6520 706c 6f74 7465 6420 6e75 6d62 6572  e plotted number
+0001e4a0: 2077 696c 6c20 6265 2077 6869 7465 0d0a   will be white..
+0001e4b0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001e4c0: 6966 204e 6f6e 6520 6769 7665 6e20 7468  if None given th
+0001e4d0: 6520 6d61 7876 616c 7565 2f32 2077 696c  e maxvalue/2 wil
+0001e4e0: 6c20 6265 2063 6f6e 7369 6465 7265 642e  l be considered.
+0001e4f0: 2054 6865 2064 6566 6175 6c74 2069 7320   The default is 
+0001e500: 4e6f 6e65 2e0d 0a0d 0a20 2020 2020 2020  None.....       
+0001e510: 2052 6574 7572 6e73 0d0a 2020 2020 2020   Returns..      
+0001e520: 2020 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020    -------..     
+0001e530: 2020 2061 7865 733a 205b 6669 6775 7265     axes: [figure
+0001e540: 2061 7865 735d 2e0d 0a20 2020 2020 2020   axes]...       
+0001e550: 2020 2020 2074 6865 2061 7865 7320 6f66       the axes of
+0001e560: 2074 6865 206d 6174 706c 6f74 6c69 6220   the matplotlib 
+0001e570: 6669 6775 7265 0d0a 2020 2020 2020 2020  figure..        
+0001e580: 6669 673a 205b 6d61 7470 6c6f 746c 6962  fig: [matplotlib
+0001e590: 2066 6967 7572 6520 6f62 6a65 6374 5d0d   figure object].
+0001e5a0: 0a20 2020 2020 2020 2020 2020 2074 6865  .            the
+0001e5b0: 2066 6967 7572 6520 6f62 6a65 6374 0d0a   figure object..
+0001e5c0: 2020 2020 2020 2020 2222 220d 0a20 2020          """..   
+0001e5d0: 2020 2020 2069 6d70 6f72 745f 636c 656f       import_cleo
+0001e5e0: 7061 7472 6128 0d0a 2020 2020 2020 2020  patra(..        
+0001e5f0: 2020 2020 2254 6865 2063 7572 7265 6e74      "The current
+0001e600: 2066 756e 6372 696f 6e20 7573 6573 2063   funcrion uses c
+0001e610: 6c65 6f70 6174 7261 2070 6163 6b61 6765  leopatra package
+0001e620: 2074 6f20 666f 7220 706c 6f74 7469 6e67   to for plotting
+0001e630: 2c20 706c 6561 7365 2069 6e73 7461 6c6c  , please install
+0001e640: 2069 7420 6d61 6e75 616c 6c79 2c20 666f   it manually, fo
+0001e650: 7220 6d6f 7265 2069 6e66 6f20 220d 0a20  r more info ".. 
+0001e660: 2020 2020 2020 2020 2020 2022 6368 6563             "chec
+0001e670: 6b20 6874 7470 733a 2f2f 6769 7468 7562  k https://github
+0001e680: 2e63 6f6d 2f53 6572 6170 6965 756d 2d6f  .com/Serapieum-o
+0001e690: 662d 616c 6578 2f63 6c65 6f70 6174 7261  f-alex/cleopatra
+0001e6a0: 220d 0a20 2020 2020 2020 2029 0d0a 2020  "..        )..  
+0001e6b0: 2020 2020 2020 6672 6f6d 2063 6c65 6f70        from cleop
+0001e6c0: 6174 7261 2e61 7272 6179 2069 6d70 6f72  atra.array impor
+0001e6d0: 7420 4172 7261 790d 0a0d 0a20 2020 2020  t Array....     
+0001e6e0: 2020 2064 6174 6120 3d20 7365 6c66 2e64     data = self.d
+0001e6f0: 6174 610d 0a0d 0a20 2020 2020 2020 2065  ata....        e
+0001e700: 7863 6c75 6465 5f76 616c 7565 203d 2028  xclude_value = (
+0001e710: 0d0a 2020 2020 2020 2020 2020 2020 5b73  ..            [s
+0001e720: 656c 662e 6261 7365 2e6e 6f5f 6461 7461  elf.base.no_data
+0001e730: 5f76 616c 7565 5b62 616e 645d 2c20 6578  _value[band], ex
+0001e740: 636c 7564 655f 7661 6c75 655d 0d0a 2020  clude_value]..  
+0001e750: 2020 2020 2020 2020 2020 6966 2065 7863            if exc
+0001e760: 6c75 6465 5f76 616c 7565 2069 7320 6e6f  lude_value is no
+0001e770: 7420 4e6f 6e65 0d0a 2020 2020 2020 2020  t None..        
+0001e780: 2020 2020 656c 7365 205b 7365 6c66 2e62      else [self.b
+0001e790: 6173 652e 6e6f 5f64 6174 615f 7661 6c75  ase.no_data_valu
+0001e7a0: 655b 6261 6e64 5d5d 0d0a 2020 2020 2020  e[band]]..      
+0001e7b0: 2020 290d 0a0d 0a20 2020 2020 2020 2063    )....        c
+0001e7c0: 6c65 6f20 3d20 4172 7261 7928 6461 7461  leo = Array(data
+0001e7d0: 2c20 6578 636c 7564 655f 7661 6c75 653d  , exclude_value=
+0001e7e0: 6578 636c 7564 655f 7661 6c75 6529 0d0a  exclude_value)..
+0001e7f0: 2020 2020 2020 2020 7469 6d65 203d 206c          time = l
+0001e800: 6973 7428 7261 6e67 6528 7365 6c66 2e74  ist(range(self.t
+0001e810: 696d 655f 6c65 6e67 7468 2929 0d0a 2020  ime_length))..  
+0001e820: 2020 2020 2020 616e 696d 203d 2063 6c65        anim = cle
+0001e830: 6f2e 616e 696d 6174 6528 7469 6d65 2c20  o.animate(time, 
+0001e840: 2a2a 6b77 6172 6773 290d 0a20 2020 2020  **kwargs)..     
+0001e850: 2020 2072 6574 7572 6e20 616e 696d 0d0a     return anim..
+0001e860: 0d0a 2020 2020 6465 6620 746f 5f66 696c  ..    def to_fil
+0001e870: 6528 7365 6c66 2c20 7061 7468 3a20 7374  e(self, path: st
+0001e880: 722c 2064 7269 7665 723a 2073 7472 203d  r, driver: str =
+0001e890: 2022 6765 6f74 6966 6622 2c20 6261 6e64   "geotiff", band
+0001e8a0: 3a20 696e 7420 3d20 3029 3a0d 0a20 2020  : int = 0):..   
+0001e8b0: 2020 2020 2022 2222 5361 7665 2074 6f20       """Save to 
+0001e8c0: 6765 6f74 6966 6620 666f 726d 6174 2e0d  geotiff format..
+0001e8d0: 0a0d 0a20 2020 2020 2020 2020 2020 2073  ...            s
+0001e8e0: 6176 6552 6173 7465 7220 7361 7665 7320  aveRaster saves 
+0001e8f0: 6120 7261 7374 6572 2074 6f20 6120 7061  a raster to a pa
+0001e900: 7468 0d0a 0d0a 2020 2020 2020 2020 5061  th....        Pa
+0001e910: 7261 6d65 7465 7273 0d0a 2020 2020 2020  rameters..      
+0001e920: 2020 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020    ----------..  
+0001e930: 2020 2020 2020 7061 7468 3a20 5b73 7472        path: [str
+0001e940: 696e 675d 0d0a 2020 2020 2020 2020 2020  ing]..          
+0001e950: 2020 6120 7061 7468 2069 6e63 6c75 646e    a path includn
+0001e960: 6720 7468 6520 6e61 6d65 206f 6620 7468  g the name of th
+0001e970: 6520 7261 7374 6572 2061 6e64 2065 7874  e raster and ext
+0001e980: 656e 7469 6f6e 2e0d 0a20 2020 2020 2020  ention...       
+0001e990: 2020 2020 203e 3e3e 2070 6174 6820 3d20       >>> path = 
+0001e9a0: 2264 6174 612f 6372 6f70 7065 642e 7469  "data/cropped.ti
+0001e9b0: 6622 0d0a 2020 2020 2020 2020 6472 6976  f"..        driv
+0001e9c0: 6572 3a20 5b73 7472 5d0d 0a20 2020 2020  er: [str]..     
+0001e9d0: 2020 2020 2020 2064 7269 7665 7220 3d20         driver = 
+0001e9e0: 2267 656f 7469 6666 222e 0d0a 2020 2020  "geotiff"...    
+0001e9f0: 2020 2020 6261 6e64 3a20 5b69 6e74 5d0d      band: [int].
+0001ea00: 0a20 2020 2020 2020 2020 2020 2062 616e  .            ban
+0001ea10: 6420 696e 6465 782c 206e 6565 6465 6420  d index, needed 
+0001ea20: 6f6e 6c79 2069 6e20 6361 7365 206f 6620  only in case of 
+0001ea30: 6173 6369 6920 6472 6976 6572 732e 2044  ascii drivers. D
+0001ea40: 6566 6175 6c74 2069 7320 312e 0d0a 0d0a  efault is 1.....
+0001ea50: 2020 2020 2020 2020 4578 616d 706c 6573          Examples
+0001ea60: 0d0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ..        ------
+0001ea70: 2d2d 0d0a 2020 2020 2020 2020 3e3e 3e20  --..        >>> 
+0001ea80: 7261 7374 6572 5f6f 626a 203d 2044 6174  raster_obj = Dat
+0001ea90: 6173 6574 2e72 6561 645f 6669 6c65 2822  aset.read_file("
+0001eaa0: 7061 7468 2f74 6f2f 6669 6c65 2f2a 2a2a  path/to/file/***
+0001eab0: 2e74 6966 2229 0d0a 2020 2020 2020 2020  .tif")..        
+0001eac0: 3e3e 3e20 6f75 7470 7574 5f70 6174 6820  >>> output_path 
+0001ead0: 3d20 2265 7861 6d70 6c65 732f 4749 532f  = "examples/GIS/
+0001eae0: 6461 7461 2f73 6176 655f 7261 7374 6572  data/save_raster
+0001eaf0: 5f74 6573 742e 7469 6622 0d0a 2020 2020  _test.tif"..    
+0001eb00: 2020 2020 3e3e 3e20 7261 7374 6572 5f6f      >>> raster_o
+0001eb10: 626a 2e74 6f5f 6669 6c65 286f 7574 7075  bj.to_file(outpu
+0001eb20: 745f 7061 7468 290d 0a20 2020 2020 2020  t_path)..       
+0001eb30: 2022 2222 0d0a 2020 2020 2020 2020 6966   """..        if
+0001eb40: 206e 6f74 2050 6174 6828 7061 7468 292e   not Path(path).
+0001eb50: 6578 6973 7473 2829 3a0d 0a20 2020 2020  exists():..     
+0001eb60: 2020 2020 2020 2050 6174 6828 7061 7468         Path(path
+0001eb70: 292e 6d6b 6469 7228 7061 7265 6e74 733d  ).mkdir(parents=
+0001eb80: 5472 7565 2c20 6578 6973 745f 6f6b 3d54  True, exist_ok=T
+0001eb90: 7275 6529 0d0a 2020 2020 2020 2020 6578  rue)..        ex
+0001eba0: 7420 3d20 4341 5441 4c4f 472e 6765 745f  t = CATALOG.get_
+0001ebb0: 6578 7465 6e73 696f 6e28 6472 6976 6572  extension(driver
+0001ebc0: 290d 0a0d 0a20 2020 2020 2020 2066 6f72  )....        for
+0001ebd0: 2069 2069 6e20 7261 6e67 6528 7365 6c66   i in range(self
+0001ebe0: 2e74 696d 655f 6c65 6e67 7468 293a 0d0a  .time_length):..
+0001ebf0: 2020 2020 2020 2020 2020 2020 7372 6320              src 
+0001ec00: 3d20 7365 6c66 2e69 6c6f 6328 6929 0d0a  = self.iloc(i)..
+0001ec10: 2020 2020 2020 2020 2020 2020 7372 632e              src.
+0001ec20: 746f 5f66 696c 6528 6622 7b70 6174 687d  to_file(f"{path}
+0001ec30: 2f7b 697d 2e7b 6578 747d 222c 2062 616e  /{i}.{ext}", ban
+0001ec40: 643d 6261 6e64 290d 0a0d 0a20 2020 2064  d=band)....    d
+0001ec50: 6566 2074 6f5f 6372 7328 0d0a 2020 2020  ef to_crs(..    
+0001ec60: 2020 2020 7365 6c66 2c0d 0a20 2020 2020      self,..     
+0001ec70: 2020 2074 6f5f 6570 7367 3a20 696e 7420     to_epsg: int 
+0001ec80: 3d20 3338 3537 2c0d 0a20 2020 2020 2020  = 3857,..       
+0001ec90: 206d 6574 686f 643a 2073 7472 203d 2022   method: str = "
+0001eca0: 6e65 6172 6573 7420 6e65 6962 6f75 7222  nearest neibour"
+0001ecb0: 2c0d 0a20 2020 2020 2020 206d 6169 6e74  ,..        maint
+0001ecc0: 6169 6e5f 616c 6967 686d 656e 743a 2069  ain_alighment: i
+0001ecd0: 6e74 203d 2046 616c 7365 2c0d 0a20 2020  nt = False,..   
+0001ece0: 2029 3a0d 0a20 2020 2020 2020 2022 2222   ):..        """
+0001ecf0: 746f 5f65 7073 672e 0d0a 0d0a 2020 2020  to_epsg.....    
+0001ed00: 2020 2020 2020 2020 2d20 746f 5f65 7073          - to_eps
+0001ed10: 6720 7265 7072 6f6a 6563 7473 2061 2072  g reprojects a r
+0001ed20: 6173 7465 7220 746f 2061 6e79 2070 726f  aster to any pro
+0001ed30: 6a65 6374 696f 6e20 2864 6566 6175 6c74  jection (default
+0001ed40: 2074 6865 2057 4753 3834 2077 6562 206d   the WGS84 web m
+0001ed50: 6572 6361 746f 7220 7072 6f6a 6563 7469  ercator projecti
+0001ed60: 6f6e 2c0d 0a20 2020 2020 2020 2020 2020  on,..           
+0001ed70: 2077 6974 686f 7574 2072 6573 616d 706c   without resampl
+0001ed80: 696e 6729 2054 6865 2066 756e 6374 696f  ing) The functio
+0001ed90: 6e20 7265 7475 726e 7320 6120 4744 414c  n returns a GDAL
+0001eda0: 2069 6e2d 6d65 6d6f 7279 2066 696c 6520   in-memory file 
+0001edb0: 6f62 6a65 6374 2c20 7768 6572 6520 796f  object, where yo
+0001edc0: 7520 6361 6e20 5265 6164 4173 4172 7261  u can ReadAsArra
+0001edd0: 7920 6574 632e 0d0a 0d0a 2020 2020 2020  y etc.....      
+0001ede0: 2020 5061 7261 6d65 7465 7273 0d0a 2020    Parameters..  
+0001edf0: 2020 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d        ----------
+0001ee00: 0d0a 2020 2020 2020 2020 746f 5f65 7073  ..        to_eps
+0001ee10: 673a 205b 696e 7465 6765 725d 0d0a 2020  g: [integer]..  
+0001ee20: 2020 2020 2020 2020 2020 7265 6665 7265            refere
+0001ee30: 6e63 6520 6e75 6d62 6572 2074 6f20 7468  nce number to th
+0001ee40: 6520 6e65 7720 7072 6f6a 6563 7469 6f6e  e new projection
+0001ee50: 2028 6874 7470 733a 2f2f 6570 7367 2e69   (https://epsg.i
+0001ee60: 6f2f 290d 0a20 2020 2020 2020 2020 2020  o/)..           
+0001ee70: 2028 6465 6661 756c 7420 3338 3537 2074   (default 3857 t
+0001ee80: 6865 2072 6566 6572 656e 6365 206e 6f20  he reference no 
+0001ee90: 6f66 2057 4753 3834 2077 6562 206d 6572  of WGS84 web mer
+0001eea0: 6361 746f 7220 290d 0a20 2020 2020 2020  cator )..       
+0001eeb0: 206d 6574 686f 643a 205b 5374 7269 6e67   method: [String
+0001eec0: 5d0d 0a20 2020 2020 2020 2020 2020 2072  ]..            r
+0001eed0: 6573 616d 706c 696e 6720 7465 6368 6e69  esampling techni
+0001eee0: 7175 6520 6465 6661 756c 7420 6973 2022  que default is "
+0001eef0: 4e65 6172 6573 7422 0d0a 2020 2020 2020  Nearest"..      
+0001ef00: 2020 2020 2020 6874 7470 733a 2f2f 6769        https://gi
+0001ef10: 7367 656f 6772 6170 6879 2e63 6f6d 2f72  sgeography.com/r
+0001ef20: 6173 7465 722d 7265 7361 6d70 6c69 6e67  aster-resampling
+0001ef30: 2f0d 0a20 2020 2020 2020 2020 2020 2022  /..            "
+0001ef40: 4e65 6172 6573 7422 2066 6f72 206e 6561  Nearest" for nea
+0001ef50: 7265 7374 206e 6569 6768 626f 7572 2c22  rest neighbour,"
+0001ef60: 6375 6269 6322 2066 6f72 2063 7562 6963  cubic" for cubic
+0001ef70: 2063 6f6e 766f 6c75 7469 6f6e 2c0d 0a20   convolution,.. 
+0001ef80: 2020 2020 2020 2020 2020 2022 6269 6c69             "bili
+0001ef90: 6e65 6172 2220 666f 7220 6269 6c69 6e65  near" for biline
+0001efa0: 6172 0d0a 2020 2020 2020 2020 6d61 696e  ar..        main
+0001efb0: 7461 696e 5f61 6c69 6768 6d65 6e74 203a  tain_alighment :
+0001efc0: 205b 626f 6f6c 5d0d 0a20 2020 2020 2020   [bool]..       
+0001efd0: 2020 2020 2054 7275 6520 746f 206d 6169       True to mai
+0001efe0: 6e74 6169 6e20 7468 6520 6e75 6d62 6572  ntain the number
+0001eff0: 206f 6620 726f 7773 2061 6e64 2063 6f6c   of rows and col
+0001f000: 756d 6e73 206f 6620 7468 6520 7261 7374  umns of the rast
+0001f010: 6572 2074 6865 2073 616d 6520 6166 7465  er the same afte
+0001f020: 7220 7265 7072 6f6a 6563 7469 6f6e 2e20  r reprojection. 
+0001f030: 4465 6661 756c 7420 6973 2046 616c 7365  Default is False
+0001f040: 2e0d 0a0d 0a20 2020 2020 2020 2052 6574  .....        Ret
+0001f050: 7572 6e73 0d0a 2020 2020 2020 2020 2d2d  urns..        --
+0001f060: 2d2d 2d2d 2d0d 0a20 2020 2020 2020 2072  -----..        r
+0001f070: 6173 7465 723a 0d0a 2020 2020 2020 2020  aster:..        
+0001f080: 2020 2020 6764 616c 2064 6174 6173 6574      gdal dataset
+0001f090: 2028 796f 7520 6361 6e20 7265 6164 2069   (you can read i
+0001f0a0: 7420 6279 2052 6561 6441 7341 7272 6179  t by ReadAsArray
+0001f0b0: 290d 0a0d 0a20 2020 2020 2020 2045 7861  )....        Exa
+0001f0c0: 6d70 6c65 730d 0a20 2020 2020 2020 202d  mples..        -
+0001f0d0: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
+0001f0e0: 203e 3e3e 2066 726f 6d20 7079 7261 6d69   >>> from pyrami
+0001f0f0: 6473 2e64 6174 6173 6574 2069 6d70 6f72  ds.dataset impor
+0001f100: 7420 4461 7461 7365 740d 0a20 2020 2020  t Dataset..     
+0001f110: 2020 203e 3e3e 2073 7263 203d 2044 6174     >>> src = Dat
+0001f120: 6173 6574 2e72 6561 645f 6669 6c65 2822  aset.read_file("
+0001f130: 7061 7468 2f72 6173 7465 725f 6e61 6d65  path/raster_name
+0001f140: 2e74 6966 2229 0d0a 2020 2020 2020 2020  .tif")..        
+0001f150: 3e3e 3e20 7072 6f6a 6563 7465 645f 7261  >>> projected_ra
+0001f160: 7374 6572 203d 2073 7263 2e74 6f5f 6372  ster = src.to_cr
+0001f170: 7328 746f 5f65 7073 673d 3338 3537 290d  s(to_epsg=3857).
+0001f180: 0a20 2020 2020 2020 2022 2222 0d0a 2020  .        """..  
+0001f190: 2020 2020 2020 666f 7220 6920 696e 2072        for i in r
+0001f1a0: 616e 6765 2873 656c 662e 7469 6d65 5f6c  ange(self.time_l
+0001f1b0: 656e 6774 6829 3a0d 0a20 2020 2020 2020  ength):..       
+0001f1c0: 2020 2020 2073 7263 203d 2073 656c 662e       src = self.
+0001f1d0: 696c 6f63 2869 290d 0a20 2020 2020 2020  iloc(i)..       
+0001f1e0: 2020 2020 2064 7374 203d 2073 7263 2e74       dst = src.t
+0001f1f0: 6f5f 6372 7328 0d0a 2020 2020 2020 2020  o_crs(..        
+0001f200: 2020 2020 2020 2020 746f 5f65 7073 672c          to_epsg,
+0001f210: 206d 6574 686f 643d 6d65 7468 6f64 2c20   method=method, 
+0001f220: 6d61 696e 7461 696e 5f61 6c69 6768 6d65  maintain_alighme
+0001f230: 6e74 3d6d 6169 6e74 6169 6e5f 616c 6967  nt=maintain_alig
+0001f240: 686d 656e 740d 0a20 2020 2020 2020 2020  hment..         
+0001f250: 2020 2029 0d0a 2020 2020 2020 2020 2020     )..          
+0001f260: 2020 6172 7220 3d20 6473 742e 7265 6164    arr = dst.read
+0001f270: 5f61 7272 6179 2829 0d0a 2020 2020 2020  _array()..      
+0001f280: 2020 2020 2020 6966 2069 203d 3d20 303a        if i == 0:
+0001f290: 0d0a 2020 2020 2020 2020 2020 2020 2020  ..              
+0001f2a0: 2020 2320 6372 6561 7465 2074 6865 2061    # create the a
+0001f2b0: 7272 6179 0d0a 2020 2020 2020 2020 2020  rray..          
+0001f2c0: 2020 2020 2020 6172 7261 7920 3d20 280d        array = (.
+0001f2d0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001f2e0: 2020 2020 206e 702e 6f6e 6573 280d 0a20       np.ones(.. 
+0001f2f0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f300: 2020 2020 2020 2028 0d0a 2020 2020 2020         (..      
+0001f310: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f320: 2020 2020 2020 7365 6c66 2e74 696d 655f        self.time_
+0001f330: 6c65 6e67 7468 2c0d 0a20 2020 2020 2020  length,..       
+0001f340: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f350: 2020 2020 2061 7272 2e73 6861 7065 5b30       arr.shape[0
+0001f360: 5d2c 0d0a 2020 2020 2020 2020 2020 2020  ],..            
+0001f370: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f380: 6172 722e 7368 6170 655b 315d 2c0d 0a20  arr.shape[1],.. 
+0001f390: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001f3a0: 2020 2020 2020 2029 0d0a 2020 2020 2020         )..      
+0001f3b0: 2020 2020 2020 2020 2020 2020 2020 290d                ).
+0001f3c0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+0001f3d0: 2020 2020 202a 206e 702e 6e61 6e0d 0a20       * np.nan.. 
+0001f3e0: 2020 2020 2020 2020 2020 2020 2020 2029                 )
+0001f3f0: 0d0a 2020 2020 2020 2020 2020 2020 6172  ..            ar
+0001f400: 7261 795b 692c 203a 2c20 3a5d 203d 2061  ray[i, :, :] = a
+0001f410: 7272 0d0a 0d0a 2020 2020 2020 2020 7365  rr....        se
+0001f420: 6c66 2e5f 6461 7461 203d 2061 7272 6179  lf._data = array
+0001f430: 0d0a 2020 2020 2020 2020 2320 7573 6520  ..        # use 
+0001f440: 7468 6520 6c61 7374 2073 7263 2061 730d  the last src as.
+0001f450: 0a20 2020 2020 2020 2073 656c 662e 5f62  .        self._b
+0001f460: 6173 6520 3d20 6473 740d 0a0d 0a20 2020  ase = dst....   
+0001f470: 2064 6566 2063 726f 7028 0d0a 2020 2020   def crop(..    
+0001f480: 2020 2020 7365 6c66 2c0d 0a20 2020 2020      self,..     
+0001f490: 2020 206d 6173 6b3a 2055 6e69 6f6e 5b44     mask: Union[D
+0001f4a0: 6174 6173 6574 2c20 7374 725d 2c0d 0a20  ataset, str],.. 
+0001f4b0: 2020 2029 202d 3e20 4e6f 6e65 3a0d 0a20     ) -> None:.. 
+0001f4c0: 2020 2020 2020 2022 2222 6372 6f70 416c         """cropAl
+0001f4d0: 6967 6e65 6446 6f6c 6465 722e 0d0a 0d0a  ignedFolder.....
+0001f4e0: 2020 2020 2020 2020 2020 2020 6372 6f70              crop
+0001f4f0: 416c 6967 6e65 6446 6f6c 6465 7220 6d61  AlignedFolder ma
+0001f500: 7463 6865 7320 7468 6520 6c6f 6361 7469  tches the locati
+0001f510: 6f6e 206f 6620 6e6f 6461 7461 2076 616c  on of nodata val
+0001f520: 7565 2066 726f 6d20 7372 6320 7261 7374  ue from src rast
+0001f530: 6572 2074 6f20 6473 740d 0a20 2020 2020  er to dst..     
+0001f540: 2020 2020 2020 2072 6173 7465 722c 204d         raster, M
+0001f550: 6173 6b20 6973 2077 6865 7265 2074 6865  ask is where the
+0001f560: 204e 6f44 6174 6176 616c 7565 2077 696c   NoDatavalue wil
+0001f570: 6c20 6265 2074 616b 656e 2061 6e64 2074  l be taken and t
+0001f580: 6865 206c 6f63 6174 696f 6e20 6f66 0d0a  he location of..
+0001f590: 2020 2020 2020 2020 2020 2020 7468 6973              this
+0001f5a0: 2076 616c 7565 2073 7263 5f64 6972 2069   value src_dir i
+0001f5b0: 7320 7061 7468 2074 6f20 7468 6520 666f  s path to the fo
+0001f5c0: 6c64 6572 2077 6865 7265 2072 6173 7465  lder where raste
+0001f5d0: 7273 2065 7869 7374 2077 6865 7265 2077  rs exist where w
+0001f5e0: 650d 0a20 2020 2020 2020 2020 2020 206e  e..            n
+0001f5f0: 6565 6420 746f 2070 7574 2074 6865 204e  eed to put the N
+0001f600: 6f44 6174 6156 616c 7565 206f 6620 7468  oDataValue of th
+0001f610: 6520 6d61 736b 2069 6e20 5261 7374 6572  e mask in Raster
+0001f620: 4220 6174 2074 6865 2073 616d 6520 6c6f  B at the same lo
+0001f630: 6361 7469 6f6e 730d 0a0d 0a20 2020 2020  cations....     
+0001f640: 2020 2050 6172 616d 6574 6572 730d 0a20     Parameters.. 
+0001f650: 2020 2020 2020 202d 2d2d 2d2d 2d2d 2d2d         ---------
+0001f660: 2d0d 0a20 2020 2020 2020 206d 6173 6b20  -..        mask 
+0001f670: 3a20 5b73 7472 2f44 6174 6173 6574 5d0d  : [str/Dataset].
+0001f680: 0a20 2020 2020 2020 2020 2020 2070 6174  .            pat
+0001f690: 682f 4461 7461 7365 7420 6f62 6a65 6374  h/Dataset object
+0001f6a0: 206f 6620 7468 6520 6d61 736b 2072 6173   of the mask ras
+0001f6b0: 7465 7220 746f 2063 726f 7020 7468 6520  ter to crop the 
+0001f6c0: 7261 7374 6572 7320 2874 6f20 6765 7420  rasters (to get 
+0001f6d0: 7468 6520 4e6f 4461 7461 2076 616c 7565  the NoData value
+0001f6e0: 0d0a 2020 2020 2020 2020 2020 2020 616e  ..            an
+0001f6f0: 6420 6974 206c 6f63 6174 696f 6e20 696e  d it location in
+0001f700: 2074 6865 2061 7272 6179 2920 4d61 736b   the array) Mask
+0001f710: 2073 686f 756c 6420 696e 636c 7564 6520   should include 
+0001f720: 7468 6520 6e61 6d65 206f 6620 7468 6520  the name of the 
+0001f730: 7261 7374 6572 2061 6e64 2074 6865 0d0a  raster and the..
+0001f740: 2020 2020 2020 2020 2020 2020 6578 7465              exte
+0001f750: 6e73 696f 6e20 6c69 6b65 2022 6461 7461  nsion like "data
+0001f760: 2f64 656d 2e74 6966 222c 206f 7220 796f  /dem.tif", or yo
+0001f770: 7520 6361 6e20 7265 6164 2074 6865 206d  u can read the m
+0001f780: 6173 6b20 7261 7374 6572 2075 7369 6e67  ask raster using
+0001f790: 2067 6461 6c20 616e 6420 7573 650d 0a20   gdal and use.. 
+0001f7a0: 2020 2020 2020 2020 2020 2069 7320 7468             is th
+0001f7b0: 6520 6669 7273 7420 7061 7261 6d65 7465  e first paramete
+0001f7c0: 7220 746f 2074 6865 2066 756e 6374 696f  r to the functio
+0001f7d0: 6e2e 0d0a 0d0a 2020 2020 2020 2020 5265  n.....        Re
+0001f7e0: 7475 726e 730d 0a20 2020 2020 2020 202d  turns..        -
+0001f7f0: 2d2d 2d2d 2d2d 0d0a 2020 2020 2020 2020  ------..        
+0001f800: 6e65 7720 7261 7374 6572 7320 6861 7665  new rasters have
+0001f810: 2074 6865 2076 616c 7565 7320 6672 6f6d   the values from
+0001f820: 2072 6173 7465 7273 2069 6e20 425f 696e   rasters in B_in
+0001f830: 7075 745f 7061 7468 2077 6974 6820 7468  put_path with th
+0001f840: 6520 4e6f 4461 7461 5661 6c75 6520 696e  e NoDataValue in
+0001f850: 2074 6865 2073 616d 650d 0a20 2020 2020   the same..     
+0001f860: 2020 206c 6f63 6174 696f 6e73 206c 696b     locations lik
+0001f870: 6520 7261 7374 6572 2041 2e0d 0a0d 0a20  e raster A..... 
+0001f880: 2020 2020 2020 2045 7861 6d70 6c65 730d         Examples.
+0001f890: 0a20 2020 2020 2020 202d 2d2d 2d2d 2d2d  .        -------
+0001f8a0: 2d0d 0a20 2020 2020 2020 203e 3e3e 2064  -..        >>> d
+0001f8b0: 656d 5f70 6174 6820 3d20 2265 7861 6d70  em_path = "examp
+0001f8c0: 6c65 732f 4749 532f 6461 7461 2f61 6363  les/GIS/data/acc
+0001f8d0: 3430 3030 2e74 6966 220d 0a20 2020 2020  4000.tif"..     
+0001f8e0: 2020 203e 3e3e 2073 7263 5f70 6174 6820     >>> src_path 
+0001f8f0: 3d20 2265 7861 6d70 6c65 732f 4749 532f  = "examples/GIS/
+0001f900: 6461 7461 2f61 6c69 676e 6564 5f72 6173  data/aligned_ras
+0001f910: 7465 7273 2f22 0d0a 2020 2020 2020 2020  ters/"..        
+0001f920: 3e3e 3e20 6f75 745f 7061 7468 203d 2022  >>> out_path = "
+0001f930: 6578 616d 706c 6573 2f47 4953 2f64 6174  examples/GIS/dat
+0001f940: 612f 6372 6f70 5f61 6c69 676e 6564 5f66  a/crop_aligned_f
+0001f950: 6f6c 6465 722f 220d 0a20 2020 2020 2020  older/"..       
+0001f960: 203e 3e3e 2044 6174 6163 7562 652e 6372   >>> Datacube.cr
+0001f970: 6f70 2864 656d 5f70 6174 682c 2073 7263  op(dem_path, src
+0001f980: 5f70 6174 682c 206f 7574 5f70 6174 6829  _path, out_path)
+0001f990: 0d0a 2020 2020 2020 2020 2222 220d 0a20  ..        """.. 
+0001f9a0: 2020 2020 2020 2066 6f72 2069 2069 6e20         for i in 
+0001f9b0: 7261 6e67 6528 7365 6c66 2e74 696d 655f  range(self.time_
+0001f9c0: 6c65 6e67 7468 293a 0d0a 2020 2020 2020  length):..      
+0001f9d0: 2020 2020 2020 7372 6320 3d20 7365 6c66        src = self
+0001f9e0: 2e69 6c6f 6328 6929 0d0a 2020 2020 2020  .iloc(i)..      
+0001f9f0: 2020 2020 2020 6473 7420 3d20 7372 632e        dst = src.
+0001fa00: 6372 6f70 286d 6173 6b29 0d0a 2020 2020  crop(mask)..    
+0001fa10: 2020 2020 2020 2020 6172 7220 3d20 6473          arr = ds
+0001fa20: 742e 7265 6164 5f61 7272 6179 2829 0d0a  t.read_array()..
+0001fa30: 2020 2020 2020 2020 2020 2020 6966 2069              if i
+0001fa40: 203d 3d20 303a 0d0a 2020 2020 2020 2020   == 0:..        
+0001fa50: 2020 2020 2020 2020 2320 6372 6561 7465          # create
+0001fa60: 2074 6865 2061 7272 6179 0d0a 2020 2020   the array..    
+0001fa70: 2020 2020 2020 2020 2020 2020 6172 7261              arra
+0001fa80: 7920 3d20 280d 0a20 2020 2020 2020 2020  y = (..         
+0001fa90: 2020 2020 2020 2020 2020 206e 702e 6f6e             np.on
+0001faa0: 6573 280d 0a20 2020 2020 2020 2020 2020  es(..           
+0001fab0: 2020 2020 2020 2020 2020 2020 2028 0d0a               (..
+0001fac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001fad0: 2020 2020 2020 2020 2020 2020 7365 6c66              self
+0001fae0: 2e74 696d 655f 6c65 6e67 7468 2c0d 0a20  .time_length,.. 
+0001faf0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001fb00: 2020 2020 2020 2020 2020 2061 7272 2e73             arr.s
+0001fb10: 6861 7065 5b30 5d2c 0d0a 2020 2020 2020  hape[0],..      
+0001fb20: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001fb30: 2020 2020 2020 6172 722e 7368 6170 655b        arr.shape[
+0001fb40: 315d 2c0d 0a20 2020 2020 2020 2020 2020  1],..           
+0001fb50: 2020 2020 2020 2020 2020 2020 2029 0d0a               )..
+0001fb60: 2020 2020 2020 2020 2020 2020 2020 2020                  
+0001fb70: 2020 2020 290d 0a20 2020 2020 2020 2020      )..         
+0001fb80: 2020 2020 2020 2020 2020 202a 206e 702e             * np.
+0001fb90: 6e61 6e0d 0a20 2020 2020 2020 2020 2020  nan..           
+0001fba0: 2020 2020 2029 0d0a 2020 2020 2020 2020       )..        
+0001fbb0: 2020 2020 6172 7261 795b 692c 203a 2c20      array[i, :, 
+0001fbc0: 3a5d 203d 2061 7272 0d0a 0d0a 2020 2020  :] = arr....    
+0001fbd0: 2020 2020 7365 6c66 2e5f 6461 7461 203d      self._data =
+0001fbe0: 2061 7272 6179 0d0a 2020 2020 2020 2020   array..        
+0001fbf0: 2320 7573 6520 7468 6520 6c61 7374 2073  # use the last s
+0001fc00: 7263 2061 730d 0a20 2020 2020 2020 2073  rc as..        s
+0001fc10: 656c 662e 5f62 6173 6520 3d20 6473 740d  elf._base = dst.
+0001fc20: 0a0d 0a20 2020 2023 2023 2054 4f44 4f3a  ...    # # TODO:
+0001fc30: 206d 6572 6765 2052 6570 726f 6a65 6374   merge Reproject
+0001fc40: 4461 7461 7365 7420 616e 6420 5072 6f6a  Dataset and Proj
+0001fc50: 6563 7452 6173 7465 7220 7468 6579 2061  ectRaster they a
+0001fc60: 7265 2061 6c6d 6f73 7420 7468 6520 7361  re almost the sa
+0001fc70: 6d65 0d0a 2020 2020 2320 2320 544f 444f  me..    # # TODO
+0001fc80: 3a20 7374 696c 6c20 6e65 6564 7320 746f  : still needs to
+0001fc90: 2062 6520 7465 7374 6564 0d0a 2020 2020   be tested..    
+0001fca0: 2320 4073 7461 7469 636d 6574 686f 640d  # @staticmethod.
+0001fcb0: 0a20 2020 2023 2064 6566 2074 6f5f 6570  .    # def to_ep
+0001fcc0: 7367 280d 0a20 2020 2023 2020 2020 2020  sg(..    #      
+0001fcd0: 2020 2073 7263 3a20 6764 616c 2e44 6174     src: gdal.Dat
+0001fce0: 6163 7562 652c 0d0a 2020 2020 2320 2020  acube,..    #   
+0001fcf0: 2020 2020 2020 746f 5f65 7073 673a 2069        to_epsg: i
+0001fd00: 6e74 203d 2033 3835 372c 0d0a 2020 2020  nt = 3857,..    
+0001fd10: 2320 2020 2020 2020 2020 6365 6c6c 5f73  #         cell_s
+0001fd20: 697a 653a 2069 6e74 203d 205b 5d2c 0d0a  ize: int = [],..
+0001fd30: 2020 2020 2320 2020 2020 2020 2020 6d65      #         me
+0001fd40: 7468 6f64 3a20 7374 7220 3d20 224e 6561  thod: str = "Nea
+0001fd50: 7265 7374 222c 0d0a 2020 2020 230d 0a20  rest",..    #.. 
+0001fd60: 2020 2023 2029 202d 3e20 6764 616c 2e44     # ) -> gdal.D
+0001fd70: 6174 6163 7562 653a 0d0a 2020 2020 2320  atacube:..    # 
+0001fd80: 2020 2020 2222 2274 6f5f 6570 7367 2e0d      """to_epsg..
+0001fd90: 0a20 2020 2023 0d0a 2020 2020 2320 2020  .    #..    #   
+0001fda0: 2020 2020 2020 2d20 746f 5f65 7073 6720        - to_epsg 
+0001fdb0: 7265 7072 6f6a 6563 7473 2061 6e64 2072  reprojects and r
+0001fdc0: 6573 616d 706c 6573 2061 2066 6f6c 6465  esamples a folde
+0001fdd0: 7220 6f66 2072 6173 7465 7273 2074 6f20  r of rasters to 
+0001fde0: 616e 7920 7072 6f6a 6563 7469 6f6e 0d0a  any projection..
+0001fdf0: 2020 2020 2320 2020 2020 2020 2020 2864      #         (d
+0001fe00: 6566 6175 6c74 2074 6865 2057 4753 3834  efault the WGS84
+0001fe10: 2077 6562 206d 6572 6361 746f 7220 7072   web mercator pr
+0001fe20: 6f6a 6563 7469 6f6e 2c20 7769 7468 6f75  ojection, withou
+0001fe30: 7420 7265 7361 6d70 6c69 6e67 290d 0a20  t resampling).. 
+0001fe40: 2020 2023 0d0a 2020 2020 2320 2020 2020     #..    #     
+0001fe50: 5061 7261 6d65 7465 7273 0d0a 2020 2020  Parameters..    
+0001fe60: 2320 2020 2020 2d2d 2d2d 2d2d 2d2d 2d2d  #     ----------
+0001fe70: 0d0a 2020 2020 2320 2020 2020 7372 633a  ..    #     src:
+0001fe80: 205b 6764 616c 2064 6174 6173 6574 5d0d   [gdal dataset].
+0001fe90: 0a20 2020 2023 2020 2020 2020 2020 2067  .    #         g
+0001fea0: 6461 6c20 6461 7461 7365 7420 6f62 6a65  dal dataset obje
+0001feb0: 6374 2028 7372 633d 6764 616c 2e4f 7065  ct (src=gdal.Ope
+0001fec0: 6e28 2264 656d 2e74 6966 2229 290d 0a20  n("dem.tif")).. 
+0001fed0: 2020 2023 2020 2020 2074 6f5f 6570 7367     #     to_epsg
+0001fee0: 3a20 5b69 6e74 6567 6572 5d0d 0a20 2020  : [integer]..   
+0001fef0: 2023 2020 2020 2020 2020 2020 7265 6665   #          refe
+0001ff00: 7265 6e63 6520 6e75 6d62 6572 2074 6f20  rence number to 
+0001ff10: 7468 6520 6e65 7720 7072 6f6a 6563 7469  the new projecti
+0001ff20: 6f6e 2028 6874 7470 733a 2f2f 6570 7367  on (https://epsg
+0001ff30: 2e69 6f2f 290d 0a20 2020 2023 2020 2020  .io/)..    #    
+0001ff40: 2020 2020 2028 6465 6661 756c 7420 3338       (default 38
+0001ff50: 3537 2074 6865 2072 6566 6572 656e 6365  57 the reference
+0001ff60: 206e 6f20 6f66 2057 4753 3834 2077 6562   no of WGS84 web
+0001ff70: 206d 6572 6361 746f 7220 290d 0a20 2020   mercator )..   
+0001ff80: 2023 2020 2020 2063 656c 6c5f 7369 7a65   #     cell_size
+0001ff90: 3a20 5b69 6e74 6567 6572 5d0d 0a20 2020  : [integer]..   
+0001ffa0: 2023 2020 2020 2020 2020 2020 6e75 6d62   #          numb
+0001ffb0: 6572 2074 6f20 7265 7361 6d70 6c65 2074  er to resample t
+0001ffc0: 6865 2072 6173 7465 7220 6365 6c6c 2073  he raster cell s
+0001ffd0: 697a 6520 746f 2061 206e 6577 2063 656c  ize to a new cel
+0001ffe0: 6c20 7369 7a65 0d0a 2020 2020 2320 2020  l size..    #   
+0001fff0: 2020 2020 2020 2864 6566 6175 6c74 2065        (default e
+00020000: 6d70 7479 2073 6f20 7261 7374 6572 2077  mpty so raster w
+00020010: 696c 6c20 6e6f 7420 6265 2072 6573 616d  ill not be resam
+00020020: 706c 6564 290d 0a20 2020 2023 2020 2020  pled)..    #    
+00020030: 206d 6574 686f 643a 205b 5374 7269 6e67   method: [String
+00020040: 5d0d 0a20 2020 2023 2020 2020 2020 2020  ]..    #        
+00020050: 2072 6573 616d 706c 696e 6720 7465 6368   resampling tech
+00020060: 6e69 7175 6520 6465 6661 756c 7420 6973  nique default is
+00020070: 2022 4e65 6172 6573 7422 0d0a 2020 2020   "Nearest"..    
+00020080: 2320 2020 2020 2020 2020 6874 7470 733a  #         https:
+00020090: 2f2f 6769 7367 656f 6772 6170 6879 2e63  //gisgeography.c
+000200a0: 6f6d 2f72 6173 7465 722d 7265 7361 6d70  om/raster-resamp
+000200b0: 6c69 6e67 2f0d 0a20 2020 2023 2020 2020  ling/..    #    
+000200c0: 2020 2020 2022 4e65 6172 6573 7422 2066       "Nearest" f
+000200d0: 6f72 206e 6561 7265 7374 206e 6569 6768  or nearest neigh
+000200e0: 626f 7572 2c22 6375 6269 6322 2066 6f72  bour,"cubic" for
+000200f0: 2063 7562 6963 2063 6f6e 766f 6c75 7469   cubic convoluti
+00020100: 6f6e 2c0d 0a20 2020 2023 2020 2020 2020  on,..    #      
+00020110: 2020 2022 6269 6c69 6e65 6172 2220 666f     "bilinear" fo
+00020120: 7220 6269 6c69 6e65 6172 0d0a 2020 2020  r bilinear..    
+00020130: 230d 0a20 2020 2023 2020 2020 2052 6574  #..    #     Ret
+00020140: 7572 6e73 0d0a 2020 2020 2320 2020 2020  urns..    #     
+00020150: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2023 2020  -------..    #  
+00020160: 2020 2072 6173 7465 723a 205b 6764 616c     raster: [gdal
+00020170: 2044 6174 6163 7562 655d 0d0a 2020 2020   Datacube]..    
+00020180: 2320 2020 2020 2020 2020 2061 2047 4441  #          a GDA
+00020190: 4c20 696e 2d6d 656d 6f72 7920 6669 6c65  L in-memory file
+000201a0: 206f 626a 6563 742c 2077 6865 7265 2079   object, where y
+000201b0: 6f75 2063 616e 2052 6561 6441 7341 7272  ou can ReadAsArr
+000201c0: 6179 2065 7463 2e0d 0a20 2020 2023 2020  ay etc...    #  
+000201d0: 2020 2022 2222 0d0a 2020 2020 2320 2020     """..    #   
+000201e0: 2020 6966 206e 6f74 2069 7369 6e73 7461    if not isinsta
+000201f0: 6e63 6528 7372 632c 2067 6461 6c2e 4461  nce(src, gdal.Da
+00020200: 7461 6375 6265 293a 0d0a 2020 2020 2320  tacube):..    # 
+00020210: 2020 2020 2020 2020 7261 6973 6520 5479          raise Ty
+00020220: 7065 4572 726f 7228 0d0a 2020 2020 2320  peError(..    # 
+00020230: 2020 2020 2020 2020 2020 2020 2273 7263              "src
+00020240: 2073 686f 756c 6420 6265 2072 6561 6420   should be read 
+00020250: 7573 696e 6720 6764 616c 2028 6764 616c  using gdal (gdal
+00020260: 2064 6174 6173 6574 2070 6c65 6173 6520   dataset please 
+00020270: 7265 6164 2069 7420 7573 696e 6720 6764  read it using gd
+00020280: 616c 220d 0a20 2020 2023 2020 2020 2020  al"..    #      
+00020290: 2020 2020 2020 2066 2220 6c69 6272 6172         f" librar
+000202a0: 7929 2067 6976 656e 207b 7479 7065 2873  y) given {type(s
+000202b0: 7263 297d 220d 0a20 2020 2023 2020 2020  rc)}"..    #    
+000202c0: 2020 2020 2029 0d0a 2020 2020 2320 2020       )..    #   
+000202d0: 2020 6966 206e 6f74 2069 7369 6e73 7461    if not isinsta
+000202e0: 6e63 6528 746f 5f65 7073 672c 2069 6e74  nce(to_epsg, int
+000202f0: 293a 0d0a 2020 2020 2320 2020 2020 2020  ):..    #       
+00020300: 2020 7261 6973 6520 5479 7065 4572 726f    raise TypeErro
+00020310: 7228 0d0a 2020 2020 2320 2020 2020 2020  r(..    #       
+00020320: 2020 2020 2020 2270 6c65 6173 6520 656e        "please en
+00020330: 7465 7220 636f 7272 6563 7420 696e 7465  ter correct inte
+00020340: 6765 7220 6e75 6d62 6572 2066 6f72 2074  ger number for t
+00020350: 6f5f 6570 7367 206d 6f72 6520 696e 666f  o_epsg more info
+00020360: 726d 6174 696f 6e20 220d 0a20 2020 2023  rmation "..    #
+00020370: 2020 2020 2020 2020 2020 2020 2066 2268               f"h
+00020380: 7474 7073 3a2f 2f65 7073 672e 696f 2f2c  ttps://epsg.io/,
+00020390: 2067 6976 656e 207b 7479 7065 2874 6f5f   given {type(to_
+000203a0: 6570 7367 297d 220d 0a20 2020 2023 2020  epsg)}"..    #  
+000203b0: 2020 2020 2020 2029 0d0a 2020 2020 2320         )..    # 
+000203c0: 2020 2020 6966 206e 6f74 2069 7369 6e73      if not isins
+000203d0: 7461 6e63 6528 6d65 7468 6f64 2c20 7374  tance(method, st
+000203e0: 7229 3a0d 0a20 2020 2023 2020 2020 2020  r):..    #      
+000203f0: 2020 2072 6169 7365 2054 7970 6545 7272     raise TypeErr
+00020400: 6f72 280d 0a20 2020 2023 2020 2020 2020  or(..    #      
+00020410: 2020 2020 2020 2022 706c 6561 7365 2065         "please e
+00020420: 6e74 6572 2063 6f72 7265 6374 206d 6574  nter correct met
+00020430: 686f 6420 6d6f 7265 2069 6e66 6f72 6d61  hod more informa
+00020440: 7469 6f6e 2073 6565 2022 2022 646f 636d  tion see " "docm
+00020450: 656e 7461 7469 6f6e 2022 0d0a 2020 2020  entation "..    
+00020460: 2320 2020 2020 2020 2020 290d 0a20 2020  #         )..   
+00020470: 2023 0d0a 2020 2020 2320 2020 2020 6966   #..    #     if
+00020480: 2063 656c 6c5f 7369 7a65 3a0d 0a20 2020   cell_size:..   
+00020490: 2023 2020 2020 2020 2020 2061 7373 6572   #         asser
+000204a0: 7420 6973 696e 7374 616e 6365 2863 656c  t isinstance(cel
+000204b0: 6c5f 7369 7a65 2c20 696e 7429 206f 7220  l_size, int) or 
+000204c0: 6973 696e 7374 616e 6365 280d 0a20 2020  isinstance(..   
+000204d0: 2023 2020 2020 2020 2020 2020 2020 2063   #             c
+000204e0: 656c 6c5f 7369 7a65 2c20 666c 6f61 740d  ell_size, float.
+000204f0: 0a20 2020 2023 2020 2020 2020 2020 2029  .    #         )
+00020500: 2c20 2270 6c65 6173 6520 656e 7465 7220  , "please enter 
+00020510: 616e 2069 6e74 6567 6572 206f 7220 666c  an integer or fl
+00020520: 6f61 7420 6365 6c6c 2073 697a 6522 0d0a  oat cell size"..
+00020530: 2020 2020 230d 0a20 2020 2023 2020 2020      #..    #    
+00020540: 2069 6620 6d65 7468 6f64 203d 3d20 224e   if method == "N
+00020550: 6561 7265 7374 223a 0d0a 2020 2020 2320  earest":..    # 
+00020560: 2020 2020 2020 2020 6d65 7468 6f64 203d          method =
+00020570: 2067 6461 6c2e 4752 415f 4e65 6172 6573   gdal.GRA_Neares
+00020580: 744e 6569 6768 626f 7572 0d0a 2020 2020  tNeighbour..    
+00020590: 2320 2020 2020 656c 6966 206d 6574 686f  #     elif metho
+000205a0: 6420 3d3d 2022 6375 6269 6322 3a0d 0a20  d == "cubic":.. 
+000205b0: 2020 2023 2020 2020 2020 2020 206d 6574     #         met
+000205c0: 686f 6420 3d20 6764 616c 2e47 5241 5f43  hod = gdal.GRA_C
+000205d0: 7562 6963 0d0a 2020 2020 2320 2020 2020  ubic..    #     
+000205e0: 656c 6966 206d 6574 686f 6420 3d3d 2022  elif method == "
+000205f0: 6269 6c69 6e65 6172 223a 0d0a 2020 2020  bilinear":..    
+00020600: 2320 2020 2020 2020 2020 6d65 7468 6f64  #         method
+00020610: 203d 2067 6461 6c2e 4752 415f 4269 6c69   = gdal.GRA_Bili
+00020620: 6e65 6172 0d0a 2020 2020 230d 0a20 2020  near..    #..   
+00020630: 2023 2020 2020 2073 7263 5f70 726f 6a20   #     src_proj 
+00020640: 3d20 7372 632e 4765 7450 726f 6a65 6374  = src.GetProject
+00020650: 696f 6e28 290d 0a20 2020 2023 2020 2020  ion()..    #    
+00020660: 2073 7263 5f67 7420 3d20 7372 632e 4765   src_gt = src.Ge
+00020670: 7447 656f 5472 616e 7366 6f72 6d28 290d  tGeoTransform().
+00020680: 0a20 2020 2023 2020 2020 2073 7263 5f78  .    #     src_x
+00020690: 203d 2073 7263 2e52 6173 7465 7258 5369   = src.RasterXSi
+000206a0: 7a65 0d0a 2020 2020 2320 2020 2020 7372  ze..    #     sr
+000206b0: 635f 7920 3d20 7372 632e 5261 7374 6572  c_y = src.Raster
+000206c0: 5953 697a 650d 0a20 2020 2023 2020 2020  YSize..    #    
+000206d0: 2064 7479 7065 203d 2073 7263 2e47 6574   dtype = src.Get
+000206e0: 5261 7374 6572 4261 6e64 2831 292e 4461  RasterBand(1).Da
+000206f0: 7461 5479 7065 0d0a 2020 2020 2320 2020  taType..    #   
+00020700: 2020 2320 7370 6174 6961 6c20 7265 660d    # spatial ref.
+00020710: 0a20 2020 2023 2020 2020 2073 7263 5f73  .    #     src_s
+00020720: 7220 3d20 6f73 722e 5370 6174 6961 6c52  r = osr.SpatialR
+00020730: 6566 6572 656e 6365 2877 6b74 3d73 7263  eference(wkt=src
+00020740: 5f70 726f 6a29 0d0a 2020 2020 2320 2020  _proj)..    #   
+00020750: 2020 7372 635f 6570 7367 203d 2073 7263    src_epsg = src
+00020760: 5f73 722e 4765 7441 7474 7256 616c 7565  _sr.GetAttrValue
+00020770: 2822 4155 5448 4f52 4954 5922 2c20 3129  ("AUTHORITY", 1)
+00020780: 0d0a 2020 2020 230d 0a20 2020 2023 2020  ..    #..    #  
+00020790: 2020 2023 2064 6973 7469 6e61 7469 6f6e     # distination
+000207a0: 0d0a 2020 2020 2320 2020 2020 2320 7370  ..    #     # sp
+000207b0: 6174 6961 6c20 7265 660d 0a20 2020 2023  atial ref..    #
+000207c0: 2020 2020 2064 7374 5f65 7073 6720 3d20       dst_epsg = 
+000207d0: 6f73 722e 5370 6174 6961 6c52 6566 6572  osr.SpatialRefer
+000207e0: 656e 6365 2829 0d0a 2020 2020 2320 2020  ence()..    #   
+000207f0: 2020 6473 745f 6570 7367 2e49 6d70 6f72    dst_epsg.Impor
+00020800: 7446 726f 6d45 5053 4728 746f 5f65 7073  tFromEPSG(to_eps
+00020810: 6729 0d0a 2020 2020 2320 2020 2020 2320  g)..    #     # 
+00020820: 7472 616e 7366 6f72 6d61 7469 6f6e 2066  transformation f
+00020830: 6163 746f 7273 0d0a 2020 2020 2320 2020  actors..    #   
+00020840: 2020 7478 203d 206f 7372 2e43 6f6f 7264    tx = osr.Coord
+00020850: 696e 6174 6554 7261 6e73 666f 726d 6174  inateTransformat
+00020860: 696f 6e28 7372 635f 7372 2c20 6473 745f  ion(src_sr, dst_
+00020870: 6570 7367 290d 0a20 2020 2023 0d0a 2020  epsg)..    #..  
+00020880: 2020 2320 2020 2020 2320 696e 6361 7365    #     # incase
+00020890: 2074 6865 2073 6f75 7263 6520 6372 7320   the source crs 
+000208a0: 6973 2047 4353 2061 6e64 206c 6f6e 6769  is GCS and longi
+000208b0: 7475 6465 2069 7320 696e 2074 6865 2077  tude is in the w
+000208c0: 6573 7420 6865 6d69 7370 6865 7265 2067  est hemisphere g
+000208d0: 6461 6c0d 0a20 2020 2023 2020 2020 2023  dal..    #     #
+000208e0: 2072 6561 6473 206c 6f6e 6769 7475 6465   reads longitude
+000208f0: 2066 726f 6e20 3020 746f 2033 3630 2061   fron 0 to 360 a
+00020900: 6e64 2074 7261 6e73 666f 726d 6174 696f  nd transformatio
+00020910: 6e20 6661 6374 6f72 2077 6f6e 7420 776f  n factor wont wo
+00020920: 726b 2077 6974 6820 7661 6c65 7573 0d0a  rk with valeus..
+00020930: 2020 2020 2320 2020 2020 2320 6772 6561      #     # grea
+00020940: 7465 7220 7468 616e 2031 3830 0d0a 2020  ter than 180..  
+00020950: 2020 2320 2020 2020 6966 2073 7263 5f65    #     if src_e
+00020960: 7073 6720 3d3d 2022 3433 3236 2220 616e  psg == "4326" an
+00020970: 6420 7372 635f 6774 5b30 5d20 3e20 3138  d src_gt[0] > 18
+00020980: 303a 0d0a 2020 2020 2320 2020 2020 2020  0:..    #       
+00020990: 2020 6c6e 675f 6e65 7720 3d20 7372 635f    lng_new = src_
+000209a0: 6774 5b30 5d20 2d20 3336 300d 0a20 2020  gt[0] - 360..   
+000209b0: 2023 2020 2020 2020 2020 2023 2074 7261   #         # tra
+000209c0: 6e73 666f 726d 2074 6865 2072 6967 6874  nsform the right
+000209d0: 2075 7070 6572 2063 6f72 6e65 7220 706f   upper corner po
+000209e0: 696e 740d 0a20 2020 2023 2020 2020 2020  int..    #      
+000209f0: 2020 2028 756c 782c 2075 6c79 2c20 756c     (ulx, uly, ul
+00020a00: 7a29 203d 2074 782e 5472 616e 7366 6f72  z) = tx.Transfor
+00020a10: 6d50 6f69 6e74 286c 6e67 5f6e 6577 2c20  mPoint(lng_new, 
+00020a20: 7372 635f 6774 5b33 5d29 0d0a 2020 2020  src_gt[3])..    
+00020a30: 2320 2020 2020 2020 2020 2320 7472 616e  #         # tran
+00020a40: 7366 6f72 6d20 7468 6520 7269 6768 7420  sform the right 
+00020a50: 6c6f 7765 7220 636f 726e 6572 2070 6f69  lower corner poi
+00020a60: 6e74 0d0a 2020 2020 2320 2020 2020 2020  nt..    #       
+00020a70: 2020 286c 7278 2c20 6c72 792c 206c 727a    (lrx, lry, lrz
+00020a80: 2920 3d20 7478 2e54 7261 6e73 666f 726d  ) = tx.Transform
+00020a90: 506f 696e 7428 0d0a 2020 2020 2320 2020  Point(..    #   
+00020aa0: 2020 2020 2020 2020 2020 6c6e 675f 6e65            lng_ne
+00020ab0: 7720 2b20 7372 635f 6774 5b31 5d20 2a20  w + src_gt[1] * 
+00020ac0: 7372 635f 782c 2073 7263 5f67 745b 335d  src_x, src_gt[3]
+00020ad0: 202b 2073 7263 5f67 745b 355d 202a 2073   + src_gt[5] * s
+00020ae0: 7263 5f79 0d0a 2020 2020 2320 2020 2020  rc_y..    #     
+00020af0: 2020 2020 290d 0a20 2020 2023 2020 2020      )..    #    
+00020b00: 2065 6c73 653a 0d0a 2020 2020 2320 2020   else:..    #   
+00020b10: 2020 2020 2020 2320 7472 616e 7366 6f72        # transfor
+00020b20: 6d20 7468 6520 7269 6768 7420 7570 7065  m the right uppe
+00020b30: 7220 636f 726e 6572 2070 6f69 6e74 0d0a  r corner point..
+00020b40: 2020 2020 2320 2020 2020 2020 2020 2875      #         (u
+00020b50: 6c78 2c20 756c 792c 2075 6c7a 2920 3d20  lx, uly, ulz) = 
+00020b60: 7478 2e54 7261 6e73 666f 726d 506f 696e  tx.TransformPoin
+00020b70: 7428 7372 635f 6774 5b30 5d2c 2073 7263  t(src_gt[0], src
+00020b80: 5f67 745b 335d 290d 0a20 2020 2023 2020  _gt[3])..    #  
+00020b90: 2020 2020 2020 2023 2074 7261 6e73 666f         # transfo
+00020ba0: 726d 2074 6865 2072 6967 6874 206c 6f77  rm the right low
+00020bb0: 6572 2063 6f72 6e65 7220 706f 696e 740d  er corner point.
+00020bc0: 0a20 2020 2023 2020 2020 2020 2020 2028  .    #         (
+00020bd0: 6c72 782c 206c 7279 2c20 6c72 7a29 203d  lrx, lry, lrz) =
+00020be0: 2074 782e 5472 616e 7366 6f72 6d50 6f69   tx.TransformPoi
+00020bf0: 6e74 280d 0a20 2020 2023 2020 2020 2020  nt(..    #      
+00020c00: 2020 2020 2020 2073 7263 5f67 745b 305d         src_gt[0]
+00020c10: 202b 2073 7263 5f67 745b 315d 202a 2073   + src_gt[1] * s
+00020c20: 7263 5f78 2c20 7372 635f 6774 5b33 5d20  rc_x, src_gt[3] 
+00020c30: 2b20 7372 635f 6774 5b35 5d20 2a20 7372  + src_gt[5] * sr
+00020c40: 635f 790d 0a20 2020 2023 2020 2020 2020  c_y..    #      
+00020c50: 2020 2029 0d0a 2020 2020 230d 0a20 2020     )..    #..   
+00020c60: 2023 2020 2020 2069 6620 6e6f 7420 6365   #     if not ce
+00020c70: 6c6c 5f73 697a 653a 0d0a 2020 2020 2320  ll_size:..    # 
+00020c80: 2020 2020 2020 2020 2320 7468 6520 7265          # the re
+00020c90: 7375 6c74 2072 6173 7465 7220 6861 7320  sult raster has 
+00020ca0: 7468 6520 7361 6d65 2070 6978 6365 6c20  the same pixcel 
+00020cb0: 7369 7a65 2061 7320 7468 6520 736f 7572  size as the sour
+00020cc0: 6365 0d0a 2020 2020 2320 2020 2020 2020  ce..    #       
+00020cd0: 2020 2320 6368 6563 6b20 6966 2074 6865    # check if the
+00020ce0: 2063 6f6f 7264 696e 6174 6520 7379 7374   coordinate syst
+00020cf0: 656d 2069 7320 4743 5320 636f 6e76 6572  em is GCS conver
+00020d00: 7420 7468 6520 6469 7374 616e 6365 2066  t the distance f
+00020d10: 726f 6d20 616e 6775 6c61 7220 746f 206d  rom angular to m
+00020d20: 6574 7269 630d 0a20 2020 2023 2020 2020  etric..    #    
+00020d30: 2020 2020 2069 6620 7372 635f 6570 7367       if src_epsg
+00020d40: 203d 3d20 2234 3332 3622 3a0d 0a20 2020   == "4326":..   
+00020d50: 2023 2020 2020 2020 2020 2020 2020 2063   #             c
+00020d60: 6f6f 7264 735f 3120 3d20 2873 7263 5f67  oords_1 = (src_g
+00020d70: 745b 335d 2c20 7372 635f 6774 5b30 5d29  t[3], src_gt[0])
+00020d80: 0d0a 2020 2020 2320 2020 2020 2020 2020  ..    #         
+00020d90: 2020 2020 636f 6f72 6473 5f32 203d 2028      coords_2 = (
+00020da0: 7372 635f 6774 5b33 5d2c 2073 7263 5f67  src_gt[3], src_g
+00020db0: 745b 305d 202b 2073 7263 5f67 745b 315d  t[0] + src_gt[1]
+00020dc0: 290d 0a20 2020 2023 2020 2020 2020 2020  )..    #        
+00020dd0: 2020 2020 2023 2020 2020 2020 2020 2020       #          
+00020de0: 2020 7069 7865 6c5f 7370 6163 696e 673d    pixel_spacing=
+00020df0: 6765 6f70 792e 6469 7374 616e 6365 2e76  geopy.distance.v
+00020e00: 696e 6365 6e74 7928 636f 6f72 6473 5f31  incenty(coords_1
+00020e10: 2c20 636f 6f72 6473 5f32 292e 6d0d 0a20  , coords_2).m.. 
+00020e20: 2020 2023 2020 2020 2020 2020 2020 2020     #            
+00020e30: 2070 6978 656c 5f73 7061 6369 6e67 203d   pixel_spacing =
+00020e40: 2046 6561 7475 7265 436f 6c6c 6563 7469   FeatureCollecti
+00020e50: 6f6e 2e47 4353 4469 7374 616e 6365 2863  on.GCSDistance(c
+00020e60: 6f6f 7264 735f 312c 2063 6f6f 7264 735f  oords_1, coords_
+00020e70: 3229 0d0a 2020 2020 2320 2020 2020 2020  2)..    #       
+00020e80: 2020 656c 7365 3a0d 0a20 2020 2023 2020    else:..    #  
+00020e90: 2020 2020 2020 2020 2020 2070 6978 656c             pixel
+00020ea0: 5f73 7061 6369 6e67 203d 2073 7263 5f67  _spacing = src_g
+00020eb0: 745b 315d 0d0a 2020 2020 2320 2020 2020  t[1]..    #     
+00020ec0: 656c 7365 3a0d 0a20 2020 2023 2020 2020  else:..    #    
+00020ed0: 2020 2020 2023 2069 6620 7372 635f 6570       # if src_ep
+00020ee0: 7367 2e47 6574 4174 7472 5661 6c75 6528  sg.GetAttrValue(
+00020ef0: 2741 5554 484f 5249 5459 272c 2031 2920  'AUTHORITY', 1) 
+00020f00: 213d 2022 3433 3236 223a 0d0a 2020 2020  != "4326":..    
+00020f10: 2320 2020 2020 2020 2020 2320 2020 2020  #         #     
+00020f20: 6173 7365 7274 2028 6365 6c6c 5f73 697a  assert (cell_siz
+00020f30: 6520 3e20 3129 2c20 2270 6c65 6173 6520  e > 1), "please 
+00020f40: 656e 7465 7220 6365 6c6c 2073 697a 6520  enter cell size 
+00020f50: 6772 6561 7465 7220 7468 616e 2031 220d  greater than 1".
+00020f60: 0a20 2020 2023 2020 2020 2020 2020 2023  .    #         #
+00020f70: 2069 6620 7468 6520 7573 6572 2069 6e70   if the user inp
+00020f80: 7574 2061 2063 656c 6c20 7369 7a65 2072  ut a cell size r
+00020f90: 6573 616d 706c 6520 7468 6520 7261 7374  esample the rast
+00020fa0: 6572 0d0a 2020 2020 2320 2020 2020 2020  er..    #       
+00020fb0: 2020 7069 7865 6c5f 7370 6163 696e 6720    pixel_spacing 
+00020fc0: 3d20 6365 6c6c 5f73 697a 650d 0a20 2020  = cell_size..   
+00020fd0: 2023 0d0a 2020 2020 2320 2020 2020 2320   #..    #     # 
+00020fe0: 6372 6561 7465 2061 206e 6577 2072 6173  create a new ras
+00020ff0: 7465 720d 0a20 2020 2023 2020 2020 2063  ter..    #     c
+00021000: 6f6c 7320 3d20 696e 7428 6e70 2e72 6f75  ols = int(np.rou
+00021010: 6e64 2861 6273 286c 7278 202d 2075 6c78  nd(abs(lrx - ulx
+00021020: 2920 2f20 7069 7865 6c5f 7370 6163 696e  ) / pixel_spacin
+00021030: 6729 290d 0a20 2020 2023 2020 2020 2072  g))..    #     r
+00021040: 6f77 7320 3d20 696e 7428 6e70 2e72 6f75  ows = int(np.rou
+00021050: 6e64 2861 6273 2875 6c79 202d 206c 7279  nd(abs(uly - lry
+00021060: 2920 2f20 7069 7865 6c5f 7370 6163 696e  ) / pixel_spacin
+00021070: 6729 290d 0a20 2020 2023 2020 2020 2064  g))..    #     d
+00021080: 7374 203d 2044 6174 6173 6574 2e5f 6372  st = Dataset._cr
+00021090: 6561 7465 5f64 6174 6173 6574 2863 6f6c  eate_dataset(col
+000210a0: 732c 2072 6f77 732c 2031 2c20 6474 7970  s, rows, 1, dtyp
+000210b0: 652c 2064 7269 7665 723d 224d 454d 2229  e, driver="MEM")
+000210c0: 0d0a 2020 2020 230d 0a20 2020 2023 2020  ..    #..    #  
+000210d0: 2020 2023 206e 6577 2067 656f 7472 616e     # new geotran
+000210e0: 7366 6f72 6d0d 0a20 2020 2023 2020 2020  sform..    #    
+000210f0: 206e 6577 5f67 656f 203d 2028 756c 782c   new_geo = (ulx,
+00021100: 2070 6978 656c 5f73 7061 6369 6e67 2c20   pixel_spacing, 
+00021110: 7372 635f 6774 5b32 5d2c 2075 6c79 2c20  src_gt[2], uly, 
+00021120: 7372 635f 6774 5b34 5d2c 202d 7069 7865  src_gt[4], -pixe
+00021130: 6c5f 7370 6163 696e 6729 0d0a 2020 2020  l_spacing)..    
+00021140: 2320 2020 2020 2320 7365 7420 7468 6520  #     # set the 
+00021150: 6765 6f74 7261 6e73 666f 726d 0d0a 2020  geotransform..  
+00021160: 2020 2320 2020 2020 6473 742e 5365 7447    #     dst.SetG
+00021170: 656f 5472 616e 7366 6f72 6d28 6e65 775f  eoTransform(new_
+00021180: 6765 6f29 0d0a 2020 2020 2320 2020 2020  geo)..    #     
+00021190: 2320 7365 7420 7468 6520 7072 6f6a 6563  # set the projec
+000211a0: 7469 6f6e 0d0a 2020 2020 2320 2020 2020  tion..    #     
+000211b0: 6473 742e 5365 7450 726f 6a65 6374 696f  dst.SetProjectio
+000211c0: 6e28 6473 745f 6570 7367 2e45 7870 6f72  n(dst_epsg.Expor
+000211d0: 7454 6f57 6b74 2829 290d 0a20 2020 2023  tToWkt())..    #
+000211e0: 2020 2020 2023 2073 6574 2074 6865 206e       # set the n
+000211f0: 6f20 6461 7461 2076 616c 7565 0d0a 2020  o data value..  
+00021200: 2020 2320 2020 2020 6e6f 5f64 6174 615f    #     no_data_
+00021210: 7661 6c75 6520 3d20 7372 632e 4765 7452  value = src.GetR
+00021220: 6173 7465 7242 616e 6428 3129 2e47 6574  asterBand(1).Get
+00021230: 4e6f 4461 7461 5661 6c75 6528 290d 0a20  NoDataValue().. 
+00021240: 2020 2023 2020 2020 2064 7374 203d 2044     #     dst = D
+00021250: 6174 6173 6574 2e5f 7365 745f 6e6f 5f64  ataset._set_no_d
+00021260: 6174 615f 7661 6c75 6528 6473 742c 206e  ata_value(dst, n
+00021270: 6f5f 6461 7461 5f76 616c 7565 290d 0a20  o_data_value).. 
+00021280: 2020 2023 2020 2020 2023 2070 6572 666f     #     # perfo
+00021290: 726d 2074 6865 2070 726f 6a65 6374 696f  rm the projectio
+000212a0: 6e20 2620 7265 7361 6d70 6c69 6e67 0d0a  n & resampling..
+000212b0: 2020 2020 2320 2020 2020 6764 616c 2e52      #     gdal.R
+000212c0: 6570 726f 6a65 6374 496d 6167 6528 0d0a  eprojectImage(..
+000212d0: 2020 2020 2320 2020 2020 2020 2020 7372      #         sr
+000212e0: 632c 2064 7374 2c20 7372 635f 7372 2e45  c, dst, src_sr.E
+000212f0: 7870 6f72 7454 6f57 6b74 2829 2c20 6473  xportToWkt(), ds
+00021300: 745f 6570 7367 2e45 7870 6f72 7454 6f57  t_epsg.ExportToW
+00021310: 6b74 2829 2c20 6d65 7468 6f64 0d0a 2020  kt(), method..  
+00021320: 2020 2320 2020 2020 290d 0a20 2020 2023    #     )..    #
+00021330: 0d0a 2020 2020 2320 2020 2020 7265 7475  ..    #     retu
+00021340: 726e 2064 7374 0d0a 0d0a 2020 2020 6465  rn dst....    de
+00021350: 6620 616c 6967 6e28 7365 6c66 2c20 616c  f align(self, al
+00021360: 6967 6e6d 656e 745f 7372 633a 2044 6174  ignment_src: Dat
+00021370: 6173 6574 293a 0d0a 2020 2020 2020 2020  aset):..        
+00021380: 2222 226d 6174 6368 4461 7461 416c 6967  """matchDataAlig
+00021390: 6e6d 656e 742e 0d0a 0d0a 2020 2020 2020  nment.....      
+000213a0: 2020 7468 6973 2066 756e 6374 696f 6e20    this function 
+000213b0: 6d61 7463 6865 7320 7468 6520 636f 6f72  matches the coor
+000213c0: 6469 6e61 7465 2073 7973 7465 6d20 616e  dinate system an
+000213d0: 6420 7468 6520 6e75 6d62 6572 206f 6620  d the number of 
+000213e0: 6f66 2072 6f77 7320 2620 636f 6c75 6d6e  of rows & column
+000213f0: 730d 0a20 2020 2020 2020 2062 6574 7765  s..        betwe
+00021400: 656e 2074 776f 2072 6173 7465 7273 0d0a  en two rasters..
+00021410: 2020 2020 2020 2020 5261 7374 6572 2041          Raster A
+00021420: 2069 7320 7468 6520 736f 7572 6365 206f   is the source o
+00021430: 6620 7468 6520 636f 6f72 6469 6e61 7465  f the coordinate
+00021440: 2073 7973 7465 6d2c 206e 6f20 6f66 2072   system, no of r
+00021450: 6f77 7320 616e 6420 6e6f 206f 6620 636f  ows and no of co
+00021460: 6c75 6d6e 7320 2620 6365 6c6c 2073 697a  lumns & cell siz
+00021470: 650d 0a20 2020 2020 2020 2072 6173 7465  e..        raste
+00021480: 7273 5f64 6972 2069 7320 7061 7468 2074  rs_dir is path t
+00021490: 6f20 7468 6520 666f 6c64 6572 2077 6865  o the folder whe
+000214a0: 7265 2052 6173 7465 7220 4220 6578 6973  re Raster B exis
+000214b0: 7420 7768 6572 6520 2052 6173 7465 7220  t where  Raster 
+000214c0: 4220 6973 0d0a 2020 2020 2020 2020 7468  B is..        th
+000214d0: 6520 736f 7572 6365 206f 6620 6461 7461  e source of data
+000214e0: 2076 616c 7565 7320 696e 2063 656c 6c73   values in cells
+000214f0: 0d0a 2020 2020 2020 2020 7468 6520 7265  ..        the re
+00021500: 7375 6c74 2077 696c 6c20 6265 2061 2072  sult will be a r
+00021510: 6173 7465 7220 7769 7468 2074 6865 2073  aster with the s
+00021520: 616d 6520 7374 7275 6374 7572 6520 6c69  ame structure li
+00021530: 6b65 2052 6173 7465 7241 2062 7574 2077  ke RasterA but w
+00021540: 6974 680d 0a20 2020 2020 2020 2076 616c  ith..        val
+00021550: 7565 7320 6672 6f6d 2052 6173 7465 7242  ues from RasterB
+00021560: 2075 7369 6e67 204e 6561 7265 7374 204e   using Nearest N
+00021570: 6569 6768 626f 7572 2069 6e74 6572 706f  eighbour interpo
+00021580: 6c61 7469 6f6e 2061 6c67 6f72 6974 686d  lation algorithm
+00021590: 0d0a 0d0a 2020 2020 2020 2020 5061 7261  ....        Para
+000215a0: 6d65 7465 7273 0d0a 2020 2020 2020 2020  meters..        
+000215b0: 2d2d 2d2d 2d2d 2d2d 2d2d 0d0a 2020 2020  ----------..    
+000215c0: 2020 2020 616c 6967 6e6d 656e 745f 7372      alignment_sr
+000215d0: 633a 205b 5374 7269 6e67 5d0d 0a20 2020  c: [String]..   
+000215e0: 2020 2020 2020 2020 2070 6174 6820 746f           path to
+000215f0: 2074 6865 2073 7061 7469 616c 2069 6e66   the spatial inf
+00021600: 6f72 6d61 7469 6f6e 2073 6f75 7263 6520  ormation source 
+00021610: 7261 7374 6572 2074 6f20 6765 7420 7468  raster to get th
+00021620: 6520 7370 6174 6961 6c20 696e 666f 726d  e spatial inform
+00021630: 6174 696f 6e0d 0a20 2020 2020 2020 2020  ation..         
+00021640: 2020 2028 636f 6f72 6469 6e61 7465 2073     (coordinate s
+00021650: 7973 7465 6d2c 206e 6f20 6f66 2072 6f77  ystem, no of row
+00021660: 7320 2620 636f 6c75 6d6e 7329 2061 6c69  s & columns) ali
+00021670: 676e 6d65 6e74 5f73 7263 2073 686f 756c  gnment_src shoul
+00021680: 6420 696e 636c 7564 6520 7468 6520 6e61  d include the na
+00021690: 6d65 206f 6620 7468 6520 7261 7374 6572  me of the raster
+000216a0: 0d0a 2020 2020 2020 2020 2020 2020 616e  ..            an
+000216b0: 6420 7468 6520 6578 7465 6e73 696f 6e20  d the extension 
+000216c0: 6c69 6b65 2022 6461 7461 2f64 656d 2e74  like "data/dem.t
+000216d0: 6966 220d 0a0d 0a20 2020 2020 2020 2052  if"....        R
+000216e0: 6574 7572 6e73 0d0a 2020 2020 2020 2020  eturns..        
+000216f0: 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020 2020  -------..       
+00021700: 206e 6577 2072 6173 7465 7273 3a0d 0a20   new rasters:.. 
+00021710: 2020 2020 2020 2020 2020 20d9 8c52 6173             ..Ras
+00021720: 7465 7273 2068 6176 6520 7468 6520 7661  ters have the va
+00021730: 6c75 6573 2066 726f 6d20 7261 7374 6572  lues from raster
+00021740: 7320 696e 2072 6173 7465 7273 5f64 6972  s in rasters_dir
+00021750: 2077 6974 6820 7468 6520 7361 6d65 0d0a   with the same..
+00021760: 2020 2020 2020 2020 2020 2020 6365 6c6c              cell
+00021770: 2073 697a 652c 206e 6f20 6f66 2072 6f77   size, no of row
+00021780: 7320 2620 636f 6c75 6d6e 732c 2063 6f6f  s & columns, coo
+00021790: 7264 696e 6174 6520 7379 7374 656d 2061  rdinate system a
+000217a0: 6e64 2061 6c69 676e 6d65 6e74 206c 696b  nd alignment lik
+000217b0: 6520 7261 7374 6572 2041 0d0a 0d0a 2020  e raster A....  
+000217c0: 2020 2020 2020 4578 616d 706c 6573 0d0a        Examples..
+000217d0: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+000217e0: 0d0a 2020 2020 2020 2020 3e3e 3e20 6465  ..        >>> de
+000217f0: 6d5f 7061 7468 203d 2022 3031 4749 532f  m_path = "01GIS/
+00021800: 696e 7075 7473 2f34 3030 302f 6163 6334  inputs/4000/acc4
+00021810: 3030 302e 7469 6622 0d0a 2020 2020 2020  000.tif"..      
+00021820: 2020 3e3e 3e20 7072 6563 5f69 6e5f 7061    >>> prec_in_pa
+00021830: 7468 203d 2022 3032 5072 6563 6970 6974  th = "02Precipit
+00021840: 6174 696f 6e2f 4348 4952 5053 2f44 6169  ation/CHIRPS/Dai
+00021850: 6c79 2f22 0d0a 2020 2020 2020 2020 3e3e  ly/"..        >>
+00021860: 3e20 7072 6563 5f6f 7574 5f70 6174 6820  > prec_out_path 
+00021870: 3d20 2230 3250 7265 6369 7069 7461 7469  = "02Precipitati
+00021880: 6f6e 2f34 6b6d 2f22 0d0a 2020 2020 2020  on/4km/"..      
+00021890: 2020 3e3e 3e20 4461 7461 7365 742e 616c    >>> Dataset.al
+000218a0: 6967 6e28 6465 6d5f 7061 7468 2c70 7265  ign(dem_path,pre
+000218b0: 635f 696e 5f70 6174 682c 7072 6563 5f6f  c_in_path,prec_o
+000218c0: 7574 5f70 6174 6829 0d0a 2020 2020 2020  ut_path)..      
+000218d0: 2020 2222 220d 0a20 2020 2020 2020 2069    """..        i
+000218e0: 6620 6e6f 7420 6973 696e 7374 616e 6365  f not isinstance
+000218f0: 2861 6c69 676e 6d65 6e74 5f73 7263 2c20  (alignment_src, 
+00021900: 4461 7461 7365 7429 3a0d 0a20 2020 2020  Dataset):..     
+00021910: 2020 2020 2020 2072 6169 7365 2054 7970         raise Typ
+00021920: 6545 7272 6f72 2822 616c 6967 6e6d 656e  eError("alignmen
+00021930: 745f 7372 6320 696e 7075 7420 7368 6f75  t_src input shou
+00021940: 6c64 2062 6520 6120 4461 7461 7365 7420  ld be a Dataset 
+00021950: 6f62 6a65 6374 2229 0d0a 0d0a 2020 2020  object")....    
+00021960: 2020 2020 666f 7220 6920 696e 2072 616e      for i in ran
+00021970: 6765 2873 656c 662e 7469 6d65 5f6c 656e  ge(self.time_len
+00021980: 6774 6829 3a0d 0a20 2020 2020 2020 2020  gth):..         
+00021990: 2020 2073 7263 203d 2073 656c 662e 696c     src = self.il
+000219a0: 6f63 2869 290d 0a20 2020 2020 2020 2020  oc(i)..         
+000219b0: 2020 2064 7374 203d 2073 7263 2e61 6c69     dst = src.ali
+000219c0: 676e 2861 6c69 676e 6d65 6e74 5f73 7263  gn(alignment_src
+000219d0: 290d 0a20 2020 2020 2020 2020 2020 2061  )..            a
+000219e0: 7272 203d 2064 7374 2e72 6561 645f 6172  rr = dst.read_ar
+000219f0: 7261 7928 290d 0a20 2020 2020 2020 2020  ray()..         
+00021a00: 2020 2069 6620 6920 3d3d 2030 3a0d 0a20     if i == 0:.. 
+00021a10: 2020 2020 2020 2020 2020 2020 2020 2023                 #
+00021a20: 2063 7265 6174 6520 7468 6520 6172 7261   create the arra
+00021a30: 790d 0a20 2020 2020 2020 2020 2020 2020  y..             
+00021a40: 2020 2061 7272 6179 203d 2028 0d0a 2020     array = (..  
+00021a50: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021a60: 2020 6e70 2e6f 6e65 7328 0d0a 2020 2020    np.ones(..    
+00021a70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021a80: 2020 2020 280d 0a20 2020 2020 2020 2020      (..         
+00021a90: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021aa0: 2020 2073 656c 662e 7469 6d65 5f6c 656e     self.time_len
+00021ab0: 6774 682c 0d0a 2020 2020 2020 2020 2020  gth,..          
+00021ac0: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021ad0: 2020 6172 722e 7368 6170 655b 305d 2c0d    arr.shape[0],.
+00021ae0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00021af0: 2020 2020 2020 2020 2020 2020 2061 7272               arr
+00021b00: 2e73 6861 7065 5b31 5d2c 0d0a 2020 2020  .shape[1],..    
+00021b10: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021b20: 2020 2020 290d 0a20 2020 2020 2020 2020      )..         
+00021b30: 2020 2020 2020 2020 2020 2029 0d0a 2020             )..  
+00021b40: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00021b50: 2020 2a20 6e70 2e6e 616e 0d0a 2020 2020    * np.nan..    
+00021b60: 2020 2020 2020 2020 2020 2020 290d 0a20              ).. 
+00021b70: 2020 2020 2020 2020 2020 2061 7272 6179             array
+00021b80: 5b69 2c20 3a2c 203a 5d20 3d20 6172 720d  [i, :, :] = arr.
+00021b90: 0a0d 0a20 2020 2020 2020 2073 656c 662e  ...        self.
+00021ba0: 5f64 6174 6120 3d20 6172 7261 790d 0a20  _data = array.. 
+00021bb0: 2020 2020 2020 2023 2075 7365 2074 6865         # use the
+00021bc0: 206c 6173 7420 7372 6320 6173 0d0a 2020   last src as..  
+00021bd0: 2020 2020 2020 7365 6c66 2e5f 6261 7365        self._base
+00021be0: 203d 2064 7374 0d0a 0d0a 2020 2020 4073   = dst....    @s
+00021bf0: 7461 7469 636d 6574 686f 640d 0a20 2020  taticmethod..   
+00021c00: 2064 6566 206d 6572 6765 280d 0a20 2020   def merge(..   
+00021c10: 2020 2020 2073 7263 3a20 4c69 7374 5b73       src: List[s
+00021c20: 7472 5d2c 0d0a 2020 2020 2020 2020 6473  tr],..        ds
+00021c30: 743a 2073 7472 2c0d 0a20 2020 2020 2020  t: str,..       
+00021c40: 206e 6f5f 6461 7461 5f76 616c 7565 3a20   no_data_value: 
+00021c50: 556e 696f 6e5b 666c 6f61 742c 2069 6e74  Union[float, int
+00021c60: 2c20 7374 725d 203d 2022 3022 2c0d 0a20  , str] = "0",.. 
+00021c70: 2020 2020 2020 2069 6e69 743a 2055 6e69         init: Uni
+00021c80: 6f6e 5b66 6c6f 6174 2c20 696e 742c 2073  on[float, int, s
+00021c90: 7472 5d20 3d20 226e 616e 222c 0d0a 2020  tr] = "nan",..  
+00021ca0: 2020 2020 2020 6e3a 2055 6e69 6f6e 5b66        n: Union[f
+00021cb0: 6c6f 6174 2c20 696e 742c 2073 7472 5d20  loat, int, str] 
+00021cc0: 3d20 226e 616e 222c 0d0a 2020 2020 293a  = "nan",..    ):
+00021cd0: 0d0a 2020 2020 2020 2020 2222 226d 6572  ..        """mer
+00021ce0: 6765 2e0d 0a0d 0a20 2020 2020 2020 2020  ge.....         
+00021cf0: 2020 206d 6572 6765 7320 6772 6f75 7020     merges group 
+00021d00: 6f66 2072 6173 7465 7273 2069 6e74 6f20  of rasters into 
+00021d10: 6f6e 6520 7261 7374 6572 0d0a 0d0a 2020  one raster....  
+00021d20: 2020 2020 2020 5061 7261 6d65 7465 7273        Parameters
+00021d30: 0d0a 2020 2020 2020 2020 2d2d 2d2d 2d2d  ..        ------
+00021d40: 2d2d 2d2d 0d0a 2020 2020 2020 2020 7372  ----..        sr
+00021d50: 633a 204c 6973 745b 7374 725d 0d0a 2020  c: List[str]..  
+00021d60: 2020 2020 2020 2020 2020 6c69 7374 206f            list o
+00021d70: 6620 7468 6520 7061 7468 2074 6f20 616c  f the path to al
+00021d80: 6c20 696e 7075 7420 7261 7374 6572 0d0a  l input raster..
+00021d90: 2020 2020 2020 2020 6473 743a 205b 7374          dst: [st
+00021da0: 725d 0d0a 2020 2020 2020 2020 2020 2020  r]..            
+00021db0: 7061 7468 2074 6f20 7468 6520 6f75 7470  path to the outp
+00021dc0: 7574 2072 6173 7465 720d 0a20 2020 2020  ut raster..     
+00021dd0: 2020 206e 6f5f 6461 7461 5f76 616c 7565     no_data_value
+00021de0: 3a20 5b66 6c6f 6174 2f69 6e74 5d0d 0a20  : [float/int].. 
+00021df0: 2020 2020 2020 2020 2020 2041 7373 6967             Assig
+00021e00: 6e20 6120 7370 6563 6966 6965 6420 6e6f  n a specified no
+00021e10: 6461 7461 2076 616c 7565 2074 6f20 6f75  data value to ou
+00021e20: 7470 7574 2062 616e 6473 2e0d 0a20 2020  tput bands...   
+00021e30: 2020 2020 2069 6e69 743a 205b 666c 6f61       init: [floa
+00021e40: 742f 696e 745d 0d0a 2020 2020 2020 2020  t/int]..        
+00021e50: 2020 2020 5072 652d 696e 6974 6961 6c69      Pre-initiali
+00021e60: 7a65 2074 6865 206f 7574 7075 7420 696d  ze the output im
+00021e70: 6167 6520 6261 6e64 7320 7769 7468 2074  age bands with t
+00021e80: 6865 7365 2076 616c 7565 732e 2048 6f77  hese values. How
+00021e90: 6576 6572 2c20 6974 2069 7320 6e6f 7420  ever, it is not 
+00021ea0: 6d61 726b 6564 2061 7320 7468 6520 6e6f  marked as the no
+00021eb0: 6461 7461 2076 616c 7565 0d0a 2020 2020  data value..    
+00021ec0: 2020 2020 2020 2020 696e 2074 6865 206f          in the o
+00021ed0: 7574 7075 7420 6669 6c65 2e20 4966 206f  utput file. If o
+00021ee0: 6e6c 7920 6f6e 6520 7661 6c75 6520 6973  nly one value is
+00021ef0: 2067 6976 656e 2c20 7468 6520 7361 6d65   given, the same
+00021f00: 2076 616c 7565 2069 7320 7573 6564 2069   value is used i
+00021f10: 6e20 616c 6c20 7468 6520 6261 6e64 732e  n all the bands.
+00021f20: 0d0a 2020 2020 2020 2020 6e3a 205b 666c  ..        n: [fl
+00021f30: 6f61 742f 696e 745d 0d0a 2020 2020 2020  oat/int]..      
+00021f40: 2020 2020 2020 4967 6e6f 7265 2070 6978        Ignore pix
+00021f50: 656c 7320 6672 6f6d 2066 696c 6573 2062  els from files b
+00021f60: 6569 6e67 206d 6572 6765 6420 696e 2077  eing merged in w
+00021f70: 6974 6820 7468 6973 2070 6978 656c 2076  ith this pixel v
+00021f80: 616c 7565 2e0d 0a0d 0a20 2020 2020 2020  alue.....       
+00021f90: 2052 6574 7572 6e73 0d0a 2020 2020 2020   Returns..      
+00021fa0: 2020 2d2d 2d2d 2d2d 2d0d 0a20 2020 2020    -------..     
+00021fb0: 2020 204e 6f6e 650d 0a20 2020 2020 2020     None..       
+00021fc0: 2022 2222 0d0a 2020 2020 2020 2020 2320   """..        # 
+00021fd0: 7275 6e20 7468 6520 636f 6d6d 616e 640d  run the command.
+00021fe0: 0a20 2020 2020 2020 2023 2063 6d64 203d  .        # cmd =
+00021ff0: 2022 6764 616c 5f6d 6572 6765 2e70 7920   "gdal_merge.py 
+00022000: 2d6f 206d 6572 6765 645f 696d 6167 655f  -o merged_image_
+00022010: 312e 7469 6622 0d0a 2020 2020 2020 2020  1.tif"..        
+00022020: 2320 7375 6270 726f 6365 7373 2e63 616c  # subprocess.cal
+00022030: 6c28 636d 642e 7370 6c69 7428 2920 2b20  l(cmd.split() + 
+00022040: 6669 6c65 5f6c 6973 7429 0d0a 2020 2020  file_list)..    
+00022050: 2020 2020 2320 7672 7420 3d20 6764 616c      # vrt = gdal
+00022060: 2e42 7569 6c64 5652 5428 226d 6572 6765  .BuildVRT("merge
+00022070: 642e 7672 7422 2c20 6669 6c65 5f6c 6973  d.vrt", file_lis
+00022080: 7429 0d0a 2020 2020 2020 2020 2320 7372  t)..        # sr
+00022090: 6320 3d20 6764 616c 2e54 7261 6e73 6c61  c = gdal.Transla
+000220a0: 7465 2822 6d65 7267 6564 5f69 6d61 6765  te("merged_image
+000220b0: 2e74 6966 222c 2076 7274 290d 0a0d 0a20  .tif", vrt).... 
+000220c0: 2020 2020 2020 2070 6172 616d 6574 6572         parameter
+000220d0: 7320 3d20 280d 0a20 2020 2020 2020 2020  s = (..         
+000220e0: 2020 205b 2222 2c20 222d 6f22 2c20 6473     ["", "-o", ds
+000220f0: 745d 0d0a 2020 2020 2020 2020 2020 2020  t]..            
+00022100: 2b20 7372 630d 0a20 2020 2020 2020 2020  + src..         
+00022110: 2020 202b 205b 0d0a 2020 2020 2020 2020     + [..        
+00022120: 2020 2020 2020 2020 222d 636f 222c 0d0a          "-co",..
+00022130: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022140: 2243 4f4d 5052 4553 533d 4c5a 5722 2c0d  "COMPRESS=LZW",.
+00022150: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+00022160: 2022 2d69 6e69 7422 2c0d 0a20 2020 2020   "-init",..     
+00022170: 2020 2020 2020 2020 2020 2073 7472 2869             str(i
+00022180: 6e69 7429 2c0d 0a20 2020 2020 2020 2020  nit),..         
+00022190: 2020 2020 2020 2022 2d61 5f6e 6f64 6174         "-a_nodat
+000221a0: 6122 2c0d 0a20 2020 2020 2020 2020 2020  a",..           
+000221b0: 2020 2020 2073 7472 286e 6f5f 6461 7461       str(no_data
+000221c0: 5f76 616c 7565 292c 0d0a 2020 2020 2020  _value),..      
+000221d0: 2020 2020 2020 2020 2020 222d 6e22 2c0d            "-n",.
+000221e0: 0a20 2020 2020 2020 2020 2020 2020 2020  .               
+000221f0: 2073 7472 286e 292c 0d0a 2020 2020 2020   str(n),..      
+00022200: 2020 2020 2020 5d0d 0a20 2020 2020 2020        ]..       
+00022210: 2029 2020 2320 272d 7365 7061 7261 7465   )  # '-separate
+00022220: 270d 0a20 2020 2020 2020 2067 6461 6c5f  '..        gdal_
+00022230: 6d65 7267 652e 6d61 696e 2870 6172 616d  merge.main(param
+00022240: 6574 6572 7329 0d0a 0d0a 2020 2020 6465  eters)....    de
+00022250: 6620 6170 706c 7928 7365 6c66 2c20 7566  f apply(self, uf
+00022260: 756e 633a 2043 616c 6c61 626c 6529 3a0d  unc: Callable):.
+00022270: 0a20 2020 2020 2020 2022 2222 666f 6c64  .        """fold
+00022280: 6572 4361 6c63 756c 6174 6f72 2e0d 0a0d  erCalculator....
+00022290: 0a20 2020 2020 2020 2074 6869 7320 6675  .        this fu
+000222a0: 6e63 7469 6f6e 206d 6174 6368 6573 2074  nction matches t
+000222b0: 6865 206c 6f63 6174 696f 6e20 6f66 206e  he location of n
+000222c0: 6f64 6174 6120 7661 6c75 6520 6672 6f6d  odata value from
+000222d0: 2073 7263 2072 6173 7465 7220 746f 2064   src raster to d
+000222e0: 7374 0d0a 2020 2020 2020 2020 7261 7374  st..        rast
+000222f0: 6572 0d0a 2020 2020 2020 2020 4461 7461  er..        Data
+00022300: 7365 7420 4120 6973 2077 6865 7265 2074  set A is where t
+00022310: 6865 204e 6f44 6174 6176 616c 7565 2077  he NoDatavalue w
+00022320: 696c 6c20 6265 2074 616b 656e 2061 6e64  ill be taken and
+00022330: 2074 6865 206c 6f63 6174 696f 6e20 6f66   the location of
+00022340: 2074 6869 7320 7661 6c75 650d 0a20 2020   this value..   
+00022350: 2020 2020 2042 5f69 6e70 7574 5f70 6174       B_input_pat
+00022360: 6820 6973 2070 6174 6820 746f 2074 6865  h is path to the
+00022370: 2066 6f6c 6465 7220 7768 6572 6520 4461   folder where Da
+00022380: 7461 7365 7420 4220 6578 6973 7420 7768  taset B exist wh
+00022390: 6572 6520 2077 6520 6e65 6564 2074 6f20  ere  we need to 
+000223a0: 7075 740d 0a20 2020 2020 2020 2074 6865  put..        the
+000223b0: 204e 6f44 6174 6156 616c 7565 206f 6620   NoDataValue of 
+000223c0: 5261 7374 6572 4120 696e 2052 6173 7465  RasterA in Raste
+000223d0: 7242 2061 7420 7468 6520 7361 6d65 206c  rB at the same l
+000223e0: 6f63 6174 696f 6e73 0d0a 0d0a 2020 2020  ocations....    
+000223f0: 2020 2020 5061 7261 6d65 7465 7273 0d0a      Parameters..
+00022400: 2020 2020 2020 2020 2d2d 2d2d 2d2d 2d2d          --------
+00022410: 2d2d 0d0a 2020 2020 2020 2020 7566 756e  --..        ufun
+00022420: 633a 205b 6675 6e63 7469 6f6e 5d0d 0a20  c: [function].. 
+00022430: 2020 2020 2020 2020 2020 2063 616c 6c61             calla
+00022440: 626c 6520 756e 6976 6572 7361 6c20 6675  ble universal fu
+00022450: 6e63 7469 6f6e 2075 6675 6e63 2028 6275  nction ufunc (bu
+00022460: 696c 7469 6e20 6f72 2075 7365 7220 6465  iltin or user de
+00022470: 6669 6e65 6429 0d0a 2020 2020 2020 2020  fined)..        
+00022480: 2020 2020 6874 7470 733a 2f2f 6e75 6d70      https://nump
+00022490: 792e 6f72 672f 646f 632f 7374 6162 6c65  y.org/doc/stable
+000224a0: 2f72 6566 6572 656e 6365 2f75 6675 6e63  /reference/ufunc
+000224b0: 732e 6874 6d6c 0d0a 2020 2020 2020 2020  s.html..        
+000224c0: 2020 2020 2d20 746f 2063 7265 6174 6520      - to create 
+000224d0: 6120 7566 756e 6320 6672 6f6d 2061 206e  a ufunc from a n
+000224e0: 6f72 6d61 6c20 6675 6e63 7469 6f6e 2028  ormal function (
+000224f0: 6874 7470 733a 2f2f 6e75 6d70 792e 6f72  https://numpy.or
+00022500: 672f 646f 632f 7374 6162 6c65 2f72 6566  g/doc/stable/ref
+00022510: 6572 656e 6365 2f67 656e 6572 6174 6564  erence/generated
+00022520: 2f6e 756d 7079 2e66 726f 6d70 7966 756e  /numpy.frompyfun
+00022530: 632e 6874 6d6c 290d 0a0d 0a20 2020 2020  c.html)....     
+00022540: 2020 2052 6574 7572 6e73 0d0a 2020 2020     Returns..    
+00022550: 2020 2020 2d2d 2d2d 2d2d 2d0d 0a20 2020      -------..   
+00022560: 2020 2020 206e 6577 2072 6173 7465 7273       new rasters
+00022570: 2077 696c 6c20 6265 2073 6176 6564 2074   will be saved t
+00022580: 6f20 7468 6520 7361 7665 5f74 6f0d 0a0d  o the save_to...
+00022590: 0a20 2020 2020 2020 2045 7861 6d70 6c65  .        Example
+000225a0: 730d 0a20 2020 2020 2020 202d 2d2d 2d2d  s..        -----
+000225b0: 2d2d 2d0d 0a20 2020 2020 2020 203e 3e3e  ---..        >>>
+000225c0: 2064 6566 2066 756e 6328 7661 6c29 3a0d   def func(val):.
+000225d0: 0a20 2020 2020 2020 203e 3e3e 2020 2020  .        >>>    
+000225e0: 7265 7475 726e 2076 616c 2532 0d0a 2020  return val%2..  
+000225f0: 2020 2020 2020 3e3e 3e20 7566 756e 6320        >>> ufunc 
+00022600: 3d20 6e70 2e66 726f 6d70 7966 756e 6328  = np.frompyfunc(
+00022610: 6675 6e63 2c20 312c 2031 290d 0a20 2020  func, 1, 1)..   
+00022620: 2020 2020 203e 3e3e 2064 6174 6173 6574       >>> dataset
+00022630: 2e61 7070 6c79 2875 6675 6e63 290d 0a20  .apply(ufunc).. 
+00022640: 2020 2020 2020 2022 2222 0d0a 2020 2020         """..    
+00022650: 2020 2020 6966 206e 6f74 2063 616c 6c61      if not calla
+00022660: 626c 6528 7566 756e 6329 3a0d 0a20 2020  ble(ufunc):..   
+00022670: 2020 2020 2020 2020 2072 6169 7365 2054           raise T
+00022680: 7970 6545 7272 6f72 2822 7365 636f 6e64  ypeError("second
+00022690: 2061 7267 756d 656e 7420 7368 6f75 6c64   argument should
+000226a0: 2062 6520 6120 6675 6e63 7469 6f6e 2229   be a function")
+000226b0: 0d0a 2020 2020 2020 2020 6172 7220 3d20  ..        arr = 
+000226c0: 7365 6c66 2e64 6174 610d 0a20 2020 2020  self.data..     
+000226d0: 2020 206e 6f5f 6461 7461 5f76 616c 7565     no_data_value
+000226e0: 203d 2073 656c 662e 6261 7365 2e6e 6f5f   = self.base.no_
+000226f0: 6461 7461 5f76 616c 7565 5b30 5d0d 0a20  data_value[0].. 
+00022700: 2020 2020 2020 2023 2065 7865 6375 7465         # execute
+00022710: 2074 6865 2066 756e 6374 696f 6e20 6f6e   the function on
+00022720: 2065 6163 6820 7261 7374 6572 0d0a 2020   each raster..  
+00022730: 2020 2020 2020 6172 725b 7e6e 702e 6973        arr[~np.is
+00022740: 636c 6f73 6528 6172 722c 206e 6f5f 6461  close(arr, no_da
+00022750: 7461 5f76 616c 7565 2c20 7274 6f6c 3d30  ta_value, rtol=0
+00022760: 2e30 3031 295d 203d 2075 6675 6e63 280d  .001)] = ufunc(.
+00022770: 0a20 2020 2020 2020 2020 2020 2061 7272  .            arr
+00022780: 5b7e 6e70 2e69 7363 6c6f 7365 2861 7272  [~np.isclose(arr
+00022790: 2c20 6e6f 5f64 6174 615f 7661 6c75 652c  , no_data_value,
+000227a0: 2072 746f 6c3d 302e 3030 3129 5d0d 0a20   rtol=0.001)].. 
+000227b0: 2020 2020 2020 2029 0d0a 0d0a 2020 2020         )....    
+000227c0: 6465 6620 6f76 6572 6c61 7928 0d0a 2020  def overlay(..  
+000227d0: 2020 2020 2020 7365 6c66 2c0d 0a20 2020        self,..   
+000227e0: 2020 2020 2063 6c61 7373 6573 5f6d 6170       classes_map
+000227f0: 2c0d 0a20 2020 2020 2020 2065 7863 6c75  ,..        exclu
+00022800: 6465 5f76 616c 7565 3a20 556e 696f 6e5b  de_value: Union[
+00022810: 666c 6f61 742c 2069 6e74 5d20 3d20 4e6f  float, int] = No
+00022820: 6e65 2c0d 0a20 2020 2029 202d 3e20 4469  ne,..    ) -> Di
+00022830: 6374 5b4c 6973 745b 666c 6f61 745d 2c20  ct[List[float], 
+00022840: 4c69 7374 5b66 6c6f 6174 5d5d 3a0d 0a20  List[float]]:.. 
+00022850: 2020 2020 2020 2022 2222 7468 6973 2066         """this f
+00022860: 756e 6374 696f 6e20 6973 2077 7269 7474  unction is writt
+00022870: 656e 2074 6f20 6578 7472 6163 7420 616e  en to extract an
+00022880: 6420 7265 7475 726e 2061 206c 6973 7420  d return a list 
+00022890: 6f66 2061 6c6c 2074 6865 2076 616c 7565  of all the value
+000228a0: 7320 696e 2061 6e20 4153 4349 4920 6669  s in an ASCII fi
+000228b0: 6c65 2e0d 0a0d 0a20 2020 2020 2020 2050  le.....        P
+000228c0: 6172 616d 6574 6572 730d 0a20 2020 2020  arameters..     
+000228d0: 2020 202d 2d2d 2d2d 2d2d 2d2d 2d0d 0a20     ----------.. 
+000228e0: 2020 2020 2020 2063 6c61 7373 6573 5f6d         classes_m
+000228f0: 6170 3a20 5b44 6174 6173 6574 5d0d 0a20  ap: [Dataset].. 
+00022900: 2020 2020 2020 2020 2020 2044 6174 6173             Datas
+00022910: 6574 204f 626a 6563 7420 6670 7220 7468  et Object fpr th
+00022920: 6520 7261 7374 6572 2074 6861 7420 6861  e raster that ha
+00022930: 7665 2063 6c61 7373 6573 2079 6f75 2077  ve classes you w
+00022940: 616e 7420 746f 206f 7665 726c 6179 2077  ant to overlay w
+00022950: 6974 6820 7468 6520 7261 7374 6572 2e0d  ith the raster..
+00022960: 0a20 2020 2020 2020 2065 7863 6c75 6465  .        exclude
+00022970: 5f76 616c 7565 3a20 5b4e 756d 6572 6963  _value: [Numeric
+00022980: 5d0d 0a20 2020 2020 2020 2020 2020 2076  ]..            v
+00022990: 616c 7565 7320 796f 7520 7761 6e74 2074  alues you want t
+000229a0: 6f20 6578 636c 7564 6520 6672 6f6d 2065  o exclude from e
+000229b0: 7874 7261 6374 6564 2076 616c 7565 732e  xtracted values.
+000229c0: 0d0a 0d0a 2020 2020 2020 2020 5265 7475  ....        Retu
+000229d0: 726e 730d 0a20 2020 2020 2020 202d 2d2d  rns..        ---
+000229e0: 2d2d 2d2d 0d0a 2020 2020 2020 2020 4469  ----..        Di
+000229f0: 6374 696f 6e61 7279 3a0d 0a20 2020 2020  ctionary:..     
+00022a00: 2020 2020 2020 2064 6963 746f 6e61 7279         dictonary
+00022a10: 2077 6974 6820 6120 6c69 7374 206f 6620   with a list of 
+00022a20: 7661 6c75 6573 2069 6e20 7468 6520 6261  values in the ba
+00022a30: 7365 6d61 7020 6173 206b 6579 7320 616e  semap as keys an
+00022a40: 6420 666f 7220 6561 6368 206b 6579 2061  d for each key a
+00022a50: 206c 6973 7420 6f66 2061 6c6c 2074 6865   list of all the
+00022a60: 2069 6e74 6572 7365 6374 6564 0d0a 2020   intersected..  
+00022a70: 2020 2020 2020 2020 2020 7661 6c75 6573            values
+00022a80: 2069 6e20 7468 6520 6d61 7073 2066 726f   in the maps fro
+00022a90: 6d20 7468 6520 7061 7468 2e0d 0a20 2020  m the path...   
+00022aa0: 2020 2020 2022 2222 0d0a 2020 2020 2020       """..      
+00022ab0: 2020 7661 6c75 6573 203d 207b 7d0d 0a20    values = {}.. 
+00022ac0: 2020 2020 2020 2066 6f72 2069 2069 6e20         for i in 
+00022ad0: 7261 6e67 6528 7365 6c66 2e74 696d 655f  range(self.time_
+00022ae0: 6c65 6e67 7468 293a 0d0a 2020 2020 2020  length):..      
+00022af0: 2020 2020 2020 7372 6320 3d20 7365 6c66        src = self
+00022b00: 2e69 6c6f 6328 6929 0d0a 2020 2020 2020  .iloc(i)..      
+00022b10: 2020 2020 2020 6469 6374 5f69 203d 2073        dict_i = s
+00022b20: 7263 2e6f 7665 726c 6179 2863 6c61 7373  rc.overlay(class
+00022b30: 6573 5f6d 6170 2c20 6578 636c 7564 655f  es_map, exclude_
+00022b40: 7661 6c75 6529 0d0a 0d0a 2020 2020 2020  value)....      
+00022b50: 2020 2020 2020 2320 7468 6573 6520 6172        # these ar
+00022b60: 6520 7468 6520 6465 7374 696e 6374 2076  e the destinct v
+00022b70: 616c 7565 7320 6672 6f6d 2074 6865 2042  alues from the B
+00022b80: 6173 654d 6170 2077 6869 6368 2061 7265  aseMap which are
+00022b90: 206b 6579 7320 696e 2074 6865 0d0a 2020   keys in the..  
+00022ba0: 2020 2020 2020 2020 2020 2320 4578 7472            # Extr
+00022bb0: 6163 7465 6456 616c 7565 7369 2064 6963  actedValuesi dic
+00022bc0: 7420 7769 7468 2065 6163 6820 6f6e 6520  t with each one 
+00022bd0: 6861 7669 6e67 2061 206c 6973 7420 6f66  having a list of
+00022be0: 2076 616c 7565 730d 0a20 2020 2020 2020   values..       
+00022bf0: 2020 2020 2063 6c61 7373 6573 203d 206c       classes = l
+00022c00: 6973 7428 6469 6374 5f69 2e6b 6579 7328  ist(dict_i.keys(
+00022c10: 2929 0d0a 0d0a 2020 2020 2020 2020 2020  ))....          
+00022c20: 2020 666f 7220 636c 6173 735f 6920 696e    for class_i in
+00022c30: 2063 6c61 7373 6573 3a0d 0a20 2020 2020   classes:..     
+00022c40: 2020 2020 2020 2020 2020 2069 6620 636c             if cl
+00022c50: 6173 735f 6920 6e6f 7420 696e 2076 616c  ass_i not in val
+00022c60: 7565 732e 6b65 7973 2829 3a0d 0a20 2020  ues.keys():..   
+00022c70: 2020 2020 2020 2020 2020 2020 2020 2020                  
+00022c80: 2076 616c 7565 735b 636c 6173 735f 695d   values[class_i]
+00022c90: 203d 206c 6973 7428 290d 0a0d 0a20 2020   = list()....   
+00022ca0: 2020 2020 2020 2020 2020 2020 2076 616c               val
+00022cb0: 7565 735b 636c 6173 735f 695d 203d 2076  ues[class_i] = v
+00022cc0: 616c 7565 735b 636c 6173 735f 695d 202b  alues[class_i] +
+00022cd0: 2064 6963 745f 695b 636c 6173 735f 695d   dict_i[class_i]
+00022ce0: 0d0a 0d0a 2020 2020 2020 2020 7265 7475  ....        retu
+00022cf0: 726e 2076 616c 7565 730d 0a0d 0a20 2020  rn values....   
+00022d00: 2023 2040 7374 6174 6963 6d65 7468 6f64   # @staticmethod
+00022d10: 0d0a 2020 2020 2320 6465 6620 7265 6164  ..    # def read
+00022d20: 4e43 280d 0a20 2020 2023 2020 2020 2020  NC(..    #      
+00022d30: 2020 2070 6174 682c 0d0a 2020 2020 2320     path,..    # 
+00022d40: 2020 2020 2020 2020 7361 7665 5f74 6f3a          save_to:
+00022d50: 2073 7472 2c0d 0a20 2020 2023 2020 2020   str,..    #    
+00022d60: 2020 2020 2073 6570 6172 6174 6f72 3a20       separator: 
+00022d70: 7374 7220 3d20 225f 222c 0d0a 2020 2020  str = "_",..    
+00022d80: 2320 2020 2020 2020 2020 7469 6d65 5f76  #         time_v
+00022d90: 6172 5f6e 616d 653a 2073 7472 203d 204e  ar_name: str = N
+00022da0: 6f6e 652c 0d0a 2020 2020 2320 2020 2020  one,..    #     
+00022db0: 2020 2020 7072 6566 6978 3a20 7374 7220      prefix: str 
+00022dc0: 3d20 4e6f 6e65 2c0d 0a20 2020 2023 2029  = None,..    # )
+00022dd0: 3a0d 0a20 2020 2023 0d0a 2020 2020 2320  :..    #..    # 
+00022de0: 2020 2020 6966 2069 7369 6e73 7461 6e63      if isinstanc
+00022df0: 6528 7061 7468 2c20 7374 7229 3a0d 0a20  e(path, str):.. 
+00022e00: 2020 2023 2020 2020 2020 2020 206e 6320     #         nc 
+00022e10: 3d20 6e65 7443 4446 342e 4461 7461 6375  = netCDF4.Datacu
+00022e20: 6265 2870 6174 6829 0d0a 2020 2020 2320  be(path)..    # 
+00022e30: 2020 2020 656c 6966 2069 7369 6e73 7461      elif isinsta
+00022e40: 6e63 6528 7061 7468 2c20 6c69 7374 293a  nce(path, list):
+00022e50: 0d0a 2020 2020 2320 2020 2020 2020 2020  ..    #         
+00022e60: 6e63 203d 206e 6574 4344 4634 2e4d 4644  nc = netCDF4.MFD
+00022e70: 6174 6173 6574 2870 6174 6829 0d0a 2020  ataset(path)..  
+00022e80: 2020 2320 2020 2020 656c 7365 3a0d 0a20    #     else:.. 
+00022e90: 2020 2023 2020 2020 2020 2020 2072 6169     #         rai
+00022ea0: 7365 2054 7970 6545 7272 6f72 280d 0a20  se TypeError(.. 
+00022eb0: 2020 2023 2020 2020 2020 2020 2020 2020     #            
+00022ec0: 2022 4669 7273 7420 7061 7261 6d65 7465   "First paramete
+00022ed0: 7220 746f 2074 6865 206e 6374 6f54 6966  r to the nctoTif
+00022ee0: 6620 6675 6e63 7469 6f6e 2073 686f 756c  f function shoul
+00022ef0: 6420 6265 2065 6974 6865 7220 7374 7220  d be either str 
+00022f00: 6f72 206c 6973 7422 0d0a 2020 2020 2320  or list"..    # 
+00022f10: 2020 2020 2020 2020 290d 0a20 2020 2023          )..    #
+00022f20: 0d0a 2020 2020 2320 2020 2020 2320 6765  ..    #     # ge
+00022f30: 7420 7468 6520 7661 7269 6162 6c65 0d0a  t the variable..
+00022f40: 2020 2020 2320 2020 2020 5661 7220 3d20      #     Var = 
+00022f50: 6c69 7374 286e 632e 7375 6273 6574 732e  list(nc.subsets.
+00022f60: 6b65 7973 2829 295b 2d31 5d0d 0a20 2020  keys())[-1]..   
+00022f70: 2023 2020 2020 2023 2065 7874 7261 6374   #     # extract
+00022f80: 2074 6865 2064 6174 610d 0a20 2020 2023   the data..    #
+00022f90: 2020 2020 2064 6174 6173 6574 203d 206e       dataset = n
+00022fa0: 635b 5661 725d 0d0a 2020 2020 2320 2020  c[Var]..    #   
+00022fb0: 2020 2320 6765 7420 7468 6520 6465 7461    # get the deta
+00022fc0: 696c 7320 6f66 2074 6865 2066 696c 650d  ils of the file.
+00022fd0: 0a20 2020 2023 2020 2020 2067 656f 2c20  .    #     geo, 
+00022fe0: 6570 7367 2c20 5f2c 205f 2c20 7469 6d65  epsg, _, _, time
+00022ff0: 5f6c 656e 2c20 7469 6d65 5f76 6172 2c20  _len, time_var, 
+00023000: 6e6f 5f64 6174 615f 7661 6c75 652c 2064  no_data_value, d
+00023010: 6174 6174 7970 6520 3d20 4e43 2e67 6574  atatype = NC.get
+00023020: 4e43 4465 7461 696c 7328 0d0a 2020 2020  NCDetails(..    
+00023030: 2320 2020 2020 2020 2020 6e63 2c20 7469  #         nc, ti
+00023040: 6d65 5f76 6172 5f6e 616d 653d 7469 6d65  me_var_name=time
+00023050: 5f76 6172 5f6e 616d 650d 0a20 2020 2023  _var_name..    #
+00023060: 2020 2020 2029 0d0a 2020 2020 2320 2020       )..    #   
+00023070: 2020 7072 696e 7428 2273 7373 2229 0d0a    print("sss")..
```

### Comparing `pyramids-gis-0.4.1/pyramids/dem.py` & `pyramids-gis-0.4.2/pyramids/dem.py`

 * *Files identical despite different names*

### Comparing `pyramids-gis-0.4.1/pyramids/featurecollection.py` & `pyramids-gis-0.4.2/pyramids/featurecollection.py`

 * *Files 0% similar despite different names*

```diff
@@ -6,15 +6,15 @@
 gpd.io.file._EXTENSION_TO_DRIVER
 """
 import os
 import tempfile
 import uuid
 import shutil
 import warnings
-from typing import List, Tuple, Union, Iterable
+from typing import List, Tuple, Union, Iterable, Any
 
 import geopandas as gpd
 import numpy as np
 import pandas as pd
 from geopandas.geodataframe import GeoDataFrame
 from osgeo import ogr, osr, gdal
 from osgeo.ogr import DataSource
@@ -259,15 +259,15 @@
             self.__init__(gdf)
             gdf = None
 
         return gdf
 
     def to_dataset(
         self,
-        cell_size: int = None,
+        cell_size: Any = None,
         dataset=None,
         column_name=None,
     ):
         """Covert a vector into raster.
 
             - The raster cell values will be taken from the column name given in the vector_filed in the vector file.
             - all the new raster geotransform data will be copied from the given raster.
@@ -311,15 +311,15 @@
                 )
             # if the raster is given the top left corner of the raster will be taken as the top left corner for
             # the rasterized polygon
             xmin, _, _, ymax, _, _ = dataset.geotransform
         else:
             # if a raster is not given the xmin and ymax will be taken as the top left corner for the rasterized
             # polygon.
-            xmin, ymin, xmax, ymax = self.feature.bounds.values[0]
+            xmin, ymin, xmax, ymax = self.feature.total_bounds
 
         if column_name is None:
             # Use a constant value for all features.
             burn_values = [1]
             attribute = None
             dtype = 5
         else:
```

### Comparing `pyramids-gis-0.4.1/pyramids/gdal_drivers.yaml` & `pyramids-gis-0.4.2/pyramids/gdal_drivers.yaml`

 * *Files identical despite different names*

### Comparing `pyramids-gis-0.4.1/pyramids/ogr_drivers.yaml` & `pyramids-gis-0.4.2/pyramids/ogr_drivers.yaml`

 * *Files identical despite different names*

### Comparing `pyramids-gis-0.4.1/pyramids_gis.egg-info/PKG-INFO` & `pyramids-gis-0.4.2/pyramids_gis.egg-info/PKG-INFO`

 * *Files 6% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: pyramids-gis
-Version: 0.4.1
+Version: 0.4.2
 Summary: GIS utility package
 Home-page: https://github.com/MAfarrag/pyramids
 Author: Mostafa Farrag
 Author-email: moah.farag@gmail.come
 License: GNU General Public License v3
 Keywords: GIS,gdal
 Classifier: Development Status :: 5 - Production/Stable
@@ -33,15 +33,16 @@
 ![GitHub last commit](https://img.shields.io/github/last-commit/MAfarrag/pyramids)
 ![GitHub forks](https://img.shields.io/github/forks/MAfarrag/pyramids?style=social)
 ![GitHub Repo stars](https://img.shields.io/github/stars/MAfarrag/pyramids?style=social)
 [![codecov](https://codecov.io/gh/Serapieum-of-alex/pyramids/branch/main/graph/badge.svg?token=g0DV4dCa8N)](https://codecov.io/gh/Serapieum-of-alex/pyramids)
 [![Codacy Badge](https://app.codacy.com/project/badge/Grade/5e3aa4d0acc843d1a91caf33545ecf03)](https://www.codacy.com/gh/Serapieum-of-alex/pyramids/dashboard?utm_source=github.com&amp;utm_medium=referral&amp;utm_content=Serapieum-of-alex/pyramids&amp;utm_campaign=Badge_Grade)
 
 
-![GitHub commits since latest release (by SemVer including pre-releases)](https://img.shields.io/github/commits-since/mafarrag/pyramids/0.4.1?include_prereleases&style=plastic)
+![GitHub commits since latest release (by SemVer including pre-releases)](https://img.shields.
+io/github/commits-since/mafarrag/pyramids/0.4.2?include_prereleases&style=plastic)
 ![GitHub last commit](https://img.shields.io/github/last-commit/mafarrag/pyramids)
 
 Current release info
 ====================
 
 | Name                                                                                                                 | Downloads                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | Version                                                                                                                                                                                                                                                                                                                                                 | Platforms |
 |----------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------| --- |
@@ -49,14 +50,16 @@
 
 pyramids - GIS utility package
 =====================================================================
 **pyramids** is a GIS utility package using gdal, ....
 
 pyramids
 
+![1](/docs/images/package-work-flow/overall.png)
+
 Main Features
 -------------
   - GIS modules to enable the modeler to fully prepare the meteorological inputs and do all the preprocessing
     needed to build the model (align rasters with the DEM), in addition to various methods to manipulate and
     convert different forms of distributed data (rasters, NetCDF, shapefiles)
 
 
@@ -68,15 +71,15 @@
 
 Installing pyramids
 ===============
 
 Installing `pyramids` from the `conda-forge` channel can be achieved by:
 
 ```
-conda install -c conda-forge pyramids=0.4.1
+conda install -c conda-forge pyramids=0.4.2
 ```
 
 It is possible to list all of the versions of `pyramids` available on your platform with:
 
 ```
 conda search pyramids --channel conda-forge
 ```
@@ -86,15 +89,15 @@
 ```
 pip install git+https://github.com/Serapieum-of-alex/pyramids
 ```
 
 ## pip
 to install the last release you can easly use pip
 ```
-pip install pyramids-gis==0.4.1
+pip install pyramids-gis==0.4.2
 ```
 
 Quick start
 ===========
 
 ```
   >>> import pyramids
@@ -176,7 +179,14 @@
 * adjust all spatial operation functions to work with multi-band rasters.
 * use gdal exceptions to capture runtime error of not finding the the file.
 * add cluster method to dataset class.
 * time_stamp attribute returns None if there is no time_stamp.
 * restructure the no_data_value related functions.
 * plot function can plot rgb imagr for multi-band rasters.
 * to_file detect the driver type from the extension in the path.
+
+0.4.2 (2023-04-27)
+------------------
+* fix bug in plotting dataset without specifying the band
+* fix bug in passing ot not passing band index in case of multi band rasters
+* change the bounds in to_dataset method to total_bounds tp get the bbox of the whole geometries in the gdf
+* add convert_longitude method to convert longitude to range between -180 and 180
```

### Comparing `pyramids-gis-0.4.1/setup.py` & `pyramids-gis-0.4.2/setup.py`

 * *Files 1% similar despite different names*

```diff
@@ -7,15 +7,15 @@
     history = history_file.read()
 
 requirements = [line.strip() for line in open("requirements.txt").readlines()]
 requirements_dev = [line.strip() for line in open("requirements-dev.txt").readlines()]
 
 setup(
     name="pyramids-gis",
-    version="0.4.1",
+    version="0.4.2",
     description="GIS utility package",
     author="Mostafa Farrag",
     author_email="moah.farag@gmail.come",
     url="https://github.com/MAfarrag/pyramids",
     keywords=["GIS", "gdal"],
     long_description=readme + "\n\n" + history,
     repository="https://github.com/MAfarrag/pyramids",
```

### Comparing `pyramids-gis-0.4.1/tests/test_io.py` & `pyramids-gis-0.4.2/tests/test_io.py`

 * *Files identical despite different names*

### Comparing `pyramids-gis-0.4.1/tests/test_utils.py` & `pyramids-gis-0.4.2/tests/test_utils.py`

 * *Files identical despite different names*

