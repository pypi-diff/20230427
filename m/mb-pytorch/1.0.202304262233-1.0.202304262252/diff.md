# Comparing `tmp/mb_pytorch-1.0.202304262233-py3-none-any.whl.zip` & `tmp/mb_pytorch-1.0.202304262252-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,20 +1,20 @@
-Zip file size: 38093 bytes, number of entries: 39
--rw-rw-r--  2.0 unx     6485 b- defN 23-Apr-26 22:13 mb_pytorch/classification/training.py
+Zip file size: 38234 bytes, number of entries: 39
+-rw-rw-r--  2.0 unx     7092 b- defN 23-Apr-26 22:51 mb_pytorch/classification/training.py
 -rw-rw-r--  2.0 unx       44 b- defN 23-Mar-16 11:39 mb_pytorch/dataloader/__init__.py
 -rw-rw-r--  2.0 unx    12981 b- defN 23-Apr-19 01:00 mb_pytorch/dataloader/loader.py
 -rw-rw-r--  2.0 unx     6476 b- defN 23-Apr-25 00:59 mb_pytorch/detection/training.py
 -rw-rw-r--  2.0 unx        0 b- defN 23-Feb-23 13:56 mb_pytorch/metalearning/__init__.py
 -rw-rw-r--  2.0 unx     1385 b- defN 23-Mar-02 03:28 mb_pytorch/metalearning/meta_utils.py
 -rw-rw-r--  2.0 unx     1030 b- defN 23-Mar-15 02:58 mb_pytorch/metalearning/proto_dataloader.py
 -rw-rw-r--  2.0 unx     2861 b- defN 23-Mar-03 23:55 mb_pytorch/metalearning/prototypical.py
 -rw-rw-r--  2.0 unx        0 b- defN 23-Mar-31 19:54 mb_pytorch/models/__init__.py
 -rw-rw-r--  2.0 unx    20215 b- defN 23-Apr-26 22:20 mb_pytorch/models/extra_models.py
 -rw-rw-r--  2.0 unx      920 b- defN 23-Mar-12 03:33 mb_pytorch/models/lenet.py
--rw-rw-r--  2.0 unx     3595 b- defN 23-Apr-26 22:33 mb_pytorch/models/modelloader.py
+-rw-rw-r--  2.0 unx     3603 b- defN 23-Apr-26 22:44 mb_pytorch/models/modelloader.py
 -rw-rw-r--  2.0 unx    10784 b- defN 23-Apr-01 03:27 mb_pytorch/models/unet_models.py
 -rw-rw-r--  2.0 unx        0 b- defN 23-Mar-31 19:54 mb_pytorch/models/blocks/__init__.py
 -rw-rw-r--  2.0 unx     2801 b- defN 23-Apr-01 00:43 mb_pytorch/models/blocks/attention_block.py
 -rw-rw-r--  2.0 unx     3629 b- defN 23-Mar-23 00:49 mb_pytorch/models/blocks/cnn.py
 -rw-rw-r--  2.0 unx     4783 b- defN 23-Mar-23 04:50 mb_pytorch/models/blocks/conv_block.py
 -rw-rw-r--  2.0 unx      920 b- defN 23-Mar-17 22:06 mb_pytorch/models/blocks/conv_with_relu.py
 -rw-rw-r--  2.0 unx     2256 b- defN 23-Mar-23 14:45 mb_pytorch/models/blocks/model_out.py
@@ -28,14 +28,14 @@
 -rw-rw-r--  2.0 unx      257 b- defN 23-Mar-01 22:55 mb_pytorch/utils/dist.py
 -rw-rw-r--  2.0 unx     3391 b- defN 23-Apr-11 23:28 mb_pytorch/utils/extra_utils.py
 -rw-rw-r--  2.0 unx     7178 b- defN 23-Mar-15 02:58 mb_pytorch/utils/generate_emb.py
 -rw-rw-r--  2.0 unx     2582 b- defN 23-Apr-03 19:30 mb_pytorch/utils/losses.py
 -rw-rw-r--  2.0 unx     1199 b- defN 23-Apr-04 20:14 mb_pytorch/utils/metrics.py
 -rw-rw-r--  2.0 unx    10502 b- defN 23-Apr-25 00:33 mb_pytorch/utils/viewer.py
 -rw-rw-r--  2.0 unx      994 b- defN 23-Mar-06 13:11 mb_pytorch/utils/yaml_reader.py
--rwxrwxr-x  2.0 unx     1304 b- defN 23-Apr-26 22:33 mb_pytorch-1.0.202304262233.data/scripts/dataload_results.py
--rwxrwxr-x  2.0 unx      980 b- defN 23-Mar-15 02:59 mb_pytorch-1.0.202304262233.data/scripts/emb.py
--rw-rw-r--  2.0 unx      329 b- defN 23-Apr-26 22:33 mb_pytorch-1.0.202304262233.dist-info/METADATA
--rw-rw-r--  2.0 unx       92 b- defN 23-Apr-26 22:33 mb_pytorch-1.0.202304262233.dist-info/WHEEL
--rw-rw-r--  2.0 unx       11 b- defN 23-Apr-26 22:33 mb_pytorch-1.0.202304262233.dist-info/top_level.txt
-?rw-rw-r--  2.0 unx     3529 b- defN 23-Apr-26 22:33 mb_pytorch-1.0.202304262233.dist-info/RECORD
-39 files, 123780 bytes uncompressed, 32345 bytes compressed:  73.9%
+-rwxrwxr-x  2.0 unx     1304 b- defN 23-Apr-26 22:53 mb_pytorch-1.0.202304262252.data/scripts/dataload_results.py
+-rwxrwxr-x  2.0 unx      980 b- defN 23-Mar-15 02:59 mb_pytorch-1.0.202304262252.data/scripts/emb.py
+-rw-rw-r--  2.0 unx      329 b- defN 23-Apr-26 22:53 mb_pytorch-1.0.202304262252.dist-info/METADATA
+-rw-rw-r--  2.0 unx       92 b- defN 23-Apr-26 22:53 mb_pytorch-1.0.202304262252.dist-info/WHEEL
+-rw-rw-r--  2.0 unx       11 b- defN 23-Apr-26 22:53 mb_pytorch-1.0.202304262252.dist-info/top_level.txt
+?rw-rw-r--  2.0 unx     3529 b- defN 23-Apr-26 22:53 mb_pytorch-1.0.202304262252.dist-info/RECORD
+39 files, 124395 bytes uncompressed, 32486 bytes compressed:  73.9%
```

## zipnote {}

```diff
@@ -93,26 +93,26 @@
 
 Filename: mb_pytorch/utils/viewer.py
 Comment: 
 
 Filename: mb_pytorch/utils/yaml_reader.py
 Comment: 
 
-Filename: mb_pytorch-1.0.202304262233.data/scripts/dataload_results.py
+Filename: mb_pytorch-1.0.202304262252.data/scripts/dataload_results.py
 Comment: 
 
-Filename: mb_pytorch-1.0.202304262233.data/scripts/emb.py
+Filename: mb_pytorch-1.0.202304262252.data/scripts/emb.py
 Comment: 
 
-Filename: mb_pytorch-1.0.202304262233.dist-info/METADATA
+Filename: mb_pytorch-1.0.202304262252.dist-info/METADATA
 Comment: 
 
-Filename: mb_pytorch-1.0.202304262233.dist-info/WHEEL
+Filename: mb_pytorch-1.0.202304262252.dist-info/WHEEL
 Comment: 
 
-Filename: mb_pytorch-1.0.202304262233.dist-info/top_level.txt
+Filename: mb_pytorch-1.0.202304262252.dist-info/top_level.txt
 Comment: 
 
-Filename: mb_pytorch-1.0.202304262233.dist-info/RECORD
+Filename: mb_pytorch-1.0.202304262252.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## mb_pytorch/classification/training.py

```diff
@@ -1,37 +1,55 @@
 import torch
 import tqdm
 from torch.utils.tensorboard import SummaryWriter
 import os
 from mb_utils.src.logging import logger
 import numpy as np
 from ..utils.viewer import gradcam_viewer,create_img_grid,plot_classes_pred
+from mb_pytorch.models.modelloader import ModelLoader
+from mb_pytorch.training.train_params import train_helper
+
 
 __all__ = ['classification_train_loop']
 
-def classification_train_loop( k_data,data_model,model,train_loader,val_loader,loss_attr,optimizer,scheduler=None,writer=None,logger=None,gradcam=None,gradcam_rgb=False,device='cpu'):
+def classification_train_loop( k_data,scheduler=None,writer=None,logger=None,gradcam=None,gradcam_rgb=False,device='cpu'):
     """
     Function to train the model
     Args:
-        data: data dictionary YAML of DataLoader
-        data_model: model parameters - data.data_dict['model']
-        model: model to be trained
-        train_loader: train dataloader
-        val_loader: validation dataloader
-        loss_attr: loss function
-        optimizer: optimizer
+        k_data: data dictionary YAML of DataLoader
         scheduler: scheduler
         writer: tensorboard writer
         logger: logger
         gradcam: gradcam layers to be visulized
         device: default is cpu
     output:
         None
     """
     
+    if logger:
+        logger.info('Training loop Starting')
+    data_model = k_data.data_dict['model']
+    model_data_load = ModelLoader(k_data.data_dict['model'])
+    model =  model_data_load.get_model()
+    
+    if logger:
+        logger.info('Model Loaded')
+    
+    train_loader,val_loader,_,_ = k_data.data_load()
+    loss_attr,optimizer_attr,optimizer_dict,scheduler_attr,scheduler_dict = train_helper(data_model) 
+    optimizer = optimizer_attr(model.parameters(),**optimizer_dict)
+    if scheduler is not None:
+        scheduler = scheduler_attr(optimizer,**scheduler_dict)
+
+    if logger:
+        logger.info('Optimizer and Scheduler Loaded')
+        logger.info(f'Loss: {loss_attr}')
+        logger.info(f'Optimizer: {optimizer}')
+        logger.info(f'Scheduler: {scheduler}')
+    
     model.to(device)
 
     for i in tqdm.tqdm(range(data_model['model_epochs'])):
         
         ##train loop
         
         model.train(True)
```

## mb_pytorch/models/modelloader.py

```diff
@@ -16,16 +16,16 @@
     """
     model_name = data['model_name']
     model_custom = data['model_custom']
     model_module = importlib.import_module(model_custom)
     if model_name=='Unet':
         if data['unet_parameters']['attention']:
             model_name = 'Unet_attention'
-    model_class = getattr(model_module, model_name)   
-    model_out = model_class(**data['unet_parameters'])
+        model_class = getattr(model_module, model_name)   
+        model_out = model_class(**data['unet_parameters'])
     return model_out
     
 
 class ModelLoader(nn.Module):
     def __init__(self, data : dict,logger=None):
         super().__init__()
         self._data= data
```

## Comparing `mb_pytorch-1.0.202304262233.data/scripts/dataload_results.py` & `mb_pytorch-1.0.202304262252.data/scripts/dataload_results.py`

 * *Files identical despite different names*

## Comparing `mb_pytorch-1.0.202304262233.data/scripts/emb.py` & `mb_pytorch-1.0.202304262252.data/scripts/emb.py`

 * *Files identical despite different names*

## Comparing `mb_pytorch-1.0.202304262233.dist-info/RECORD` & `mb_pytorch-1.0.202304262252.dist-info/RECORD`

 * *Files 7% similar despite different names*

```diff
@@ -1,19 +1,19 @@
-mb_pytorch/classification/training.py,sha256=T2H4nGnnWicFDdWfm5RQKD_xKKAxbH0zXT7ocQR3OO8,6485
+mb_pytorch/classification/training.py,sha256=Yv8nM9R39BYL2dQpV8kdzyG48LPR61w8FTq9A6irC3A,7092
 mb_pytorch/dataloader/__init__.py,sha256=nB0xPAHbI91Ra1dDkWR1l4td5A4k9xko-I5Jdgv5apI,44
 mb_pytorch/dataloader/loader.py,sha256=Cn6N9MYVRxpm-fZznk6uu0nzdWCPQWKyK93DNVlKUvk,12981
 mb_pytorch/detection/training.py,sha256=7fyZGU-zgwULf51dOzDlmJQvqS1acUhkO7rknBpHUCU,6476
 mb_pytorch/metalearning/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 mb_pytorch/metalearning/meta_utils.py,sha256=mgHYiQIIcYQ1pVTJcrjquSXpQstdYD1q8iXO09Zao1s,1385
 mb_pytorch/metalearning/proto_dataloader.py,sha256=WvrfZYkYMxorocCkR_zHS_AC8W_ML9YndB-P6evkdcc,1030
 mb_pytorch/metalearning/prototypical.py,sha256=qFVf6VF3s8zskGqbM3geJV-dfkdO3tRaf3P8U_KR-cE,2861
 mb_pytorch/models/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 mb_pytorch/models/extra_models.py,sha256=F1Owng-lMowbxHuQ4SP9D5nkuBuX6ksbXOvsxxlXgoo,20215
 mb_pytorch/models/lenet.py,sha256=vZpN0LsfVGNI6z91YO3GLPCVB9Sv0EAxaTwEavRSKKo,920
-mb_pytorch/models/modelloader.py,sha256=q2cW0tldSHyxmFrlpDY6pFqE6OVj2sIjoRaF31-C4Vs,3595
+mb_pytorch/models/modelloader.py,sha256=XQBbISw-IaBig9HO19398hAkIxadTKlaFWLxnCKhrs0,3603
 mb_pytorch/models/unet_models.py,sha256=8AYw1MaFRUPLkfyyPmAaVZol2lRY28oiTjZRgZVRa4s,10784
 mb_pytorch/models/blocks/__init__.py,sha256=47DEQpj8HBSa-_TImW-5JCeuQeRkm5NMpJWZG3hSuFU,0
 mb_pytorch/models/blocks/attention_block.py,sha256=jMkfI79upW-PDc28dQ17s34gUR0gCpMB0XIpGgFDE_Q,2801
 mb_pytorch/models/blocks/cnn.py,sha256=IFPDIkKb-LyfzqK9RshqzNidSDdfrRmMylADYvWGACE,3629
 mb_pytorch/models/blocks/conv_block.py,sha256=vlcJiBwkbbmhQMpGLzQA0S14Wkw1Ai9adSbOquFBk0c,4783
 mb_pytorch/models/blocks/conv_with_relu.py,sha256=WIwJBfzvp-kE8QY6Ts5wg0ioJAcJIvmqKLpSl46j_II,920
 mb_pytorch/models/blocks/model_out.py,sha256=JmtY1zHCtkj-RbEVhQ8e6EvXd5WWVLrP9Lb_FigO7rA,2256
@@ -27,13 +27,13 @@
 mb_pytorch/utils/dist.py,sha256=7-ZdntmiugRWYnT5wileo8mYTuV1dbjVl4ffJsfnfAw,257
 mb_pytorch/utils/extra_utils.py,sha256=-MaT-x3gwgEOVLpg-tWm5yLFtI0CxpV0QUlXx-rqu08,3391
 mb_pytorch/utils/generate_emb.py,sha256=2iK8wRIrYfaLpEgjdbFnDqGU5ux-1JhncQoeboW_6LQ,7178
 mb_pytorch/utils/losses.py,sha256=OLCPLkJH46IofSSVly2xdcklVv7Q5OFFEGtVrJcV7V0,2582
 mb_pytorch/utils/metrics.py,sha256=Kqmdu9llSjR8aRp3IVlmy6PqeQexf0ZXjTJUcEtvcfI,1199
 mb_pytorch/utils/viewer.py,sha256=oXOdgE7GNeg3aC6tTYq0-Lz47LO7ELWY-z-fQUgbUaE,10502
 mb_pytorch/utils/yaml_reader.py,sha256=Azgr_5qttsH_BBVsCtfccFMvK6IEjTRYhd5qp4S5uzk,994
-mb_pytorch-1.0.202304262233.data/scripts/dataload_results.py,sha256=8IFAH7WX-nSJ7V532rr3Cl7R37v0jhSakw0JCd9dalE,1304
-mb_pytorch-1.0.202304262233.data/scripts/emb.py,sha256=5jSbTGNOhusDTvHZeaTwk4pmJa4HIdkRGd98s0L4Rl0,980
-mb_pytorch-1.0.202304262233.dist-info/METADATA,sha256=W3h6iP9OUshJ7eFoMMMSzcmZnDxcMPgTpEcB74UmMjQ,329
-mb_pytorch-1.0.202304262233.dist-info/WHEEL,sha256=g4nMs7d-Xl9-xC9XovUrsDHGXt-FT0E17Yqo92DEfvY,92
-mb_pytorch-1.0.202304262233.dist-info/top_level.txt,sha256=2m_aBiEfjq3pZM2NtYSlTqlgoQxH6WaK8_8SsRicIvg,11
-mb_pytorch-1.0.202304262233.dist-info/RECORD,,
+mb_pytorch-1.0.202304262252.data/scripts/dataload_results.py,sha256=8IFAH7WX-nSJ7V532rr3Cl7R37v0jhSakw0JCd9dalE,1304
+mb_pytorch-1.0.202304262252.data/scripts/emb.py,sha256=5jSbTGNOhusDTvHZeaTwk4pmJa4HIdkRGd98s0L4Rl0,980
+mb_pytorch-1.0.202304262252.dist-info/METADATA,sha256=5gNctXZeVxrkeAzOvC-XSGQRedQQQMQzAKacLrZyrxg,329
+mb_pytorch-1.0.202304262252.dist-info/WHEEL,sha256=g4nMs7d-Xl9-xC9XovUrsDHGXt-FT0E17Yqo92DEfvY,92
+mb_pytorch-1.0.202304262252.dist-info/top_level.txt,sha256=2m_aBiEfjq3pZM2NtYSlTqlgoQxH6WaK8_8SsRicIvg,11
+mb_pytorch-1.0.202304262252.dist-info/RECORD,,
```

