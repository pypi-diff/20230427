# Comparing `tmp/nanga-0.0.9rc2-py3-none-any.whl.zip` & `tmp/nanga-0.1.0rc2-py3-none-any.whl.zip`

## zipinfo {}

```diff
@@ -1,8 +1,8 @@
-Zip file size: 45288 bytes, number of entries: 41
+Zip file size: 45329 bytes, number of entries: 41
 -rw-rw-r--  2.0 unx       32 b- defN 22-Jul-19 16:34 nanga/__init__.py
 -rw-rw-r--  2.0 unx       27 b- defN 22-Jul-19 13:56 nanga/pipelines/__init__.py
 -rw-rw-r--  2.0 unx      613 b- defN 22-Jul-27 07:46 nanga/pipelines/base.py
 -rw-rw-r--  2.0 unx      551 b- defN 22-Jul-27 06:34 nanga/pipelines/sarcat.py
 -rw-rw-r--  2.0 unx      417 b- defN 22-Jul-19 14:25 nanga/pipelines/summarization.py
 -rw-rw-r--  2.0 unx      271 b- defN 22-Jul-27 06:27 nanga/sarcat/__init__.py
 -rw-rw-r--  2.0 unx     3493 b- defN 22-Jul-06 11:24 nanga/sarcat/inference.py
@@ -11,15 +11,15 @@
 -rw-rw-r--  2.0 unx    11177 b- defN 21-Jun-24 11:02 nanga/sarcat/train.py
 -rw-rw-r--  2.0 unx       56 b- defN 22-Jul-27 06:29 nanga/sarcat/models/__init__.py
 -rw-rw-r--  2.0 unx     1314 b- defN 20-Dec-15 10:36 nanga/sarcat/models/bert_models.py
 -rw-rw-r--  2.0 unx    13315 b- defN 21-Jun-24 11:02 nanga/sarcat/models/modules.py
 -rw-rw-r--  2.0 unx    11959 b- defN 21-Jun-24 11:02 nanga/sarcat/models/rnn_models.py
 -rw-rw-r--  2.0 unx       33 b- defN 22-Jul-27 06:26 nanga/sarcat/models/legacy/__init__.py
 -rw-rw-r--  2.0 unx    10031 b- defN 21-Jun-24 11:02 nanga/sarcat/models/legacy/db.py
--rw-rw-r--  2.0 unx     4165 b- defN 22-Jul-26 12:57 nanga/sarcat/models/legacy/inference.py
+-rw-rw-r--  2.0 unx     4327 b- defN 22-Nov-21 15:08 nanga/sarcat/models/legacy/inference.py
 -rw-rw-r--  2.0 unx    13376 b- defN 22-Jul-26 12:56 nanga/sarcat/models/legacy/modules.py
 -rw-rw-r--  2.0 unx    17760 b- defN 21-Jun-24 11:02 nanga/sarcat/models/legacy/utils.py
 -rw-rw-r--  2.0 unx      123 b- defN 21-Jun-24 11:02 nanga/sarcat/predictions/__init__.py
 -rw-rw-r--  2.0 unx    14232 b- defN 21-Jun-24 11:02 nanga/sarcat/predictions/classification.py
 -rw-rw-r--  2.0 unx      652 b- defN 21-Jun-24 11:02 nanga/sarcat/predictions/utils.py
 -rw-rw-r--  2.0 unx      101 b- defN 22-Jul-19 14:03 nanga/summarization/__init__.py
 -rw-rw-r--  2.0 unx      698 b- defN 22-Jul-20 10:47 nanga/summarization/inference.py
@@ -32,12 +32,12 @@
 -rw-rw-r--  2.0 unx     7312 b- defN 22-Jul-19 14:16 nanga/summarization/core/extractive/extractive_summarizer.py
 -rw-rw-r--  2.0 unx       46 b- defN 22-Jul-18 13:51 nanga/summarization/core/texts/__init__.py
 -rw-rw-r--  2.0 unx     2419 b- defN 22-Jul-19 06:48 nanga/summarization/core/texts/sentence_handler.py
 -rw-rw-r--  2.0 unx       39 b- defN 22-Jul-18 12:36 nanga/summarization/models/__init__.py
 -rw-rw-r--  2.0 unx     6866 b- defN 22-Jul-19 07:08 nanga/summarization/models/bert_models.py
 -rw-rw-r--  2.0 unx       24 b- defN 22-Jul-27 07:46 nanga/utils/__init__.py
 -rw-rw-r--  2.0 unx     1259 b- defN 22-Jul-27 07:13 nanga/utils/log.py
--rw-rw-r--  2.0 unx      800 b- defN 22-Jul-29 10:50 nanga-0.0.9rc2.dist-info/METADATA
--rw-rw-r--  2.0 unx       92 b- defN 22-Jul-29 10:50 nanga-0.0.9rc2.dist-info/WHEEL
--rw-rw-r--  2.0 unx        6 b- defN 22-Jul-29 10:50 nanga-0.0.9rc2.dist-info/top_level.txt
-?rw-rw-r--  2.0 unx     3627 b- defN 22-Jul-29 10:50 nanga-0.0.9rc2.dist-info/RECORD
-41 files, 138222 bytes uncompressed, 39408 bytes compressed:  71.5%
+-rw-rw-r--  2.0 unx      800 b- defN 23-Apr-27 15:24 nanga-0.1.0rc2.dist-info/METADATA
+-rw-rw-r--  2.0 unx       92 b- defN 23-Apr-27 15:24 nanga-0.1.0rc2.dist-info/WHEEL
+-rw-rw-r--  2.0 unx        6 b- defN 23-Apr-27 15:24 nanga-0.1.0rc2.dist-info/top_level.txt
+?rw-rw-r--  2.0 unx     3627 b- defN 23-Apr-27 15:24 nanga-0.1.0rc2.dist-info/RECORD
+41 files, 138384 bytes uncompressed, 39449 bytes compressed:  71.5%
```

## zipnote {}

```diff
@@ -105,20 +105,20 @@
 
 Filename: nanga/utils/__init__.py
 Comment: 
 
 Filename: nanga/utils/log.py
 Comment: 
 
-Filename: nanga-0.0.9rc2.dist-info/METADATA
+Filename: nanga-0.1.0rc2.dist-info/METADATA
 Comment: 
 
-Filename: nanga-0.0.9rc2.dist-info/WHEEL
+Filename: nanga-0.1.0rc2.dist-info/WHEEL
 Comment: 
 
-Filename: nanga-0.0.9rc2.dist-info/top_level.txt
+Filename: nanga-0.1.0rc2.dist-info/top_level.txt
 Comment: 
 
-Filename: nanga-0.0.9rc2.dist-info/RECORD
+Filename: nanga-0.1.0rc2.dist-info/RECORD
 Comment: 
 
 Zip file comment:
```

## nanga/sarcat/models/legacy/inference.py

```diff
@@ -23,15 +23,15 @@
         #nlp.vocab,
         #rules = rules,
         #prefix_search=prefix_re.search,
         #suffix_search=suffix_re.search,
         #infix_finditer=infix_re.finditer,
     #)
 
-def predict(model, title: str, abstract: str, return_mcats=False):
+def predict(model, title: str, abstract: str, return_mcats=False, device=None):
     ''' Get the predicted categories from a model, a title and an abstract.
 
     INPUT
         model: torch.nn.Module
             A trained model
         title: str
             The title of a research paper
@@ -54,18 +54,22 @@
     # Load the tokeniser
 
     tokenizer = nlp.Defaults.create_tokenizer(nlp)
     #tokenizer = nlp.tokenizer
 
     # Numericalise the tokens
     idxs = torch.LongTensor([[model.stoi[t.text] for t in tokenizer(text)]])
+    if device:
+        idxs = idxs.to(device)
 
     # Get predictions
-    logits = model(idxs.transpose(0, 1))
-    probs = torch.sigmoid(logits)
+    with torch.no_grad():
+        model.eval()
+        logits = model(idxs.transpose(0, 1))
+    probs = torch.sigmoid(logits.detach().cpu()) if device else torch.sigmoid(logits)
 
     # Get the categories corresponding to the predictions
     cats = get_cats(data_dir = model.data_dir)['id']
     sorted_idxs = probs.argsort(descending = True)
     predicted_cats = [(cats[idx], round(float(probs[idx]), 2))
         for idx in sorted_idxs if probs[idx] >= min(0.5, torch.max(probs))]
```

## Comparing `nanga-0.0.9rc2.dist-info/METADATA` & `nanga-0.1.0rc2.dist-info/METADATA`

 * *Files 2% similar despite different names*

```diff
@@ -1,10 +1,10 @@
 Metadata-Version: 2.1
 Name: nanga
-Version: 0.0.9rc2
+Version: 0.1.0rc2
 Summary: NLP tasks
 Home-page: UNKNOWN
 Author: Fréjus A.A. Laleye
 Author-email: frejus.laleye@gmail.com
 Maintainer: Fréjus A. A. Laleye
 Maintainer-email: frejus.laleye@gmail.com
 License: UNKNOWN
@@ -15,13 +15,13 @@
 Classifier: Programming Language :: Python :: 3
 Classifier: Operating System :: OS Independent
 Requires-Python: >=3.7
 Description-Content-Type: text/markdown
 Requires-Dist: transformers (==4.20.1)
 Requires-Dist: joblib (==1.1.0)
 Requires-Dist: torch (==1.7.1)
-Requires-Dist: spacy (==2.3.2)
+Requires-Dist: spacy (==3.4.4)
 Requires-Dist: scikit-learn (==1.1.1)
 Requires-Dist: torchtext (==0.8.1)
 
 # nanga
```

## Comparing `nanga-0.0.9rc2.dist-info/RECORD` & `nanga-0.1.0rc2.dist-info/RECORD`

 * *Files 3% similar despite different names*

```diff
@@ -10,15 +10,15 @@
 nanga/sarcat/train.py,sha256=5agiDSsVYPN-AIma_LZs_3b-6XyZywHWv4pPxa8dmEg,11177
 nanga/sarcat/models/__init__.py,sha256=SS45fv49zjYAK-GK0YrVTYnt3qt1edVzVmuwzxJGkdk,56
 nanga/sarcat/models/bert_models.py,sha256=xESyIPUNkOJ4SbPX4X3LTXCojptO2V3PDhH_WhKKyyU,1314
 nanga/sarcat/models/modules.py,sha256=V9hjXNppjZgrDCe8H88t7GlwVRJgZJ8s5kEX-g5kjjQ,13315
 nanga/sarcat/models/rnn_models.py,sha256=RijJX7PYhE9_lTpGiiHaNi7fUeEdWLyfFRnJJmfUcnM,11959
 nanga/sarcat/models/legacy/__init__.py,sha256=gPpcywRQakoRWOCIzq4fh2BjX46C113B4OVHDrJEd-4,33
 nanga/sarcat/models/legacy/db.py,sha256=dC-5TxPY9O4d8Ocavzvp5jMfGG8ilqXIWEgE3CJwySw,10031
-nanga/sarcat/models/legacy/inference.py,sha256=VT87wfbX-4N5GD7cWkHbYBDcN9cjlsJ8HNsdT6vurVo,4165
+nanga/sarcat/models/legacy/inference.py,sha256=SGiCnfHou0HDzhzJy4lHsGQ-sPCVI0K-ajpLDmOsVMU,4327
 nanga/sarcat/models/legacy/modules.py,sha256=1uay6UgRSekp0AKdFK2ZFBUarcIkGPRx5xlORd0dx4g,13376
 nanga/sarcat/models/legacy/utils.py,sha256=C1ncC8SWhg0SL5bLTmGYKbWtVyxIERejSxrPr-3beLo,17760
 nanga/sarcat/predictions/__init__.py,sha256=UF0QTo7hWpxGVyeCtg_osBiQvH8FDhT4O62v1P-zjCo,123
 nanga/sarcat/predictions/classification.py,sha256=hvdsbrfAhfM3Jrp_5fXhroJOaTkcsxEGfCaq9E-w79w,14232
 nanga/sarcat/predictions/utils.py,sha256=0SniBxmWSt1_v_qv3EHqSpianOIZ_n0rOQs8OR2frvY,652
 nanga/summarization/__init__.py,sha256=j1HnBUSX9ZS0pC3LBx0581UA-6QFVAhq5zGFGcTLMY8,101
 nanga/summarization/inference.py,sha256=6XjCOr25xXO9hWZoU_7Fcslud-o_LiBPM4FljsKlccM,698
@@ -31,11 +31,11 @@
 nanga/summarization/core/extractive/extractive_summarizer.py,sha256=QWWm_86OsOknMND1Y5NnQsL_FIxKqBYPGzCNDAatHLQ,7312
 nanga/summarization/core/texts/__init__.py,sha256=_XP6TFhcMluovJLjud3WH7SlfjcFc3WiKfG4h64sWuQ,46
 nanga/summarization/core/texts/sentence_handler.py,sha256=s9FQWDWt6Fdri4NdGledpqfYNag3fl5re7-s7F74T-Q,2419
 nanga/summarization/models/__init__.py,sha256=tHYHy53-xNOHX3O-5WKpahUPXKM21uIJ2r6gF_UM9hM,39
 nanga/summarization/models/bert_models.py,sha256=iEwliMraaCJD41ichDlhyEClNO2ixYOBoqvZxTUW_W4,6866
 nanga/utils/__init__.py,sha256=BGNIj7InL5EAbQjIcaalzvkQCSy3-ykPi3e_g0kMZzQ,24
 nanga/utils/log.py,sha256=zU8C1_mnXV4z14Ilao78sUotVrurcO6ymNsQa5p5ZCY,1259
-nanga-0.0.9rc2.dist-info/METADATA,sha256=Xsaw2aiflAoVpzDvCTZbxtlA3rVyuuG0LTVOmfnoiOU,800
-nanga-0.0.9rc2.dist-info/WHEEL,sha256=g4nMs7d-Xl9-xC9XovUrsDHGXt-FT0E17Yqo92DEfvY,92
-nanga-0.0.9rc2.dist-info/top_level.txt,sha256=ZXWTSEH_GkKdJBBOBDRvP3gQAHrd4na5av9FCPXn85s,6
-nanga-0.0.9rc2.dist-info/RECORD,,
+nanga-0.1.0rc2.dist-info/METADATA,sha256=9PL68NpssON0K60m7iDlR92y3HAPYMmycI7GRKKXjiA,800
+nanga-0.1.0rc2.dist-info/WHEEL,sha256=g4nMs7d-Xl9-xC9XovUrsDHGXt-FT0E17Yqo92DEfvY,92
+nanga-0.1.0rc2.dist-info/top_level.txt,sha256=ZXWTSEH_GkKdJBBOBDRvP3gQAHrd4na5av9FCPXn85s,6
+nanga-0.1.0rc2.dist-info/RECORD,,
```

